<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="å¦é—¨ç¿”å®‰æ€æ˜é™¢åŒº">
<title>ä½“æ£€æ ‡æœ¬æ¥æ”¶</title>

<link rel='canonical' href='https://work.717170.xyz/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/'>

<link rel="stylesheet" href="/scss/style.min.9f449ccc662f48c455f81316fd5cb87099956cabbb7a108c4681662ea647628e.css"><meta property='og:title' content="ä½“æ£€æ ‡æœ¬æ¥æ”¶">
<meta property='og:description' content="å¦é—¨ç¿”å®‰æ€æ˜é™¢åŒº">
<meta property='og:url' content='https://work.717170.xyz/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/'>
<meta property='og:site_name' content='æœ¨å­æ´‹'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-01-12T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-01-12T23:59:59&#43;00:00'/><meta property='og:image' content='https://work.717170.xyz/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110221-lxg7dmt.png' />
<meta name="twitter:title" content="ä½“æ£€æ ‡æœ¬æ¥æ”¶">
<meta name="twitter:description" content="å¦é—¨ç¿”å®‰æ€æ˜é™¢åŒº"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://work.717170.xyz/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110221-lxg7dmt.png' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/touxiang_hu_3261c9b36eb249a9.jpg" width="300"
                            height="285" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">æœ¨å­æ´‹</a></h1>
            <h2 class="site-description">To be or not to be.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/muziyangg'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>é¦–é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/link/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹é“¾</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#æ›´æ–°ä½ç½®">æ›´æ–°ä½ç½®</a>
          <ol>
            <li><a href="#è·å–ä¸œåå…±åº“æ¨¡å¼æ ‡æœ¬ä¿¡æ¯è·å–">è·å–ä¸œåå…±åº“æ¨¡å¼æ ‡æœ¬ä¿¡æ¯è·å–</a></li>
            <li><a href="#æ‰§è¡ŒåŒ»å˜±">æ‰§è¡ŒåŒ»å˜±</a></li>
            <li><a href="#ä¿å­˜å›æ’æ›´æ–°ä¸­é—´è¡¨çŠ¶æ€">ä¿å­˜å›æ’æ›´æ–°ä¸­é—´è¡¨çŠ¶æ€</a></li>
            <li><a href="#è·å–æ¡ç ä¿¡æ¯åŠåŒ»å˜±ä¿¡æ¯">è·å–æ¡ç ä¿¡æ¯åŠåŒ»å˜±ä¿¡æ¯</a></li>
            <li><a href="#æ£€éªŒå†…éƒ¨æ‰§è¡Œ">æ£€éªŒå†…éƒ¨æ‰§è¡Œ</a></li>
            <li><a href="#å–æ¶ˆåŒ»å˜±æ‰§è¡Œ">å–æ¶ˆåŒ»å˜±æ‰§è¡Œ</a></li>
            <li><a href="#å–æ¶ˆliså†…éƒ¨åŒ»å˜±æ‰§è¡Œ">å–æ¶ˆLISå†…éƒ¨åŒ»å˜±æ‰§è¡Œ</a></li>
            <li><a href="#è®¾ç½®ä½“æ£€æ ‡æœ¬å·ç±»å‹">è®¾ç½®ä½“æ£€æ ‡æœ¬å·ç±»å‹</a></li>
            <li><a href="#å‘é€ä½“æ£€æŠ¥å‘Šåˆ°ä½“æ£€">å‘é€ä½“æ£€æŠ¥å‘Šåˆ°ä½“æ£€</a></li>
          </ol>
        </li>
        <li><a href="#æ›´æ–°å¯¼å…¥ç±»">æ›´æ–°å¯¼å…¥ç±»</a>
          <ol>
            <li><a href="#ä¸šåŠ¡ç±»">ä¸šåŠ¡ç±»</a></li>
            <li><a href="#æ›´æ–°çŠ¶æ€ç±»">æ›´æ–°çŠ¶æ€ç±»</a></li>
          </ol>
        </li>
        <li><a href="#xmlä¸²ä¿¡æ¯">XMLä¸²ä¿¡æ¯</a>
          <ol>
            <li><a href="#ä½“æ£€è¿”å›ä¸²">ä½“æ£€è¿”å›ä¸²</a></li>
            <li><a href="#æ ¼å¼åŒ–åä¸²">æ ¼å¼åŒ–åä¸²</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/">
                <img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110221-lxg7dmt_hu_91babc78fb62c3e.png"
                        srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110221-lxg7dmt_hu_91babc78fb62c3e.png 800w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110221-lxg7dmt_hu_3fb434e55f68bc62.png 1600w"
                        width="800" 
                        height="360" 
                        loading="lazy"
                        alt="Featured image of post ä½“æ£€æ ‡æœ¬æ¥æ”¶" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E9%A1%B9%E7%9B%AE%E5%8A%9F%E8%83%BD/" >
                é¡¹ç›®åŠŸèƒ½
            </a>
        
            <a href="/categories/%E5%8E%A6%E9%97%A8%E7%BF%94%E5%AE%89%E6%80%9D%E6%98%8E%E9%99%A2%E5%8C%BA/" >
                å¦é—¨ç¿”å®‰æ€æ˜é™¢åŒº
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/">ä½“æ£€æ ‡æœ¬æ¥æ”¶</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            å¦é—¨ç¿”å®‰æ€æ˜é™¢åŒº
        </h3>
        
    </div>

        
        <footer class="article-time">
            
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                    <time class="article-time--published">2025-01-12</time>
                </div>
            

            
            
                        æœ€åæ›´æ–°äº
                        <time class="article-time--updated" datetime="2025-01-12 23:59:59 &#43;0000 UTC" title="2025-01-12 23:59:59 &#43;0000 UTC">
                            2025-01-12 23:59:59
                        </time>
			
			
			
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



					<time class="article-words">
						26635å­—
					</time>
				</div>
			
			

            
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                    <time class="article-time--reading">
                        é˜…è¯»æ—¶é•¿: 54 åˆ†é’Ÿ
                    </time>
                </div>
            
        </footer>
    


    
</div>
</header>



    <section class="article-content">
    
    
    <h3 id="æ›´æ–°ä½ç½®">æ›´æ–°ä½ç½®
</h3><h4 id="è·å–ä¸œåå…±åº“æ¨¡å¼æ ‡æœ¬ä¿¡æ¯è·å–">è·å–ä¸œåå…±åº“æ¨¡å¼æ ‡æœ¬ä¿¡æ¯è·å–
</h4><blockquote>
<p>LISProxy.BLL.RPVisitNumber.cls(GetLISInerLabNoInfo+7): s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).GetILabTestSetInfo(BarCode)<br>
LISProxy.BLL.RPVisitNumber.cls(GetLISInerLabNoInfo+35): s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).GetILabTestSetInfo(BarCode)<br>
LISProxy.BLL.RPVisitNumber.cls(GetLISInerLabNoInfo+42): s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).GetInnerLabNoInfo(BarCode)</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// Creator:  
</span></span><span class="line"><span class="cl">/// CreatDate:	2021-11-22
</span></span><span class="line"><span class="cl">/// Description:hè·å–ä¸œåä¾›åº“æ¨¡å¼æ ‡æœ¬ä¿¡æ¯è·å–
</span></span><span class="line"><span class="cl">/// Table:		æ— 
</span></span><span class="line"><span class="cl">/// Global:	
</span></span><span class="line"><span class="cl">/// Input:		æ¡ç å·
</span></span><span class="line"><span class="cl">/// Return:	
</span></span><span class="line"><span class="cl">/// Others:		W ##Class(LISProxy.BLL.RPVisitNumber).GetSampleInfo(&#34;1212&#34;)
</span></span><span class="line"><span class="cl">ClassMethod GetLISInerLabNoInfo(BarCode As %String, SYSCode As %String) As %GlobalCharacterStream
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s CurNamespace=$ZUTIL(5)
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">	s WebNamespace=##Class(OTH.SYSParameter).GetWebNamespace()
</span></span><span class="line"><span class="cl">	b //ä¸­é—´è¡¨å–æ•°æ®
</span></span><span class="line"><span class="cl">	i $d(^dbo.RILabTestSetI(&#34;BarCode&#34;,BarCode))
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).GetILabTestSetInfo(BarCode)
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">	elseif SYSCode=&#34;HIS1&#34; 
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	   NEW $NAMESPACE 
</span></span><span class="line"><span class="cl">	   s $NAMESPACE= WebNamespace
</span></span><span class="line"><span class="cl">	   s RetVal=##class(LISAPP.LIS.BLL.DHCReceiveInterface).GetLabNoInfo(BarCode)
</span></span><span class="line"><span class="cl">	   s $NAMESPACE= CurNamespace
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    elseif SYSCode=&#34;HIS3&#34; 
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		//s RetVal=##class(MI.TEST.ReceiveVisitNumber).GetXML(BarCode)
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	   //NEW $NAMESPACE 
</span></span><span class="line"><span class="cl">	   s ^DHCLIS(&#34;BARCODE&#34;,1)=BarCode
</span></span><span class="line"><span class="cl">	   s $NAMESPACE= &#34;DHC-APP&#34;
</span></span><span class="line"><span class="cl">	   //s RetVal=##class(LISAPP.LIS.BLL.DHCReceiveInterface).GetLabNoInfo(BarCode)
</span></span><span class="line"><span class="cl">	   set stream=##class(%GlobalCharacterStream).%New()
</span></span><span class="line"><span class="cl">	   s messageCode=&#34;MES0068&#34;
</span></span><span class="line"><span class="cl">	   s xml=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;1&lt;/SourceSystem&gt;&lt;MessageID&gt;20&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;GetPatOrdListRt&gt;&lt;SpecimenID&gt;&#34;_BarCode_&#34;&lt;/SpecimenID&gt;&lt;UpdateUserCode&gt;demo&lt;/UpdateUserCode&gt;&lt;UpdateDate&gt;2024-12-19&lt;/UpdateDate&gt;&lt;UpdateTime&gt;10:00:00&lt;/UpdateTime&gt;&lt;/GetPatOrdListRt&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">	         //&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;1&lt;/SourceSystem&gt;&lt;MessageID&gt;20&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;GetPatOrdListRt&gt;&lt;SpecimenID&gt;6080005712&lt;/SpecimenID&gt;&lt;UpdateUserCode&gt;demo&lt;/UpdateUserCode&gt;&lt;UpdateDate&gt;2024-12-19&lt;/UpdateDate&gt;&lt;UpdateTime&gt;10:00:00&lt;/UpdateTime&gt;&lt;/GetPatOrdListRt&gt;&lt;/Body&gt;&lt;/Request&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	   do stream.Write(xml)
</span></span><span class="line"><span class="cl">	   s RetVal=##class(web.DHCENS.EnsHISService).DHCHisInterface(&#34;S00000064&#34;,messageCode,stream).Read()
</span></span><span class="line"><span class="cl">	   s $NAMESPACE= &#34;dhc-lisdata&#34;
</span></span><span class="line"><span class="cl">	   s ^DHCLIS(&#34;BARCODE&#34;)=RetVal
</span></span><span class="line"><span class="cl">	   s ret=##class(LIS.WS.BLL.DHCENSLabInterface).SaveRequestTestSet(RetVal)
</span></span><span class="line"><span class="cl">	   s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).GetILabTestSetInfo(BarCode)
</span></span><span class="line"><span class="cl">	   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	elseif SYSCode=&#34;OTH&#34; 
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">	   s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).GetInnerLabNoInfo(BarCode)
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	elseif SYSCode=&#34;YG&#34;
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		s RetVal=##Class(LISProxy.BLL.ReceiveYGVisitNmber).GetLabNoInfo(BarCode)
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	q RetVal
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110221-lxg7dmt.png"
	width="1319"
	height="594"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110221-lxg7dmt_hu_3399781779ee8eb6.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110221-lxg7dmt_hu_eca0c2b7fb9a9d5f.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="532px"
	
>â€‹</p>
<h4 id="æ‰§è¡ŒåŒ»å˜±">æ‰§è¡ŒåŒ»å˜±
</h4><blockquote>
<p>HIS.DHCReceiveInterface.cls(ExecOrdItem+8)</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// Creatorï¼š      huangliangliang
</span></span><span class="line"><span class="cl">/// CreatDateï¼š    202100202
</span></span><span class="line"><span class="cl">/// Description:ï¼š æ‰§è¡ŒåŒ»å˜±
</span></span><span class="line"><span class="cl">/// Inputï¼š        Labno æ¡ç å·ï¼ˆå¿…ä¼ ï¼‰ TestSetList æ‰§è¡ŒåŒ»å˜±åˆ—è¡¨ï¼ˆæ ¼å¼å¦‚ä¸‹åŒ»å˜±ä¸»é”®@S@ç¬¬ä¸‰æ–¹æˆ–HISåŒ»å˜±ä¸»é”®@S@åŒ»å˜±ä»·æ ¼@I@åŒ»å˜±ä¸»é”®@S@ç¬¬ä¸‰æ–¹æˆ–HISåŒ»å˜±ä¸»é”®@S@åŒ»å˜±ä»·æ ¼ï¼‰ UserCode ç”¨æˆ·ä»£ç ï¼ˆæ‰§è¡ŒåŒ»å˜±ç”¨æˆ·ï¼‰
</span></span><span class="line"><span class="cl">/// Outputï¼š     
</span></span><span class="line"><span class="cl">/// Returnï¼š       1æˆåŠŸ å…¶ä»–å¤±è´¥
</span></span><span class="line"><span class="cl">/// Othersï¼š 
</span></span><span class="line"><span class="cl">/// w ##class(HIS.DHCReceiveInterface).GetLabNoInfo
</span></span><span class="line"><span class="cl">ClassMethod ExecOrdItem(Labno As %String, Usercode As %String, TestSetList As %String(MAXLEN=1000)) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	// è·å–æ¡ç ç±»å‹
</span></span><span class="line"><span class="cl">	s LabNoType=##class(LIS.Common.DHCVisitNumber).GetLabNoType(Labno)
</span></span><span class="line"><span class="cl">	s retValue=1
</span></span><span class="line"><span class="cl">    //ä¸­é—´è¡¨æ¨¡å¼
</span></span><span class="line"><span class="cl">	i $d(^dbo.RILabTestSetI(&#34;BarCode&#34;,Labno))
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		s retValue=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTestSetState(Labno,TestSetList,&#34;5&#34;,Usercode)
</span></span><span class="line"><span class="cl">    } 
</span></span><span class="line"><span class="cl">	i LabNoType=&#34;HIS1&#34;
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	    // è·å–his NameSpace
</span></span><span class="line"><span class="cl">	    s WebNamespace=##Class(OTH.SYSParameter).GetWebNamespace()
</span></span><span class="line"><span class="cl">	    s $Namespace= WebNamespace
</span></span><span class="line"><span class="cl">	    s retValue=##Class(LISAPP.LIS.BLL.DHCReceiveInterface).ExecOrdItem(Labno,Usercode,TestSetList)
</span></span><span class="line"><span class="cl">	    s $Namespace=&#34;DHC-LISDATA&#34;
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	elseif LabNoType=&#34;HIS2&#34; //è€ç³»ç»Ÿæ¡ç 
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">	    	//ä¿å­˜æ ‡æœ¬åŒ»å˜±
</span></span><span class="line"><span class="cl">	    	s ExceTSList=&#34;&#34;
</span></span><span class="line"><span class="cl">		    s SplitStr=&#34;@S@&#34;,ItemSpitStr=&#34;@I@&#34;
</span></span><span class="line"><span class="cl">			f z=1:1:$l(TestSetList,ItemSpitStr)
</span></span><span class="line"><span class="cl">		    {
</span></span><span class="line"><span class="cl">			    s TSItem=$p(TestSetList,ItemSpitStr,z)
</span></span><span class="line"><span class="cl">			    i &#39;$l(TSItem) continue
</span></span><span class="line"><span class="cl">			    s HISOrderID=$p(TSItem,SplitStr,1)
</span></span><span class="line"><span class="cl">			    s OrdId=$p(TSItem,SplitStr,1)
</span></span><span class="line"><span class="cl">			    s OrdSubId=$p(TSItem,SplitStr,2)
</span></span><span class="line"><span class="cl">			    s TestSetDR=$p(TSItem,SplitStr,3)
</span></span><span class="line"><span class="cl">			    s TestSetCode=$lg($g(^dbo.BTTestSetD(TestSetDR)),2)
</span></span><span class="line"><span class="cl">			    S TestSetFee=$p(TSItem,SplitStr,7)
</span></span><span class="line"><span class="cl">			    S $p(TSItem,SplitStr,3)=TestSetCode
</span></span><span class="line"><span class="cl">			    //s TSItem=$replace(TSItem,SplitStr,&#34;|&#34;)
</span></span><span class="line"><span class="cl">			    S ExceTSList=TSItem_&#34;^&#34;_ExceTSList
</span></span><span class="line"><span class="cl">			  
</span></span><span class="line"><span class="cl">			}
</span></span><span class="line"><span class="cl">			s ServiceObj=##Class(TransReportService.TransReportServiceSoap).%New()
</span></span><span class="line"><span class="cl">			s retValue=ServiceObj.ExecOrdItem(Labno,Usercode,ExceTSList)
</span></span><span class="line"><span class="cl">			i retValue=0 s retValue=1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	elseif LabNoType=&#34;T&#34;
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		// é€šè¿‡ä½“æ£€webserviceè·å–xml
</span></span><span class="line"><span class="cl">		// è§£æç»„è£…æ ‡å‡†xml æ˜¯å¦è®©å¹³å°ç›´æ¥ä¿®æ”¹æä¾›æ ‡å‡†æ ¼å¼
</span></span><span class="line"><span class="cl">		// s LabNoInfo=&#34;&#34;_Labno
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	elseif LabNoType=&#34;EME&#34;
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		//&#34;åº”æ€¥é¢„ç•™&#34;
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	else
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	    s Msg=&#34;æœªè·å–åˆ°å¯è¯†åˆ«æ¡ç ç±»å‹ï¼&#34;
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	q retValue
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105517-v5f3sb2.png"
	width="1277"
	height="522"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105517-v5f3sb2_hu_2a4ff1f244c15aef.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105517-v5f3sb2_hu_8f91ed8a5d7f834e.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="587px"
	
>â€‹</p>
<h4 id="ä¿å­˜å›æ’æ›´æ–°ä¸­é—´è¡¨çŠ¶æ€">ä¿å­˜å›æ’æ›´æ–°ä¸­é—´è¡¨çŠ¶æ€
</h4><blockquote>
<p>HIS.DHCReceiveCommon.cls(SaveLabNoReportInfo+189)</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">            //æ›´æ–°ä¸­é—´è¡¨æ•°æ®
</span></span><span class="line"><span class="cl">            s IRet=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTSAcceptInfo(objVisitNumberReport.RowID)
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105252-hz2g63u.png"
	width="1284"
	height="528"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105252-hz2g63u_hu_d6fcd93c923ebe19.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105252-hz2g63u_hu_72325dcab5a0ddd8.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="243"
		data-flex-basis="583px"
	
>â€‹</p>
<h4 id="è·å–æ¡ç ä¿¡æ¯åŠåŒ»å˜±ä¿¡æ¯">è·å–æ¡ç ä¿¡æ¯åŠåŒ»å˜±ä¿¡æ¯
</h4><blockquote>
<p>HIS.DHCReceiveInterface.cls(GetLabNoInfo+10)</p>
<p>HIS.DHCReceiveInterface.cls(GetLabNoInfo+46)</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">//å°è¯•ä¸­é—´è¡¨å–æ•°æ®
</span></span><span class="line"><span class="cl">	i $d(^dbo.RILabTestSetI(&#34;BarCode&#34;,Labno))
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		s VisitNumberStream=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).GetILabTestSetInfo(Labno,RetType,UserCode)
</span></span><span class="line"><span class="cl">		q VisitNumberStream
</span></span><span class="line"><span class="cl">    } 
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">elseif LabNoType=&#34;HIS&#34;
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		s VisitNumberStream=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).GetInnerLabNoInfo(Labno,RetType,UserCode)
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	}
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105740-dhwt04k.png"
	width="1245"
	height="519"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105740-dhwt04k_hu_793beb38e3b3cb1b.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105740-dhwt04k_hu_1176a242b96bde30.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="239"
		data-flex-basis="575px"
	
>â€‹</p>
<p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105805-6sj599p.png"
	width="1222"
	height="264"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105805-6sj599p_hu_2ec76d3ec63a220a.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105805-6sj599p_hu_f1ec7598cfe7e8e8.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="462"
		data-flex-basis="1110px"
	
>â€‹</p>
<h4 id="æ£€éªŒå†…éƒ¨æ‰§è¡Œ">æ£€éªŒå†…éƒ¨æ‰§è¡Œ
</h4><blockquote>
<p>LISProxy.BLL.RPVisitNumber.cls(OrderLISInerItemExec+10): s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTestSetState(BarCode,TestSetList,&ldquo;5&rdquo;,UserCode)</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// Creator:  
</span></span><span class="line"><span class="cl">/// CreatDate:	2021-11-22
</span></span><span class="line"><span class="cl">/// Description:æ£€éªŒå†…éƒ¨æ‰§è¡Œ
</span></span><span class="line"><span class="cl">/// Table:		æ— 
</span></span><span class="line"><span class="cl">/// Global:	
</span></span><span class="line"><span class="cl">/// Input:		æ¡ç å· å·¥å· åŒ»å˜±åˆ—è¡¨ ç³»ç»Ÿç±»å‹
</span></span><span class="line"><span class="cl">/// Return:	
</span></span><span class="line"><span class="cl">/// Others:		W ##Class(LISProxy.BLL.RPVisitNumber).GetSampleInfo(&#34;1212&#34;)
</span></span><span class="line"><span class="cl">ClassMethod OrderLISInerItemExec(BarCode As %String, UserCode As %String, TestSetList As %String, SYSCode As %String) As %GlobalCharacterStream
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s BarCode=$g(BarCode),UserCode=$g(UserCode),TestSetList=$g(TestSetList),SYSCode=$g(SYSCode)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s CurNamespace=$ZUTIL(5)
</span></span><span class="line"><span class="cl">	s WebNamespace=##Class(OTH.SYSParameter).GetWebNamespace()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s RetVal=&#34;1&#34;
</span></span><span class="line"><span class="cl">	//ä¸­é—´è¡¨å–æ•°æ®
</span></span><span class="line"><span class="cl">	i $d(^dbo.RILabTestSetI(&#34;BarCode&#34;,BarCode))
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTestSetState(BarCode,TestSetList,&#34;5&#34;,UserCode)
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">	elseif SYSCode=&#34;HIS1&#34; 
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	   NEW $NAMESPACE 
</span></span><span class="line"><span class="cl">	   s $NAMESPACE= WebNamespace
</span></span><span class="line"><span class="cl">	   s RetVal=##Class(LISAPP.LIS.BLL.DHCReceiveInterface).ExecOrdItem(BarCode,UserCode,TestSetList)
</span></span><span class="line"><span class="cl">	   s $NAMESPACE= CurNamespace
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	elseif SYSCode=&#34;OTH&#34; 
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	   //s RetVal=1  // é»˜è®¤è¿”å›1 
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	q RetVal
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110317-c8m8tu0.png"
	width="1496"
	height="577"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110317-c8m8tu0_hu_fe48dea5b5ee961c.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110317-c8m8tu0_hu_a6fb61a0caa32b4c.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="259"
		data-flex-basis="622px"
	
>â€‹</p>
<h4 id="å–æ¶ˆåŒ»å˜±æ‰§è¡Œ">å–æ¶ˆåŒ»å˜±æ‰§è¡Œ
</h4><blockquote>
<p>HIS.DHCReceiveInterface.cls(CancelOrdItem+8)</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// Creatorï¼š      huangliangliang
</span></span><span class="line"><span class="cl">/// CreatDateï¼š    202100202
</span></span><span class="line"><span class="cl">/// Description:ï¼š å–æ¶ˆåŒ»å˜±æ‰§è¡Œ
</span></span><span class="line"><span class="cl">/// Inputï¼š        Labno æ¡ç å·ï¼ˆå¿…ä¼ ï¼‰ HISOrderID åŒ»å˜±rowid  UserCode ç”¨æˆ·ä»£ç ï¼ˆæ‰§è¡ŒåŒ»å˜±ç”¨æˆ·ï¼‰
</span></span><span class="line"><span class="cl">/// Outputï¼š     
</span></span><span class="line"><span class="cl">/// Returnï¼š       1æˆåŠŸ å…¶ä»–å¤±è´¥
</span></span><span class="line"><span class="cl">/// Othersï¼š 
</span></span><span class="line"><span class="cl">/// w ##class(HIS.DHCReceiveInterface).CancelOrdItem
</span></span><span class="line"><span class="cl">/// /
</span></span><span class="line"><span class="cl">ClassMethod CancelOrdItem(Labno, HISOrderID, UserCode) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	// è·å–æ¡ç ç±»å‹
</span></span><span class="line"><span class="cl">	s LabNoType=##class(LIS.Common.DHCVisitNumber).GetLabNoType(Labno)
</span></span><span class="line"><span class="cl">	s ret=1
</span></span><span class="line"><span class="cl">    //ä¸­é—´è¡¨æ¨¡å¼
</span></span><span class="line"><span class="cl">	i $d(^dbo.RILabTestSetI(&#34;BarCode&#34;,Labno))
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		s ret=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTSStateByHISOrderID(Labno,HISOrderID,&#34;7&#34;)
</span></span><span class="line"><span class="cl">		//q ret
</span></span><span class="line"><span class="cl">    } 
</span></span><span class="line"><span class="cl">	i LabNoType=&#34;HIS1&#34;
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	    // è·å–his NameSpace
</span></span><span class="line"><span class="cl">	    s WebNamespace=##Class(OTH.SYSParameter).GetWebNamespace()
</span></span><span class="line"><span class="cl">	    s $Namespace= WebNamespace
</span></span><span class="line"><span class="cl">	    s ret=##Class(LISAPP.LIS.BLL.DHCReceiveInterface).CancelOrdItem(Labno, HISOrderID, UserCode)
</span></span><span class="line"><span class="cl">	    i ret=0 s ret=1
</span></span><span class="line"><span class="cl">	    s $Namespace=&#34;DHC-LISDATA&#34;
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	elseif LabNoType=&#34;HIS2&#34; //è€ç³»ç»Ÿæ¡ç 
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">		s ServiceObj=##Class(TransReportService.TransReportServiceSoap).%New()
</span></span><span class="line"><span class="cl">		s ret=ServiceObj.RejectLabReport(Labno, HISOrderID, UserCode)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	q ret
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105405-hvlvp63.png"
	width="1150"
	height="575"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105405-hvlvp63_hu_a852760f8d7288aa.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105405-hvlvp63_hu_177c21e0b9e11710.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="480px"
	
>â€‹</p>
<h4 id="å–æ¶ˆliså†…éƒ¨åŒ»å˜±æ‰§è¡Œ">å–æ¶ˆLISå†…éƒ¨åŒ»å˜±æ‰§è¡Œ
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">LISProxy.BLL.RPVisitNumber.cls(CancelLISInerOrdItem+10): s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTestSetState(BarCode,TestSetList,&#34;5&#34;,UserCode)
</span></span><span class="line"><span class="cl">LISProxy.BLL.RPVisitNumber.cls(CancelLISInerOrdItem+11): s ret=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTSStateByHISOrderID(BarCode,TestSetList,&#34;7&#34;)
</span></span><span class="line"><span class="cl">LISProxy.BLL.RPVisitNumber.cls(CancelLISInerOrdItem+18): .s ret=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTSStateByHISOrderID(BarCode,HISOrderID,&#34;7&#34;)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// Creator:  
</span></span><span class="line"><span class="cl">/// CreatDate:	2021-11-22
</span></span><span class="line"><span class="cl">/// Description:å–æ¶ˆLISå†…éƒ¨åŒ»å˜±æ‰§è¡Œ
</span></span><span class="line"><span class="cl">/// Table:		æ— 
</span></span><span class="line"><span class="cl">/// Global:	
</span></span><span class="line"><span class="cl">/// Input:		æ¡ç å· å·¥å· åŒ»å˜±åˆ—è¡¨ ç³»ç»Ÿç±»å‹
</span></span><span class="line"><span class="cl">/// Return:	
</span></span><span class="line"><span class="cl">/// Others:		W ##Class(LISProxy.BLL.RPVisitNumber).GetSampleInfo(&#34;1212&#34;)
</span></span><span class="line"><span class="cl">ClassMethod CancelLISInerOrdItem(BarCode As %String, UserCode As %String, TestSetList As %String, SYSCode As %String) As %GlobalCharacterStream
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s BarCode=$g(BarCode),UserCode=$g(UserCode),TestSetList=$g(TestSetList),SYSCode=$g(SYSCode)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s CurNamespace=$ZUTIL(5)
</span></span><span class="line"><span class="cl">	s WebNamespace=##Class(OTH.SYSParameter).GetWebNamespace()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s RetVal=1
</span></span><span class="line"><span class="cl">	//ä¸­é—´è¡¨å–æ•°æ®
</span></span><span class="line"><span class="cl">	i $d(^dbo.RILabTestSetI(&#34;BarCode&#34;,BarCode))
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		s RetVal=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTestSetState(BarCode,TestSetList,&#34;5&#34;,UserCode)
</span></span><span class="line"><span class="cl">		s ret=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTSStateByHISOrderID(BarCode,TestSetList,&#34;7&#34;)
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	    s SplitStr=&#34;@I@&#34;
</span></span><span class="line"><span class="cl">	    s ErrorInfo=&#34;&#34;
</span></span><span class="line"><span class="cl">	    f i=1:1:$l(TestSetList,SplitStr) d  q:$l(ErrorInfo)
</span></span><span class="line"><span class="cl">	    .s HISOrderID=$p(TestSetList,SplitStr,i)
</span></span><span class="line"><span class="cl">	    .i &#39;$l(HISOrderID) q
</span></span><span class="line"><span class="cl">	    .s ret=##Class(LIS.WS.BLL.DHCReceiveInerLanNoInfo).SetILabTSStateByHISOrderID(BarCode,HISOrderID,&#34;7&#34;)
</span></span><span class="line"><span class="cl">	    .i ret&#39;=0 s ErrorInfo=ret
</span></span><span class="line"><span class="cl">	    i $l(ErrorInfo) s RetVal=ErrorInfo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">	elseif SYSCode=&#34;HIS1&#34; 
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	   NEW $NAMESPACE 
</span></span><span class="line"><span class="cl">	   s $NAMESPACE=WebNamespace
</span></span><span class="line"><span class="cl">	   s SplitStr=&#34;@I@&#34;
</span></span><span class="line"><span class="cl">	   s ErrorInfo=&#34;&#34;
</span></span><span class="line"><span class="cl">	   f i=1:1:$l(TestSetList,SplitStr) d  q:$l(ErrorInfo)
</span></span><span class="line"><span class="cl">	   .s HISOrderID=$p(TestSetList,SplitStr,i)
</span></span><span class="line"><span class="cl">	   .i &#39;$l(HISOrderID) q
</span></span><span class="line"><span class="cl">	   .s ret=##class(LISAPP.LIS.BLL.DHCReceiveInterface).CancelOrdItem(BarCode,HISOrderID,UserCode)
</span></span><span class="line"><span class="cl">	   .i ret&#39;=0 s ErrorInfo=ret
</span></span><span class="line"><span class="cl">	   s $NAMESPACE=CurNamespace
</span></span><span class="line"><span class="cl">	   i $l(ErrorInfo) s RetVal=ErrorInfo
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	elseif SYSCode=&#34;OTH&#34; 
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">	   //s RetVal=1  // é»˜è®¤è¿”å›1 
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	q RetVal
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110043-3094mlo.png"
	width="1231"
	height="621"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110043-3094mlo_hu_56bbab5af22b9ac8.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104110043-3094mlo_hu_3cd95e4ad936b11.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="475px"
	
>â€‹</p>
<h4 id="è®¾ç½®ä½“æ£€æ ‡æœ¬å·ç±»å‹">è®¾ç½®ä½“æ£€æ ‡æœ¬å·ç±»å‹
</h4><blockquote>
<p>w ##Class(LIS.Common.DHCVisitNumber).GetLabNoType(Labno)</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// Others  w ##Class(LIS.Common.DHCVisitNumber).GetLabNoType(Labno) 
</span></span><span class="line"><span class="cl">/// å…¥å‚æ¡ç å·
</span></span><span class="line"><span class="cl">/// å‡ºå‚è¯´æ˜å¦‚ä¸‹
</span></span><span class="line"><span class="cl">/// ä¸œåHIS Parameter DHCS = &#34;HIS1&#34;;
</span></span><span class="line"><span class="cl">/// ä¸œåè€HIS Parameter DHCO = &#34;HIS2&#34;;
</span></span><span class="line"><span class="cl">/// ç¬¬ä¸‰æ–¹HISç³»ç»Ÿ Parameter HIS = &#34;HIS3&#34;;
</span></span><span class="line"><span class="cl">/// ç¬¬ä¸‰æ–¹ä½“æ£€ç³»ç»Ÿ Parameter PES1 = &#34;PES1&#34;;
</span></span><span class="line"><span class="cl">/// ç¬¬ä¸‰æ–¹ä½“æ£€ç³»ç»Ÿ Parameter PES2 = &#34;PES2&#34;;
</span></span><span class="line"><span class="cl">/// å…¶å®ƒç³»ç»Ÿ Parameter OTH = &#34;OTH&#34;;
</span></span><span class="line"><span class="cl">ClassMethod GetLabNoType(LabNo) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	//é»˜è®¤ä¸œåHISæ¡ç ç±»å‹
</span></span><span class="line"><span class="cl">	s RetType=##Class(LIS.ENUM.SYSCode).#DHCS
</span></span><span class="line"><span class="cl">	//æ‰‹å·¥æ¡ç 
</span></span><span class="line"><span class="cl">	i $e(LabNo)=&#34;9&#34; s RetType=##Class(LIS.ENUM.SYSCode).#OTH
</span></span><span class="line"><span class="cl">	i $e(LabNo)=&#34;8&#34; s RetType=##Class(LIS.ENUM.SYSCode).#OTH	//YHR 20241226 è®¾ç½®8å¼€å¤´çš„ä¸ºåˆ†é™¢æ‰‹å·¥ç™»è®°æ ‡æœ¬
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	i $e(LabNo)=&#34;K&#34; s RetType=##Class(LIS.ENUM.SYSCode).#PES1
</span></span><span class="line"><span class="cl">	i $e(LabNo)=&#34;6&#34; d
</span></span><span class="line"><span class="cl">	.s RetType=##Class(LIS.ENUM.SYSCode).#HIS //ä½“æ£€ç³»ç»Ÿæ¥å£
</span></span><span class="line"><span class="cl">	i ($e(LabNo)=&#34;O&#34;)||($e(LabNo)=&#34;E&#34;) s RetType=##Class(LIS.ENUM.SYSCode).#YG
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	//ä¸œåè€HISç³»ç»Ÿæ¡ç 
</span></span><span class="line"><span class="cl">	//i $e(LabNo)=&#34;7&#34;,$L(LabNo)=8 s RetType=##Class(LIS.ENUM.SYSCode).#DHCO
</span></span><span class="line"><span class="cl">	Q RetType
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105849-7xxg5gp.png"
	width="1114"
	height="503"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105849-7xxg5gp_hu_9ec461aaa39dc315.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104105849-7xxg5gp_hu_f4bf9f1c5d702284.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="221"
		data-flex-basis="531px"
	
>â€‹</p>
<h4 id="å‘é€ä½“æ£€æŠ¥å‘Šåˆ°ä½“æ£€">å‘é€ä½“æ£€æŠ¥å‘Šåˆ°ä½“æ£€
</h4><h5 id="è§¦å‘æ–¹æ³•">è§¦å‘æ–¹æ³•
</h5><p>â€‹<img src="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104111922-gr3jkwb.png"
	width="1139"
	height="686"
	srcset="/p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104111922-gr3jkwb_hu_211b0d558cb0b63.png 480w, /p/%E4%BD%93%E6%A3%80%E6%A0%87%E6%9C%AC%E6%8E%A5%E6%94%B620250112235959/assets/image-20250104111922-gr3jkwb_hu_f875568d89fe6178.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="398px"
	
>â€‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">//YHR 20241231 æ¨é€ç»“æœåˆ°ä½“æ£€
</span></span><span class="line"><span class="cl">		i $e(Labno)=6 d
</span></span><span class="line"><span class="cl">		.try{s ret=##Class(LIS.Service.ENS.TransReport).SendToTiJian(VisitNumberReportDR)}catch{}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// d ##class(LIS.Service.ENS.TransReport).SendToTiJian(&#34;3333385&#34;)
</span></span><span class="line"><span class="cl">ClassMethod SendToTiJian(ReportDR)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s xml=..GetReportNew(ReportDR)
</span></span><span class="line"><span class="cl">	zn &#34;dhc-app&#34;
</span></span><span class="line"><span class="cl">	set stream=##class(%GlobalCharacterStream).%New()
</span></span><span class="line"><span class="cl">	do stream.Write(xml)
</span></span><span class="line"><span class="cl">	s messageCode=&#34;MES0069&#34;
</span></span><span class="line"><span class="cl">	s ret=##class(web.DHCENS.EnsHISService).DHCHisInterface(&#34;S00000064&#34;,messageCode,stream)
</span></span><span class="line"><span class="cl">	zn &#34;dhc-lisdata&#34;
</span></span><span class="line"><span class="cl">	q &#34;&#34;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="è°ƒç”¨æ–¹æ³•">è°ƒç”¨æ–¹æ³•
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// Creatorï¼š        liuzf
</span></span><span class="line"><span class="cl">/// CreateDateï¼š 2016-04-27
</span></span><span class="line"><span class="cl">/// Descriptionï¼š    å‘é€æ ‡æœ¬ç»“æœåˆ°ä½“æ£€
</span></span><span class="line"><span class="cl">/// Tableï¼š          æ— 
</span></span><span class="line"><span class="cl">/// Inputï¼š          æ£€éªŒå·
</span></span><span class="line"><span class="cl">/// Outputï¼š     æ— 
</span></span><span class="line"><span class="cl">/// Returnï¼š     é”™è¯¯ä¿¡æ¯
</span></span><span class="line"><span class="cl">/// Othersï¼š     æ— 
</span></span><span class="line"><span class="cl">/// w ##Class(LIS.Service.ENS.TransReport).GetReportNew(&#34;3333181&#34;,&#34;&#34;)
</span></span><span class="line"><span class="cl">ClassMethod GetReportNew(ReportDR As %String, ByRef error As %String) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s ReportDR=$g(ReportDR)
</span></span><span class="line"><span class="cl">    //Set $ZTrap = &#34;ErrorHandle&#34;
</span></span><span class="line"><span class="cl">    //åŸºæœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">    s ^TMP(&#34;YY&#34;,&#34;ReportDR&#34;)=ReportDR
</span></span><span class="line"><span class="cl">    s RetStr=&#34;&#34;
</span></span><span class="line"><span class="cl">    i &#39;$l(ReportDR) q $$ReturnOut(&#34;æ— æ­¤æŠ¥å‘Š&#34;)
</span></span><span class="line"><span class="cl">    i &#39;$l(ReportDR) q $$ReturnOut(&#34;æ— æ­¤æŠ¥å‘Š&#34;)
</span></span><span class="line"><span class="cl">    s ReportData=$g(^dbo.RPVisitNumberReportD(ReportDR))
</span></span><span class="line"><span class="cl">    i $lg(ReportData,22)&#39;=3 q $$ReturnOut(&#34;æŠ¥å‘Šæœªå®¡æ ¸&#34;)
</span></span><span class="line"><span class="cl">    s VisitNumberDR=$lg(ReportData,2)
</span></span><span class="line"><span class="cl">    i &#39;$l(VisitNumberDR) q $$ReturnOut(&#34;æ— æ­¤æŠ¥å‘Š&#34;)
</span></span><span class="line"><span class="cl">    s VisitNumberData=$g(^dbo.RPVisitNumberD(VisitNumberDR))
</span></span><span class="line"><span class="cl">    s LabNo=$lg(VisitNumberData,2)
</span></span><span class="line"><span class="cl">    s gName=$lg(VisitNumberData,14)
</span></span><span class="line"><span class="cl">    s sName=$lg(VisitNumberData,13)
</span></span><span class="line"><span class="cl">    s patname=gName_&#34; &#34;_sName
</span></span><span class="line"><span class="cl">    i gName=sName s patname=gName
</span></span><span class="line"><span class="cl">    s spname=&#34;&#34;             ;æ€§åˆ«
</span></span><span class="line"><span class="cl">    s SpeciesDR=$lg(VisitNumberData,15)
</span></span><span class="line"><span class="cl">    i $l(SpeciesDR) s spname=$lg(^dbo.BTSpeciesD(SpeciesDR),3)
</span></span><span class="line"><span class="cl">    s patDOB=$lg(VisitNumberData,16)
</span></span><span class="line"><span class="cl">    i (patDOB&lt;10000000) s patDOB=$zd(patDOB,8)
</span></span><span class="line"><span class="cl">    i $l(patDOB) s patDOB=##Class(LIS.Util.Common).FormatDate(patDOB)
</span></span><span class="line"><span class="cl">    s Age=$lg(VisitNumberData,18)
</span></span><span class="line"><span class="cl">    s AgeUnitDR=$lg(VisitNumberData,19),AgeUnit=&#34;&#34;
</span></span><span class="line"><span class="cl">    i $l(AgeUnitDR) s AgeUnit=$lg($g(^dbo.BTAgeUnitD(AgeUnitDR)),3)
</span></span><span class="line"><span class="cl">    s patage=Age_AgeUnit
</span></span><span class="line"><span class="cl">    //
</span></span><span class="line"><span class="cl">    s SpecimenDR=$lg(VisitNumberData,56),specmen=&#34;&#34;   ;æ ‡æœ¬ç±»å‹
</span></span><span class="line"><span class="cl">    i $l(SpecimenDR) s specmen=$lg($g(^dbo.BTSpecimenD(SpecimenDR)),3)  
</span></span><span class="line"><span class="cl">    s tsname=&#34;&#34;,TSCode=&#34;&#34;
</span></span><span class="line"><span class="cl">    s TestSetDR=&#34;&#34; f  s TestSetDR=$o(^dbo.RPVisitNumberTestSetI(&#34;IndexMaster&#34;,VisitNumberDR,TestSetDR)) q:TestSetDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    .i $l(tsname) s tsname=tsname_&#34;+&#34;_$lg(^dbo.BTTestSetD(TestSetDR),3),TSCode=TSCode_&#34;+&#34;_$lg(^dbo.BTTestSetD(TestSetDR),2)
</span></span><span class="line"><span class="cl">    .e  s tsname=$lg(^dbo.BTTestSetD(TestSetDR),3),TSCode=$lg(^dbo.BTTestSetD(TestSetDR),2)
</span></span><span class="line"><span class="cl">    i $l(specmen,&#34;(&#34;)&gt;1 s specmen=$p(specmen,&#34;(&#34;,1)
</span></span><span class="line"><span class="cl">    //
</span></span><span class="line"><span class="cl">    s patloc=&#34;&#34;                    ;ç§‘å®¤
</span></span><span class="line"><span class="cl">    s LocationDR=$lg(VisitNumberData,22)
</span></span><span class="line"><span class="cl">    i $l(LocationDR) s patloc=$lg($g(^dbo.BTLocationD(LocationDR)),3)
</span></span><span class="line"><span class="cl">    //ç”³è¯·æ—¥æœŸ
</span></span><span class="line"><span class="cl">    s requestdate=$lg(VisitNumberData,24)
</span></span><span class="line"><span class="cl">    i (requestdate&lt;10000000) s requestdate=$zd(requestdate,8) 
</span></span><span class="line"><span class="cl">    i $l(requestdate) s requestdate=##Class(LIS.Util.Common).FormatDate(requestdate)
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    //
</span></span><span class="line"><span class="cl">    s (recdate,rectime,recusr,entrydate,entrytime,entryusr,authdate,authtime,authusr)=&#34;&#34;
</span></span><span class="line"><span class="cl">    s recdate=$lg(VisitNumberData,66)   ;æ¥æ”¶æ—¥æœŸ
</span></span><span class="line"><span class="cl">    s rectime=$lg(VisitNumberData,67)   ;æ¥æ”¶æ—¶é—´
</span></span><span class="line"><span class="cl">    i $l(recdate) s recdate=##Class(LIS.Util.Common).FormatDate(recdate)
</span></span><span class="line"><span class="cl">    i $l(rectime) s rectime=##Class(LIS.Util.Common).FormatTime(rectime)
</span></span><span class="line"><span class="cl">    s ReceiveUserDR=$lg(VisitNumberData,68)
</span></span><span class="line"><span class="cl">    i $l(ReceiveUserDR) s recusr=$lg($g(^dbo.SYSUserD(ReceiveUserDR)),3) 
</span></span><span class="line"><span class="cl">    s entrydate=$lg(ReportData,16)      ;åˆå®¡æ—¥æœŸ
</span></span><span class="line"><span class="cl">    s entrytime=$lg(ReportData,17)      ;åˆå®¡æ—¶é—´
</span></span><span class="line"><span class="cl">    i $l(entrydate) s entrydate=##Class(LIS.Util.Common).FormatDate(entrydate)
</span></span><span class="line"><span class="cl">    i $l(entrytime) s entrytime=##Class(LIS.Util.Common).FormatTime(entrytime)
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    s EntryUserDR=$lg(ReportData,18)
</span></span><span class="line"><span class="cl">    i $l(EntryUserDR) s entryusr=$lg($g(^dbo.SYSUserD(EntryUserDR)),3)
</span></span><span class="line"><span class="cl">    s authdate=$lg(ReportData,19)       ;æ ¸æ”¶æ—¥æœŸ
</span></span><span class="line"><span class="cl">    s authtime=$lg(ReportData,20)       ;æ ¸æ”¶æ—¶é—´
</span></span><span class="line"><span class="cl">    i $l(authdate) s authdate=##Class(LIS.Util.Common).FormatDate(authdate)
</span></span><span class="line"><span class="cl">    i $l(authtime) s authtime=##Class(LIS.Util.Common).FormatTime(authtime)
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    s AuthUserDR=$lg(ReportData,21)
</span></span><span class="line"><span class="cl">    i $l(AuthUserDR) s authusr=$lg($g(^dbo.SYSUserD(AuthUserDR)),3)
</span></span><span class="line"><span class="cl">    //
</span></span><span class="line"><span class="cl">    s coldate=$lg(VisitNumberData,51)   ;é‡‡é›†æ—¥æœŸ
</span></span><span class="line"><span class="cl">    s coltime=$lg(VisitNumberData,52)   ;é‡‡é›†æ—¶é—´
</span></span><span class="line"><span class="cl">    i $l(coldate) s coldate=##Class(LIS.Util.Common).FormatDate(coldate)
</span></span><span class="line"><span class="cl">    i $l(coltime) s coltime=##Class(LIS.Util.Common).FormatTime(coltime)
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    s CollDT=&#34;&#34;
</span></span><span class="line"><span class="cl">    i $l(coldate) s CollDT=coldate_&#34; &#34;_coltime
</span></span><span class="line"><span class="cl">    //
</span></span><span class="line"><span class="cl">    s (recDT,entryDT,authDT)=&#34;&#34;
</span></span><span class="line"><span class="cl">    i $l(recdate) s recDT=recdate_&#34; &#34;_rectime
</span></span><span class="line"><span class="cl">    i $l(entrydate) s entryDT=entrydate_&#34; &#34;_entrytime
</span></span><span class="line"><span class="cl">    i $l(authdate) s authDT=authdate_&#34; &#34;_authtime
</span></span><span class="line"><span class="cl">    //
</span></span><span class="line"><span class="cl">    s debtor=$lg(VisitNumberData,3)  ;ç™»è®°å·
</span></span><span class="line"><span class="cl">    s DoctorDR=$lg(VisitNumberData,23)
</span></span><span class="line"><span class="cl">    s docname=&#34;&#34;                    ;åŒ»ç”Ÿ
</span></span><span class="line"><span class="cl">    i $l(DoctorDR) s docname=$lg($g(^dbo.BTDoctorD(DoctorDR)),3)
</span></span><span class="line"><span class="cl">    //è¯Šæ–­
</span></span><span class="line"><span class="cl">    s patdiag=&#34;&#34;
</span></span><span class="line"><span class="cl">    s DiseaseDR=&#34;&#34; f  s DiseaseDR=$o(^dbo.RPVisitNumberDiagnoseI(&#34;IndexMaster&#34;,VisitNumberDR,DiseaseDR)) q:DiseaseDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    .i $l(patdiag) s patdiag=patdiag_&#34;+&#34;_$lg(^dbo.BTDiseaseD(DiseaseDR),4)
</span></span><span class="line"><span class="cl">    .e  s patdiag=$lg(^dbo.BTDiseaseD(DiseaseDR),4)
</span></span><span class="line"><span class="cl">    //ä»ªå™¨,ç—…åŒº,åºŠå·,æµæ°´å·
</span></span><span class="line"><span class="cl">    s Machine=&#34;&#34;
</span></span><span class="line"><span class="cl">    //s MachineDR=$lg(ResultData,14)
</span></span><span class="line"><span class="cl">    //i $l(MachineDR) s Machine=$lg($g(^dbo.BTMIMachineParameterD(MachineDR)),3)
</span></span><span class="line"><span class="cl">    s bed=$lg(VisitNumberData,27)    ;åºŠå·
</span></span><span class="line"><span class="cl">    s WardName=&#34;&#34;
</span></span><span class="line"><span class="cl">    s WardDR=$lg(VisitNumberData,26)
</span></span><span class="line"><span class="cl">    i $l(WardDR) s WardName=$lg($g(^dbo.BTWardD(WardDR)),3)
</span></span><span class="line"><span class="cl">    s episode=$lg(ReportData,8)
</span></span><span class="line"><span class="cl">    //æ£€éªŒç§‘-é—¨è¯Šæ£€éªŒç»„\Lab Manager#84322268
</span></span><span class="line"><span class="cl">    s Depart=&#34;&#34;
</span></span><span class="line"><span class="cl">    s WorkGroupMachineDR=$lg(ReportData,4)
</span></span><span class="line"><span class="cl">    i $l(WorkGroupMachineDR) s WorkGroupDR=$lg($g(^dbo.BTWorkGroupMachineD(WorkGroupMachineDR)),4)
</span></span><span class="line"><span class="cl">    i $l(WorkGroupDR) s DepartPhone=$lg($g(^dbo.BTWorkGroupD(WorkGroupDR)),6)
</span></span><span class="line"><span class="cl">    // 20141114
</span></span><span class="line"><span class="cl">    s AdmID=$lg(VisitNumberData,6)
</span></span><span class="line"><span class="cl">    s AdmNo=$lg(VisitNumberData,5)
</span></span><span class="line"><span class="cl">    s Notes=$lg(VisitNumberData,48)
</span></span><span class="line"><span class="cl">    s requestNo=$p($lg(VisitNumberData,48),&#34;^&#34;)
</span></span><span class="line"><span class="cl">    S obj=##Class(LIS.Service.ENS.Data.ReportMsg).%New()
</span></span><span class="line"><span class="cl">    s obj.OrdID=requestNo
</span></span><span class="line"><span class="cl">    //s obj.OEORIARCItmMastDesc=&#34;&#34;
</span></span><span class="line"><span class="cl">    //s obj.PAADMVisitNumber=&#34;&#34;
</span></span><span class="line"><span class="cl">    s obj.LabNo=LabNo
</span></span><span class="line"><span class="cl">    s obj.PAADMVisitNumber=AdmNo
</span></span><span class="line"><span class="cl">    s obj.ReportID=ReportDR ///æŠ¥å‘ŠID
</span></span><span class="line"><span class="cl">    s obj.ReportUrl=&#34;&#34;      //æŠ¥å‘Šåœ°å€
</span></span><span class="line"><span class="cl">    s obj.RecUser=recusr            //æ¥æ”¶è€…
</span></span><span class="line"><span class="cl">    s obj.RecUserCode=ReceiveUserDR //æ¥æ”¶è€…ä»£ç 
</span></span><span class="line"><span class="cl">    s obj.RecDate=recdate       //æ¥æ”¶æ—¥æœŸ
</span></span><span class="line"><span class="cl">    s obj.RecTime=rectime       //æ¥æ”¶æ—¶é—´
</span></span><span class="line"><span class="cl">    s obj.EntryUser=entryusr    //å½•å…¥è€…
</span></span><span class="line"><span class="cl">    s obj.EntryUserCode=EntryUserDR //å½•å…¥è€…ä»£ç 
</span></span><span class="line"><span class="cl">    s obj.EntryDate=entrydate   //å½•å…¥æ—¥æœŸ
</span></span><span class="line"><span class="cl">    s obj.EntryTime=entrytime   //å½•å…¥æ—¶é—´
</span></span><span class="line"><span class="cl">    s obj.AuthUser=authusr      //å®¡æ ¸è€…
</span></span><span class="line"><span class="cl">    s obj.AuthUserCode=AuthUserDR   //å®¡æ ¸è€…ä»£ç 
</span></span><span class="line"><span class="cl">    s obj.AuthDate=authdate //å®¡æ ¸æ—¥æœŸ
</span></span><span class="line"><span class="cl">    s obj.AuthTime=authtime //å®¡æ ¸æ—¶é—´
</span></span><span class="line"><span class="cl">    s obj.Notes=Notes       //æŠ¥å‘Šå¤‡æ³¨
</span></span><span class="line"><span class="cl">    s obj.ImageFile=&#34;&#34;      //å›¾åƒçš„è·¯å¾„ï¼ˆå¤šå¹…å›¾ä½¿ç”¨@åˆ†å‰²ï¼‰ 
</span></span><span class="line"><span class="cl">    s obj.MainWarnDesc=&#34;&#34;   //å±æ€¥å€¼è¯´æ˜ 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    //ç»“æœ
</span></span><span class="line"><span class="cl">    Set result = ##class(%ResultSet).%New(&#34;LIS.Service.ENS.Business.ReportResult:QryTestSetResult&#34;)
</span></span><span class="line"><span class="cl">    Set sc = result.Execute(ReportDR)
</span></span><span class="line"><span class="cl">    While (result.Next(.sc)) // go to the next row of the result set
</span></span><span class="line"><span class="cl">     {
</span></span><span class="line"><span class="cl">        If ($SYSTEM.Status.IsOK(sc)) // check if this succeeded without errors
</span></span><span class="line"><span class="cl">            {
</span></span><span class="line"><span class="cl">                s objRes=##Class(LIS.Service.ENS.Data.ResultMsg).%New()
</span></span><span class="line"><span class="cl">                s objRes.LabNo=LabNo
</span></span><span class="line"><span class="cl">                s objRes.TestSetCode=result.Data(&#34;TestSetCode&#34;)
</span></span><span class="line"><span class="cl">                s objRes.TestCode=result.Data(&#34;TestCode&#34;)
</span></span><span class="line"><span class="cl">                s objRes.TestName=result.Data(&#34;TestName&#34;)
</span></span><span class="line"><span class="cl">                s objRes.TestEngName=result.Data(&#34;TestSync&#34;)
</span></span><span class="line"><span class="cl">                s objRes.Result=result.Data(&#34;Result&#34;)
</span></span><span class="line"><span class="cl">                s ResFlag=result.Data(&#34;ResFlag&#34;)
</span></span><span class="line"><span class="cl">                i &#39;$l(ResFlag) s ResFlag=&#34;N&#34;
</span></span><span class="line"><span class="cl">                s objRes.ResultFlag=ResFlag
</span></span><span class="line"><span class="cl">                s objRes.Units=result.Data(&#34;Unit&#34;)
</span></span><span class="line"><span class="cl">                s Ranges=result.Data(&#34;Ranges&#34;)
</span></span><span class="line"><span class="cl">                i &#39;$l(Ranges) s Ranges=&#34; &#34;
</span></span><span class="line"><span class="cl">                s objRes.Ranges=Ranges
</span></span><span class="line"><span class="cl">                s MICFlag=result.Data(&#34;MICFlag&#34;)
</span></span><span class="line"><span class="cl">                //whf add 2016-8-29
</span></span><span class="line"><span class="cl">                i MICFlag=&#34;Y&#34;
</span></span><span class="line"><span class="cl">                {
</span></span><span class="line"><span class="cl">                    s objRes.MICFlag=&#34;Y&#34;
</span></span><span class="line"><span class="cl">                    s objRes.Result=result.Data(&#34;OrganismCode&#34;)
</span></span><span class="line"><span class="cl">                    s objRes.MICName=result.Data(&#34;OrganismDesc&#34;)
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">                //
</span></span><span class="line"><span class="cl">                s objRes.Sequence=result.Data(&#34;Sequence&#34;) //æ˜¾ç¤ºé¡ºåº 20141114 huhm
</span></span><span class="line"><span class="cl">                s objRes.OrdID=result.Data(&#34;PAADMVisitNumber&#34;)
</span></span><span class="line"><span class="cl">                s objRes.OEORIARCItmMastDesc=result.Data(&#34;OEORIARCItmMastDesc&#34;)   //TestSetCode
</span></span><span class="line"><span class="cl">                s objRes.OEORIOrderItemID=result.Data(&#34;TestSetCode&#34;)
</span></span><span class="line"><span class="cl">                ///ç»†èŒç»“æœID
</span></span><span class="line"><span class="cl">                s SenResultId=result.Data(&#34;SenResultId&#34;)
</span></span><span class="line"><span class="cl">                i $l(SenResultId) 
</span></span><span class="line"><span class="cl">                {
</span></span><span class="line"><span class="cl">                    s sen=##class(%ResultSet).%New(&#34;LIS.Service.ENS.Business.ReportResult:QryTestSetResultSen&#34;)
</span></span><span class="line"><span class="cl">                    Set st = sen.Execute(SenResultId)
</span></span><span class="line"><span class="cl">                    While (sen.Next(.st))
</span></span><span class="line"><span class="cl">                    {
</span></span><span class="line"><span class="cl">                       If ($SYSTEM.Status.IsOK(st)) 
</span></span><span class="line"><span class="cl">                       {
</span></span><span class="line"><span class="cl">                           //WCode,AntCode,AntName,SenCode,SenName,SenMethod,SenValue
</span></span><span class="line"><span class="cl">                           s objSen=##Class(LIS.Service.ENS.Data.OrgResultMsg).%New()
</span></span><span class="line"><span class="cl">                           s objSen.BugsCode=result.Data(&#34;OrganismCode&#34;)
</span></span><span class="line"><span class="cl">                           s objSen.AntiCode=sen.Data(&#34;AntCode&#34;)
</span></span><span class="line"><span class="cl">                           s objSen.AntiName=sen.Data(&#34;AntName&#34;)
</span></span><span class="line"><span class="cl">                           s objSen.Result=sen.Data(&#34;SenName&#34;)
</span></span><span class="line"><span class="cl">                           s objSen.KBRes=sen.Data(&#34;SenMethod&#34;)
</span></span><span class="line"><span class="cl">                           s objSen.MICRes=sen.Data(&#34;SenValue&#34;)
</span></span><span class="line"><span class="cl">                           s objSen.Order=sen.Data(&#34;Order&#34;)
</span></span><span class="line"><span class="cl">                           d objRes.OrgResultMsgs.Insert(objSen)
</span></span><span class="line"><span class="cl">                          //
</span></span><span class="line"><span class="cl">                       }
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">                d obj.ResultMsgs.Insert(objRes)
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">     }
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    s Input=&#34;&#34;
</span></span><span class="line"><span class="cl">    //d obj.XMLExportToStream(.Input)
</span></span><span class="line"><span class="cl">    //Set objStream=##class(%GlobalCharacterStream).%New()
</span></span><span class="line"><span class="cl">    // d objStream.Write(&#34;&lt;ReportData&gt;&#34;)
</span></span><span class="line"><span class="cl">    d obj.XMLExportToString(.Input)
</span></span><span class="line"><span class="cl">    ;s retObj=##Class(UtilsController.LIS.UtilsControllerHttpSoap12Endpoint).%New()
</span></span><span class="line"><span class="cl">    ;s Input=retObj.ReportMsg(Input)
</span></span><span class="line"><span class="cl">    ;s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;NFYY&lt;/SourceSystem&gt;&lt;MessageID&gt;åŒ»é™¢ä¿¡æ¯å¹³å°&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&#34;_Input_&#34;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">    s Input=&#34;&lt;Response&gt;&#34;_Input_&#34;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    Set objStream=##class(%GlobalCharacterStream).%New()
</span></span><span class="line"><span class="cl">    d objStream.Write(Input)
</span></span><span class="line"><span class="cl">    s ^TMP(&#34;Au&#34;,LabNo)=Input    
</span></span><span class="line"><span class="cl">    ;s $NameSpace=&#34;DHC-APP&#34;
</span></span><span class="line"><span class="cl">    ;s Input=##class(web.DHCENS.EnsHISService).DHCHisInterface(&#34;S00000046&#34;,objStream)
</span></span><span class="line"><span class="cl">    ;s $NameSpace=&#34;DHC-LISDATA&#34;
</span></span><span class="line"><span class="cl">    s ^TMP(&#34;AuReport&#34;,LabNo)=Input    
</span></span><span class="line"><span class="cl">    q Input 
</span></span><span class="line"><span class="cl">ErrorHandle
</span></span><span class="line"><span class="cl">    s err=$tr(&#34;æŸ¥è¯¢å¼‚å¸¸.é”™è¯¯&#34;_$tr($ZERROR,&#34;^&#34;,&#34;--&#34;)_&#34;.é”™è¯¯ä»£ç :&#34;_$ECODE,&#34;&lt;&gt;&#34;)
</span></span><span class="line"><span class="cl">    Quit $$ReturnOut(err)
</span></span><span class="line"><span class="cl">ReturnOut(err)
</span></span><span class="line"><span class="cl">    //Set objStream=##class(%GlobalCharacterStream).%New()
</span></span><span class="line"><span class="cl">    //d objStream.Write(&#34;&lt;ReportData&gt;&#34;)
</span></span><span class="line"><span class="cl">    //d objStream.Write(&#34;&lt;ReturnValue&gt;-1^&#34;_err_&#34;&lt;/ReturnValue&gt;&#34;)
</span></span><span class="line"><span class="cl">    //Do objStream.Write(&#34;&lt;/ReportData&gt;&#34;)
</span></span><span class="line"><span class="cl">    q &#34;-1^&#34;_err
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ›´æ–°å¯¼å…¥ç±»">æ›´æ–°å¯¼å…¥ç±»
</h3><h4 id="ä¸šåŠ¡ç±»">ä¸šåŠ¡ç±»
</h4><blockquote>
<p>LIS.WS.BLL.DHCReceiveInerLanNoInfo</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Class LIS.WS.BLL.DHCReceiveInerLanNoInfo Extends %RegisteredObject
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// è·å–æ£€éªŒæ‰‹å·¥ç”³è¯·æ ‡æœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">/// è·å–æ ‡æœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">ClassMethod GetInnerLabNoInfo(Labno As %String, RetType As %String, UserCode As %String, Output Msg As %String(MAXLEN=32767)) As %GlobalCharacterStream
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	// æ ‡æœ¬xml
</span></span><span class="line"><span class="cl">	s RetType=$g(RetType),UserCode=$g(UserCode)
</span></span><span class="line"><span class="cl">    s Msg=&#34;&#34;
</span></span><span class="line"><span class="cl">	s RetXML=##class(LIS.Util.COM.XML).New(&#34;Response&#34;)
</span></span><span class="line"><span class="cl">    s Header=##class(LIS.Util.COM.XML).New(&#34;Header&#34;)
</span></span><span class="line"><span class="cl">	s objVisitNumber=##class(LIS.Util.COM.XML).New(&#34;Body&#34;)
</span></span><span class="line"><span class="cl">    s OrderList=##class(LIS.Util.COM.XML).New(&#34;OrderList&#34;)   
</span></span><span class="line"><span class="cl">    s VisitNumberDR=$o(^dbo.RPVisitNumberI(&#34;IndexVisitNumber&#34;,##Class(LIS.Util.Common).IndexData(Labno),&#34;&#34;)) 
</span></span><span class="line"><span class="cl">    i &#39;$l(VisitNumberDR)
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">	     s Header.ResultCode=&#34;-1&#34;
</span></span><span class="line"><span class="cl">		 s Header.ResultContent=&#34;æ¡ç ä¿¡æ¯ä¸å­˜åœ¨&#34; 
</span></span><span class="line"><span class="cl">		 d RetXML.Insert(Header)
</span></span><span class="line"><span class="cl">		 d RetXML.Insert(objVisitNumber)
</span></span><span class="line"><span class="cl">		 q RetXML.ToXMLStream()
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    s VisitNumberObjData=##class(dbo.RPVisitNumber).%OpenId(VisitNumberDR)
</span></span><span class="line"><span class="cl">    s HospitalDR=VisitNumberObjData.HospitalDR
</span></span><span class="line"><span class="cl">    s HospitalCode=&#34;&#34;
</span></span><span class="line"><span class="cl">    i $l(HospitalDR) s HospitalCode=$lg($g(^dbo.BTHospitalD(HospitalDR)),2)
</span></span><span class="line"><span class="cl">    s objVisitNumber.HospitalCode=HospitalCode
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    s TestSetDR=&#34;&#34;
</span></span><span class="line"><span class="cl">    f {
</span></span><span class="line"><span class="cl">         S TestSetDR=$o(^dbo.RPVisitNumberTestSetI(&#34;IndexMaster&#34;,VisitNumberDR,TestSetDR))
</span></span><span class="line"><span class="cl">         Q:TestSetDR=&#34;&#34;
</span></span><span class="line"><span class="cl">       
</span></span><span class="line"><span class="cl">         s RowID=$o(^dbo.RPVisitNumberTestSetI(&#34;IndexMaster&#34;,VisitNumberDR,TestSetDR,&#34;&#34;))
</span></span><span class="line"><span class="cl">		 i $l(RowID)
</span></span><span class="line"><span class="cl">		 {
</span></span><span class="line"><span class="cl">			 s OderItem=##class(LIS.Util.COM.XML).New(&#34;OderItem&#34;)
</span></span><span class="line"><span class="cl">			 s objTestSets=##class(dbo.RPVisitNumberTestSet).%OpenId(RowID)
</span></span><span class="line"><span class="cl">		     s OderItem.HISOrderID=&#34;&#34;
</span></span><span class="line"><span class="cl">			 s OderItem.TestSetCode=$lg($g(^dbo.BTTestSetD(TestSetDR)),2)
</span></span><span class="line"><span class="cl">			 s OderItem.OrdItmStat=&#34;&#34;
</span></span><span class="line"><span class="cl">			 s OderItem.Biled=0
</span></span><span class="line"><span class="cl">			 s OderItem.TestSetFee=objTestSets.TestSetFee
</span></span><span class="line"><span class="cl">			 d OrderList.Insert(OderItem) 
</span></span><span class="line"><span class="cl">      	}
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    D objVisitNumber.Insert(OrderList)
</span></span><span class="line"><span class="cl">   	//åªå–åŒ»å˜±ä¿¡æ¯
</span></span><span class="line"><span class="cl">   	i RetType=&#34;0&#34; 
</span></span><span class="line"><span class="cl">   	{
</span></span><span class="line"><span class="cl">   		 s Header.ResultCode=&#34;0&#34;
</span></span><span class="line"><span class="cl">		 s Header.ResultContent=&#34;&#34; 
</span></span><span class="line"><span class="cl">		 d RetXML.Insert(Header)
</span></span><span class="line"><span class="cl">		 d RetXML.Insert(objVisitNumber)
</span></span><span class="line"><span class="cl">		 q RetXML.ToXMLStream()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    //è·å–æ ‡æœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">  	s objVisitNumber.VisitNumber=VisitNumberObjData.VisitNumber
</span></span><span class="line"><span class="cl">	s objVisitNumber.RegNo=VisitNumberObjData.RegNo
</span></span><span class="line"><span class="cl">	s AdmissionTypeDR=VisitNumberObjData.AdmissionTypeDR
</span></span><span class="line"><span class="cl">	S AdmissionTypeCode=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(AdmissionTypeDR) s AdmissionTypeCode=$lg($g(^dbo.BTAdmissionTypeD(AdmissionTypeDR)),2)
</span></span><span class="line"><span class="cl">	s objVisitNumber.AdmissionTypeCode=AdmissionTypeCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.AdmNo=VisitNumberObjData.AdmNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.MedicalRecordNo=VisitNumberObjData.MedicalRecordNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.AdmDate=VisitNumberObjData.AdmDate
</span></span><span class="line"><span class="cl">	s AdmTime=VisitNumberObjData.AdmTime
</span></span><span class="line"><span class="cl">	i $l(AdmTime) s AdmTime=$zt(AdmTime,1)
</span></span><span class="line"><span class="cl">	s objVisitNumber.AdmTime=AdmTime
</span></span><span class="line"><span class="cl">	//s objVisitNumber.CertTypeDR=CertTypeDR  //è¯ä»¶ç±»å‹ é¢„ç•™ï¼Ÿ
</span></span><span class="line"><span class="cl">	s objVisitNumber.IDNumber=VisitNumberObjData.IDNumber
</span></span><span class="line"><span class="cl">	//s objVisitNumber.PaymentTypeDR=PaymentTypeDR  //æ”¯ä»˜ç±»å‹ é¢„ç•™ï¼Ÿ
</span></span><span class="line"><span class="cl">	s objVisitNumber.SurName=VisitNumberObjData.SurName
</span></span><span class="line"><span class="cl">	s objVisitNumber.GivenName=VisitNumberObjData.GivenName
</span></span><span class="line"><span class="cl">	s SpeciesDR=VisitNumberObjData.SpeciesDR
</span></span><span class="line"><span class="cl">	s (SexCode,SexName)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(SpeciesDR) s SexCode=$lg($g(^dbo.BTSpeciesD(SpeciesDR)),2),SexName=$lg($g(^dbo.BTSpeciesD(SpeciesDR)),3)
</span></span><span class="line"><span class="cl">	s objVisitNumber.SpeciesCode=SexCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.SpeciesDesc=SexName
</span></span><span class="line"><span class="cl">	s objVisitNumber.BirthDate=VisitNumberObjData.BirthDate
</span></span><span class="line"><span class="cl">	//s objVisitNumber.BirthTime=BirthTime
</span></span><span class="line"><span class="cl">	s objVisitNumber.Age=VisitNumberObjData.Age
</span></span><span class="line"><span class="cl">	s AgeUnitDR=VisitNumberObjData.AgeUnitDR
</span></span><span class="line"><span class="cl">	s (AgeCode,AgeUnitName)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(AgeUnitDR) s AgeCode=$lg($g(^dbo.BTAgeUnitD(AgeUnitDR)),2),AgeUnitName=$lg($g(^dbo.BTAgeUnitD(AgeUnitDR)),3)
</span></span><span class="line"><span class="cl">	s objVisitNumber.AgeUnitCode=AgeCode
</span></span><span class="line"><span class="cl">    s objVisitNumber.AgeUnitDesc=AgeUnitName
</span></span><span class="line"><span class="cl">	//s objVisitNumber.EthnicityDR=EthnicityDR    //æ°‘æ— é¢„ç•™ï¼Ÿ
</span></span><span class="line"><span class="cl">	s LocDR=VisitNumberObjData.LocationDR
</span></span><span class="line"><span class="cl">	s (LocCode,LocDesc)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(LocDR) s LocCode=$lg($g(^dbo.BTLocationD(LocDR)),2),LocDesc=$lg($g(^dbo.BTLocationD(LocDR)),3)
</span></span><span class="line"><span class="cl">	s objVisitNumber.LocationCode=LocCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.LocationDesc=LocDesc
</span></span><span class="line"><span class="cl">	s DoctorDR=VisitNumberObjData.DoctorDR
</span></span><span class="line"><span class="cl">	s (drcode,drname)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(DoctorDR) s drcode=$lg($g(^dbo.BTDoctorD(DoctorDR)),2),drname=$lg($g(^dbo.BTDoctorD(DoctorDR)),3)
</span></span><span class="line"><span class="cl">	s objVisitNumber.DoctorCode=drcode
</span></span><span class="line"><span class="cl">	s objVisitNumber.DoctorDesc=drname
</span></span><span class="line"><span class="cl">	s objVisitNumber.RequestDate=VisitNumberObjData.RequestDate
</span></span><span class="line"><span class="cl">	s RequestTime=VisitNumberObjData.RequestTime
</span></span><span class="line"><span class="cl">	i $l(RequestTime) s RequestTime=$zt(RequestTime,1)
</span></span><span class="line"><span class="cl">	s objVisitNumber.RequestTime=RequestTime
</span></span><span class="line"><span class="cl">	s WardDR=VisitNumberObjData.WardDR
</span></span><span class="line"><span class="cl">	s (WardCode,WardDesc)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(WardDR) s WardCode=$lg($g(^dbo.BTWardD(WardDR)),2),WardDesc=$lg($g(^dbo.BTWardD(WardDR)),3)
</span></span><span class="line"><span class="cl">	s objVisitNumber.WardCode=WardCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.WardDesc=WardDesc
</span></span><span class="line"><span class="cl">	s objVisitNumber.BedNo=VisitNumberObjData.BedNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.Symptom=VisitNumberObjData.Symptom //Symptom  è¯Šæ–­è·å–å…¬å…±CLS ï¼Ÿï¼Ÿï¼Ÿ
</span></span><span class="line"><span class="cl">	s objVisitNumber.MobileNo=VisitNumberObjData.MobileNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.PhoneNo=VisitNumberObjData.PhoneNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.EMail=VisitNumberObjData.EMail
</span></span><span class="line"><span class="cl">	s objVisitNumber.Address=VisitNumberObjData.Address
</span></span><span class="line"><span class="cl">	s objVisitNumber.PostCode=VisitNumberObjData.PostCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.ReqNotes=VisitNumberObjData.ReqNotes
</span></span><span class="line"><span class="cl">	s objVisitNumber.CarryDate=VisitNumberObjData.CarryDate
</span></span><span class="line"><span class="cl">	s CarryTime=VisitNumberObjData.CarryTime
</span></span><span class="line"><span class="cl">	i $l(CarryTime) s CarryTime=$zt(CarryTime,1)
</span></span><span class="line"><span class="cl">	s objVisitNumber.CarryTime=CarryTime
</span></span><span class="line"><span class="cl">	s CarryUserDR=VisitNumberObjData.CarryUserDR
</span></span><span class="line"><span class="cl">	s (CarryUserCode,CarryUserDesc)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(CarryUserDR) s CarryUserCode=$lg($g(^dbo.SYSUserD(CarryUserDR)),2),CarryUserDesc=$lg($g(^dbo.SYSUserD(CarryUserDR)),3)
</span></span><span class="line"><span class="cl">	s objVisitNumber.CarryUserCode=CarryUserCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.CarryUserDesc=CarryUserDesc
</span></span><span class="line"><span class="cl">	s objVisitNumber.Urgent=VisitNumberObjData.Urgent
</span></span><span class="line"><span class="cl">	s CollectUserDR=VisitNumberObjData.CollectUserDR
</span></span><span class="line"><span class="cl">	s (ColUserCode,ColUserName)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(CollectUserDR) s CarryUserCode=$lg($g(^dbo.SYSUserD(CollectUserDR)),2),CarryUserDesc=$lg($g(^dbo.SYSUserD(CollectUserDR)),3)
</span></span><span class="line"><span class="cl">	s objVisitNumber.CollectDate=VisitNumberObjData.CollectDate
</span></span><span class="line"><span class="cl">	s CollectTime=VisitNumberObjData.CollectTime
</span></span><span class="line"><span class="cl">	i $l(CollectTime) s CollectTime=$zt(CollectTime,1)
</span></span><span class="line"><span class="cl">	s objVisitNumber.CollectTime=CollectTime
</span></span><span class="line"><span class="cl">	s objVisitNumber.CollectUserCode=ColUserCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.CollectUserCode=ColUserName
</span></span><span class="line"><span class="cl">	s SpecimenDR=VisitNumberObjData.SpecimenDR
</span></span><span class="line"><span class="cl">	s ContainerDR=VisitNumberObjData.ContainerDR
</span></span><span class="line"><span class="cl">	s (SpecCode,ConCode)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(SpecimenDR) s SpecCode=$lg($g(^dbo.BTSpecimenD(SpecimenDR)),2)
</span></span><span class="line"><span class="cl">	i $l(ContainerDR) s ConCode=$lg($g(^dbo.BTContainerD(ContainerDR)),2)
</span></span><span class="line"><span class="cl">	s objVisitNumber.SpecimenCode=SpecCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.SpecimenDesc=&#34;&#34;
</span></span><span class="line"><span class="cl">	s objVisitNumber.ContainerCode=ConCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.CollectNotes=&#34;&#34;
</span></span><span class="line"><span class="cl">	s objVisitNumber.H24UVolume=&#34;&#34;
</span></span><span class="line"><span class="cl">	s objVisitNumber.H24UTimePeriod=&#34;&#34;
</span></span><span class="line"><span class="cl">	s objVisitNumber.BodyTemp=&#34;&#34;
</span></span><span class="line"><span class="cl">	s objVisitNumber.Confidential=&#34;&#34;
</span></span><span class="line"><span class="cl">	s objVisitNumber.AgeDesc=VisitNumberObjData.AgeDesc
</span></span><span class="line"><span class="cl">	s objVisitNumber.ICDs=VisitNumberObjData.ICDs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s Header.ResultCode=&#34;0&#34;
</span></span><span class="line"><span class="cl">	s Header.ResultContent=&#34;&#34; 
</span></span><span class="line"><span class="cl">	d RetXML.Insert(Header)
</span></span><span class="line"><span class="cl">	d RetXML.Insert(objVisitNumber)
</span></span><span class="line"><span class="cl">	q RetXML.ToXMLStream()
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// è·å–ä¸­é—´è¡¨æ ‡æœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">ClassMethod GetILabTestSetInfo(Labno As %String, RetType As %String, UserCode As %String, Output Msg As %String(MAXLEN=32767)) As %GlobalCharacterStream
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s Labno=$g(Labno),RetType=$g(RetType),UserCode=$g(UserCode)
</span></span><span class="line"><span class="cl">	// æ ‡æœ¬xml
</span></span><span class="line"><span class="cl">	s RetXML=##class(LIS.Util.COM.XML).New(&#34;Response&#34;)
</span></span><span class="line"><span class="cl">    s Header=##class(LIS.Util.COM.XML).New(&#34;Header&#34;)
</span></span><span class="line"><span class="cl">	s objVisitNumber=##class(LIS.Util.COM.XML).New(&#34;Body&#34;)
</span></span><span class="line"><span class="cl">    s OrderList=##class(LIS.Util.COM.XML).New(&#34;OrderList&#34;)   
</span></span><span class="line"><span class="cl">    s VisitNumberDR=$o(^dbo.RILabTestSetI(&#34;BarCode&#34;,Labno,&#34;&#34;)) 
</span></span><span class="line"><span class="cl">    i &#39;$l(VisitNumberDR) 
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		s Header.ResultCode=&#34;1&#34;
</span></span><span class="line"><span class="cl">		s Header.ResultContent=&#34;ä¸­é—´è¡¨æ¡ç ä¿¡æ¯ä¸å­˜åœ¨ï¼&#34; 
</span></span><span class="line"><span class="cl">		d RetXML.Insert(Header)
</span></span><span class="line"><span class="cl">		q RetXML.ToXMLStream()
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    s VisitNumberObjData=##class(dbo.RILabTestSet).%OpenId(VisitNumberDR)
</span></span><span class="line"><span class="cl">    s PatDR=VisitNumberObjData.VisitNumberDR
</span></span><span class="line"><span class="cl">    s PatObjData=##class(dbo.RILabRequest).%OpenId(PatDR)
</span></span><span class="line"><span class="cl">    s objVisitNumber.HospitalCode=VisitNumberObjData.HospitalCode
</span></span><span class="line"><span class="cl">    S RetTSRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">    s LabTestSetRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">    f {
</span></span><span class="line"><span class="cl">         S LabTestSetRowID=$o(^dbo.RILabTestSetI(&#34;BarCode&#34;,Labno,LabTestSetRowID))
</span></span><span class="line"><span class="cl">         Q:LabTestSetRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">         s OderItem=##class(LIS.Util.COM.XML).New(&#34;OderItem&#34;)
</span></span><span class="line"><span class="cl">         s TestSetCode=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),2)
</span></span><span class="line"><span class="cl">     	 s OderItem.HISOrderID=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),4)
</span></span><span class="line"><span class="cl">		 s OderItem.TestSetCode=TestSetCode
</span></span><span class="line"><span class="cl">		 s OderItem.OrdItmStat=&#34;&#34;
</span></span><span class="line"><span class="cl">		 S TSBiled=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),44)
</span></span><span class="line"><span class="cl">		 i TSBiled=2 s TSBiled=0 //å·²è®¡è´¹
</span></span><span class="line"><span class="cl">		 s OderItem.Biled=TSBiled
</span></span><span class="line"><span class="cl">		 s OderItem.TestSetFee=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),43)
</span></span><span class="line"><span class="cl">		 d OrderList.Insert(OderItem) 
</span></span><span class="line"><span class="cl">		 S RetTSRowID=LabTestSetRowID
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    D objVisitNumber.Insert(OrderList)
</span></span><span class="line"><span class="cl">   	//åªå–åŒ»å˜±ä¿¡æ¯
</span></span><span class="line"><span class="cl">   	i RetType=&#34;0&#34; 
</span></span><span class="line"><span class="cl">   	{
</span></span><span class="line"><span class="cl">   		 s Header.ResultCode=&#34;0&#34;
</span></span><span class="line"><span class="cl">		 s Header.ResultContent=&#34;&#34; 
</span></span><span class="line"><span class="cl">		 d RetXML.Insert(Header)
</span></span><span class="line"><span class="cl">		 d RetXML.Insert(objVisitNumber)
</span></span><span class="line"><span class="cl">		 q RetXML.ToXMLStream()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    //è·å–æ ‡æœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">  	s objVisitNumber.VisitNumber=VisitNumberObjData.BarCode
</span></span><span class="line"><span class="cl">	s objVisitNumber.RegNo=PatObjData.RegNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.AdmissionTypeCode=PatObjData.AdmissionType
</span></span><span class="line"><span class="cl">	s objVisitNumber.AdmNo=PatObjData.AdmNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.MedicalRecordNo=PatObjData.MedicalRecordNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.AdmDate=PatObjData.AdmDate
</span></span><span class="line"><span class="cl">	s objVisitNumber.AdmTime=PatObjData.AdmTime
</span></span><span class="line"><span class="cl">	//s objVisitNumber.CertTypeDR=CertTypeDR  //è¯ä»¶ç±»å‹ é¢„ç•™ï¼Ÿ
</span></span><span class="line"><span class="cl">	s objVisitNumber.IDNumber=PatObjData.IDNumber
</span></span><span class="line"><span class="cl">	//s objVisitNumber.PaymentTypeDR=PaymentTypeDR  //æ”¯ä»˜ç±»å‹ é¢„ç•™ï¼Ÿ
</span></span><span class="line"><span class="cl">	s objVisitNumber.SurName=PatObjData.SurName
</span></span><span class="line"><span class="cl">	s objVisitNumber.GivenName=PatObjData.GivenName
</span></span><span class="line"><span class="cl">	s objVisitNumber.SpeciesCode=PatObjData.SpeciesID
</span></span><span class="line"><span class="cl">	s objVisitNumber.SpeciesDesc=PatObjData.SpeciesName
</span></span><span class="line"><span class="cl">	s objVisitNumber.BirthDate=PatObjData.BirthDate
</span></span><span class="line"><span class="cl">	//s objVisitNumber.BirthTime=BirthTime
</span></span><span class="line"><span class="cl">	s objVisitNumber.Age=PatObjData.Age
</span></span><span class="line"><span class="cl">	s objVisitNumber.AgeUnitCode=PatObjData.AgeUnit
</span></span><span class="line"><span class="cl">    s objVisitNumber.AgeUnitDesc=PatObjData.AgeUnit
</span></span><span class="line"><span class="cl">    s objVisitNumber.Symptom=PatObjData.Symptom //Symptom  è¯Šæ–­è·å–å…¬å…±CLS ï¼Ÿï¼Ÿï¼Ÿ
</span></span><span class="line"><span class="cl">	s objVisitNumber.MobileNo=PatObjData.MobileNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.PhoneNo=PatObjData.PhoneNo
</span></span><span class="line"><span class="cl">	s objVisitNumber.EMail=PatObjData.email
</span></span><span class="line"><span class="cl">	s objVisitNumber.Address=PatObjData.Address
</span></span><span class="line"><span class="cl">	s objVisitNumber.PostCode=PatObjData.PostCode
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    i $l(RetTSRowID) d
</span></span><span class="line"><span class="cl">    .s objVisitNumber.LocationCode=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),15)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.LocationDesc=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),16)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.DoctorCode=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),20)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.DoctorDesc=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),21)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.RequestDate=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),22)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.RequestTime=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),23)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.WardCode=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),17)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.WardDesc=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),18)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.BedNo=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),19)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.ReqNotes=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),46)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CarryDate=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),35)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CarryTime=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),36)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CarryUserCode=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),37)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CarryUserDesc=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),38)
</span></span><span class="line"><span class="cl">	.i &#39;$l(objVisitNumber.CarryDate)&amp;&amp;$d(^dbo.RPTransportItemI(&#34;IndexBarcode&#34;,##Class(LIS.Util.Common).IndexData(Labno))) d
</span></span><span class="line"><span class="cl">	..s CarryInfo=##class(LIS.WS.BLL.DHCRPTransport).QryTransportByBarCode(Labno)
</span></span><span class="line"><span class="cl">	..s objVisitNumber.CarryDate=$p(CarryInfo,&#34;^&#34;,10)
</span></span><span class="line"><span class="cl">	..s objVisitNumber.CarryTime=$p(CarryInfo,&#34;^&#34;,11)
</span></span><span class="line"><span class="cl">	..s objVisitNumber.CarryUserCode=$p(CarryInfo,&#34;^&#34;,8)
</span></span><span class="line"><span class="cl">	..s objVisitNumber.CarryUserDesc=$p(CarryInfo,&#34;^&#34;,9)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CarryDate=$tr(objVisitNumber.CarryDate,&#34;-&#34;)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.Urgent=VisitNumberObjData.Urgent
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CollectDate=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),29)
</span></span><span class="line"><span class="cl">	.s CollectTime=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),30)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CollectTime=CollectTime
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CollectUserCode=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),31)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CollectUserDesc=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),32)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.SpecimenCode=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),10)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.SpecimenDesc=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),11)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.ContainerCode=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),12)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.ContainerDesc=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),13)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.CollectNotes=$lg($g(^dbo.RILabTestSetD(RetTSRowID)),14)
</span></span><span class="line"><span class="cl">	.s objVisitNumber.H24UVolume=&#34;&#34;
</span></span><span class="line"><span class="cl">	.s objVisitNumber.H24UTimePeriod=&#34;&#34;
</span></span><span class="line"><span class="cl">	.s objVisitNumber.BodyTemp=&#34;&#34;
</span></span><span class="line"><span class="cl">	.s objVisitNumber.Confidential=&#34;&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s Header.ResultCode=&#34;0&#34;
</span></span><span class="line"><span class="cl">	s Header.ResultContent=&#34;&#34; 
</span></span><span class="line"><span class="cl">	d RetXML.Insert(Header)
</span></span><span class="line"><span class="cl">	d RetXML.Insert(objVisitNumber)
</span></span><span class="line"><span class="cl">	q RetXML.ToXMLStream()
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// è®¾ç½®ä¸­é—´è¡¨çŠ¶æ€
</span></span><span class="line"><span class="cl">ClassMethod SetILabTestSetState(Labno As %String, recTSList, TestSetState, Usercode) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s Labno=$g(Labno),recTSList=$g(recTSList),TestSetState=$g(TestSetState),Usercode=$g(Usercode)
</span></span><span class="line"><span class="cl">	s retValue=1
</span></span><span class="line"><span class="cl">	s UserDR=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(Usercode)	s Usercode = $zcvt(Usercode,&#34;U&#34;) s UserDR=$o(^dbo.SYSUserI(&#34;IndexCode&#34;,##Class(LIS.Util.Common).IndexData(Usercode)))
</span></span><span class="line"><span class="cl">	s SplitStr=&#34;@S@&#34;,ItemSpitStr=&#34;@I@&#34;
</span></span><span class="line"><span class="cl">    s HISOrderList=&#34;&#34;
</span></span><span class="line"><span class="cl">	f z=1:1:$l(recTSList,ItemSpitStr)
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">	    s TSItem=$p(recTSList,ItemSpitStr,z)
</span></span><span class="line"><span class="cl">	    i &#39;$l(TSItem) continue
</span></span><span class="line"><span class="cl">	    s TestSetDR=$p(TSItem,SplitStr,1)
</span></span><span class="line"><span class="cl">	    s ckHISOrderID=$p(TSItem,SplitStr,2)
</span></span><span class="line"><span class="cl">	    s LabTestSetRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">	    f 
</span></span><span class="line"><span class="cl">	    {
</span></span><span class="line"><span class="cl">	         S LabTestSetRowID=$o(^dbo.RILabTestSetI(&#34;BarCode&#34;,Labno,LabTestSetRowID))
</span></span><span class="line"><span class="cl">	         Q:LabTestSetRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">	         s TestSetCode=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),2)
</span></span><span class="line"><span class="cl">	     	 s HISOrderID=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),3)
</span></span><span class="line"><span class="cl">	     	 i $l(ckHISOrderID),ckHISOrderID&#39;=HISOrderID continue
</span></span><span class="line"><span class="cl">	     	 s VTSObjData=##class(dbo.RILabTestSet).%OpenId(LabTestSetRowID)
</span></span><span class="line"><span class="cl">	     	 s VTSObjData.TestSetState=TestSetState
</span></span><span class="line"><span class="cl">	     	 i TestSetState=5
</span></span><span class="line"><span class="cl">	     	 {
</span></span><span class="line"><span class="cl">		     	 s VTSObjData.ReceiveDate=$zd($h,8)
</span></span><span class="line"><span class="cl">		     	 s VTSObjData.ReceiveTime=$p($h,&#34;,&#34;,2)
</span></span><span class="line"><span class="cl">		     	 s VTSObjData.ReceiveUserID=UserDR
</span></span><span class="line"><span class="cl">		     }
</span></span><span class="line"><span class="cl">	     	 s sc=VTSObjData.%Save()
</span></span><span class="line"><span class="cl">	    }
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	Q retValue
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// è®¾ç½®ä¸­é—´è¡¨çŠ¶æ€
</span></span><span class="line"><span class="cl">ClassMethod SetILabTSAcceptInfo(ReportDR As %String) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s retValue=1
</span></span><span class="line"><span class="cl">	s VisitNumberDR=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),2)
</span></span><span class="line"><span class="cl">	s WorkGroupMachineDR=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),4)
</span></span><span class="line"><span class="cl">	s AssayNo=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),6)
</span></span><span class="line"><span class="cl">	s TransmitDate=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),3)
</span></span><span class="line"><span class="cl">	s AcceptDate=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),9)
</span></span><span class="line"><span class="cl">	s AcceptTime=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),10)
</span></span><span class="line"><span class="cl">	s LabNo=$lg($g(^dbo.RPVisitNumberD(VisitNumberDR)),2)
</span></span><span class="line"><span class="cl">	s TestSetDR=&#34;&#34;,TSList=&#34;&#34;
</span></span><span class="line"><span class="cl">    f  s TestSetDR=$o(^dbo.RPVisitNumberTestSetI(&#34;IndexReportID&#34;,ReportDR,TestSetDR)) q:TestSetDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    .s VSRowID=$o(^dbo.RPVisitNumberTestSetI(&#34;IndexReportID&#34;,ReportDR,TestSetDR,&#34;&#34;))
</span></span><span class="line"><span class="cl">    .s HISOrderID=$lg($g(^dbo.RPVisitNumberTestSetD(VSRowID)),10)
</span></span><span class="line"><span class="cl">    .s TSList=HISOrderID_&#34;,&#34;_TSList
</span></span><span class="line"><span class="cl">    s LabTestSetRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">    f 
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">         S LabTestSetRowID=$o(^dbo.RILabTestSetI(&#34;BarCode&#34;,LabNo,LabTestSetRowID))
</span></span><span class="line"><span class="cl">         Q:LabTestSetRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">         s TestSetCode=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),2)
</span></span><span class="line"><span class="cl">     	 s ckHISOrderID=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),3)
</span></span><span class="line"><span class="cl">     	 i $l(ckHISOrderID),(&#34;,&#34;_TSList_&#34;,&#34;)&#39;[(&#34;,&#34;_ckHISOrderID_&#34;,&#34;) continue
</span></span><span class="line"><span class="cl">     	 s VTSObjData=##class(dbo.RILabTestSet).%OpenId(LabTestSetRowID)
</span></span><span class="line"><span class="cl">     	 s VTSObjData.WorkGroupMachineDR=WorkGroupMachineDR
</span></span><span class="line"><span class="cl">     	 s VTSObjData.AssayNo=AssayNo
</span></span><span class="line"><span class="cl">     	 s VTSObjData.TransmitDate=TransmitDate
</span></span><span class="line"><span class="cl">     	 s VTSObjData.AcceptDate=AcceptDate
</span></span><span class="line"><span class="cl">     	 s VTSObjData.AcceptTime=AcceptTime
</span></span><span class="line"><span class="cl">     	 s sc=VTSObjData.%Save()
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">	Q retValue
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// è®¾ç½®ä¸­é—´è¡¨çŠ¶æ€
</span></span><span class="line"><span class="cl">ClassMethod SetILabTSStateByHISOrderID(Labno As %String, HISOrderID, TestSetState) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s retValue=1
</span></span><span class="line"><span class="cl">    s LabTestSetRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">    f 
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">         S LabTestSetRowID=$o(^dbo.RILabTestSetI(&#34;BarCode&#34;,Labno,LabTestSetRowID))
</span></span><span class="line"><span class="cl">         Q:LabTestSetRowID=&#34;&#34;
</span></span><span class="line"><span class="cl">         s TestSetCode=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),2)
</span></span><span class="line"><span class="cl">     	 s ckHISOrderID=$lg($g(^dbo.RILabTestSetD(LabTestSetRowID)),3)
</span></span><span class="line"><span class="cl">     	 i $l(ckHISOrderID),ckHISOrderID&#39;=HISOrderID continue
</span></span><span class="line"><span class="cl">     	 s VTSObjData=##class(dbo.RILabTestSet).%OpenId(LabTestSetRowID)
</span></span><span class="line"><span class="cl">     	 s VTSObjData.TestSetState=TestSetState
</span></span><span class="line"><span class="cl">     	 s sc=VTSObjData.%Save()
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">	Q retValue
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ›´æ–°çŠ¶æ€ç±»">æ›´æ–°çŠ¶æ€ç±»
</h4><blockquote>
<p>é€šè¿‡XMLä¸²ï¼ŒæŠŠç¬¬ä¸‰æ–¹ç³»ç»ŸåŒ»å˜±ä¿å­˜åˆ°dbo.RI_LabRequest,dbo.RI_LabTestSetè¡¨ä¸­ã€‚</p>
<p>LIS.WS.BLL.DHCENSLabInterface</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span><span class="lnt">513
</span><span class="lnt">514
</span><span class="lnt">515
</span><span class="lnt">516
</span><span class="lnt">517
</span><span class="lnt">518
</span><span class="lnt">519
</span><span class="lnt">520
</span><span class="lnt">521
</span><span class="lnt">522
</span><span class="lnt">523
</span><span class="lnt">524
</span><span class="lnt">525
</span><span class="lnt">526
</span><span class="lnt">527
</span><span class="lnt">528
</span><span class="lnt">529
</span><span class="lnt">530
</span><span class="lnt">531
</span><span class="lnt">532
</span><span class="lnt">533
</span><span class="lnt">534
</span><span class="lnt">535
</span><span class="lnt">536
</span><span class="lnt">537
</span><span class="lnt">538
</span><span class="lnt">539
</span><span class="lnt">540
</span><span class="lnt">541
</span><span class="lnt">542
</span><span class="lnt">543
</span><span class="lnt">544
</span><span class="lnt">545
</span><span class="lnt">546
</span><span class="lnt">547
</span><span class="lnt">548
</span><span class="lnt">549
</span><span class="lnt">550
</span><span class="lnt">551
</span><span class="lnt">552
</span><span class="lnt">553
</span><span class="lnt">554
</span><span class="lnt">555
</span><span class="lnt">556
</span><span class="lnt">557
</span><span class="lnt">558
</span><span class="lnt">559
</span><span class="lnt">560
</span><span class="lnt">561
</span><span class="lnt">562
</span><span class="lnt">563
</span><span class="lnt">564
</span><span class="lnt">565
</span><span class="lnt">566
</span><span class="lnt">567
</span><span class="lnt">568
</span><span class="lnt">569
</span><span class="lnt">570
</span><span class="lnt">571
</span><span class="lnt">572
</span><span class="lnt">573
</span><span class="lnt">574
</span><span class="lnt">575
</span><span class="lnt">576
</span><span class="lnt">577
</span><span class="lnt">578
</span><span class="lnt">579
</span><span class="lnt">580
</span><span class="lnt">581
</span><span class="lnt">582
</span><span class="lnt">583
</span><span class="lnt">584
</span><span class="lnt">585
</span><span class="lnt">586
</span><span class="lnt">587
</span><span class="lnt">588
</span><span class="lnt">589
</span><span class="lnt">590
</span><span class="lnt">591
</span><span class="lnt">592
</span><span class="lnt">593
</span><span class="lnt">594
</span><span class="lnt">595
</span><span class="lnt">596
</span><span class="lnt">597
</span><span class="lnt">598
</span><span class="lnt">599
</span><span class="lnt">600
</span><span class="lnt">601
</span><span class="lnt">602
</span><span class="lnt">603
</span><span class="lnt">604
</span><span class="lnt">605
</span><span class="lnt">606
</span><span class="lnt">607
</span><span class="lnt">608
</span><span class="lnt">609
</span><span class="lnt">610
</span><span class="lnt">611
</span><span class="lnt">612
</span><span class="lnt">613
</span><span class="lnt">614
</span><span class="lnt">615
</span><span class="lnt">616
</span><span class="lnt">617
</span><span class="lnt">618
</span><span class="lnt">619
</span><span class="lnt">620
</span><span class="lnt">621
</span><span class="lnt">622
</span><span class="lnt">623
</span><span class="lnt">624
</span><span class="lnt">625
</span><span class="lnt">626
</span><span class="lnt">627
</span><span class="lnt">628
</span><span class="lnt">629
</span><span class="lnt">630
</span><span class="lnt">631
</span><span class="lnt">632
</span><span class="lnt">633
</span><span class="lnt">634
</span><span class="lnt">635
</span><span class="lnt">636
</span><span class="lnt">637
</span><span class="lnt">638
</span><span class="lnt">639
</span><span class="lnt">640
</span><span class="lnt">641
</span><span class="lnt">642
</span><span class="lnt">643
</span><span class="lnt">644
</span><span class="lnt">645
</span><span class="lnt">646
</span><span class="lnt">647
</span><span class="lnt">648
</span><span class="lnt">649
</span><span class="lnt">650
</span><span class="lnt">651
</span><span class="lnt">652
</span><span class="lnt">653
</span><span class="lnt">654
</span><span class="lnt">655
</span><span class="lnt">656
</span><span class="lnt">657
</span><span class="lnt">658
</span><span class="lnt">659
</span><span class="lnt">660
</span><span class="lnt">661
</span><span class="lnt">662
</span><span class="lnt">663
</span><span class="lnt">664
</span><span class="lnt">665
</span><span class="lnt">666
</span><span class="lnt">667
</span><span class="lnt">668
</span><span class="lnt">669
</span><span class="lnt">670
</span><span class="lnt">671
</span><span class="lnt">672
</span><span class="lnt">673
</span><span class="lnt">674
</span><span class="lnt">675
</span><span class="lnt">676
</span><span class="lnt">677
</span><span class="lnt">678
</span><span class="lnt">679
</span><span class="lnt">680
</span><span class="lnt">681
</span><span class="lnt">682
</span><span class="lnt">683
</span><span class="lnt">684
</span><span class="lnt">685
</span><span class="lnt">686
</span><span class="lnt">687
</span><span class="lnt">688
</span><span class="lnt">689
</span><span class="lnt">690
</span><span class="lnt">691
</span><span class="lnt">692
</span><span class="lnt">693
</span><span class="lnt">694
</span><span class="lnt">695
</span><span class="lnt">696
</span><span class="lnt">697
</span><span class="lnt">698
</span><span class="lnt">699
</span><span class="lnt">700
</span><span class="lnt">701
</span><span class="lnt">702
</span><span class="lnt">703
</span><span class="lnt">704
</span><span class="lnt">705
</span><span class="lnt">706
</span><span class="lnt">707
</span><span class="lnt">708
</span><span class="lnt">709
</span><span class="lnt">710
</span><span class="lnt">711
</span><span class="lnt">712
</span><span class="lnt">713
</span><span class="lnt">714
</span><span class="lnt">715
</span><span class="lnt">716
</span><span class="lnt">717
</span><span class="lnt">718
</span><span class="lnt">719
</span><span class="lnt">720
</span><span class="lnt">721
</span><span class="lnt">722
</span><span class="lnt">723
</span><span class="lnt">724
</span><span class="lnt">725
</span><span class="lnt">726
</span><span class="lnt">727
</span><span class="lnt">728
</span><span class="lnt">729
</span><span class="lnt">730
</span><span class="lnt">731
</span><span class="lnt">732
</span><span class="lnt">733
</span><span class="lnt">734
</span><span class="lnt">735
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// é€šè¿‡XMLä¸²ï¼ŒæŠŠç¬¬ä¸‰æ–¹ç³»ç»ŸåŒ»å˜±ä¿å­˜åˆ°dbo.RI_LabRequest,dbo.RI_LabTestSetè¡¨ä¸­ã€‚
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2020-10-28
</span></span><span class="line"><span class="cl">/// Description:  ä¿å­˜åŒ»å˜±æ•°æ®åˆ°ä¸­é—´è¡¨
</span></span><span class="line"><span class="cl">/// Table?        dbo.RI_LabRequest,dbo.RI_LabTestSet
</span></span><span class="line"><span class="cl">Class LIS.WS.BLL.DHCENSLabInterface Extends %RegisteredObject
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2024-11-15
</span></span><span class="line"><span class="cl">/// Description:  æŒ‰ç…§å¹³å°ç»„æ–°çš„ç»“æ„ä¿å­˜åŒ»å˜±æ•°æ®åˆ°ä¸­é—´è¡¨
</span></span><span class="line"><span class="cl">/// Table?        dbo.RI_LabRequest,dbo.RI_LabTestSet
</span></span><span class="line"><span class="cl">/// Input?        Input:åŒ»å˜±ä¿¡æ¯XMLä¸²
</span></span><span class="line"><span class="cl">/// Return?       ret:ä¿å­˜æ˜¯å¦æˆåŠŸ
</span></span><span class="line"><span class="cl">/// Others?       æ— 
</span></span><span class="line"><span class="cl">/// s Input=&#34;&lt;Request&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;æˆåŠŸ&lt;/ResultContent&gt;&lt;Orders&gt;&lt;OrderList&gt;&lt;OrdID&gt;&lt;/OrdID&gt;&lt;LabNo&gt;1600904130&lt;/LabNo&gt;&lt;ArcimCode&gt;L002&lt;/ArcimCode&gt;&lt;ArcimDesc&gt;è¡€å¸¸è§„&lt;/ArcimDesc&gt;&lt;OrderQty&gt;1&lt;/OrderQty&gt;&lt;BillCode&gt;P&lt;/BillCode&gt;&lt;SpecimenTypeCode&gt;&lt;/SpecimenTypeCode&gt;&lt;SpecimenTypeDesc&gt;&lt;/SpecimenTypeDesc&gt;&lt;SpVolume&gt;&lt;/SpVolume&gt;&lt;ColInfo&gt;&lt;/ColInfo&gt;&lt;Container&gt;&lt;/Container&gt;&lt;GTSeq&gt;&lt;/GTSeq&gt;&lt;SpecFlag&gt;&lt;/SpecFlag&gt;&lt;VerifyDate&gt;2016-04-26&lt;/VerifyDate&gt;&lt;VerifyTime&gt;13:43:09&lt;/VerifyTime&gt;&lt;ColDate&gt;&lt;/ColDate&gt;&lt;ColTime&gt;&lt;/ColTime&gt;&lt;AppDeptCode&gt;&lt;/AppDeptCode&gt;&lt;AppDeptDesc&gt;ä½“æ£€ç§‘&lt;/AppDeptDesc&gt;&lt;RecDeptCode&gt;&lt;/RecDeptCode&gt;&lt;RecDeptDesc&gt;&lt;/RecDeptDesc&gt;&lt;TSPrice&gt;20&lt;/TSPrice&gt;&lt;OrderStatus&gt;E&lt;/OrderStatus&gt;&lt;DocCode&gt;&lt;/DocCode&gt;&lt;DocDesc&gt;&lt;/DocDesc&gt;&lt;RepLoct&gt;&lt;/RepLoct&gt;&lt;RepDate&gt;&lt;/RepDate&gt;&lt;RepTime&gt;&lt;/RepTime&gt;&lt;Note&gt;&lt;/Note&gt;&lt;AdmNo&gt;&lt;/AdmNo&gt;&lt;AdmDate&gt;2016-04-26&lt;/AdmDate&gt;&lt;AdmTime&gt;13:43:09&lt;/AdmTime&gt;&lt;AdmTypeCode&gt;&lt;/AdmTypeCode&gt;&lt;AdmTypeDesc&gt;ä½“æ£€&lt;/AdmTypeDesc&gt;&lt;FeeType&gt;&lt;/FeeType&gt;&lt;PatientWard&gt;&lt;/PatientWard&gt;&lt;BedNo&gt;&lt;/BedNo&gt;&lt;Diagnose&gt;&lt;/Diagnose&gt;&lt;RegisterNo&gt;16009041&lt;/RegisterNo&gt;&lt;PatientName&gt;æµ‹è¯•ï¼ˆç«¥ï¼‰&lt;/PatientName&gt;&lt;SexCode&gt;M&lt;/SexCode&gt;&lt;SexDesc&gt;ç”·&lt;/SexDesc&gt;&lt;DOB&gt;1987-04-26&lt;/DOB&gt;&lt;Age&gt;29å²&lt;/Age&gt;&lt;DocumentID&gt;D16008409&lt;/DocumentID&gt;&lt;PatientAddress&gt;&lt;/PatientAddress&gt;&lt;IdentityCardNo&gt;&lt;/IdentityCardNo&gt;&lt;Telephone&gt;&lt;/Telephone&gt;&lt;SpecUserCode&gt;&lt;/SpecUserCode&gt;&lt;StartDate&gt;&lt;/StartDate&gt;&lt;StartTime&gt;&lt;/StartTime&gt;&lt;SendFlag&gt;NW&lt;/SendFlag&gt;&lt;/OrderList&gt;&lt;/Orders&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).SaveRequestTestSet(&#34;&lt;Request&gt;&lt;Body&gt;&lt;Orders&gt;&lt;OrderList&gt;&lt;AppDeptDesc&gt;&lt;/AppDeptDesc&gt;&lt;IdentityCardNo&gt;360730199608051156&lt;/IdentityCardNo&gt;&lt;SpecimenTypeDesc&gt;&lt;/SpecimenTypeDesc&gt;&lt;Age&gt;23å²&lt;/Age&gt;&lt;RecDeptCode&gt;&lt;/RecDeptCode&gt;&lt;OrderStatus&gt;&lt;/OrderStatus&gt;&lt;SpVolume&gt;&lt;/SpVolume&gt;&lt;Telephone&gt;&lt;/Telephone&gt;&lt;DOB&gt;1997-01-01&lt;/DOB&gt;&lt;PatientWard&gt;&lt;/PatientWard&gt;&lt;LabNo&gt;9000000114&lt;/LabNo&gt;&lt;ContainerDesc&gt;&lt;/ContainerDesc&gt;&lt;SexCode&gt;1&lt;/SexCode&gt;&lt;SpecUserName&gt;&lt;/SpecUserName&gt;&lt;FeeType&gt;&lt;/FeeType&gt;&lt;TSPrice&gt;&lt;/TSPrice&gt;&lt;ColTime&gt;&lt;/ColTime&gt;&lt;OrderQty&gt;1&lt;/OrderQty&gt;&lt;StartDate&gt;&lt;/StartDate&gt;&lt;BedNo&gt;&lt;/BedNo&gt;&lt;AdmTypeCode&gt;&lt;/AdmTypeCode&gt;&lt;ArcimCode&gt;BGJY000001&lt;/ArcimCode&gt;&lt;RecDeptDesc&gt;&lt;/RecDeptDesc&gt;&lt;PatientAddress&gt;&lt;/PatientAddress&gt;&lt;StartTime&gt;&lt;/StartTime&gt;&lt;VerifyDate&gt;2020-11-19&lt;/VerifyDate&gt;&lt;AppDeptCode&gt;4659&lt;/AppDeptCode&gt;&lt;Container&gt;&lt;/Container&gt;&lt;DocumentID&gt;&lt;/DocumentID&gt;&lt;AdmDate&gt;2020-11-20&lt;/AdmDate&gt;&lt;AdmTime&gt;09:00:00&lt;/AdmTime&gt;&lt;ColDate&gt;&lt;/ColDate&gt;&lt;BillCode&gt;B&lt;/BillCode&gt;&lt;ColInfo&gt;&lt;/ColInfo&gt;&lt;ArcimDesc&gt;è¡€å¸¸è§„&lt;/ArcimDesc&gt;&lt;DocDesc&gt;&lt;/DocDesc&gt;&lt;Note&gt;&lt;/Note&gt;&lt;PatientName&gt;æµ‹è¯•&lt;/PatientName&gt;&lt;Diagnose&gt;&lt;/Diagnose&gt;&lt;AdmTypeDesc&gt;&lt;/AdmTypeDesc&gt;&lt;SpecUserCode&gt;&lt;/SpecUserCode&gt;&lt;GTSeq&gt;&lt;/GTSeq&gt;&lt;DocCode&gt;9803&lt;/DocCode&gt;&lt;OrdID&gt;1481&lt;/OrdID&gt;&lt;SexDesc&gt;ç”·&lt;/SexDesc&gt;&lt;VerifyTime&gt;07:11:17&lt;/VerifyTime&gt;&lt;SpecimenTypeCode&gt;&lt;/SpecimenTypeCode&gt;&lt;AdmNo&gt;45887462&lt;/AdmNo&gt;&lt;RegisterNo&gt;635761&lt;/RegisterNo&gt;&lt;/OrderList&gt;&lt;/Orders&gt;&lt;/Body&gt;&lt;Header&gt;&lt;MessageID&gt;123&lt;/MessageID&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;/Header&gt;&lt;/Request&gt;&#34;)
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).SaveRequestTestSet(^TMP(&#34;LIS&#34;))
</span></span><span class="line"><span class="cl">ClassMethod SaveRequestTestSet(Input)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s ^tmp(&#34;SaveRequestTestSet&#34;)=Input
</span></span><span class="line"><span class="cl">    s Input=$g(Input)  
</span></span><span class="line"><span class="cl">    i &#39;$l(Input) q Ret
</span></span><span class="line"><span class="cl">    s repid=$i(^CacheTemp)
</span></span><span class="line"><span class="cl">    s RetValue=0  //é»˜è®¤è¿”å›å€¼ä¸º1
</span></span><span class="line"><span class="cl">    TSTART
</span></span><span class="line"><span class="cl">    Set $ZTrap = &#34;ErrorHandle1&#34;
</span></span><span class="line"><span class="cl">    s ResXML = ##class(LIS.Util.COM.XML).FromXML(Input,&#34;Y&#34;)
</span></span><span class="line"><span class="cl">    s MessageID=ResXML.Header.MessageID
</span></span><span class="line"><span class="cl">    s xmlDataInfo=ResXML.Body.PATPatientInfo
</span></span><span class="line"><span class="cl">    s xmlDataAdmInfo=ResXML.Body.PATAdmInfo
</span></span><span class="line"><span class="cl">    s xmlDataOrdListRt=ResXML.Body.SendPatOrdListRt.OrderList
</span></span><span class="line"><span class="cl">    s xmlDataMDiagnose=ResXML.Body.PAADMDiagnose
</span></span><span class="line"><span class="cl">    //è·å–ç—…äººä¿¡æ¯ã€‚
</span></span><span class="line"><span class="cl">    i $l(xmlDataAdmInfo)
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">	    s RegNo=xmlDataInfo.PATPatientID
</span></span><span class="line"><span class="cl">	    s BedNo=&#34;&#34; //xmlDataAdmInfo.PAADMCurBedNo
</span></span><span class="line"><span class="cl">        s Diagnose=&#34;&#34; //xmlDataMDiagnose.DiagDesc
</span></span><span class="line"><span class="cl">        s PatName=xmlDataInfo.PATName
</span></span><span class="line"><span class="cl">        s SexCode=xmlDataInfo.PATSexCode
</span></span><span class="line"><span class="cl">        i SexCode=1 s SexCode=&#34;M&#34;
</span></span><span class="line"><span class="cl">        i SexCode=2 s SexCode=&#34;F&#34;
</span></span><span class="line"><span class="cl">        s SexDesc=xmlDataInfo.PATSexDesc
</span></span><span class="line"><span class="cl">        s DOB=xmlDataInfo.PATDob
</span></span><span class="line"><span class="cl">        s Age=xmlDataInfo.PATAge
</span></span><span class="line"><span class="cl">        s DocumentID=xmlDataInfo.PATDocumentNo
</span></span><span class="line"><span class="cl">        s PatientAddress=xmlDataInfo.PATWorkPlaceName
</span></span><span class="line"><span class="cl">        s IdentityCardNo=xmlDataInfo.PATIdentityNum
</span></span><span class="line"><span class="cl">        s Telephone=xmlDataInfo.PATTelephone               
</span></span><span class="line"><span class="cl">        s StartDate=&#34;&#34;
</span></span><span class="line"><span class="cl">        s StartTime=&#34;&#34;
</span></span><span class="line"><span class="cl">        s HospCode =xmlDataInfo.HospitalCode
</span></span><span class="line"><span class="cl">        i HospCode=&#34;&#34; s HospCode=&#34;XMYQ&#34;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    b //è·å–åŒ»å˜±ä¿¡æ¯
</span></span><span class="line"><span class="cl">    i xmlDataOrdListRt.Length()&gt;0 
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">	    s i=0 f i=0:1:xmlDataOrdListRt.Length()-1
</span></span><span class="line"><span class="cl">	    {
</span></span><span class="line"><span class="cl">		    s TSItem=xmlDataOrdListRt.Get(i)
</span></span><span class="line"><span class="cl">		    //s i=i+1
</span></span><span class="line"><span class="cl">	        s OrderID=TSItem.OEORIOrderItemID
</span></span><span class="line"><span class="cl">	        //b ;9
</span></span><span class="line"><span class="cl">            s LabNo=TSItem.OEORISpecimenID
</span></span><span class="line"><span class="cl">            s ArcimCode=TSItem.OEORIARCItmMastCode
</span></span><span class="line"><span class="cl">            s ArcimDesc=TSItem.OEORIARCItmMastDesc
</span></span><span class="line"><span class="cl">            s OrderQty=TSItem.OEORIOrderQty
</span></span><span class="line"><span class="cl">            s BillCode=TSItem.BillStatus
</span></span><span class="line"><span class="cl">            i BillCode=&#34;P&#34; s BillCode=2
</span></span><span class="line"><span class="cl">            s SpecimenTypeCode=TSItem.OEORISpecimenCode
</span></span><span class="line"><span class="cl">            s SpecimenTypeDesc=TSItem.OEORISpecimenDesc
</span></span><span class="line"><span class="cl">            s SpVolume=TSItem.SpVolume
</span></span><span class="line"><span class="cl">            s ColInfo=TSItem.ColInfo
</span></span><span class="line"><span class="cl">            s Container=TSItem.Container
</span></span><span class="line"><span class="cl">            s ContainerDesc=TSItem.ContainerDesc
</span></span><span class="line"><span class="cl">            s GTSeq=TSItem.GTSeq          
</span></span><span class="line"><span class="cl">            s SpecFlag=TSItem.SpecFlag
</span></span><span class="line"><span class="cl">            s VerifyDate=TSItem.VerifyDate
</span></span><span class="line"><span class="cl">            s VerifyTime=TSItem.VerifyTime
</span></span><span class="line"><span class="cl">            s ColDate=TSItem.ColDate
</span></span><span class="line"><span class="cl">            s ColTime=TSItem.ColTime
</span></span><span class="line"><span class="cl">            s AppDeptCode= TSItem.AppDeptCode
</span></span><span class="line"><span class="cl">            s AppDeptDesc=TSItem.AppDeptDesc
</span></span><span class="line"><span class="cl">            s RecDeptCode=TSItem.RecDeptCode
</span></span><span class="line"><span class="cl">            s RecDeptDesc=TSItem.RecDeptDesc
</span></span><span class="line"><span class="cl">            s TSPrice=TSItem.TSPrice
</span></span><span class="line"><span class="cl">            ///E:æ‰§è¡Œï¼ŒV:å®¡æ ¸ï¼ŒD:åœæ­¢ã€‚åªæœ‰VçŠ¶æ€çš„åŒ»å˜±æ˜¯èƒ½å‡ºæŠ¥å‘Š
</span></span><span class="line"><span class="cl">            ///1ï¼šç™»è®°ï¼Œ2ï¼šæ‰“å°æ¡ç ï¼Œ3ï¼šé‡‡é›†ï¼Œ4ï¼šæ ‡æœ¬è¿é€ï¼Œ5ï¼šæ ‡æœ¬æ¥æ”¶ï¼Œ6ï¼šåœæ­¢ï¼Œ7ï¼šä½œåºŸï¼Œ8.æ‹’æ”¶ï¼Œ9.æ ¸æ”¶ï¼Œ10.HISå·²æ‰§è¡Œ
</span></span><span class="line"><span class="cl">            s OrderStatus=TSItem.OrderStatus
</span></span><span class="line"><span class="cl">            i OrderStatus=&#34;V&#34;  s OrderStatus =1
</span></span><span class="line"><span class="cl">            i OrderStatus=&#34;D&#34;  s OrderStatus =6
</span></span><span class="line"><span class="cl">            i OrderStatus=&#34;E&#34;  s OrderStatus =10
</span></span><span class="line"><span class="cl">            s OrderStatus=2
</span></span><span class="line"><span class="cl">            s DocCode=TSItem.DocCode
</span></span><span class="line"><span class="cl">            s DocDesc=TSItem.DocDesc
</span></span><span class="line"><span class="cl">            s Note=TSItem.Note
</span></span><span class="line"><span class="cl">            s SpecUserCode=TSItem.SpecUserCode
</span></span><span class="line"><span class="cl">            s SpecUserName=TSItem.SpecUserDesc
</span></span><span class="line"><span class="cl">            s AdmNo=$P(xmlDataAdmInfo.PAADMVisitNumber,&#34;_&#34;)
</span></span><span class="line"><span class="cl">            s AdmDate=xmlDataAdmInfo.PAADMStartDate
</span></span><span class="line"><span class="cl">            s AdmTime=xmlDataAdmInfo.PAADMStartTime 
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">            s AdmTypeCode=xmlDataAdmInfo.PAADMTypeCode 
</span></span><span class="line"><span class="cl">            i AdmTypeCode=&#34;&#34; s AdmTypeCode=&#34;H&#34;
</span></span><span class="line"><span class="cl">            s AdmTypeDesc=xmlDataAdmInfo.PAADMTypeDesc 
</span></span><span class="line"><span class="cl">            s FeeType=xmlDataAdmInfo.PAADMFeeTypeCode 
</span></span><span class="line"><span class="cl">            s PatientWard=xmlDataAdmInfo.PAADMAdmWardCode  
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">            b //ä¿å­˜ä¿¡æ¯
</span></span><span class="line"><span class="cl">            i AdmTypeCode=&#34;&#34; s RetValue=&#34;ç—…äººç±»å‹å­—æ®µï¼šAdmTypeCodeä¸ºç©ºï¼Œä¸èƒ½è¿›è¡Œä¿¡æ¯ä¿å­˜ï¼&#34;
</span></span><span class="line"><span class="cl">                    i AdmNo=&#34;&#34; s RetValue=&#34;å°±è¯Šå·å­—æ®µï¼šAdmNoä¸ºç©ºï¼Œä¸èƒ½è¿›è¡Œä¿¡æ¯ä¿å­˜ï¼&#34;
</span></span><span class="line"><span class="cl">                    i RetValue&#39;=0 q
</span></span><span class="line"><span class="cl">                    i $l(AdmTypeCode),$l(AdmNo),$D(^dbo.RILabRequestI(&#34;PKRIRequest&#34;,1,AdmTypeCode,AdmNo)) d
</span></span><span class="line"><span class="cl">                    .s LabRequestRowId=$o(^dbo.RILabRequestI(&#34;PKRIRequest&#34;,1,AdmTypeCode,AdmNo,&#34;&#34;))
</span></span><span class="line"><span class="cl">                    .s ObjLabRequest=##class(dbo.RILabRequest).%OpenId(LabRequestRowId)
</span></span><span class="line"><span class="cl">                    e  d
</span></span><span class="line"><span class="cl">                    .s ObjLabRequest=##class(dbo.RILabRequest).%New()
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.VisitNumberFrom=&#34;1&#34;
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AdmissionType=AdmTypeCode
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.RegNo=RegNo
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AdmNo=AdmNo
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.MedicalRecordNo=DocumentID
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AdmDate=AdmDate
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AdmTime=AdmTime
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.IDNumber=IdentityCardNo
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.PaymentType=FeeType
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.SurName=PatName
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.GivenName=PatName
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.SpeciesID=SexCode
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.SpeciesName=SexDesc
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.BirthDate=$p(DOB,&#34; &#34;,1)
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.BirthTime=$p(DOB,&#34; &#34;,2)
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.Age=+Age
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AgeUnit=$e(Age,$l(Age)-1,$l(Age))
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.Symptom=Diagnose
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.MobileNo=Telephone
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.Address=PatientAddress
</span></span><span class="line"><span class="cl">                    s sc=ObjLabRequest.%Save()
</span></span><span class="line"><span class="cl">                    s VisitNumberDR=&#34;&#34;
</span></span><span class="line"><span class="cl">                    If ($SYSTEM.Status.IsOK(sc)){
</span></span><span class="line"><span class="cl">                        s RetValue=0
</span></span><span class="line"><span class="cl">                        s VisitNumberDR=$o(^dbo.RILabRequestI(&#34;PKRIRequest&#34;,1,AdmTypeCode,AdmNo,&#34;&#34;))
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                    Else {
</span></span><span class="line"><span class="cl">                        s RetValue=&#34;-1^æ ‡æœ¬ä¸»è¡¨ä¿¡æ¯ä¿å­˜å¤±è´¥:&#34;_$SYSTEM.Status.GetErrorText(sc)
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                    i OrderID=&#34;&#34; s RetValue=&#34;åŒ»å˜±OrderIDå­—æ®µä¸ºç©ºï¼Œä¸èƒ½è¿›è¡ŒåŒ»å˜±ä¿å­˜:&#34;
</span></span><span class="line"><span class="cl">                    i RetValue&#39;=0  q
</span></span><span class="line"><span class="cl">                    b //ä¿å­˜å­è¡¨ï¼ˆåŒ»å˜±è¡¨ï¼‰ä¿¡æ¯
</span></span><span class="line"><span class="cl">                    i $d(^dbo.RILabTestSetI(&#34;PKRITestSet&#34;,VisitNumberDR,OrderID)) d
</span></span><span class="line"><span class="cl">                    .s RILabTestSetRowId=$o(^dbo.RILabTestSetI(&#34;PKRITestSet&#34;,VisitNumberDR,OrderID,&#34;&#34;))
</span></span><span class="line"><span class="cl">                    .s objLabTestSet=##class(dbo.RILabTestSet).%OpenId(RILabTestSetRowId)
</span></span><span class="line"><span class="cl">                    e  d
</span></span><span class="line"><span class="cl">                    .s objLabTestSet=##class(dbo.RILabTestSet).%New()
</span></span><span class="line"><span class="cl">                 
</span></span><span class="line"><span class="cl">                    s objLabTestSet.VisitNumberDR=VisitNumberDR
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetCode=ArcimCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetName=ArcimDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetRowID=OrderID
</span></span><span class="line"><span class="cl">                    s objLabTestSet.Sequence=OrderQty
</span></span><span class="line"><span class="cl">                    s objLabTestSet.BarCode=LabNo
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetState=OrderStatus   
</span></span><span class="line"><span class="cl">                    s objLabTestSet.SpecimenCode=SpecimenTypeCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.SpecimenName=SpecimenTypeDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.ContainerCode=Container
</span></span><span class="line"><span class="cl">                    s objLabTestSet.ContainerName=ContainerDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectNotes=ColInfo
</span></span><span class="line"><span class="cl">                    s objLabTestSet.LocationCode=AppDeptCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.LocationName=AppDeptDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.WardCode=PatientWard
</span></span><span class="line"><span class="cl">                    s objLabTestSet.BedNo=BedNo
</span></span><span class="line"><span class="cl">                    s objLabTestSet.DotorID=DocCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.DotorName=DocDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.RequestDate=VerifyDate
</span></span><span class="line"><span class="cl">                    s objLabTestSet.RequestTime=VerifyTime
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectDate=ColDate
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectTime=ColTime
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectUserID=SpecUserCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectUserName=SpecUserName
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetFee=TSPrice
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetFeeFlag=BillCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.ReqNotes=Note
</span></span><span class="line"><span class="cl">                    s objLabTestSet.OrdDeptID=RecDeptCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.OrdDeptName=RecDeptDesc
</span></span><span class="line"><span class="cl">                    ;s HospitaID=$o(^dbo.BTHospitalI(&#34;IndexCode&#34;,&#34; &#34;_HospCode,&#34;&#34;))
</span></span><span class="line"><span class="cl">                    s objLabTestSet.HospitalCode=HospCode
</span></span><span class="line"><span class="cl">                    s sc=objLabTestSet.%Save()
</span></span><span class="line"><span class="cl">                    b ;1
</span></span><span class="line"><span class="cl">                    If ($SYSTEM.Status.IsOK(sc)){
</span></span><span class="line"><span class="cl">                        s RetValue=0
</span></span><span class="line"><span class="cl">                        b ;4
</span></span><span class="line"><span class="cl">                        }
</span></span><span class="line"><span class="cl">                    Else {
</span></span><span class="line"><span class="cl">	                    b ;5
</span></span><span class="line"><span class="cl">                        s RetValue=$SYSTEM.Status.GetErrorText(sc)
</span></span><span class="line"><span class="cl">                    }  
</span></span><span class="line"><span class="cl">	      }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    b ;2
</span></span><span class="line"><span class="cl">    i RetValue&#39;=0 s Ret=&#34;&lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;&#34;_RetValue_&#34;&lt;/ResultContent&gt;&lt;/Body&gt;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    e  s Ret=&#34;&lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;ä¿å­˜æˆåŠŸï¼&lt;/ResultContent&gt;&lt;/Body&gt;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    If RetValue&#39;=0 TROLLBACK  q Ret
</span></span><span class="line"><span class="cl">    TCOMMIT
</span></span><span class="line"><span class="cl">    q Ret
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">ErrorHandle1
</span></span><span class="line"><span class="cl">    TROLLBACK
</span></span><span class="line"><span class="cl">    s RetValue=&#34;ä¿å­˜é”™è¯¯&#34;_$tr($ZERROR,&#34;^&#34;,&#34;--&#34;)_&#34;.é”™è¯¯ä»£ç :&#34;_$ECODE
</span></span><span class="line"><span class="cl">    b ;00
</span></span><span class="line"><span class="cl">    s Ret=&#34;&lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;&#34;_RetValue_&#34;&lt;/ResultContent&gt;&lt;/Body&gt;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    Quit Ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2020-10-28
</span></span><span class="line"><span class="cl">/// Description:  ä¿å­˜åŒ»å˜±æ•°æ®åˆ°ä¸­é—´è¡¨
</span></span><span class="line"><span class="cl">/// Table?        dbo.RI_LabRequest,dbo.RI_LabTestSet
</span></span><span class="line"><span class="cl">/// Input?        Input:åŒ»å˜±ä¿¡æ¯XMLä¸²
</span></span><span class="line"><span class="cl">/// Return?       ret:ä¿å­˜æ˜¯å¦æˆåŠŸ
</span></span><span class="line"><span class="cl">/// Others?       æ— 
</span></span><span class="line"><span class="cl">/// s Input=&#34;&lt;Request&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;æˆåŠŸ&lt;/ResultContent&gt;&lt;Orders&gt;&lt;OrderList&gt;&lt;OrdID&gt;&lt;/OrdID&gt;&lt;LabNo&gt;1600904130&lt;/LabNo&gt;&lt;ArcimCode&gt;L002&lt;/ArcimCode&gt;&lt;ArcimDesc&gt;è¡€å¸¸è§„&lt;/ArcimDesc&gt;&lt;OrderQty&gt;1&lt;/OrderQty&gt;&lt;BillCode&gt;P&lt;/BillCode&gt;&lt;SpecimenTypeCode&gt;&lt;/SpecimenTypeCode&gt;&lt;SpecimenTypeDesc&gt;&lt;/SpecimenTypeDesc&gt;&lt;SpVolume&gt;&lt;/SpVolume&gt;&lt;ColInfo&gt;&lt;/ColInfo&gt;&lt;Container&gt;&lt;/Container&gt;&lt;GTSeq&gt;&lt;/GTSeq&gt;&lt;SpecFlag&gt;&lt;/SpecFlag&gt;&lt;VerifyDate&gt;2016-04-26&lt;/VerifyDate&gt;&lt;VerifyTime&gt;13:43:09&lt;/VerifyTime&gt;&lt;ColDate&gt;&lt;/ColDate&gt;&lt;ColTime&gt;&lt;/ColTime&gt;&lt;AppDeptCode&gt;&lt;/AppDeptCode&gt;&lt;AppDeptDesc&gt;ä½“æ£€ç§‘&lt;/AppDeptDesc&gt;&lt;RecDeptCode&gt;&lt;/RecDeptCode&gt;&lt;RecDeptDesc&gt;&lt;/RecDeptDesc&gt;&lt;TSPrice&gt;20&lt;/TSPrice&gt;&lt;OrderStatus&gt;E&lt;/OrderStatus&gt;&lt;DocCode&gt;&lt;/DocCode&gt;&lt;DocDesc&gt;&lt;/DocDesc&gt;&lt;RepLoct&gt;&lt;/RepLoct&gt;&lt;RepDate&gt;&lt;/RepDate&gt;&lt;RepTime&gt;&lt;/RepTime&gt;&lt;Note&gt;&lt;/Note&gt;&lt;AdmNo&gt;&lt;/AdmNo&gt;&lt;AdmDate&gt;2016-04-26&lt;/AdmDate&gt;&lt;AdmTime&gt;13:43:09&lt;/AdmTime&gt;&lt;AdmTypeCode&gt;&lt;/AdmTypeCode&gt;&lt;AdmTypeDesc&gt;ä½“æ£€&lt;/AdmTypeDesc&gt;&lt;FeeType&gt;&lt;/FeeType&gt;&lt;PatientWard&gt;&lt;/PatientWard&gt;&lt;BedNo&gt;&lt;/BedNo&gt;&lt;Diagnose&gt;&lt;/Diagnose&gt;&lt;RegisterNo&gt;16009041&lt;/RegisterNo&gt;&lt;PatientName&gt;æµ‹è¯•ï¼ˆç«¥ï¼‰&lt;/PatientName&gt;&lt;SexCode&gt;M&lt;/SexCode&gt;&lt;SexDesc&gt;ç”·&lt;/SexDesc&gt;&lt;DOB&gt;1987-04-26&lt;/DOB&gt;&lt;Age&gt;29å²&lt;/Age&gt;&lt;DocumentID&gt;D16008409&lt;/DocumentID&gt;&lt;PatientAddress&gt;&lt;/PatientAddress&gt;&lt;IdentityCardNo&gt;&lt;/IdentityCardNo&gt;&lt;Telephone&gt;&lt;/Telephone&gt;&lt;SpecUserCode&gt;&lt;/SpecUserCode&gt;&lt;StartDate&gt;&lt;/StartDate&gt;&lt;StartTime&gt;&lt;/StartTime&gt;&lt;SendFlag&gt;NW&lt;/SendFlag&gt;&lt;/OrderList&gt;&lt;/Orders&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).SaveRequestTestSet(&#34;&lt;Request&gt;&lt;Body&gt;&lt;Orders&gt;&lt;OrderList&gt;&lt;AppDeptDesc&gt;&lt;/AppDeptDesc&gt;&lt;IdentityCardNo&gt;360730199608051156&lt;/IdentityCardNo&gt;&lt;SpecimenTypeDesc&gt;&lt;/SpecimenTypeDesc&gt;&lt;Age&gt;23å²&lt;/Age&gt;&lt;RecDeptCode&gt;&lt;/RecDeptCode&gt;&lt;OrderStatus&gt;&lt;/OrderStatus&gt;&lt;SpVolume&gt;&lt;/SpVolume&gt;&lt;Telephone&gt;&lt;/Telephone&gt;&lt;DOB&gt;1997-01-01&lt;/DOB&gt;&lt;PatientWard&gt;&lt;/PatientWard&gt;&lt;LabNo&gt;9000000114&lt;/LabNo&gt;&lt;ContainerDesc&gt;&lt;/ContainerDesc&gt;&lt;SexCode&gt;1&lt;/SexCode&gt;&lt;SpecUserName&gt;&lt;/SpecUserName&gt;&lt;FeeType&gt;&lt;/FeeType&gt;&lt;TSPrice&gt;&lt;/TSPrice&gt;&lt;ColTime&gt;&lt;/ColTime&gt;&lt;OrderQty&gt;1&lt;/OrderQty&gt;&lt;StartDate&gt;&lt;/StartDate&gt;&lt;BedNo&gt;&lt;/BedNo&gt;&lt;AdmTypeCode&gt;&lt;/AdmTypeCode&gt;&lt;ArcimCode&gt;BGJY000001&lt;/ArcimCode&gt;&lt;RecDeptDesc&gt;&lt;/RecDeptDesc&gt;&lt;PatientAddress&gt;&lt;/PatientAddress&gt;&lt;StartTime&gt;&lt;/StartTime&gt;&lt;VerifyDate&gt;2020-11-19&lt;/VerifyDate&gt;&lt;AppDeptCode&gt;4659&lt;/AppDeptCode&gt;&lt;Container&gt;&lt;/Container&gt;&lt;DocumentID&gt;&lt;/DocumentID&gt;&lt;AdmDate&gt;2020-11-20&lt;/AdmDate&gt;&lt;AdmTime&gt;09:00:00&lt;/AdmTime&gt;&lt;ColDate&gt;&lt;/ColDate&gt;&lt;BillCode&gt;B&lt;/BillCode&gt;&lt;ColInfo&gt;&lt;/ColInfo&gt;&lt;ArcimDesc&gt;è¡€å¸¸è§„&lt;/ArcimDesc&gt;&lt;DocDesc&gt;&lt;/DocDesc&gt;&lt;Note&gt;&lt;/Note&gt;&lt;PatientName&gt;æµ‹è¯•&lt;/PatientName&gt;&lt;Diagnose&gt;&lt;/Diagnose&gt;&lt;AdmTypeDesc&gt;&lt;/AdmTypeDesc&gt;&lt;SpecUserCode&gt;&lt;/SpecUserCode&gt;&lt;GTSeq&gt;&lt;/GTSeq&gt;&lt;DocCode&gt;9803&lt;/DocCode&gt;&lt;OrdID&gt;1481&lt;/OrdID&gt;&lt;SexDesc&gt;ç”·&lt;/SexDesc&gt;&lt;VerifyTime&gt;07:11:17&lt;/VerifyTime&gt;&lt;SpecimenTypeCode&gt;&lt;/SpecimenTypeCode&gt;&lt;AdmNo&gt;45887462&lt;/AdmNo&gt;&lt;RegisterNo&gt;635761&lt;/RegisterNo&gt;&lt;/OrderList&gt;&lt;/Orders&gt;&lt;/Body&gt;&lt;Header&gt;&lt;MessageID&gt;123&lt;/MessageID&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;/Header&gt;&lt;/Request&gt;&#34;)
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).SaveRequestTestSet(^tmp(&#34;SaveRequestTestSet&#34;))
</span></span><span class="line"><span class="cl">ClassMethod SaveRequestTestSetV1(Input)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s ^tmp(&#34;SaveRequestTestSet&#34;)=Input
</span></span><span class="line"><span class="cl">    s Input=$g(Input)
</span></span><span class="line"><span class="cl">    s Input=$P(Input,&#34;&lt;Body&gt;&#34;,2)
</span></span><span class="line"><span class="cl">    s Input=$P(Input,&#34;&lt;/Body&gt;&#34;,1)
</span></span><span class="line"><span class="cl">    S Input=&#34;&lt;Request&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;æˆåŠŸ&lt;/ResultContent&gt;&#34;_Input_&#34;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">    //s Input=&#34;&lt;Request&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;æˆåŠŸ&lt;/ResultContent&gt;&lt;Orders&gt;&lt;OrderList&gt;&lt;OrdID&gt;&lt;/OrdID&gt;&lt;LabNo&gt;1600904130&lt;/LabNo&gt;&lt;ArcimCode&gt;L002&lt;/ArcimCode&gt;&lt;ArcimDesc&gt;è¡€å¸¸è§„&lt;/ArcimDesc&gt;&lt;OrderQty&gt;1&lt;/OrderQty&gt;&lt;BillCode&gt;P&lt;/BillCode&gt;&lt;SpecimenTypeCode&gt;SP001&lt;/SpecimenTypeCode&gt;&lt;SpecimenTypeDesc&gt;è¡€æ¸…&lt;/SpecimenTypeDesc&gt;&lt;SpVolume&gt;&lt;/SpVolume&gt;&lt;ColInfo&gt;&lt;/ColInfo&gt;&lt;Container&gt;&lt;/Container&gt;&lt;GTSeq&gt;&lt;/GTSeq&gt;&lt;SpecFlag&gt;&lt;/SpecFlag&gt;&lt;VerifyDate&gt;2016-04-26&lt;/VerifyDate&gt;&lt;VerifyTime&gt;13:43:09&lt;/VerifyTime&gt;&lt;ColDate&gt;&lt;/ColDate&gt;&lt;ColTime&gt;&lt;/ColTime&gt;&lt;AppDeptCode&gt;&lt;/AppDeptCode&gt;&lt;AppDeptDesc&gt;ä½“æ£€ç§‘&lt;/AppDeptDesc&gt;&lt;RecDeptCode&gt;&lt;/RecDeptCode&gt;&lt;RecDeptDesc&gt;&lt;/RecDeptDesc&gt;&lt;TSPrice&gt;20&lt;/TSPrice&gt;&lt;OrderStatus&gt;E&lt;/OrderStatus&gt;&lt;DocCode&gt;&lt;/DocCode&gt;&lt;DocDesc&gt;&lt;/DocDesc&gt;&lt;RepLoct&gt;&lt;/RepLoct&gt;&lt;RepDate&gt;&lt;/RepDate&gt;&lt;RepTime&gt;&lt;/RepTime&gt;&lt;Note&gt;&lt;/Note&gt;&lt;AdmNo&gt;&lt;/AdmNo&gt;&lt;AdmDate&gt;2016-04-26&lt;/AdmDate&gt;&lt;AdmTime&gt;13:43:09&lt;/AdmTime&gt;&lt;AdmTypeCode&gt;&lt;/AdmTypeCode&gt;&lt;AdmTypeDesc&gt;ä½“æ£€&lt;/AdmTypeDesc&gt;&lt;FeeType&gt;&lt;/FeeType&gt;&lt;PatientWard&gt;&lt;/PatientWard&gt;&lt;BedNo&gt;&lt;/BedNo&gt;&lt;Diagnose&gt;&lt;/Diagnose&gt;&lt;RegisterNo&gt;16009041&lt;/RegisterNo&gt;&lt;PatientName&gt;æµ‹è¯•ï¼ˆç«¥ï¼‰&lt;/PatientName&gt;&lt;SexCode&gt;M&lt;/SexCode&gt;&lt;SexDesc&gt;ç”·&lt;/SexDesc&gt;&lt;DOB&gt;1987-04-26&lt;/DOB&gt;&lt;Age&gt;29å²&lt;/Age&gt;&lt;DocumentID&gt;D16008409&lt;/DocumentID&gt;&lt;PatientAddress&gt;&lt;/PatientAddress&gt;&lt;IdentityCardNo&gt;&lt;/IdentityCardNo&gt;&lt;Telephone&gt;&lt;/Telephone&gt;&lt;SpecUserCode&gt;&lt;/SpecUserCode&gt;&lt;StartDate&gt;&lt;/StartDate&gt;&lt;StartTime&gt;&lt;/StartTime&gt;&lt;SendFlag&gt;NW&lt;/SendFlag&gt;&lt;/OrderList&gt;&lt;/Orders&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">    //s Ret=&#34;&lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;å¤±è´¥ï¼è¾“å…¥ä¿¡æ¯ä¸ºç©º&lt;/ResultContent&gt;&lt;/Body&gt;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    i &#39;$l(Input) q Ret
</span></span><span class="line"><span class="cl">    s repid=$i(^CacheTemp)
</span></span><span class="line"><span class="cl">    s RetValue=1  //é»˜è®¤è¿”å›å€¼ä¸º1
</span></span><span class="line"><span class="cl">    Set $ZTrap = &#34;ErrorHandle&#34;
</span></span><span class="line"><span class="cl">    TSTART
</span></span><span class="line"><span class="cl">    Set reader = ##class(%XML.Reader).%New()
</span></span><span class="line"><span class="cl">    Do reader.OpenString(Input)
</span></span><span class="line"><span class="cl">    Do reader.Correlate(&#34;Request&#34;,&#34;LIS.Service.ENS.Data.RequestOrderMsg&#34;)
</span></span><span class="line"><span class="cl">    b ;ss
</span></span><span class="line"><span class="cl">    While (reader.Next(.obj,.sc)) {
</span></span><span class="line"><span class="cl">        If ($SYSTEM.Status.IsOK(sc)) 
</span></span><span class="line"><span class="cl">        {
</span></span><span class="line"><span class="cl">            s ResultCode=obj.ResultCode
</span></span><span class="line"><span class="cl">            s ResultContent=obj.ResultContent
</span></span><span class="line"><span class="cl">            b ;xx
</span></span><span class="line"><span class="cl">            i (ResultCode=0)
</span></span><span class="line"><span class="cl">            {
</span></span><span class="line"><span class="cl">                s objInfo=##Class(LIS.Model.RPVisitNumber).%New()
</span></span><span class="line"><span class="cl">                s Counts=+obj.Orders.Count()
</span></span><span class="line"><span class="cl">                s (RegNo,AdmNo,AdmTypeCode,MedicalRecordNo,SpecimenTypeCode,AdmDate,AdmTime,PatName,SexCode)=&#34;&#34;
</span></span><span class="line"><span class="cl">                s (DOB,Age,AppDeptCode,AppDeptDesc,DocCode,DocDesc,VerifyDate,VerifyTime,Diagnose)=&#34;&#34;
</span></span><span class="line"><span class="cl">                s (Telephone,IdentityCardNo,PatientAddress,Note,ColDate,ColTime,SpecUserCode,BillCode)=&#34;&#34;
</span></span><span class="line"><span class="cl">                s err=&#34;&#34;
</span></span><span class="line"><span class="cl">                b ;aa
</span></span><span class="line"><span class="cl">                f tmpi=1:1:Counts
</span></span><span class="line"><span class="cl">                {
</span></span><span class="line"><span class="cl">              
</span></span><span class="line"><span class="cl">                    s OrderList=obj.Orders.GetAt(tmpi)
</span></span><span class="line"><span class="cl">               
</span></span><span class="line"><span class="cl">                    s OrderID=$tr(OrderList.OrdID,$c(0)) 
</span></span><span class="line"><span class="cl">              
</span></span><span class="line"><span class="cl">                    s LabNo=OrderList.LabNo
</span></span><span class="line"><span class="cl">                    s ArcimCode=$tr(OrderList.ArcimCode,$c(0))
</span></span><span class="line"><span class="cl">                    s ArcimDesc=$tr(OrderList.ArcimDesc,$c(0))
</span></span><span class="line"><span class="cl">                    s OrderQty=$tr(OrderList.OrderQty,$c(0))
</span></span><span class="line"><span class="cl">                    b ;BillCode OrderList
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    s BillCode=$tr(OrderList.BillCode,$c(0))  
</span></span><span class="line"><span class="cl">                    s BillCode=2                                   
</span></span><span class="line"><span class="cl">                    s SpecimenTypeCode=$tr(OrderList.SpecimenTypeCode,$c(0))
</span></span><span class="line"><span class="cl">                    s SpecimenTypeDesc=$tr(OrderList.SpecimenTypeDesc,$c(0))
</span></span><span class="line"><span class="cl">                    s SpVolume=$tr(OrderList.SpVolume,$c(0))
</span></span><span class="line"><span class="cl">                    s ColInfo=$tr(OrderList.ColInfo,$c(0)) 
</span></span><span class="line"><span class="cl">                    s Container=$tr(OrderList.Container,$c(0))
</span></span><span class="line"><span class="cl">                    s ContainerDesc=$tr(OrderList.ContainerDesc,$c(0))
</span></span><span class="line"><span class="cl">                    s GTSeq=$tr(OrderList.GTSeq,$c(0))
</span></span><span class="line"><span class="cl">                    s VerifyDate=$tr(OrderList.VerifyDate,$c(0))
</span></span><span class="line"><span class="cl">                    s VerifyTime=$tr(OrderList.VerifyTime,$c(0))
</span></span><span class="line"><span class="cl">                    s ColDate=$tr(OrderList.ColDate,$c(0))
</span></span><span class="line"><span class="cl">                    s ColTime=$tr(OrderList.ColTime,$c(0))
</span></span><span class="line"><span class="cl">                    s SpecUserCode=$tr(OrderList.SpecUserCode,$c(0))
</span></span><span class="line"><span class="cl">                    s SpecUserName=$tr(OrderList.SpecUserName,$c(0))
</span></span><span class="line"><span class="cl">                    s AppDeptCode=$tr(OrderList.AppDeptCode,$c(0))
</span></span><span class="line"><span class="cl">                    s AppDeptDesc=$tr(OrderList.AppDeptDesc,$c(0))
</span></span><span class="line"><span class="cl">                    s RecDeptCode=$tr(OrderList.RecDeptCode,$c(0))
</span></span><span class="line"><span class="cl">                    s RecDeptDesc=$tr(OrderList.RecDeptDesc,$c(0))
</span></span><span class="line"><span class="cl">                    s TSPrice=$tr(OrderList.TSPrice,$c(0)) 
</span></span><span class="line"><span class="cl">                    s OrderStatus=$tr(OrderList.OrderStatus,$c(0))
</span></span><span class="line"><span class="cl">                    i OrderStatus=&#34;V&#34;  s OrderStatus =1
</span></span><span class="line"><span class="cl">                    i OrderStatus=&#34;D&#34;  s OrderStatus =6
</span></span><span class="line"><span class="cl">                    i OrderStatus=&#34;E&#34;  s OrderStatus =10
</span></span><span class="line"><span class="cl">                    ///E:æ‰§è¡Œï¼ŒV:å®¡æ ¸ï¼ŒD:åœæ­¢ã€‚åªæœ‰VçŠ¶æ€çš„åŒ»å˜±æ˜¯èƒ½å‡ºæŠ¥å‘Š
</span></span><span class="line"><span class="cl">                    ///1ï¼šç™»è®°ï¼Œ2ï¼šæ‰“å°æ¡ç ï¼Œ3ï¼šé‡‡é›†ï¼Œ4ï¼šæ ‡æœ¬è¿é€ï¼Œ5ï¼šæ ‡æœ¬æ¥æ”¶ï¼Œ6ï¼šåœæ­¢ï¼Œ7ï¼šä½œåºŸï¼Œ8.æ‹’æ”¶ï¼Œ9.æ ¸æ”¶ï¼Œ10.HISå·²æ‰§è¡Œ
</span></span><span class="line"><span class="cl">                    s DocCode=$tr(OrderList.DocCode,$c(0))
</span></span><span class="line"><span class="cl">                    s DocDesc=$tr(OrderList.DocDesc,$c(0))
</span></span><span class="line"><span class="cl">                    s Note=$tr(OrderList.Note,$c(0))
</span></span><span class="line"><span class="cl">                    s AdmNo=$tr(OrderList.AdmNo,$c(0))
</span></span><span class="line"><span class="cl">                 
</span></span><span class="line"><span class="cl">                    s AdmDate=$tr(OrderList.AdmDate,$c(0))
</span></span><span class="line"><span class="cl">                    s AdmTime=$tr(OrderList.AdmTime,$c(0))  
</span></span><span class="line"><span class="cl">                    s AdmTypeCode=$tr(OrderList.AdmTypeCode,$c(0))
</span></span><span class="line"><span class="cl">                    i AdmTypeCode=&#34;&#34; s AdmTypeCode=&#34;I&#34;
</span></span><span class="line"><span class="cl">                    s AdmTypeDesc=$tr(OrderList.AdmTypeDesc,$c(0))
</span></span><span class="line"><span class="cl">                    s FeeType=$tr(OrderList.FeeType,$c(0))
</span></span><span class="line"><span class="cl">                    s PatientWard=$tr(OrderList.PatientWard,$c(0))
</span></span><span class="line"><span class="cl">                 
</span></span><span class="line"><span class="cl">                    s BedNo=$tr(OrderList.BedNo,$c(0))
</span></span><span class="line"><span class="cl">                    s Diagnose=$tr(OrderList.Diagnose,$c(0))
</span></span><span class="line"><span class="cl">                    s RegNo=$tr(OrderList.RegisterNo,$c(0))
</span></span><span class="line"><span class="cl">                    i AdmNo=&#34;&#34; s AdmNo=RegNo
</span></span><span class="line"><span class="cl">                    s PatName=$tr(OrderList.PatientName,$c(0))
</span></span><span class="line"><span class="cl">                    s SexCode=$tr(OrderList.SexCode,$c(0))
</span></span><span class="line"><span class="cl">                    s SexDesc=$tr(OrderList.SexDesc,$c(0))
</span></span><span class="line"><span class="cl">                    s DOB=$tr(OrderList.DOB,$c(0)) 
</span></span><span class="line"><span class="cl">                    s Age=$tr(OrderList.Age,$c(0))
</span></span><span class="line"><span class="cl">                    s DocumentID=$tr(OrderList.DocumentID,$c(0))
</span></span><span class="line"><span class="cl">                    s PatientAddress=$tr(OrderList.PatientAddress,$c(0))
</span></span><span class="line"><span class="cl">                    s IdentityCardNo=$tr(OrderList.IdentityCardNo,$c(0))
</span></span><span class="line"><span class="cl">                    s Telephone=$tr(OrderList.Telephone,$c(0))                  
</span></span><span class="line"><span class="cl">                    s StartDate=$tr(OrderList.StartDate,$c(0))
</span></span><span class="line"><span class="cl">                    s StartTime=$tr(OrderList.StartTime,$c(0)) 
</span></span><span class="line"><span class="cl">                    s HospCode =$tr(OrderList.HospCode,$c(0)) 
</span></span><span class="line"><span class="cl">                    b //ä¿å­˜ä¸»è¡¨ä¿¡æ¯iåŸºæœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">                    i AdmTypeCode=&#34;&#34; s RetValue=&#34;ç—…äººç±»å‹å­—æ®µï¼šAdmTypeCodeä¸ºç©ºï¼Œä¸èƒ½è¿›è¡Œä¿¡æ¯ä¿å­˜ï¼&#34;
</span></span><span class="line"><span class="cl">                    i AdmNo=&#34;&#34; s RetValue=&#34;å°±è¯Šå·å­—æ®µï¼šAdmNoä¸ºç©ºï¼Œä¸èƒ½è¿›è¡Œä¿¡æ¯ä¿å­˜ï¼&#34;
</span></span><span class="line"><span class="cl">                    i RetValue&#39;=1 q
</span></span><span class="line"><span class="cl">                    i $l(AdmTypeCode),$l(AdmNo),$D(^dbo.RILabRequestI(&#34;PKRIRequest&#34;,1,AdmTypeCode,AdmNo)) d
</span></span><span class="line"><span class="cl">                    .s LabRequestRowId=$o(^dbo.RILabRequestI(&#34;PKRIRequest&#34;,1,AdmTypeCode,AdmNo,&#34;&#34;))
</span></span><span class="line"><span class="cl">                    .s ObjLabRequest=##class(dbo.RILabRequest).%OpenId(LabRequestRowId)
</span></span><span class="line"><span class="cl">                    e  d
</span></span><span class="line"><span class="cl">                    .s ObjLabRequest=##class(dbo.RILabRequest).%New()
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.VisitNumberFrom=&#34;1&#34;
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AdmissionType=AdmTypeCode
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.RegNo=RegNo
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AdmNo=AdmNo
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.MedicalRecordNo=DocumentID
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AdmDate=AdmDate
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AdmTime=AdmTime
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.IDNumber=IdentityCardNo
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.PaymentType=FeeType
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.SurName=PatName
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.GivenName=PatName
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.SpeciesID=SexCode
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.SpeciesName=SexDesc
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.BirthDate=$p(DOB,&#34; &#34;,1)
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.BirthTime=$p(DOB,&#34; &#34;,2)
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.Age=+Age
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.AgeUnit=$e(Age,$l(Age)-1,$l(Age))
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.Symptom=Diagnose
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.MobileNo=Telephone
</span></span><span class="line"><span class="cl">                    s ObjLabRequest.Address=PatientAddress
</span></span><span class="line"><span class="cl">                  
</span></span><span class="line"><span class="cl">                    s sc=ObjLabRequest.%Save()
</span></span><span class="line"><span class="cl">                    s VisitNumberDR=&#34;&#34;
</span></span><span class="line"><span class="cl">                    If ($SYSTEM.Status.IsOK(sc)) {
</span></span><span class="line"><span class="cl">                        s RetValue=0
</span></span><span class="line"><span class="cl">                        s VisitNumberDR=$o(^dbo.RILabRequestI(&#34;PKRIRequest&#34;,1,AdmTypeCode,AdmNo,&#34;&#34;))
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                    Else {
</span></span><span class="line"><span class="cl">                        s RetValue=&#34;-1^æ ‡æœ¬ä¸»è¡¨ä¿¡æ¯ä¿å­˜å¤±è´¥:&#34;_$SYSTEM.Status.GetErrorText(sc)
</span></span><span class="line"><span class="cl">                    }
</span></span><span class="line"><span class="cl">                    i OrderID=&#34;&#34; s RetValue=&#34;åŒ»å˜±OrderIDå­—æ®µä¸ºç©ºï¼Œä¸èƒ½è¿›è¡ŒåŒ»å˜±ä¿å­˜:&#34;
</span></span><span class="line"><span class="cl">                    i RetValue&#39;=0  q
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                    b //ä¿å­˜å­è¡¨ï¼ˆåŒ»å˜±è¡¨ï¼‰ä¿¡æ¯
</span></span><span class="line"><span class="cl">                    i $d(^dbo.RILabTestSetI(&#34;PKRITestSet&#34;,VisitNumberDR,OrderID)) d
</span></span><span class="line"><span class="cl">                    .s RILabTestSetRowId=$o(^dbo.RILabTestSetI(&#34;PKRITestSet&#34;,VisitNumberDR,OrderID,&#34;&#34;))
</span></span><span class="line"><span class="cl">                    .s objLabTestSet=##class(dbo.RILabTestSet).%OpenId(RILabTestSetRowId)
</span></span><span class="line"><span class="cl">                  
</span></span><span class="line"><span class="cl">                    e  d
</span></span><span class="line"><span class="cl">                    .s objLabTestSet=##class(dbo.RILabTestSet).%New()
</span></span><span class="line"><span class="cl">                 
</span></span><span class="line"><span class="cl">                    s objLabTestSet.VisitNumberDR=VisitNumberDR
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetCode=ArcimCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetName=ArcimDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetRowID=OrderID
</span></span><span class="line"><span class="cl">                    s objLabTestSet.Sequence=OrderQty
</span></span><span class="line"><span class="cl">                    s objLabTestSet.BarCode=LabNo
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetState=OrderStatus   
</span></span><span class="line"><span class="cl">                    s objLabTestSet.SpecimenCode=SpecimenTypeCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.SpecimenName=SpecimenTypeDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.ContainerCode=Container
</span></span><span class="line"><span class="cl">                    s objLabTestSet.ContainerName=ContainerDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectNotes=ColInfo
</span></span><span class="line"><span class="cl">                    s objLabTestSet.LocationCode=AppDeptCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.LocationName=AppDeptDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.WardCode=PatientWard
</span></span><span class="line"><span class="cl">                    s objLabTestSet.BedNo=BedNo
</span></span><span class="line"><span class="cl">                    s objLabTestSet.DotorID=DocCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.DotorName=DocDesc
</span></span><span class="line"><span class="cl">                    s objLabTestSet.RequestDate=VerifyDate
</span></span><span class="line"><span class="cl">                    s objLabTestSet.RequestTime=VerifyTime
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectDate=ColDate
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectTime=ColTime
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectUserID=SpecUserCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.CollectUserName=SpecUserName
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetFee=TSPrice
</span></span><span class="line"><span class="cl">                    s objLabTestSet.TestSetFeeFlag=BillCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.ReqNotes=Note
</span></span><span class="line"><span class="cl">                    s objLabTestSet.OrdDeptID=RecDeptCode
</span></span><span class="line"><span class="cl">                    s objLabTestSet.OrdDeptName=RecDeptDesc
</span></span><span class="line"><span class="cl">                    ;s HospitaID=$o(^dbo.BTHospitalI(&#34;IndexCode&#34;,&#34; &#34;_HospCode,&#34;&#34;))
</span></span><span class="line"><span class="cl">                 
</span></span><span class="line"><span class="cl">                    s objLabTestSet.HospitalCode=HospCode
</span></span><span class="line"><span class="cl">                 
</span></span><span class="line"><span class="cl">                    b ;xxs
</span></span><span class="line"><span class="cl">                    s sc=objLabTestSet.%Save()
</span></span><span class="line"><span class="cl">                    b ;sc
</span></span><span class="line"><span class="cl">                    If ($SYSTEM.Status.IsOK(sc)) {
</span></span><span class="line"><span class="cl">                        s RetValue=0
</span></span><span class="line"><span class="cl">                        }
</span></span><span class="line"><span class="cl">                    Else {
</span></span><span class="line"><span class="cl">                        s RetValue=$SYSTEM.Status.GetErrorText(sc)
</span></span><span class="line"><span class="cl">                    }  
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    b ;
</span></span><span class="line"><span class="cl">    i RetValue&#39;=0 s Ret=&#34;&lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;&#34;_RetValue_&#34;&lt;/ResultContent&gt;&lt;/Body&gt;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    e  s Ret=&#34;&lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;ä¿å­˜æˆåŠŸï¼&lt;/ResultContent&gt;&lt;/Body&gt;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    If RetValue&#39;=0 TROLLBACK  q Ret
</span></span><span class="line"><span class="cl">    TCOMMIT
</span></span><span class="line"><span class="cl">    q Ret
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">ErrorHandle
</span></span><span class="line"><span class="cl">    TROLLBACK
</span></span><span class="line"><span class="cl">    s RetValue=&#34;ä¿å­˜é”™è¯¯&#34;_$tr($ZERROR,&#34;^&#34;,&#34;--&#34;)_&#34;.é”™è¯¯ä»£ç :&#34;_$ECODE
</span></span><span class="line"><span class="cl">    s Ret=&#34;&lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;&#34;_RetValue_&#34;&lt;/ResultContent&gt;&lt;/Body&gt;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    Quit Ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2020-10-28
</span></span><span class="line"><span class="cl">///               2020-11-03 æŠŠæ‹¼ä¸²æ¨¡å¼ï¼Œæ”¹æˆèµ°ç±»æ–¹æ³•
</span></span><span class="line"><span class="cl">/// Description:  æ ‡æœ¬ç”³è¯·ç³»ç»Ÿè¿”å›æ¡ç å·æ¥å£
</span></span><span class="line"><span class="cl">/// Table?      
</span></span><span class="line"><span class="cl">/// Input?        Input:åŒ»å˜±ä¿¡æ¯XMLä¸²
</span></span><span class="line"><span class="cl">/// Return?       ret:ä¿å­˜æ˜¯å¦æˆåŠŸ
</span></span><span class="line"><span class="cl">/// Others?       æ— 
</span></span><span class="line"><span class="cl">/// s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;OrderItemList&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;A001&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP001&lt;/Specimen&gt;&lt;/OrderItem&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;A002&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP002&lt;/Specimen&gt;&lt;/OrderItem&gt;&lt;OrderItemList&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;&#34;
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).CreateBarcode(&#34;&lt;Request&gt;&lt;Body&gt;&lt;OrderItemList&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;XLJY000010&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP002&lt;/SpecimenCode&gt;&lt;Containe&gt;CO9&lt;/Containe&gt;&lt;/OrderItem&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;XLJY000011&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP002&lt;/SpecimenCode&gt;&lt;Containe&gt;CO9&lt;/Containe&gt;&lt;/OrderItem&gt;&lt;/OrderItemList&gt;&lt;/Body&gt;&lt;Header&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;SourceSystem&gt;500233127&lt;/SourceSystem&gt;&lt;/Header&gt;&lt;/Request&gt;&#34;).Read()
</span></span><span class="line"><span class="cl">ClassMethod CreateBarcode(Input As %String(MAXLEN=32767)) As %GlobalCharacterStream
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s Input=$g(Input)
</span></span><span class="line"><span class="cl">    s ^TMP(&#34;CreateBarcode&#34;)=Input
</span></span><span class="line"><span class="cl">    Set $ZTrap = &#34;ErrorHandle&#34;
</span></span><span class="line"><span class="cl">    //s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;OrderItemList&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;A001&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP001&lt;/SpecimenCode&gt;&lt;Container&gt;ç´«ç®¡&lt;/Container&gt;&lt;/OrderItem&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;A002&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP002&lt;/SpecimenCode&gt;&lt;Container&gt;ç´«ç®¡&lt;/Container&gt;&lt;OrdDeptID&gt;ç”ŸåŒ–å®¤&lt;/OrdDeptID&gt;&lt;/OrderItem&gt;&lt;/OrderItemList&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">    s xmlData= ##class(LIS.Util.COM.XML).FromXML(Input)
</span></span><span class="line"><span class="cl">    s xmlDataRps = ##class(LIS.Util.COM.XML).New(&#34;Response&#34;)
</span></span><span class="line"><span class="cl">    s Header = ##class(LIS.Util.COM.XML).New(&#34;Header&#34;)
</span></span><span class="line"><span class="cl">    s Header.SourceSystem=&#34;&#34;
</span></span><span class="line"><span class="cl">    s Header.MessageID=&#34;&#34;
</span></span><span class="line"><span class="cl">    d xmlDataRps.Insert(Header)
</span></span><span class="line"><span class="cl">    s Body = ##class(LIS.Util.COM.XML).New(&#34;Body&#34;)
</span></span><span class="line"><span class="cl">    s Body.ResultCode=0
</span></span><span class="line"><span class="cl">    s Body.ResultContent=&#34;æˆåŠŸ&#34;
</span></span><span class="line"><span class="cl">    s OrderItemListRps = ##class(LIS.Util.COM.XML).New(&#34;OrderItemList&#34;)
</span></span><span class="line"><span class="cl">    s TestSetStrs=&#34;&#34;
</span></span><span class="line"><span class="cl">    s count = 0
</span></span><span class="line"><span class="cl">    s OrderItemList = xmlData.Body.OrderItemList
</span></span><span class="line"><span class="cl">    ;b ;123
</span></span><span class="line"><span class="cl">   while OrderItemList.Next(){
</span></span><span class="line"><span class="cl">        s item = OrderItemList.Get(count)
</span></span><span class="line"><span class="cl">        s ItemCode=item.ItemCode
</span></span><span class="line"><span class="cl">        s SpecimenCode=item.SpecimenCode
</span></span><span class="line"><span class="cl">         s SpecimenCode=item.SpecimenCode
</span></span><span class="line"><span class="cl">         s Container=item.Containe
</span></span><span class="line"><span class="cl">        s TestSetStrs=TestSetStrs_ItemCode_&#34;|&#34;_SpecimenCode_&#34;|&#34;_Container_&#34;^&#34;
</span></span><span class="line"><span class="cl">        s count=count+1
</span></span><span class="line"><span class="cl">        ;b ;11
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    b ;xdgd
</span></span><span class="line"><span class="cl">    k ^TMP($ZN,$J)
</span></span><span class="line"><span class="cl">    s Num=1
</span></span><span class="line"><span class="cl">    f i=1:1:$l(TestSetStrs,&#34;^&#34;) d
</span></span><span class="line"><span class="cl">    .s TestSetCode=$p($p(TestSetStrs,&#34;^&#34;,i),&#34;|&#34;,1),TestSetDr=&#34;&#34;,SpecimenDR=&#34;&#34;,ContainerDR=&#34;&#34;
</span></span><span class="line"><span class="cl">    .s SpecimenDR=$p($p(TestSetStrs,&#34;^&#34;,i),&#34;|&#34;,2)
</span></span><span class="line"><span class="cl">    .s ContainerDR=$p($p(TestSetStrs,&#34;^&#34;,i),&#34;|&#34;,3)
</span></span><span class="line"><span class="cl">    .i TestSetCode=&#34;&#34; q 
</span></span><span class="line"><span class="cl">    .i $l(TestSetCode) s TestSetDr=$o(^dbo.BTTestSetI(&#34;IndexHISCode&#34;,TestSetCode,&#34;&#34;))
</span></span><span class="line"><span class="cl">    .i $l(TestSetDr),&#39;$l(SpecimenDR) s SpecimenDR=$lg(^dbo.BTTestSetD(TestSetDr),10)
</span></span><span class="line"><span class="cl">    .i $l(TestSetDr),&#39;$l(ContainerDR) s ContainerDR=$lg(^dbo.BTTestSetD(TestSetDr),11)
</span></span><span class="line"><span class="cl">    .s StrData=&#34;SPE&#34;_SpecimenDR_&#34;CON&#34;_ContainerDR
</span></span><span class="line"><span class="cl">    .s ^TMP($ZN,$J,StrData,Num)=TestSetCode_&#34;|&#34;_SpecimenDR
</span></span><span class="line"><span class="cl">    .s Num=Num+1
</span></span><span class="line"><span class="cl">    b //åˆå¹¶ç»„åˆæˆæ¡ç 
</span></span><span class="line"><span class="cl">    s StrData=&#34;&#34; f  s StrData=$o(^TMP($ZN,$J,StrData)) q:StrData=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    .s Labno=##Class(LISSP.BLL.DHCSYSRecordNumber).CreateNewNumber(&#34;MBC&#34;)
</span></span><span class="line"><span class="cl">    .s Num=&#34;&#34; f  s Num=$o(^TMP($ZN,$J,StrData,Num)) q:Num=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    ..s ItemCode=$p($g(^TMP($ZN,$J,StrData,Num)),&#34;|&#34;,1)
</span></span><span class="line"><span class="cl">    ..s SpecimenCode=$p($g(^TMP($ZN,$J,StrData,Num)),&#34;|&#34;,2)
</span></span><span class="line"><span class="cl">    ..s OrderItemRps = ##class(LIS.Util.COM.XML).New(&#34;OrderItem&#34;)
</span></span><span class="line"><span class="cl">    ..s OrderItemRps.ItemCode=ItemCode
</span></span><span class="line"><span class="cl">    ..s OrderItemRps.SpecimenCode=SpecimenCode
</span></span><span class="line"><span class="cl">    ..s OrderItemRps.LabNo=Labno
</span></span><span class="line"><span class="cl">    ..d OrderItemListRps.Insert(OrderItemRps) 
</span></span><span class="line"><span class="cl">    ..s count = count + 1
</span></span><span class="line"><span class="cl">    ..b ;dgsa
</span></span><span class="line"><span class="cl">    d Body.Insert(OrderItemListRps) 
</span></span><span class="line"><span class="cl">    d xmlDataRps.Insert(Body) 
</span></span><span class="line"><span class="cl">    s out=xmlDataRps.ToXMLStream().Read()
</span></span><span class="line"><span class="cl">    q out
</span></span><span class="line"><span class="cl">    b ;xdg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">ErrorHandle  
</span></span><span class="line"><span class="cl">    Quit ##class(LIS.Service.ENS.CommonENS).MsgErr(-1,$ZE)
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2020-10-28
</span></span><span class="line"><span class="cl">/// Description:  æ ‡æœ¬ç”³è¯·ç³»ç»Ÿè¿”å›æ¡ç å·æ¥å£
</span></span><span class="line"><span class="cl">/// Table?      
</span></span><span class="line"><span class="cl">/// Input?        Input:åŒ»å˜±ä¿¡æ¯XMLä¸²
</span></span><span class="line"><span class="cl">/// Return?       ret:ä¿å­˜æ˜¯å¦æˆåŠŸ
</span></span><span class="line"><span class="cl">/// Others?       æ— 
</span></span><span class="line"><span class="cl">/// s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;OrderItemList&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;WY000010&lt;/ItemCode&gt;&lt;SpecimenCode&gt;&lt;/SpecimenCode&gt;&lt;/OrderItem&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;ZZJY003&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP002&lt;/SpecimenCode&gt;&lt;/OrderItem&gt;&lt;OrderItemList&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;&#34;
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).CreateBarcode(&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;OrderItemList&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;WY000010&lt;/ItemCode&gt;&lt;SpecimenCode&gt;&lt;/SpecimenCode&gt;&lt;/OrderItem&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;ZZJY003&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP002&lt;/SpecimenCode&gt;&lt;/OrderItem&gt;&lt;OrderItemList&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;)
</span></span><span class="line"><span class="cl">ClassMethod CreateBarcodeOld(Input)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s Input=$g(Input)
</span></span><span class="line"><span class="cl">    //s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;OrderItemList&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;A001&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP001&lt;/Specimen&gt;&lt;Container&gt;ç´«ç®¡&lt;/Container&gt;&lt;OrdDeptID&gt;ç”ŸåŒ–å®¤&lt;/OrdDeptID&gt;&lt;/OrderItem&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;A002&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP002&lt;/Specimen&gt;&lt;Container&gt;ç´«ç®¡&lt;/Container&gt;&lt;OrdDeptID&gt;ç”ŸåŒ–å®¤&lt;/OrdDeptID&gt;&lt;/OrderItem&gt;&lt;OrderItemList&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">    ;s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;OrderItemList&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;WY000010&lt;/ItemCode&gt;&lt;SpecimenCode&gt;&lt;/SpecimenCode&gt;&lt;/OrderItem&gt;&lt;OrderItem&gt;&lt;ItemCode&gt;ZZJY003&lt;/ItemCode&gt;&lt;SpecimenCode&gt;SP002&lt;/SpecimenCode&gt;&lt;/OrderItem&gt;&lt;OrderItemList&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">    s Input=$REPLACE(Input,&#34;&lt;ItemCode&gt;&#34;,&#34;@&#34;)
</span></span><span class="line"><span class="cl">    s Input=$REPLACE(Input,&#34;&lt;/ItemCode&gt;&#34;,&#34;^&#34;)
</span></span><span class="line"><span class="cl">    s TestSetStrs=&#34;&#34;
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    f i=1:1:$l(Input,&#34;^&#34;) d
</span></span><span class="line"><span class="cl">    .s TestSetStrs=TestSetStrs_&#34;|&#34;_$p($p(Input,&#34;^&#34;,i),&#34;@&#34;,2)
</span></span><span class="line"><span class="cl">    .b ;1
</span></span><span class="line"><span class="cl">    s Ret=&#34;&lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;æˆåŠŸ&lt;/ResultContent&gt;&#34;
</span></span><span class="line"><span class="cl">    k ^TMP($ZN,$J)
</span></span><span class="line"><span class="cl">    s Num=1
</span></span><span class="line"><span class="cl">    b ;12
</span></span><span class="line"><span class="cl">    f i=1:1:$l(TestSetStrs,&#34;|&#34;) d
</span></span><span class="line"><span class="cl">    .s TestSetCode=$p(TestSetStrs,&#34;|&#34;,i),TestSetDr=&#34;&#34;,SpecimenDR=&#34;&#34;,ContainerDR=&#34;&#34;
</span></span><span class="line"><span class="cl">    .i TestSetCode=&#34;&#34; q 
</span></span><span class="line"><span class="cl">    .s HospDr=&#34;&#34; f  s HospDr=$o(^dbo.BTTestSetI(&#34;IndexCode&#34;,HospDr)) q:HospDr=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    ..i &#39;$d(^dbo.BTTestSetI(&#34;IndexCode&#34;,HospDr,&#34; &#34;_TestSetCode)) q
</span></span><span class="line"><span class="cl">    ..s TestSetDr=$o(^dbo.BTTestSetI(&#34;IndexCode&#34;,HospDr,&#34; &#34;_TestSetCode,&#34;&#34;))
</span></span><span class="line"><span class="cl">    .i $l(TestSetDr) s SpecimenDR=$lg(^dbo.BTTestSetD(TestSetDr),10)
</span></span><span class="line"><span class="cl">    .i $l(ContainerDR) s ContainerDR=$lg(^dbo.BTTestSetD(TestSetDr),11)
</span></span><span class="line"><span class="cl">    .s StrData=&#34;SPE&#34;_SpecimenDR_&#34;CON&#34;_ContainerDR
</span></span><span class="line"><span class="cl">    .s ^TMP($ZN,$J,StrData,Num)=TestSetCode_&#34;|&#34;_SpecimenDR
</span></span><span class="line"><span class="cl">    .s Num=Num+1
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    i Num&gt;1 s Ret=Ret_&#34;&lt;OrderItemList&gt;&#34;
</span></span><span class="line"><span class="cl">    s StrData=&#34;&#34; f  s StrData=$o(^TMP($ZN,$J,StrData)) q:StrData=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    .s Labno=##Class(LISSP.BLL.DHCSYSRecordNumber).CreateNewNumber(&#34;MBC&#34;)
</span></span><span class="line"><span class="cl">    .s Num=&#34;&#34; f  s Num=$o(^TMP($ZN,$J,StrData,Num)) q:Num=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    ..s Ret=Ret_&#34;&lt;OrderItem&gt;&lt;ItemCode&gt;&#34;_$p($g(^TMP($ZN,$J,StrData,Num)),&#34;|&#34;,1)_&#34;&lt;/ItemCode&gt;&#34;
</span></span><span class="line"><span class="cl">    ..s Ret=Ret_&#34;&lt;SpecimenCode&gt;&#34;_$p($g(^TMP($ZN,$J,StrData,Num)),&#34;|&#34;,2)_&#34;&lt;/SpecimenCode&gt;&#34;
</span></span><span class="line"><span class="cl">    ..s Ret=Ret_&#34;&lt;LabNo&gt;&#34;_Labno_&#34;&lt;/LabNo&gt;&lt;/OrderItem&gt;&#34;
</span></span><span class="line"><span class="cl">    s Ret=Ret_&#34;&lt;/OrderItemList&gt;&lt;/Body&gt;&lt;/Response&gt;&#34;
</span></span><span class="line"><span class="cl">    q Ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2020-10-28
</span></span><span class="line"><span class="cl">/// Description:  æ›´æ–°æ ‡æœ¬æ¥æ”¶çŠ¶æ€
</span></span><span class="line"><span class="cl">/// Table?        dbo.RI_LabTestSet
</span></span><span class="line"><span class="cl">/// Input?        BarCode:æ¡ç å·, OrderIDï¼šåŒ»å˜±ä»£ç ,HospCode:åŒ»é™¢ä»£ç ,RecFlagï¼šçŠ¶æ€Cï¼šæ¥æ”¶ï¼ŒHï¼šæ ¸æ”¶
</span></span><span class="line"><span class="cl">/// Return?       SQLCODEï¼š0 æˆåŠŸï¼Œå…¶ä»–å¤±è´¥
</span></span><span class="line"><span class="cl">/// Others?       æ— 
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).OrderItemExec(&#34;&#34;)
</span></span><span class="line"><span class="cl">/// W ##class(LIS.WS.BLL.DHCENSLabInterface).OrderItemExec(&#34;9000000001&#34;,&#34;1236&#34;,&#34;500233999&#34;,&#34;H&#34;)
</span></span><span class="line"><span class="cl">ClassMethod OrderItemExec(BarCode, OrderID, HospCode, RecFlag)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s BarCode=$g(BarCode),OrderID=$g(OrderID),TestSetState=5
</span></span><span class="line"><span class="cl">    i &#39;$l(BarCode) q &#34;æ¡ç å·ä¸èƒ½ä¸ºç©ºï¼&#34;
</span></span><span class="line"><span class="cl">    i &#39;$l(OrderID) q &#34;åŒ»å˜±ä»£ç ä¸èƒ½ä¸ºç©ºï¼&#34;
</span></span><span class="line"><span class="cl">    i RecFlag=&#34;C&#34; s TestSetState=5  //æ¥æ”¶ã€
</span></span><span class="line"><span class="cl">    i RecFlag=&#34;H&#34; s TestSetState=9   //æ ¸æ”¶
</span></span><span class="line"><span class="cl">    B ;XDG
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    s ^tmp(&#34;OrderItemExec&#34;,&#34;RecFlag&#34;,BarCode,OrderID)=RecFlag
</span></span><span class="line"><span class="cl">    &amp;sql(Update dbo.RI_LabTestSet set TestSetState=:TestSetState WHERE BarCode=:BarCode and TestSetRowID=:OrderID)
</span></span><span class="line"><span class="cl">    B //åœ¨è°ƒç”¨ç¬¬ä¸‰æ–¹ç³»ç»Ÿï¼Œæ›´æ–°æ­åˆ›æ¥å£ä¿¡æ¯
</span></span><span class="line"><span class="cl">    s Input=&#34;&lt;Request&gt;&lt;Header&gt; &lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;BarCode&gt;&#34;_BarCode_&#34;&lt;/BarCode&gt;&lt;OrderID&gt;&#34;_OrderID_&#34;&lt;/OrderID&gt;&lt;HospCode&gt;&#34;_HospCode_&#34;&lt;/HospCode&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">    s soap=##class(LisWsServiceService.LisWsServicePort).%New()
</span></span><span class="line"><span class="cl">    s ^tmp(&#34;OrderItemExec&#34;,&#34;in&#34;,BarCode,OrderID)=Input
</span></span><span class="line"><span class="cl">    s ret=soap.OrderItemExec(Input)
</span></span><span class="line"><span class="cl">    s ^tmp(&#34;OrderItemExec&#34;,&#34;out&#34;,BarCode,OrderID)=Input
</span></span><span class="line"><span class="cl">    q ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2020-10-28
</span></span><span class="line"><span class="cl">/// Description:  æ ‡æœ¬ç”³è¯·ç³»ç»Ÿè¿”å›æ¡ç å·æ¥å£
</span></span><span class="line"><span class="cl">/// Table?        dbo.RI_LabTestSet
</span></span><span class="line"><span class="cl">/// Input?        BarCodeï¼šæ¡ç å·ï¼Œæ‹’æ”¶ä¿¡æ¯
</span></span><span class="line"><span class="cl">/// Return?       ret:ä¿å­˜æ˜¯å¦æˆåŠŸ
</span></span><span class="line"><span class="cl">/// Others?       æ— 
</span></span><span class="line"><span class="cl">/// s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;BarCode&gt;1234567890&lt;/BarCode &gt;&lt;RejRemark&gt;æ ‡æœ¬æº¶è¡€&lt;/RejRemark&gt;&lt;RejTime&gt;2020-08-01&lt;/RejTime&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).SyncSampleReject(&#34;9000000194&#34;,&#34;&#34;,&#34;500233127&#34;)
</span></span><span class="line"><span class="cl">ClassMethod SyncSampleReject(BarCode, RejRemark, HospCode)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s BarCode=$g(BarCode)
</span></span><span class="line"><span class="cl">    s RejRemark=$g(RejRemark)
</span></span><span class="line"><span class="cl">    s TestSetState=8
</span></span><span class="line"><span class="cl">    &amp;sql(Update dbo.RI_LabTestSet set TestSetState=:TestSetState WHERE BarCode=:BarCode)
</span></span><span class="line"><span class="cl">    s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;HospCode&gt;&#34;_HospCode_&#34;&lt;/HospCode&gt;&lt;BarCode&gt;&#34;_BarCode_&#34;&lt;/BarCode &gt;&lt;RejRemark&gt;&#34;_RejRemark_&#34;&lt;/RejRemark&gt;&lt;RejTime&gt;&#34;_$zdt($h,3)_&#34;&lt;/RejTime&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;  
</span></span><span class="line"><span class="cl">    s soap=##class(LisWsServiceService.LisWsServicePort).%New()
</span></span><span class="line"><span class="cl">     s ^tmp(&#34;OrderItemExec&#34;,&#34;in&#34;,BarCode)=Input
</span></span><span class="line"><span class="cl">    s ret=soap.SyncSampleReject(Input)
</span></span><span class="line"><span class="cl">     s ^tmp(&#34;OrderItemExec&#34;,&#34;out&#34;,BarCode)=Input
</span></span><span class="line"><span class="cl">    q ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2020-10-28
</span></span><span class="line"><span class="cl">/// Description:  æ ‡æœ¬ç”³è¯·ç³»ç»Ÿè¿”å›æ¡ç å·æ¥å£
</span></span><span class="line"><span class="cl">/// Table?        dbo.RI_LabTestSet
</span></span><span class="line"><span class="cl">/// Input?        OrdIDï¼šåŒ»å˜±ID,, ReportID:æŠ¥å‘ŠID,ReportStatusï¼šçŠ¶æ€
</span></span><span class="line"><span class="cl">/// Return?       ret:ä¿å­˜æ˜¯å¦æˆåŠŸ
</span></span><span class="line"><span class="cl">/// Others?       æ— 
</span></span><span class="line"><span class="cl">/// s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;BarCode&gt;1234567890&lt;/BarCode &gt;&lt;RejRemark&gt;æ ‡æœ¬æº¶è¡€&lt;/RejRemark&gt;&lt;RejTime&gt;2020-08-01&lt;/RejTime&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).SyncReprtStatus(OrdID, ReportID, ReportStatus, HospCode)
</span></span><span class="line"><span class="cl">ClassMethod SyncReprtStatus(OrdID, ReportID, ReportStatus, HospCode)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s OrdID=$g(OrdID)
</span></span><span class="line"><span class="cl">    s ReportID=$g(ReportID)
</span></span><span class="line"><span class="cl">    s ReportStatus=$g(ReportStatus)
</span></span><span class="line"><span class="cl">    s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;OrdID&gt;&#34;_OrdID_&#34;&lt;/OrdID&gt;&lt;ReportID&gt;&#34;_ReportID_&#34;&lt;/ReportID&gt;&lt;ReportStatus&gt;&#34;_ReportStatus_&#34;&lt;/ReportStatus&gt;&lt;HospCode&gt;&#34;_HospCode_&#34;&lt;/HospCode&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    s soap=##class(LisWsServiceService.LisWsServicePort).%New()
</span></span><span class="line"><span class="cl">    s ^tmp(&#34;SyncReprtStatus,input&#34;,ReportID,OrdID)=Input
</span></span><span class="line"><span class="cl">    s ret=soap.SyncReprtStatus(Input)
</span></span><span class="line"><span class="cl">    s ^tmp(&#34;SyncReprtStatus,ret&#34;,ReportID,OrdID)=ret
</span></span><span class="line"><span class="cl">    q ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Creator?      DaiYi
</span></span><span class="line"><span class="cl">/// CreatDate?    2020-10-29
</span></span><span class="line"><span class="cl">/// Description:  æ ¹æ®æ¡ç å·è·å–åŒ»å˜±ä¿¡æ¯
</span></span><span class="line"><span class="cl">/// Table?        dbo.RI_LabRequest,dbo.RI_LabTestSet
</span></span><span class="line"><span class="cl">/// Input?        LabNoï¼šæ¡ç å·
</span></span><span class="line"><span class="cl">/// Return?       ret:è¿”å›æ ‡æœ¬ä¿¡æ¯XMLä¸²
</span></span><span class="line"><span class="cl">/// Others?       æ— //AND a.TestSetFeeFlag=&#34;1&#34;
</span></span><span class="line"><span class="cl">/// w ##class(LIS.WS.BLL.DHCENSLabInterface).GetSampleInfo(&#34;9000000117&#34;)
</span></span><span class="line"><span class="cl">ClassMethod GetSampleInfo(LabNo) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">   s ret=&#34;&lt;Request&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;æŸ¥è¯¢è®°å½•å¤±è´¥,æ¡ç å·ä¸ºç©º&lt;/ResultContent&gt;&#34;
</span></span><span class="line"><span class="cl">   //s xmlData= ##class(LIS.Util.COM.XML).FromXML(Input)
</span></span><span class="line"><span class="cl">   i LabNo=&#34;&#34; q ret
</span></span><span class="line"><span class="cl">   s TestsetRowId=&#34;&#34;,TestSetStatus=&#34;&#34;,TestSetFeeFlag=&#34;P&#34;
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   i $d(^dbo.RILabTestSetI(&#34;BarCode&#34;,LabNo)) d
</span></span><span class="line"><span class="cl">   .s TestSetRowId=$o(^dbo.RILabTestSetI(&#34;BarCode&#34;,LabNo,&#34;&#34;))
</span></span><span class="line"><span class="cl">   .s TestSetStatus=$lg(^dbo.RILabTestSetD(TestSetRowId),8)
</span></span><span class="line"><span class="cl">   .s TestSetFeeFlag=$lg(^dbo.RILabTestSetD(TestSetRowId),44)
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   i TestSetStatus=9 q &#34;&lt;Request&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;æ ‡æœ¬å·²ç»æ ¸æ”¶å®Œæ¯•ï¼&lt;/ResultContent&gt;&#34;
</span></span><span class="line"><span class="cl">   i TestSetStatus=6 q &#34;&lt;Request&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;åŒ»å˜±å·²ç»åœæ­¢ï¼&lt;/ResultContent&gt;&#34;
</span></span><span class="line"><span class="cl">   i TestSetStatus=7 q &#34;&lt;Request&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;åŒ»å˜±å·²ç»ä½œåºŸï¼&lt;/ResultContent&gt;&#34;
</span></span><span class="line"><span class="cl">   i TestSetFeeFlag&#39;=&#34;P&#34; q &#34;&lt;Request&gt;&lt;ResultCode&gt;1&lt;/ResultCode&gt;&lt;ResultContent&gt;åŒ»å˜±æœªæ”¶è´¹ï¼Œè¯·å…ˆç¼´è´¹ï¼&lt;/ResultContent&gt;&#34;
</span></span><span class="line"><span class="cl">   s SpecNums=0
</span></span><span class="line"><span class="cl">   &amp;sql(DECLARE RIQuest CURSOR FOR
</span></span><span class="line"><span class="cl">        SELECT a.TestSetRowID,a.BarCode,a.TestSetCode,a.TestSetName,a.Sequence,a.SpecimenCode,a.SpecimenName,a.CollectNotes,
</span></span><span class="line"><span class="cl">        a.ContainerCode,a.SpecialFlag,a.SpecialRowId,a.RequestDate,a.RequestTime,a.CollectDate,
</span></span><span class="line"><span class="cl">        a.CollectTime,a.LocationCode,a.LocationName,a.OrdDeptID,a.OrdDeptName,a.TestSetFee,a.TestSetState,
</span></span><span class="line"><span class="cl">        a.DotorID,a.DotorName,a.ReqNotes,b.AdmNo,b.AdmDate,b.AdmTime,b.AdmissionType,b.PaymentType,a.WardCode,
</span></span><span class="line"><span class="cl">        a.BedNo,b.Symptom,b.RegNo,b.SurName,b.SpeciesID,b.SpeciesName,b.BirthDate,b.Age,b.AgeUnit,b.MedicalRecordNo,
</span></span><span class="line"><span class="cl">        b.Address,b.MobileNo,a.CollectUserID,a.CollectUserName,a.TestSetFeeFlag,a.RowId,b.HospitaID
</span></span><span class="line"><span class="cl">        into
</span></span><span class="line"><span class="cl">        :OrdID,:BarCode,:ArcimCode,:ArcimDesc,:OrderQty,:SpecimenTypeCode,:SpecimenTypeDesc,:SpVolume,
</span></span><span class="line"><span class="cl">        :Container,:GTSeq,:SpecFlag,:VerifyDate,:VerifyTime,:ColDate,
</span></span><span class="line"><span class="cl">        :ColTime,:AppDeptCode,:AppDeptDesc,:RecDeptCode,:RecDeptDesc,:TSPrice,:OrderStatus,
</span></span><span class="line"><span class="cl">        :DocCode,:DocDesc,:Note,:AdmNo,:AdmDate,:AdmTime,:AdmTypeCode,:FeeType,:PatientWard,
</span></span><span class="line"><span class="cl">        :BedNo,:Diagnose,:RegisterNo,:PatientName,:SexCode,:SexDesc,:DOB,:Age,:AgeUnit,:DocumentID,
</span></span><span class="line"><span class="cl">        :PatientAddress,:Telephone,:SpecUserCode,:SpecUserName,:SendFlag,:RowId,:HospCode
</span></span><span class="line"><span class="cl">        FROM dbo.RI_LabTestSet AS a,dbo.RI_LabRequest AS b 
</span></span><span class="line"><span class="cl">        WHERE a.VisitNumberDR=b.RowId AND a.BarCode=:LabNo )
</span></span><span class="line"><span class="cl">   &amp;sql(OPEN RIQuest)
</span></span><span class="line"><span class="cl">   &amp;sql(FETCH RIQuest)
</span></span><span class="line"><span class="cl">   i SQLCODE=0 d
</span></span><span class="line"><span class="cl">   .s SpecNums=1
</span></span><span class="line"><span class="cl">   .s ret=&#34;&lt;Request&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;æˆåŠŸ&lt;/ResultContent&gt;&#34;
</span></span><span class="line"><span class="cl">   .s ret=ret_&#34;&lt;Orders&gt;&#34;
</span></span><span class="line"><span class="cl">   While (SQLCODE = 0) 
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;OrderList&gt;&lt;OrdID&gt;&#34;_$tr(OrdID,$c(0))_&#34;&lt;/OrdID&gt;&lt;LabNo&gt;&#34;_$tr(BarCode,$c(0))_&#34;&lt;/LabNo&gt;&lt;ArcimCode&gt;&#34;_$tr(ArcimCode,$c(0))_&#34;&lt;/ArcimCode&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;ArcimDesc&gt;&#34;_$tr(ArcimDesc,$c(0))_&#34;&lt;/ArcimDesc&gt;&lt;OrderQty&gt;&#34;_$tr(OrderQty,$c(0))_&#34;&lt;/OrderQty&gt;&lt;BillCode&gt;&lt;/BillCode&gt;&lt;SpecimenTypeCode&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_$tr(SpecimenTypeCode,$c(0))_&#34;&lt;/SpecimenTypeCode&gt;&lt;SpecimenTypeDesc&gt;&#34;_$tr(SpecimenTypeDesc,$c(0))_&#34;&lt;/SpecimenTypeDesc&gt;&lt;SpVolume&gt;&#34;_$tr(SpVolume,$c(0))_&#34;&lt;/SpVolume&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;ColInfo&gt;&lt;/ColInfo&gt;&lt;Container&gt;&#34;_$tr(Container,$c(0))_&#34;&lt;/Container&gt;&lt;GTSeq&gt;&#34;_$tr(GTSeq,$c(0))_&#34;&lt;/GTSeq&gt;&lt;SpecFlag&gt;&#34;_$tr(SpecFlag,$c(0))_&#34;&lt;/SpecFlag&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;VerifyDate&gt;&#34;_$tr(VerifyDate,$c(0))_&#34;&lt;/VerifyDate&gt;&lt;VerifyTime&gt;&#34;_$tr(VerifyTime,$c(0))_&#34;&lt;/VerifyTime&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;ColDate&gt;&#34;_$tr(ColDate,$c(0))_&#34;&lt;/ColDate&gt;&lt;ColTime&gt;&#34;_$tr(ColTime,$c(0))_&#34;&lt;/ColTime&gt;&lt;AppDeptCode&gt;&#34;_$tr(AppDeptCode,$c(0))_&#34;&lt;/AppDeptCode&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;AppDeptDesc&gt;&#34;_$tr(AppDeptDesc,$c(0))_&#34;&lt;/AppDeptDesc&gt;&lt;RecDeptCode&gt;&#34;_$tr(RecDeptCode,$c(0))_&#34;&lt;/RecDeptCode&gt;&lt;RecDeptDesc&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_$tr(AppDeptDesc,$c(0))_&#34;&lt;/RecDeptDesc&gt;&lt;TSPrice&gt;&#34;_$tr(TSPrice,$c(0))_&#34;&lt;/TSPrice&gt;&lt;OrderStatus&gt;&#34;_$tr(OrderStatus,$c(0))_&#34;&lt;/OrderStatus&gt;&lt;DocCode&gt;&#34;_$tr(DocCode,$c(0))_&#34;&lt;/DocCode&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;DocDesc&gt;&#34;_$tr(DocDesc,$c(0))_&#34;&lt;/DocDesc&gt;&lt;RepLoct&gt;&lt;/RepLoct&gt;&lt;RepDate&gt;&lt;/RepDate&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;RepTime&gt;&lt;/RepTime&gt;&lt;Note&gt;&#34;_$tr(Note,$c(0))_&#34;&lt;/Note&gt;&lt;AdmNo&gt;&#34;_$tr(AdmNo,$c(0))_&#34;&lt;/AdmNo&gt;&lt;AdmDate&gt;&#34;_$tr(AdmDate,$c(0))_&#34;&lt;/AdmDate&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;AdmTime&gt;&#34;_$tr(AdmTime,$c(0))_&#34;&lt;/AdmTime&gt;&lt;AdmTypeCode&gt;&#34;_$tr(AdmTypeCode,$c(0))_&#34;&lt;/AdmTypeCode&gt;&lt;AdmTypeDesc&gt;&lt;/AdmTypeDesc&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;FeeType&gt;&#34;_$tr(FeeType,$c(0))_&#34;&lt;/FeeType&gt;&lt;PatientWard&gt;&#34;_$tr(PatientWard,$c(0))_&#34;&lt;/PatientWard&gt;&lt;BedNo&gt;&#34;_$tr(BedNo,$c(0))_&#34;&lt;/BedNo&gt;&lt;Diagnose&gt;&#34;_$tr(Diagnose,$c(0))_&#34;&lt;/Diagnose&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;RegisterNo&gt;&#34;_$tr(RegisterNo,$c(0))_&#34;&lt;/RegisterNo&gt;&lt;PatientName&gt;&#34;_$tr(PatientName,$c(0))_&#34;&lt;/PatientName&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;SexCode&gt;&#34;_$tr(SexCode,$c(0))_&#34;&lt;/SexCode&gt;&lt;SexDesc&gt;&#34;_$tr(SexDesc,$c(0))_&#34;&lt;/SexDesc&gt;&lt;DOB&gt;&#34;_$tr(DOB,$c(0))_&#34;&lt;/DOB&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;Age&gt;&#34;_$tr(Age,$c(0))_&#34;&lt;/Age&gt;&lt;DocumentID&gt;&#34;_$tr(DocumentID,$c(0))_&#34;&lt;/DocumentID&gt;&lt;PatientAddress&gt;&#34;_$tr(PatientAddress,$c(0))_&#34;&lt;/PatientAddress&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;IdentityCardNo&gt;&lt;/IdentityCardNo&gt;&lt;Telephone&gt;&#34;_$tr(Telephone,$c(0))_&#34;&lt;/Telephone&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;SpecUserCode&gt;&#34;_$tr(SpecUserCode,$c(0))_&#34;&lt;/SpecUserCode&gt;&lt;StartDate&gt;&lt;/StartDate&gt;&lt;StartTime&gt;&lt;/StartTime&gt;&#34;
</span></span><span class="line"><span class="cl">        s ret=ret_&#34;&lt;SendFlag&gt;&#34;_$tr(SendFlag,$c(0))_&#34;&lt;/SendFlag&gt;&#34;_&#34;&lt;HospCode&gt;&#34;_$tr(HospCode,$c(0))_&#34;&lt;/HospCode&gt;&lt;/OrderList&gt;&#34;
</span></span><span class="line"><span class="cl">        s TestsetRowId=TestsetRowId_RowId_&#34;^&#34;
</span></span><span class="line"><span class="cl">        &amp;sql(FETCH RIQuest)
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    i SpecNums&gt;0 s ret=ret_&#34;&lt;/Orders&gt;&lt;/Request&gt;&#34; 
</span></span><span class="line"><span class="cl">    i SpecNums=0 s ret=ret_&#34;&lt;/Request&gt;&#34; 
</span></span><span class="line"><span class="cl">   &amp;sql(CLOSE RIQuest)
</span></span><span class="line"><span class="cl">   Q ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// 7.æ ¹æ®æŠ¥å‘ŠIDè·å–æŠ¥å‘Šä¿¡æ¯
</span></span><span class="line"><span class="cl">/// Input: &lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ReportID&gt;19&lt;/ReportID&gt;&lt;/Body&gt;&lt;/Request&gt;
</span></span><span class="line"><span class="cl">/// Output: &lt;Response&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ResultCode&gt;0&lt;/ResultCode&gt;&lt;ResultContent&gt;æˆåŠŸ&lt;/ResultContent&gt;&lt;LabNo&gt;7000027229&lt;/LabNo&gt;&lt;RecUserCode&gt;1450&lt;/RecUserCode&gt;&lt;RecUser&gt;é™ˆç§€å¨Ÿ&lt;/RecUser&gt;&lt;RecDate&gt;2016-11-13&lt;/RecDate&gt;&lt;RecTime&gt;15:12:34&lt;/RecTime&gt;&lt;EntryUserCode&gt;1560&lt;/EntryUserCode&gt;&lt;EntryUser&gt;éƒ‘æ³½å¼º&lt;/EntryUser&gt;&lt;EntryDate&gt;2016-11-14&lt;/EntryDate&gt;&lt;EntryTime&gt;12:53:51&lt;/EntryTime&gt;&lt;AuthUserCode&gt;1475&lt;/AuthUserCode&gt;&lt;AuthUser&gt;å‘¨è²&lt;/AuthUser&gt;&lt;AuthDate&gt;2016-11-14&lt;/AuthDate&gt;&lt;AuthTime&gt;12:53:51&lt;/AuthTime&gt;&lt;Notes/&gt;&lt;MainWarnDesc/&gt;&lt;ResultMsgs&gt;&lt;ResultMsg&gt;&lt;TestCode&gt;4081&lt;/TestCode&gt;&lt;TestName&gt;å¼“å½¢è™«æŠ—ä½“&lt;/TestName&gt;&lt;TestEngName&gt;TO-lgM(ELISA)&lt;/TestEngName&gt;&lt;Result&gt;é˜´æ€§(-)&lt;/Result&gt;&lt;Units/&gt;&lt;Notes/&gt;&lt;ResultFlag&gt;N&lt;/ResultFlag&gt;&lt;Ranges&gt;é˜´æ€§ï¼ˆ-ï¼‰&lt;/Ranges&gt;&lt;Sequence&gt;280&lt;/Sequence&gt;&lt;MICFlag&gt;N&lt;/MICFlag&gt;&lt;MICName/&gt;&lt;WarnDesc/&gt;&lt;OrgResultMsgs/&gt;&lt;/ResultMsg&gt;&lt;ResultMsg&gt;&lt;TestCode&gt;4072&lt;/TestCode&gt;&lt;TestName&gt;é£ç–¹ç—…æ¯’æŠ—ä½“&lt;/TestName&gt;&lt;TestEngName&gt;R-lgM(ELISA)&lt;/TestEngName&gt;&lt;Result&gt;é˜´æ€§(-)&lt;/Result&gt;&lt;Units/&gt;&lt;Notes/&gt;&lt;ResultFlag&gt;N&lt;/ResultFlag&gt;&lt;Ranges&gt;é˜´æ€§ï¼ˆ-ï¼‰&lt;/Ranges&gt;&lt;Sequence&gt;290&lt;/Sequence&gt;&lt;MICFlag&gt;N&lt;/MICFlag&gt;&lt;MICName/&gt;&lt;WarnDesc/&gt;&lt;OrgResultMsgs/&gt;&lt;/ResultMsg&gt;&lt;ResultMsg&gt;&lt;TestCode&gt;4016&lt;/TestCode&gt;&lt;TestName&gt;å·¨ç»†èƒç—…æ¯’æŠ—ä½“&lt;/TestName&gt;&lt;TestEngName&gt;C -lgM(ELISA)&lt;/TestEngName&gt;&lt;Result&gt;é˜´æ€§(-)&lt;/Result&gt;&lt;Units/&gt;&lt;Notes/&gt;&lt;ResultFlag&gt;N&lt;/ResultFlag&gt;&lt;Ranges&gt;é˜´æ€§ï¼ˆ-ï¼‰&lt;/Ranges&gt;&lt;Sequence&gt;300&lt;/Sequence&gt;&lt;MICFlag&gt;N&lt;/MICFlag&gt;&lt;MICName/&gt;&lt;WarnDesc/&gt;&lt;OrgResultMsgs/&gt;&lt;/ResultMsg&gt;&lt;ResultMsg&gt;&lt;TestCode&gt;4053&lt;/TestCode&gt;&lt;TestName&gt;å•çº¯ç–±ç–¹ç—…æ¯’æŠ—ä½“â… å‹M&lt;/TestName&gt;&lt;TestEngName&gt;HSV-â… lgM(ELISA)&lt;/TestEngName&gt;&lt;Result&gt;é˜´æ€§(-)&lt;/Result&gt;&lt;Units/&gt;&lt;Notes/&gt;&lt;ResultFlag&gt;N&lt;/ResultFlag&gt;&lt;Ranges&gt;é˜´æ€§ï¼ˆ-ï¼‰&lt;/Ranges&gt;&lt;Sequence&gt;310&lt;/Sequence&gt;&lt;MICFlag&gt;N&lt;/MICFlag&gt;&lt;MICName/&gt;&lt;WarnDesc/&gt;&lt;OrgResultMsgs/&gt;&lt;/ResultMsg&gt;&lt;ResultMsg&gt;&lt;TestCode&gt;4055&lt;/TestCode&gt;&lt;TestName&gt;å•çº¯ç–±ç–¹ç—…æ¯’æŠ—ä½“â…¡å‹M&lt;/TestName&gt;&lt;TestEngName&gt;HSV-â…¡lgM(ELISA)&lt;/TestEngName&gt;&lt;Result&gt;é˜´æ€§(-)&lt;/Result&gt;&lt;Units/&gt;&lt;Notes/&gt;&lt;ResultFlag&gt;N&lt;/ResultFlag&gt;&lt;Ranges&gt;é˜´æ€§ï¼ˆ-ï¼‰&lt;/Ranges&gt;&lt;Sequence&gt;320&lt;/Sequence&gt;&lt;MICFlag&gt;N&lt;/MICFlag&gt;&lt;MICName/&gt;&lt;WarnDesc/&gt;&lt;OrgResultMsgs/&gt;&lt;/ResultMsg&gt;&lt;/ResultMsgs&gt;&lt;/Body&gt;&lt;/Response&gt;
</span></span><span class="line"><span class="cl">/// w ##Class(LIS.WS.BLL.DHCENSLabInterface).GetReport(&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ReportID&gt;12&lt;/ReportID&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;).Read()
</span></span><span class="line"><span class="cl">ClassMethod GetReport(Input As %String(MAXLEN=32767)) As %GlobalCharacterStream
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    s Input=$g(Input)
</span></span><span class="line"><span class="cl">    Set $ZTrap = &#34;ErrorHandle&#34;
</span></span><span class="line"><span class="cl">    //s Input=&#34;&lt;Request&gt;&lt;Header&gt;&lt;SourceSystem&gt;&lt;/SourceSystem&gt;&lt;MessageID&gt;&lt;/MessageID&gt;&lt;/Header&gt;&lt;Body&gt;&lt;ReportID&gt;19&lt;/ReportID&gt;&lt;/Body&gt;&lt;/Request&gt;&#34;
</span></span><span class="line"><span class="cl">    s xmlData= ##class(LIS.Util.COM.XML).FromXML(Input)
</span></span><span class="line"><span class="cl">    s ReportID=xmlData.Body.ReportID
</span></span><span class="line"><span class="cl">    i &#39;$l(ReportID) Quit ##class(LIS.Service.ENS.CommonENS).MsgErr(&#34;-1&#34;,&#34;å…¥å‚æŠ¥å‘ŠIDä¸èƒ½ä¸ºç©º&#34;)
</span></span><span class="line"><span class="cl">    s retValue=##Class(LIS.Service.ENS.TransReport).GetReport(ReportID,.Msg)
</span></span><span class="line"><span class="cl">    q retValue
</span></span><span class="line"><span class="cl">ErrorHandle 
</span></span><span class="line"><span class="cl">    Quit ##class(LIS.Service.ENS.CommonENS).MsgErr(-1,$ZE)
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="xmlä¸²ä¿¡æ¯">XMLä¸²ä¿¡æ¯
</h3><h4 id="ä½“æ£€è¿”å›ä¸²">ä½“æ£€è¿”å›ä¸²
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;Request&gt;
</span></span><span class="line"><span class="cl">	&lt;Header&gt;
</span></span><span class="line"><span class="cl">		&lt;SourceSystem&gt;PEIS&lt;/SourceSystem&gt;
</span></span><span class="line"><span class="cl">		&lt;MessageID&gt;20250104111146&lt;/MessageID&gt;
</span></span><span class="line"><span class="cl">	&lt;/Header&gt;
</span></span><span class="line"><span class="cl">	&lt;Body&gt;
</span></span><span class="line"><span class="cl">		&lt;PATPatientInfo&gt;
</span></span><span class="line"><span class="cl">			&lt;HospitalCode&gt;SMYQ&lt;/HospitalCode&gt;
</span></span><span class="line"><span class="cl">			&lt;HospitalDesc&gt;å¦é—¨å¤§å­¦é™„å±ç¿”å®‰åŒ»é™¢æ€æ˜é™¢åŒº&lt;/HospitalDesc&gt;
</span></span><span class="line"><span class="cl">			&lt;PATPatientID&gt;0000177422&lt;/PATPatientID&gt;
</span></span><span class="line"><span class="cl">			&lt;PATName&gt;ç†Šæ°¸èŠ³&lt;/PATName&gt;
</span></span><span class="line"><span class="cl">			&lt;PATDob&gt;1962-02-24&lt;/PATDob&gt;
</span></span><span class="line"><span class="cl">			&lt;PATAge&gt;62&lt;/PATAge&gt;
</span></span><span class="line"><span class="cl">			&lt;PATSexCode&gt;1&lt;/PATSexCode&gt;
</span></span><span class="line"><span class="cl">			&lt;PATSexDesc&gt;ç”·&lt;/PATSexDesc&gt;
</span></span><span class="line"><span class="cl">			&lt;PATMaritalStatusCode&gt;90&lt;/PATMaritalStatusCode&gt;
</span></span><span class="line"><span class="cl">			&lt;PATMaritalStatusDesc&gt;æœªè¯´æ˜çš„å©šå§»çŠ¶å†µ&lt;/PATMaritalStatusDesc&gt;
</span></span><span class="line"><span class="cl">			&lt;PATDocumentNo/&gt;
</span></span><span class="line"><span class="cl">			&lt;PATNationCode/&gt;
</span></span><span class="line"><span class="cl">			&lt;PATNationDesc/&gt;
</span></span><span class="line"><span class="cl">			&lt;PATCountryCode&gt;156&lt;/PATCountryCode&gt;
</span></span><span class="line"><span class="cl">			&lt;PATCountryDesc&gt;ä¸­å›½&lt;/PATCountryDesc&gt;
</span></span><span class="line"><span class="cl">			&lt;PATIdentityNum&gt;352623196202246137&lt;/PATIdentityNum&gt;
</span></span><span class="line"><span class="cl">			&lt;PATIdTypeCode&gt;01&lt;/PATIdTypeCode&gt;
</span></span><span class="line"><span class="cl">			&lt;PATIdTypeDesc&gt;å±…æ°‘èº«ä»½è¯&lt;/PATIdTypeDesc&gt;
</span></span><span class="line"><span class="cl">			&lt;PATTelephone&gt;18359732216&lt;/PATTelephone&gt;
</span></span><span class="line"><span class="cl">		&lt;/PATPatientInfo&gt;
</span></span><span class="line"><span class="cl">		&lt;PATAdmInfo&gt;
</span></span><span class="line"><span class="cl">			&lt;PAADMVisitNumber&gt;TJ11011800&lt;/PAADMVisitNumber&gt;
</span></span><span class="line"><span class="cl">		&lt;/PATAdmInfo&gt;
</span></span><span class="line"><span class="cl">		&lt;SendPatOrdListRt&gt;
</span></span><span class="line"><span class="cl">			&lt;OrderList&gt;
</span></span><span class="line"><span class="cl">				&lt;Order&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORIOrderItemID&gt;0087243&lt;/OEORIOrderItemID&gt;
</span></span><span class="line"><span class="cl">					&lt;RISRSystemType&gt;HIS&lt;/RISRSystemType&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORISpecimenID&gt;6080005896&lt;/OEORISpecimenID&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORIARCItmMastCode&gt;SMA041&lt;/OEORIARCItmMastCode&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORIARCItmMastDesc&gt;æœ‰æ ¸çº¢ç»†èƒè®¡æ•°&lt;/OEORIARCItmMastDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORIOrderQty&gt;1&lt;/OEORIOrderQty&gt;
</span></span><span class="line"><span class="cl">					&lt;BillStatus&gt;P&lt;/BillStatus&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORISpecimenCode&gt;3&lt;/OEORISpecimenCode&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORISpecimenDesc&gt;å…¨è¡€&lt;/OEORISpecimenDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;ColDate&gt;2025-01-03&lt;/ColDate&gt;
</span></span><span class="line"><span class="cl">					&lt;ColTime&gt;09:27:36&lt;/ColTime&gt;
</span></span><span class="line"><span class="cl">					&lt;AppDeptCode&gt;32300&lt;/AppDeptCode&gt;
</span></span><span class="line"><span class="cl">					&lt;AppDeptDesc&gt;å¥åº·ä½“æ£€ç§‘&lt;/AppDeptDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;RecDeptCode/&gt;
</span></span><span class="line"><span class="cl">					&lt;RecDeptDesc&gt;æ£€éªŒ&lt;/RecDeptDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;TSPrice&gt;9.00&lt;/TSPrice&gt;
</span></span><span class="line"><span class="cl">					&lt;OrderStatus&gt;E&lt;/OrderStatus&gt;
</span></span><span class="line"><span class="cl">					&lt;DocCode&gt;cbl&lt;/DocCode&gt;
</span></span><span class="line"><span class="cl">					&lt;DocDesc&gt;é™ˆæ»¨æ—&lt;/DocDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;OrdSubCatCode&gt;SMAA01&lt;/OrdSubCatCode&gt;
</span></span><span class="line"><span class="cl">					&lt;OrdSubCatDesc&gt;ä¸´æ£€XN-1000&lt;/OrdSubCatDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;OrdCatCode&gt;SMAA&lt;/OrdCatCode&gt;
</span></span><span class="line"><span class="cl">					&lt;OrdCatDesc&gt;ä¸´æ£€ç»„&lt;/OrdCatDesc&gt;
</span></span><span class="line"><span class="cl">				&lt;/Order&gt;
</span></span><span class="line"><span class="cl">				&lt;Order&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORIOrderItemID&gt;0087244&lt;/OEORIOrderItemID&gt;
</span></span><span class="line"><span class="cl">					&lt;RISRSystemType&gt;HIS&lt;/RISRSystemType&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORISpecimenID&gt;6080005896&lt;/OEORISpecimenID&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORIARCItmMastCode&gt;SMA001&lt;/OEORIARCItmMastCode&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORIARCItmMastDesc&gt;è¡€ç»†èƒåˆ†æï¼ˆå…¨è¡€ç»†èƒè®¡æ•°+äº”åˆ†ç±»ï¼‰&lt;/OEORIARCItmMastDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORIOrderQty&gt;1&lt;/OEORIOrderQty&gt;
</span></span><span class="line"><span class="cl">					&lt;BillStatus&gt;P&lt;/BillStatus&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORISpecimenCode&gt;3&lt;/OEORISpecimenCode&gt;
</span></span><span class="line"><span class="cl">					&lt;OEORISpecimenDesc&gt;å…¨è¡€&lt;/OEORISpecimenDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;ColDate&gt;2025-01-03&lt;/ColDate&gt;
</span></span><span class="line"><span class="cl">					&lt;ColTime&gt;09:27:36&lt;/ColTime&gt;
</span></span><span class="line"><span class="cl">					&lt;AppDeptCode&gt;32300&lt;/AppDeptCode&gt;
</span></span><span class="line"><span class="cl">					&lt;AppDeptDesc&gt;å¥åº·ä½“æ£€ç§‘&lt;/AppDeptDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;RecDeptCode/&gt;
</span></span><span class="line"><span class="cl">					&lt;RecDeptDesc&gt;æ£€éªŒ&lt;/RecDeptDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;TSPrice&gt;25.00&lt;/TSPrice&gt;
</span></span><span class="line"><span class="cl">					&lt;OrderStatus&gt;E&lt;/OrderStatus&gt;
</span></span><span class="line"><span class="cl">					&lt;DocCode&gt;cbl&lt;/DocCode&gt;
</span></span><span class="line"><span class="cl">					&lt;DocDesc&gt;é™ˆæ»¨æ—&lt;/DocDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;OrdSubCatCode&gt;SMAA01&lt;/OrdSubCatCode&gt;
</span></span><span class="line"><span class="cl">					&lt;OrdSubCatDesc&gt;ä¸´æ£€XN-1000&lt;/OrdSubCatDesc&gt;
</span></span><span class="line"><span class="cl">					&lt;OrdCatCode&gt;SMAA&lt;/OrdCatCode&gt;
</span></span><span class="line"><span class="cl">					&lt;OrdCatDesc&gt;ä¸´æ£€ç»„&lt;/OrdCatDesc&gt;
</span></span><span class="line"><span class="cl">				&lt;/Order&gt;
</span></span><span class="line"><span class="cl">			&lt;/OrderList&gt;
</span></span><span class="line"><span class="cl">		&lt;/SendPatOrdListRt&gt;
</span></span><span class="line"><span class="cl">	&lt;/Body&gt;
</span></span><span class="line"><span class="cl">&lt;/Request&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ ¼å¼åŒ–åä¸²">æ ¼å¼åŒ–åä¸²
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;Response&gt;
</span></span><span class="line"><span class="cl">	&lt;Header&gt;
</span></span><span class="line"><span class="cl">		&lt;ResultCode&gt;0&lt;/ResultCode&gt;
</span></span><span class="line"><span class="cl">		&lt;ResultContent/&gt;
</span></span><span class="line"><span class="cl">	&lt;/Header&gt;
</span></span><span class="line"><span class="cl">	&lt;Body&gt;
</span></span><span class="line"><span class="cl">		&lt;HospitalCode&gt;SMYQ&lt;/HospitalCode&gt;
</span></span><span class="line"><span class="cl">		&lt;OrderList&gt;
</span></span><span class="line"><span class="cl">			&lt;OderItem&gt;
</span></span><span class="line"><span class="cl">				&lt;HISOrderID&gt;0087243&lt;/HISOrderID&gt;
</span></span><span class="line"><span class="cl">				&lt;TestSetCode&gt;SMA041&lt;/TestSetCode&gt;
</span></span><span class="line"><span class="cl">				&lt;OrdItmStat/&gt;
</span></span><span class="line"><span class="cl">				&lt;Biled&gt;0&lt;/Biled&gt;
</span></span><span class="line"><span class="cl">				&lt;TestSetFee&gt;9.00&lt;/TestSetFee&gt;
</span></span><span class="line"><span class="cl">			&lt;/OderItem&gt;
</span></span><span class="line"><span class="cl">			&lt;OderItem&gt;
</span></span><span class="line"><span class="cl">				&lt;HISOrderID&gt;0087244&lt;/HISOrderID&gt;
</span></span><span class="line"><span class="cl">				&lt;TestSetCode&gt;SMA001&lt;/TestSetCode&gt;
</span></span><span class="line"><span class="cl">				&lt;OrdItmStat/&gt;
</span></span><span class="line"><span class="cl">				&lt;Biled&gt;0&lt;/Biled&gt;
</span></span><span class="line"><span class="cl">				&lt;TestSetFee&gt;25.00&lt;/TestSetFee&gt;
</span></span><span class="line"><span class="cl">			&lt;/OderItem&gt;
</span></span><span class="line"><span class="cl">		&lt;/OrderList&gt;
</span></span><span class="line"><span class="cl">		&lt;VisitNumber&gt;6080005896&lt;/VisitNumber&gt;
</span></span><span class="line"><span class="cl">		&lt;RegNo&gt;0000177422&lt;/RegNo&gt;
</span></span><span class="line"><span class="cl">		&lt;AdmissionTypeCode&gt;H&lt;/AdmissionTypeCode&gt;
</span></span><span class="line"><span class="cl">		&lt;AdmNo&gt;TJ11011800&lt;/AdmNo&gt;
</span></span><span class="line"><span class="cl">		&lt;MedicalRecordNo/&gt;
</span></span><span class="line"><span class="cl">		&lt;AdmDate/&gt;
</span></span><span class="line"><span class="cl">		&lt;AdmTime/&gt;
</span></span><span class="line"><span class="cl">		&lt;IDNumber&gt;352623196202246137&lt;/IDNumber&gt;
</span></span><span class="line"><span class="cl">		&lt;SurName&gt;ç†Šæ°¸èŠ³&lt;/SurName&gt;
</span></span><span class="line"><span class="cl">		&lt;GivenName&gt;ç†Šæ°¸èŠ³&lt;/GivenName&gt;
</span></span><span class="line"><span class="cl">		&lt;SpeciesCode&gt;M&lt;/SpeciesCode&gt;
</span></span><span class="line"><span class="cl">		&lt;SpeciesDesc&gt;ç”·&lt;/SpeciesDesc&gt;
</span></span><span class="line"><span class="cl">		&lt;BirthDate&gt;1962-02-24&lt;/BirthDate&gt;
</span></span><span class="line"><span class="cl">		&lt;Age&gt;62&lt;/Age&gt;
</span></span><span class="line"><span class="cl">		&lt;AgeUnitCode&gt;62&lt;/AgeUnitCode&gt;
</span></span><span class="line"><span class="cl">		&lt;AgeUnitDesc&gt;62&lt;/AgeUnitDesc&gt;
</span></span><span class="line"><span class="cl">		&lt;Symptom/&gt;
</span></span><span class="line"><span class="cl">		&lt;MobileNo&gt;18359732216&lt;/MobileNo&gt;
</span></span><span class="line"><span class="cl">		&lt;PhoneNo/&gt;
</span></span><span class="line"><span class="cl">		&lt;EMail/&gt;
</span></span><span class="line"><span class="cl">		&lt;Address/&gt;
</span></span><span class="line"><span class="cl">		&lt;PostCode/&gt;
</span></span><span class="line"><span class="cl">		&lt;LocationCode&gt;32300&lt;/LocationCode&gt;
</span></span><span class="line"><span class="cl">		&lt;LocationDesc&gt;å¥åº·ä½“æ£€ç§‘&lt;/LocationDesc&gt;
</span></span><span class="line"><span class="cl">		&lt;DoctorCode&gt;cbl&lt;/DoctorCode&gt;
</span></span><span class="line"><span class="cl">		&lt;DoctorDesc&gt;é™ˆæ»¨æ—&lt;/DoctorDesc&gt;
</span></span><span class="line"><span class="cl">		&lt;RequestDate/&gt;
</span></span><span class="line"><span class="cl">		&lt;RequestTime/&gt;
</span></span><span class="line"><span class="cl">		&lt;WardCode/&gt;
</span></span><span class="line"><span class="cl">		&lt;WardDesc/&gt;
</span></span><span class="line"><span class="cl">		&lt;BedNo/&gt;
</span></span><span class="line"><span class="cl">		&lt;ReqNotes/&gt;
</span></span><span class="line"><span class="cl">		&lt;CarryDate/&gt;
</span></span><span class="line"><span class="cl">		&lt;CarryTime/&gt;
</span></span><span class="line"><span class="cl">		&lt;CarryUserCode/&gt;
</span></span><span class="line"><span class="cl">		&lt;CarryUserDesc/&gt;
</span></span><span class="line"><span class="cl">		&lt;CarryDate/&gt;
</span></span><span class="line"><span class="cl">		&lt;Urgent/&gt;
</span></span><span class="line"><span class="cl">		&lt;CollectDate&gt;2025-01-03&lt;/CollectDate&gt;
</span></span><span class="line"><span class="cl">		&lt;CollectTime&gt;09:27:36&lt;/CollectTime&gt;
</span></span><span class="line"><span class="cl">		&lt;CollectUserCode/&gt;
</span></span><span class="line"><span class="cl">		&lt;CollectUserDesc/&gt;
</span></span><span class="line"><span class="cl">		&lt;SpecimenCode&gt;3&lt;/SpecimenCode&gt;
</span></span><span class="line"><span class="cl">		&lt;SpecimenDesc&gt;å…¨è¡€&lt;/SpecimenDesc&gt;
</span></span><span class="line"><span class="cl">		&lt;ContainerCode/&gt;
</span></span><span class="line"><span class="cl">		&lt;ContainerDesc/&gt;
</span></span><span class="line"><span class="cl">		&lt;CollectNotes/&gt;
</span></span><span class="line"><span class="cl">		&lt;H24UVolume/&gt;
</span></span><span class="line"><span class="cl">		&lt;H24UTimePeriod/&gt;
</span></span><span class="line"><span class="cl">		&lt;BodyTemp/&gt;
</span></span><span class="line"><span class="cl">		&lt;Confidential/&gt;
</span></span><span class="line"><span class="cl">	&lt;/Body&gt;
</span></span><span class="line"><span class="cl">&lt;/Response&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€</p>

</section>


    <footer class="article-footer">
    <section>
        é¡µé¢æµè§ˆé‡<span id="busuanzi_value_page_pv">Loading</span>
    </section>
</footer>


    
</article>

<div class="post-password">
	
</div>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/%E5%8F%8C%E5%90%91%E4%BB%AA%E5%99%A8%E8%B7%A8%E5%B7%A5%E4%BD%9C%E7%BB%84%E6%9F%A5%E8%AF%A2%E4%B8%8A%E4%BC%A0%E4%BF%A1%E6%81%AF20250112235959/">
        
        
            <div class="article-image">
                <img src="/p/%E5%8F%8C%E5%90%91%E4%BB%AA%E5%99%A8%E8%B7%A8%E5%B7%A5%E4%BD%9C%E7%BB%84%E6%9F%A5%E8%AF%A2%E4%B8%8A%E4%BC%A0%E4%BF%A1%E6%81%AF20250112235959/assets/image-20250104102449-p7wll0q.3b75cd2872d3023eb4a3b6f44c0b4de9_hu_e5e7dbc6c6218a27.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post åŒå‘ä»ªå™¨è·¨å·¥ä½œç»„æŸ¥è¯¢ä¸Šä¼ ä¿¡æ¯"
                        data-key="åŒå‘ä»ªå™¨è·¨å·¥ä½œç»„æŸ¥è¯¢ä¸Šä¼ ä¿¡æ¯20250112235959" 
                        data-hash="md5-O3XNKHLTAj60o7b0TAtN6Q==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">åŒå‘ä»ªå™¨è·¨å·¥ä½œç»„æŸ¥è¯¢ä¸Šä¼ ä¿¡æ¯</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E6%89%B9%E9%87%8F%E5%8F%96%E6%B6%88%E5%AE%A1%E6%A0%B8%E6%8A%A5%E5%91%8A20250112235959/">
        
        
            <div class="article-image">
                
                    <img src="/img/title.jpg" loading="lazy" data-key="æ‰¹é‡å–æ¶ˆå®¡æ ¸æŠ¥å‘Š20250112235959" data-hash="/img/title.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">æ‰¹é‡å–æ¶ˆå®¡æ ¸æŠ¥å‘Š</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E9%A1%B5%E9%9D%A2%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E9%94%AE20250112235959/">
        
        
            <div class="article-image">
                <img src="/p/%E9%A1%B5%E9%9D%A2%E5%88%9B%E5%BB%BA%E5%BF%AB%E6%8D%B7%E9%94%AE20250112235959/assets/image-20250107112932-mmxvcaz.1feff679ab04e398f6ded8339ce449bd_hu_5cd2dfaf7b92f865.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post é¡µé¢åˆ›å»ºå¿«æ·é”®"
                        data-key="é¡µé¢åˆ›å»ºå¿«æ·é”®20250112235959" 
                        data-hash="md5-H&#43;/2easE45j23tgznORJvQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">é¡µé¢åˆ›å»ºå¿«æ·é”®</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet'/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }
</style><script>
    
    Waline.init({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo"],"lang":"zh-CN","locale":{"admin":"Admin","placeholder":null},"requiredMeta":["name","email","url"],"serverURL":"https://waline.717170.xyz"});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 muziyang
    </section>
    
    <section class="powerby">
        
            ç½‘ç«™æ€»è®¿å®¢æ•°ï¼š<span id='busuanzi_value_site_uv'>Loading</span><br/>ç½‘ç«™æ€»è®¿é—®é‡ï¼š<span id='busuanzi_value_site_pv'>Loading</span> <br/>
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<script defer src="https://cn.vercount.one/js"></script>

    </body>
</html>
