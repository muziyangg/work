<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£Ê£ÄÈ™å">
<title>ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£</title>

<link rel='canonical' href='https://work.717170.xyz/p/%E5%9B%BD%E5%AE%B6%E4%BC%A0%E6%9F%93%E7%97%85%E6%8E%A5%E5%8F%A3-20250104010204/'>

<link rel="stylesheet" href="/scss/style.min.9f449ccc662f48c455f81316fd5cb87099956cabbb7a108c4681662ea647628e.css"><meta property='og:title' content="ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£">
<meta property='og:description' content="ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£Ê£ÄÈ™å">
<meta property='og:url' content='https://work.717170.xyz/p/%E5%9B%BD%E5%AE%B6%E4%BC%A0%E6%9F%93%E7%97%85%E6%8E%A5%E5%8F%A3-20250104010204/'>
<meta property='og:site_name' content='Êú®Â≠êÊ¥ã'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='' /><meta property='article:published_time' content='2024-12-17T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-12-24T00:00:00&#43;00:00'/><meta property='og:image' content='https://work.717170.xyz/img/title.jpg' />
<meta name="twitter:title" content="ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£">
<meta name="twitter:description" content="ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£Ê£ÄÈ™å"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://work.717170.xyz/img/title.jpg' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/touxiang_hu_3261c9b36eb249a9.jpg" width="300"
                            height="285" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Êú®Â≠êÊ¥ã</a></h1>
            <h2 class="site-description">To be or not to be.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/muziyangg'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://gitee.com/muziyangg'
                        target="_blank"
                        title="Gitee"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1756364241553" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1459" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M739.76 462H484.2a22.22 22.22 0 0 0-22.2 22.21v55.56A22.24 22.24 0 0 0 484.19 562h155.57A22.22 22.22 0 0 1 662 584.22v11.11A66.67 66.67 0 0 1 595.31 662H384.19A22.22 22.22 0 0 1 362 639.79V428.68A66.67 66.67 0 0 1 428.64 362h311.07a22.21 22.21 0 0 0 22.22-22.2v-55.56A22.22 22.22 0 0 0 739.79 262h-311.1A166.67 166.67 0 0 0 262 428.68v311.1A22.22 22.22 0 0 0 284.22 762H612a150 150 0 0 0 150-150V484.23A22.23 22.23 0 0 0 739.77 462z m0 0" fill="#231815" p-id="1460"></path></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>È¶ñÈ°µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ÂÖ≥‰∫é</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>ÂΩíÊ°£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>ÊêúÁ¥¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/link/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>ÂèãÈìæ</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>ÊöóËâ≤Ê®°Âºè</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#2024Âπ¥12Êúà17Êó•113747Â∞Üpatid‰Ωú‰∏∫ÊÇ£ËÄÖÂîØ‰∏Äid">2024Âπ¥12Êúà17Êó•11:37:47	Â∞Üpatid‰Ωú‰∏∫ÊÇ£ËÄÖÂîØ‰∏Äid</a></li>
        <li><a href="#2024Âπ¥12Êúà17Êó•114012Â∞ÜÁóÖÊàøÂè∑‰ªécodeÊîπ‰∏∫‰∏ªÈîÆ">2024Âπ¥12Êúà17Êó•11:40:12	Â∞ÜÁóÖÊàøÂè∑‰ªécodeÊîπ‰∏∫‰∏ªÈîÆ</a></li>
        <li><a href="#2024Âπ¥12Êúà18Êó•170959Êä•Âëä‰∏≠ÂêåÊó∂Â≠òÂú®ÂÆöÊÄßÂíåÂÆöÈáèÁªìÊûúÊó∂ÂÆöÊÄßÁªìÊûúËΩ¨Ê†áÂåñÊú™ÁΩÆÁ©∫">2024Âπ¥12Êúà18Êó•17:09:59	Êä•Âëä‰∏≠ÂêåÊó∂Â≠òÂú®ÂÆöÊÄßÂíåÂÆöÈáèÁªìÊûúÊó∂ÔºåÂÆöÊÄßÁªìÊûúËΩ¨Ê†áÂåñÊú™ÁΩÆÁ©∫</a></li>
        <li><a href="#2024Âπ¥12Êúà19Êó•204038Â¢ûÂä†ÈÖçÁΩÆÂèÇÊï∞Èùû‰∫íËÆ§Êï∞ÊçÆÊòØÂê¶‰∏ä‰º†">2024Âπ¥12Êúà19Êó•20:40:38	Â¢ûÂä†ÈÖçÁΩÆÂèÇÊï∞ÔºåÈùû‰∫íËÆ§Êï∞ÊçÆÊòØÂê¶‰∏ä‰º†</a></li>
        <li><a href="#2024Âπ¥12Êúà24Êó•222012Êñ∞Â¢ûÁ≠âÂæÖÊó∂Èó¥Á¨¨‰∏âÊñπË¶ÅÊ±ÇÂÖàÊé®ÈÄÅÂÆåÊä•Âëä‰ø°ÊÅØÁ≠âÂæÖ‰∏Ä‰ºöÂú®Êé®ÈÄÅÁªìÊûú‰ø°ÊÅØÈ¢ÑË≠¶ÂèØËÉΩÂ§±ÊïàÊé®ËçêÂÖ•ÂèÇ30ÂàÜÈíüÂè™ÈíàÂØπÊñπÊ°à‰∏ÄÊñπÊ°à‰∫åÊó†Ê≥ï‰ºòÂåñ">2024Âπ¥12Êúà24Êó•22:20:12		Êñ∞Â¢ûÁ≠âÂæÖÊó∂Èó¥ÔºåÁ¨¨‰∏âÊñπË¶ÅÊ±ÇÂÖàÊé®ÈÄÅÂÆåÊä•Âëä‰ø°ÊÅØÁ≠âÂæÖ‰∏Ä‰ºöÂú®Êé®ÈÄÅÁªìÊûú‰ø°ÊÅØÔºåÈ¢ÑË≠¶ÂèØËÉΩÂ§±ÊïàÔºåÊé®ËçêÂÖ•ÂèÇ30ÂàÜÈíü„ÄÇÂè™ÈíàÂØπÊñπÊ°à‰∏ÄÔºåÊñπÊ°à‰∫åÊó†Ê≥ï‰ºòÂåñ„ÄÇ</a></li>
        <li><a href="#ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£">ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E5%9B%BD%E5%AE%B6%E4%BC%A0%E6%9F%93%E7%97%85%E6%8E%A5%E5%8F%A3-20250104010204/">
                
                    <img src="/img/title.jpg" loading="lazy" alt="Featured image of post ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%A5%E5%8F%A3/" >
                Á¨¨‰∏âÊñπÊé•Âè£
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E5%9B%BD%E5%AE%B6%E4%BC%A0%E6%9F%93%E7%97%85%E6%8E%A5%E5%8F%A3-20250104010204/">ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£Ê£ÄÈ™å
        </h3>
        
    </div>

        
        <footer class="article-time">
            
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                    <time class="article-time--published">2024-12-17</time>
                </div>
            

            
            
                        ÊúÄÂêéÊõ¥Êñ∞‰∫é
                        <time class="article-time--updated" datetime="2024-12-24 00:00:00 &#43;0000 UTC" title="2024-12-24 00:00:00 &#43;0000 UTC">
                            2024-12-24 00:00:00
                        </time>
			
			
			
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



					<time class="article-words">
						3695Â≠ó
					</time>
				</div>
			
			

            
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                    <time class="article-time--reading">
                        ÈòÖËØªÊó∂Èïø: 8 ÂàÜÈíü
                    </time>
                </div>
            
        </footer>
    


    
</div>
</header>



    <section class="article-content">
    
    
    <h3 id="2024Âπ¥12Êúà17Êó•113747Â∞Üpatid‰Ωú‰∏∫ÊÇ£ËÄÖÂîØ‰∏Äid">2024Âπ¥12Êúà17Êó•11:37:47	Â∞Üpatid‰Ωú‰∏∫ÊÇ£ËÄÖÂîØ‰∏Äid
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">s RegNo=$lg(VisitNumberData,3)
</span></span><span class="line"><span class="cl">s:$l(RegNo) patId=$o(^[&#34;dhc-app&#34;]PAPERi(&#34;PAPMI_PatNo&#34;,RegNo,&#34;&#34;))
</span></span><span class="line"><span class="cl">;s patId=RegNo// ÔºÅÔºÅÔºÅÊ†πÊçÆÈ°πÁõÆÂÆûÈôÖÊÉÖÂÜµÔºåÂ¶ÇÊûú‰∏ªË°®Áî®patid‰Ωú‰∏∫ÊÇ£ËÄÖÂîØ‰∏Ä‰∏ªÈîÆÂàôÂ±èËîΩËØ•Ë°å,ÁôªËÆ∞Âè∑ÂàôÊîæÂºÄÔºÅÔºÅÔºÅ
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2024Âπ¥12Êúà17Êó•114012Â∞ÜÁóÖÊàøÂè∑‰ªécodeÊîπ‰∏∫‰∏ªÈîÆ">2024Âπ¥12Êúà17Êó•11:40:12	Â∞ÜÁóÖÊàøÂè∑‰ªécodeÊîπ‰∏∫‰∏ªÈîÆ
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">;ÁóÖÊàøÂè∑
</span></span><span class="line"><span class="cl">s InputObj.&#34;ward_no&#34;=WardDR
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2024Âπ¥12Êúà18Êó•170959Êä•Âëä‰∏≠ÂêåÊó∂Â≠òÂú®ÂÆöÊÄßÂíåÂÆöÈáèÁªìÊûúÊó∂ÂÆöÊÄßÁªìÊûúËΩ¨Ê†áÂåñÊú™ÁΩÆÁ©∫">2024Âπ¥12Êúà18Êó•17:09:59	Êä•Âëä‰∏≠ÂêåÊó∂Â≠òÂú®ÂÆöÊÄßÂíåÂÆöÈáèÁªìÊûúÊó∂ÔºåÂÆöÊÄßÁªìÊûúËΩ¨Ê†áÂåñÊú™ÁΩÆÁ©∫
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">s (examinationStringResultCode,examinationStringResultName)=&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2024Âπ¥12Êúà19Êó•204038Â¢ûÂä†ÈÖçÁΩÆÂèÇÊï∞Èùû‰∫íËÆ§Êï∞ÊçÆÊòØÂê¶‰∏ä‰º†">2024Âπ¥12Êúà19Êó•20:40:38	Â¢ûÂä†ÈÖçÁΩÆÂèÇÊï∞ÔºåÈùû‰∫íËÆ§Êï∞ÊçÆÊòØÂê¶‰∏ä‰º†
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// ÈùûÂØπÁÖßÊï∞ÊçÆÊòØÂê¶‰∏ä‰º†(1:‰∏ä‰º†,0:‰∏ç‰∏ä‰º†)(ÁßëÂÆ§‰∫íËÆ§,Ê†áÊú¨Á±ªÂûã‰∫íËÆ§,Ê£ÄÊµãÈ°πÁõÆ‰∫íËÆ§)
</span></span><span class="line"><span class="cl">Parameter IsInput = 0;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2024Âπ¥12Êúà24Êó•222012Êñ∞Â¢ûÁ≠âÂæÖÊó∂Èó¥Á¨¨‰∏âÊñπË¶ÅÊ±ÇÂÖàÊé®ÈÄÅÂÆåÊä•Âëä‰ø°ÊÅØÁ≠âÂæÖ‰∏Ä‰ºöÂú®Êé®ÈÄÅÁªìÊûú‰ø°ÊÅØÈ¢ÑË≠¶ÂèØËÉΩÂ§±ÊïàÊé®ËçêÂÖ•ÂèÇ30ÂàÜÈíüÂè™ÈíàÂØπÊñπÊ°à‰∏ÄÊñπÊ°à‰∫åÊó†Ê≥ï‰ºòÂåñ">2024Âπ¥12Êúà24Êó•22:20:12		Êñ∞Â¢ûÁ≠âÂæÖÊó∂Èó¥ÔºåÁ¨¨‰∏âÊñπË¶ÅÊ±ÇÂÖàÊé®ÈÄÅÂÆåÊä•Âëä‰ø°ÊÅØÁ≠âÂæÖ‰∏Ä‰ºöÂú®Êé®ÈÄÅÁªìÊûú‰ø°ÊÅØÔºåÈ¢ÑË≠¶ÂèØËÉΩÂ§±ÊïàÔºåÊé®ËçêÂÖ•ÂèÇ30ÂàÜÈíü„ÄÇÂè™ÈíàÂØπÊñπÊ°à‰∏ÄÔºåÊñπÊ°à‰∫åÊó†Ê≥ï‰ºòÂåñ„ÄÇ
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/// Time:Êó∂Èó¥(ÂàÜÈíü)
</span></span><span class="line"><span class="cl">/// d ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).Do(30)
</span></span><span class="line"><span class="cl">ClassMethod Do(Time)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s Time=$g(Time)
</span></span><span class="line"><span class="cl">	i &#39;$l(Time) s Time=120
</span></span><span class="line"><span class="cl">	s STime=+Time*60+60
</span></span><span class="line"><span class="cl">	s SttDT=..GetMinutesAgoTime($zdt($h,8),STime)
</span></span><span class="line"><span class="cl">	s EndDT=$zdt($h,8)
</span></span><span class="line"><span class="cl">	s SttDate=$p(SttDT,&#34; &#34;,1)
</span></span><span class="line"><span class="cl">	s SttTime=$zth($p(SttDT,&#34; &#34;,2))
</span></span><span class="line"><span class="cl">	s EndDate=$p(EndDT,&#34; &#34;,1)
</span></span><span class="line"><span class="cl">	s EndTime=$zth($p(EndDT,&#34; &#34;,2))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s WorkGroupMachineDR=&#34;&#34; f  s WorkGroupMachineDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR)) q:WorkGroupMachineDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	.s AuthDate=SttDate-1 f  s AuthDate=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR,AuthDate)) q:((AuthDate=&#34;&#34;)||(AuthDate&gt;EndDate))  d
</span></span><span class="line"><span class="cl">	..s ReportDR=&#34;&#34; f  s ReportDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR,AuthDate,ReportDR)) q:ReportDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	...s AuthTime=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),20)
</span></span><span class="line"><span class="cl">	...i AuthTime&lt;SttTime q
</span></span><span class="line"><span class="cl">	...i AuthTime&gt;EndTime q
</span></span><span class="line"><span class="cl">	...i &#39;$l($$IsReportOutPut(ReportDR)) q
</span></span><span class="line"><span class="cl">	...i $d(^TMP($zn,$j,$i,ReportDR,1)) q
</span></span><span class="line"><span class="cl">	...d ..SendReportInfo(ReportDR)
</span></span><span class="line"><span class="cl">	...s ^TMP($zn,$j,$i,ReportDR,1)=&#34;&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	//*************************Âª∂Êó∂Á≠âÂæÖ****************************//
</span></span><span class="line"><span class="cl">	h 30		// Á≠âÂæÖ30Áßí
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s WorkGroupMachineDR=&#34;&#34; f  s WorkGroupMachineDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR)) q:WorkGroupMachineDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	.s AuthDate=SttDate-1 f  s AuthDate=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR,AuthDate)) q:((AuthDate=&#34;&#34;)||(AuthDate&gt;EndDate))  d
</span></span><span class="line"><span class="cl">	..s ReportDR=&#34;&#34; f  s ReportDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR,AuthDate,ReportDR)) q:ReportDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	...s AuthTime=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),20)
</span></span><span class="line"><span class="cl">	...i AuthTime&lt;SttTime q
</span></span><span class="line"><span class="cl">	...i AuthTime&gt;EndTime q
</span></span><span class="line"><span class="cl">	...i &#39;$l($$IsReportOutPut(ReportDR)) q
</span></span><span class="line"><span class="cl">	...i $d(^TMP($zn,$j,$i,ReportDR,2)) q
</span></span><span class="line"><span class="cl">	...d ..SendResultInfo(ReportDR)
</span></span><span class="line"><span class="cl">	...s ^TMP($zn,$j,$i,ReportDR,2)=&#34;&#34;
</span></span><span class="line"><span class="cl">	q
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">IsReportOutPut(ReportDR)
</span></span><span class="line"><span class="cl">	s ret=&#34;&#34;
</span></span><span class="line"><span class="cl">	i &#39;$l(ReportDR) q ret
</span></span><span class="line"><span class="cl">	s Status=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),22)
</span></span><span class="line"><span class="cl">	q:Status&#39;[&#34;3&#34; ret
</span></span><span class="line"><span class="cl">	s VisitNumberDR=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),2)
</span></span><span class="line"><span class="cl">	s HospitalDR=$lg($g(^dbo.RPVisitNumberD(VisitNumberDR)),21)		//ÈôêÂà∂Êù°‰ª∂
</span></span><span class="line"><span class="cl">	s ret=&#34;1&#34;
</span></span><span class="line"><span class="cl">	q ret
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>‚Äç</p>
<p>‚Äç</p>
<h3 id="ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£">ÂõΩÂÆ∂‰º†ÊüìÁóÖÊé•Âè£
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Class LISAPP.LIS.BLL.UplaodDataBSToD3C Extends %RegisteredObject
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/*
</span></span><span class="line"><span class="cl">	ËØ¥ÊòéÔºö	1.Â∞ÜÂπ≥Âè∞ÊñπÊ≥ïÊîæÂà∞Ê≥®ÈáäÂØπÂ∫îÁöÑ‰ΩçÁΩÆÔºåË∞ÉÁî® w ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).Send(&#34;26&#34;) ÁúãÂπ≥Âè∞ÊòØÂê¶ÊúâÊó•Âøó
</span></span><span class="line"><span class="cl">			2.ÊñπÊ°à‰∏Ä(Êé®Ëçê)ÔºöÈÉ®ÁΩ≤ÂÆöÊó∂‰ªªÂä°ÔºåËÆæÁΩÆÂ§ö‰πÖËøêË°å‰∏ÄÊ¨°Â∞±ÂÖ•ÂèÇ‰∏∫Â§öÂ∞ëÂàÜÈíüÔºåÊ≤°ÊúâÂÖ•ÂèÇÈªòËÆ§‰∏∫120ÂàÜÈíü(2Â∞èÊó∂)
</span></span><span class="line"><span class="cl">			  (Êñ∞Â¢ûÁ≠âÂæÖÊó∂Èó¥ÔºåÁ¨¨‰∏âÊñπË¶ÅÊ±ÇÂÖàÊé®ÈÄÅÂÆåÊä•Âëä‰ø°ÊÅØÁ≠âÂæÖ‰∏Ä‰ºöÂú®Êé®ÈÄÅÁªìÊûú‰ø°ÊÅØÔºåÂê¶ÂàôÈ¢ÑË≠¶ÂèØËÉΩÂ§±ÊïàÔºåÊé®ËçêÂÖ•ÂèÇ30ÂàÜÈíü„ÄÇÂè™ÈíàÂØπÊñπÊ°à‰∏ÄÔºåÊñπÊ°à‰∫åÊó†Ê≥ï‰ºòÂåñ„ÄÇ)
</span></span><span class="line"><span class="cl">			   d ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).Do(30)
</span></span><span class="line"><span class="cl">			  ÊñπÊ°à‰∫åÔºöÂÆûÊó∂Ë∞ÉÁî®ÔºåÂ∞Ü‰∏ªÊñπÊ≥ïÊîæÂà∞Ê£ÄÈ™åÊ∂àÊÅØ‰ªªÂä°ÂÆ°Ê†∏ÂêéÊé®ÈÄÅ
</span></span><span class="line"><span class="cl">			   winÊúçÂä°Âô®ÁâàÊú¨lisÔºå„Äêdhc-app„Äëweb.DHCLisRealTimeInterface		linuxÊúçÂä°Âô®ÁâàÊú¨lisÔºå„Äêdhc-lisdata„ÄëLISAPP.TASK.LisRealTimeInterface
</span></span><span class="line"><span class="cl">			   try{s ret=##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).Send(VisitNumberReportDR)}catch{}
</span></span><span class="line"><span class="cl">*/
</span></span><span class="line"><span class="cl">/// Áî≥ËØ∑Êú∫ÊûÑ‰ª£Á†Å
</span></span><span class="line"><span class="cl">Parameter SQJGCode = &#34;SQJGCode&#34;;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Áî≥ËØ∑Êú∫ÊûÑÂêçÁß∞
</span></span><span class="line"><span class="cl">Parameter SQJGName = &#34;SQJGName&#34;;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// ÈùûÂØπÁÖßÊï∞ÊçÆÊòØÂê¶‰∏ä‰º†(1:‰∏ä‰º†,0:‰∏ç‰∏ä‰º†)(ÁßëÂÆ§‰∫íËÆ§,Ê†áÊú¨Á±ªÂûã‰∫íËÆ§,Ê£ÄÊµãÈ°πÁõÆ‰∫íËÆ§)
</span></span><span class="line"><span class="cl">Parameter IsInput = 0;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// CreatorÔºö      yanghaoran
</span></span><span class="line"><span class="cl">/// CreatDateÔºö    2024-12-24
</span></span><span class="line"><span class="cl">/// DescriptionÔºö  ÂõΩÂÆ∂‰º†ÊüìÁóÖÊô∫ËÉΩÁõëÊµãÈ¢ÑË≠¶ÂâçÁΩÆËΩØ‰ª∂Êé•Âè£ÈÉ®ÁΩ≤ÔºöÊ£ÄÈ™åÊä•Âëä emr_ex_lab
</span></span><span class="line"><span class="cl">/// 			   ÂõΩÂÆ∂‰º†ÊüìÁóÖÊô∫ËÉΩÁõëÊµãÈ¢ÑË≠¶ÂâçÁΩÆËΩØ‰ª∂Êé•Âè£ÈÉ®ÁΩ≤ÔºöÊ£ÄÈ™åÊä•ÂëäÈ°πÁõÆ emr_ex_lab_item
</span></span><span class="line"><span class="cl">/// TableÔºö      
</span></span><span class="line"><span class="cl">/// InputÔºö        Êä•ÂëäRowID
</span></span><span class="line"><span class="cl">/// OutputÔºö     
</span></span><span class="line"><span class="cl">/// ReturnÔºö
</span></span><span class="line"><span class="cl">/// w ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).Send(&#34;26&#34;)
</span></span><span class="line"><span class="cl">ClassMethod Send(ReportDR) As %String
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	i &#39;$l(ReportDR) q &#34;&#34;
</span></span><span class="line"><span class="cl">	s Status=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),22)
</span></span><span class="line"><span class="cl">	q:Status&#39;[&#34;3&#34; &#34;&#34;
</span></span><span class="line"><span class="cl">	s VisitNumberDR=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),2)
</span></span><span class="line"><span class="cl">	s HospitalDR=$lg($g(^dbo.RPVisitNumberD(VisitNumberDR)),21)		//ÈôêÂà∂Êù°‰ª∂
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	d ..SendReportInfo(ReportDR)
</span></span><span class="line"><span class="cl">	d ..SendResultInfo(ReportDR)
</span></span><span class="line"><span class="cl">	q &#34;&#34;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// ÂõΩÂÆ∂‰º†ÊüìÁóÖÊô∫ËÉΩÁõëÊµãÈ¢ÑË≠¶ÂâçÁΩÆËΩØ‰ª∂Êé•Âè£ÈÉ®ÁΩ≤ÔºöÊ£ÄÈ™åÊä•Âëä emr_ex_lab
</span></span><span class="line"><span class="cl">/// w ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).SendReportInfo(26)
</span></span><span class="line"><span class="cl">ClassMethod SendReportInfo(ReportDR As %String) As %Stream.GlobalCharacter
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s InputObj={} ;##class(DHCDoc.Util.ArrayData).%New()	##class(%DynamicObject).%New()
</span></span><span class="line"><span class="cl">	q:ReportDR=&#34;&#34; &#34;&#34;
</span></span><span class="line"><span class="cl">	q:&#39;$d(^dbo.RPVisitNumberReportD(ReportDR)) &#34;&#34;
</span></span><span class="line"><span class="cl">	s VisitNumberDR=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),2)
</span></span><span class="line"><span class="cl">	s Status=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),22)
</span></span><span class="line"><span class="cl">	q:Status&#39;[&#34;3&#34; &#34;&#34;
</span></span><span class="line"><span class="cl">	s VisitNumberData=$g(^dbo.RPVisitNumberD(VisitNumberDR))
</span></span><span class="line"><span class="cl">	;Â∞±ËØäÂè∑
</span></span><span class="line"><span class="cl">	s AdmNo=$lg(VisitNumberData,5)
</span></span><span class="line"><span class="cl">	;ÁôªËÆ∞Âè∑
</span></span><span class="line"><span class="cl">	s RegNo=$lg(VisitNumberData,3)
</span></span><span class="line"><span class="cl">	s:$l(RegNo) patId=$o(^[&#34;dhc-app&#34;]PAPERi(&#34;PAPMI_PatNo&#34;,RegNo,&#34;&#34;))
</span></span><span class="line"><span class="cl">	;s patId=RegNo			// ÔºÅÔºÅÔºÅÊ†πÊçÆÈ°πÁõÆÂÆûÈôÖÊÉÖÂÜµÔºåÂ¶ÇÊûú‰∏ªË°®Áî®patid‰Ωú‰∏∫ÊÇ£ËÄÖÂîØ‰∏Ä‰∏ªÈîÆÂàôÂ±èËîΩËØ•Ë°å,ÁôªËÆ∞Âè∑ÂàôÊîæÂºÄÔºÅÔºÅÔºÅ
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™å‰ø°ÊÅØÂú®Èô¢ÂÜÖÁöÑÂîØ‰∏ÄËØÜÂà´Ê†áËØÜ
</span></span><span class="line"><span class="cl">	s InputObj.&#34;id&#34;=ReportDR
</span></span><span class="line"><span class="cl">	;Êú∫ÊûÑÂÜÖÊÇ£ËÄÖÂü∫Êú¨‰ø°ÊÅØÂîØ‰∏ÄÊ†áËØÜ
</span></span><span class="line"><span class="cl">	s InputObj.&#34;patient_id&#34;=$g(patId)
</span></span><span class="line"><span class="cl">	;ËØäÊñ≠Ê¥ªÂä®Á±ªÂûã‰ª£Á†Å  ËØäÊñ≠Ê¥ªÂä®Á±ªÂûãÂêçÁß∞
</span></span><span class="line"><span class="cl">	s AdmissionTypeDR=$lg(VisitNumberData,4),AdmissionTypeCode=&#34;&#34;,AdmissionTypeName=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(AdmissionTypeDR) d
</span></span><span class="line"><span class="cl">	.s AdmissionTypeCode=$lg($g(^dbo.BTAdmissionTypeD(AdmissionTypeDR)),2)		;Â∞±ËØäÁ±ªÂûã
</span></span><span class="line"><span class="cl">	s InputObj.&#34;activity_type_code&#34;=$case(AdmissionTypeCode,&#34;O&#34;:&#34;1&#34;,&#34;I&#34;:&#34;2&#34;,&#34;E&#34;:&#34;6&#34;,:&#34;1&#34;)
</span></span><span class="line"><span class="cl">	s InputObj.&#34;activity_type_name&#34;=$case(AdmissionTypeCode,&#34;O&#34;:&#34;Èó®ËØä&#34;,&#34;I&#34;:&#34;ÊÄ•ËØä&#34;,&#34;E&#34;:&#34;‰ΩèÈô¢&#34;,:&#34;Èó®ËØä&#34;)
</span></span><span class="line"><span class="cl">	;Â∞±ËØäÊµÅÊ∞¥Âè∑
</span></span><span class="line"><span class="cl">	s InputObj.&#34;serial_number&#34;=AdmNo
</span></span><span class="line"><span class="cl">	;Â∞±ËØäËÄÖÂßìÂêç
</span></span><span class="line"><span class="cl">	s InputObj.&#34;patient_name&#34;=$lg(VisitNumberData,13)
</span></span><span class="line"><span class="cl">	;Ë∫´‰ªΩËØÅ‰ª∂Á±ªÂà´‰ª£Á†Å  Ë∫´‰ªΩËØÅ‰ª∂Á±ªÂà´ÂêçÁß∞  Ë∫´‰ªΩËØÅ‰ª∂Âè∑
</span></span><span class="line"><span class="cl">	s IDNumber=$lg(VisitNumberData,11)
</span></span><span class="line"><span class="cl">	i &#39;$l(IDNumber),$l(AdmNo) d
</span></span><span class="line"><span class="cl">	.s patientid=$p($g(^[&#34;dhc-app&#34;]PAADM(AdmNo)),&#34;^&#34;,1)
</span></span><span class="line"><span class="cl">	.s IDNumber=$P($g(^[&#34;dhc-app&#34;]PAPER(patientid,&#34;PER&#34;,2)),&#34;^&#34;,1)	//Â¶ÇÊûúÊ£ÄÈ™åË°®ÈáåÊ≤°ÊúâË∫´‰ªΩËØÅÂè∑ÔºåÂ∞ùËØï‰ªéhisËé∑ÂèñË∫´‰ªΩËØÅÂè∑
</span></span><span class="line"><span class="cl">	i $l(IDNumber) d
</span></span><span class="line"><span class="cl">	.s InputObj.&#34;id_card_type_code&#34;=&#34;01&#34;
</span></span><span class="line"><span class="cl">	.s InputObj.&#34;id_card_type_name&#34;=&#34;Â±ÖÊ∞ëË∫´‰ªΩËØÅ&#34;
</span></span><span class="line"><span class="cl">	.s InputObj.&#34;id_card&#34;=IDNumber
</span></span><span class="line"><span class="cl">	e  d
</span></span><span class="line"><span class="cl">	.s BirthDate=$lg(VisitNumberData,16)
</span></span><span class="line"><span class="cl">	.s InputObj.&#34;id_card_type_code&#34;=&#34;99&#34;
</span></span><span class="line"><span class="cl">	.s InputObj.&#34;id_card_type_name&#34;=&#34;ÂÖ∂‰ªñÊ≥ïÂÆöÊúâÊïàËØÅ‰ª∂&#34;
</span></span><span class="line"><span class="cl">	.s InputObj.&#34;id_card&#34;=BirthDate
</span></span><span class="line"><span class="cl">	;ÁóÖÂå∫ÂêçÁß∞ 
</span></span><span class="line"><span class="cl">	s WardDR=$lg(VisitNumberData,26)
</span></span><span class="line"><span class="cl">	s InputObj.&#34;ward_name&#34;=$s($l(WardDR):$lg($g(^dbo.BTWardD(WardDR)),3),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	;ÁóÖÊàøÂè∑
</span></span><span class="line"><span class="cl">	s InputObj.&#34;ward_no&#34;=WardDR
</span></span><span class="line"><span class="cl">	;ÁóÖÂ∫äÂè∑
</span></span><span class="line"><span class="cl">	s InputObj.&#34;bed_no&#34;=$lg(VisitNumberData,27)
</span></span><span class="line"><span class="cl">	;ÁîµÂ≠êÁî≥ËØ∑ÂçïÁºñÂè∑
</span></span><span class="line"><span class="cl">	s InputObj.&#34;application_form_no&#34;=ReportDR
</span></span><span class="line"><span class="cl">	s LocationDR = $lg(VisitNumberData,22)
</span></span><span class="line"><span class="cl">	s LocationCode=$s($l(LocationDR):$lg($g(^dbo.BTLocationD(LocationDR)),2),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	s LocationName=$s($l(LocationDR):$lg($g(^dbo.BTLocationD(LocationDR)),3),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	s LocationData=..GetData(&#34;SQKS&#34;,LocationCode)
</span></span><span class="line"><span class="cl">	i &#39;$l(LocationData),..#IsInput q &#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(LocationData) d
</span></span><span class="line"><span class="cl">	.s LocationCode=$p(LocationData,&#34;^&#34;,1)
</span></span><span class="line"><span class="cl">	.s LocationName=$p(LocationData,&#34;^&#34;,2)		//***HR***//
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÁî≥ËØ∑ÁßëÂÆ§‰ª£Á†Å
</span></span><span class="line"><span class="cl">	s InputObj.&#34;apply_dept_code&#34;=LocationCode
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÁî≥ËØ∑ÁßëÂÆ§ÂêçÁß∞
</span></span><span class="line"><span class="cl">	s InputObj.&#34;apply_dept_name&#34;=LocationName
</span></span><span class="line"><span class="cl">	s HospitalDR=$lg(VisitNumberData,21)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÁî≥ËØ∑Êú∫ÊûÑ‰ª£Á†Å ÂêçÁß∞
</span></span><span class="line"><span class="cl">	s InputObj.&#34;apply_org_code&#34;=..#SQJGCode
</span></span><span class="line"><span class="cl">	s InputObj.&#34;apply_org_name&#34;=..#SQJGName
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÁî≥ËØ∑ÂåªÂ∏à
</span></span><span class="line"><span class="cl">	s DoctorDR=$lg(VisitNumberData,23)
</span></span><span class="line"><span class="cl">	s InputObj.&#34;apply_physician_id&#34;=$s($l(DoctorDR):$lg($g(^dbo.BTDoctorD(DoctorDR)),2),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	;Ê†áÊú¨Á±ªÂà´‰ª£Á†Å
</span></span><span class="line"><span class="cl">	s SpecimenDR=$lg(VisitNumberData,56)
</span></span><span class="line"><span class="cl">	s SpecimenCode=$s($l(SpecimenDR):$lg($g(^dbo.BTSpecimenD(SpecimenDR)),2),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	s SpecimenName=$s($l(SpecimenDR):$lg($g(^dbo.BTSpecimenD(SpecimenDR)),3),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	s SpecimenData=..GetData(&#34;SP&#34;,SpecimenCode)
</span></span><span class="line"><span class="cl">	i &#39;$l(SpecimenCode),..#IsInput q &#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(SpecimenData) d
</span></span><span class="line"><span class="cl">	.s SpecimenCode=$p(SpecimenData,&#34;^&#34;,1)
</span></span><span class="line"><span class="cl">	.s SpecimenName=$p(SpecimenData,&#34;^&#34;,2)		//***HR***//
</span></span><span class="line"><span class="cl">	s InputObj.&#34;specimen_category_code&#34;=SpecimenCode
</span></span><span class="line"><span class="cl">	s InputObj.&#34;specimen_category_name&#34;=SpecimenName
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÊ†áÊú¨Âè∑
</span></span><span class="line"><span class="cl">	s InputObj.&#34;specimen_no&#34;=$lg(VisitNumberData,2)
</span></span><span class="line"><span class="cl">	;Ê†áÊú¨ÈááÊ†∑Êó•ÊúüÊó∂Èó¥
</span></span><span class="line"><span class="cl">	s CollectDate=$lg(VisitNumberData,51)
</span></span><span class="line"><span class="cl">    s CollectTime=$lg(VisitNumberData,52)
</span></span><span class="line"><span class="cl">    s InputObj.&#34;specimen_sampling_date&#34;=$s(($l(CollectDate)&amp;&amp;$l(CollectTime)):$zd($zdh(CollectDate,8),3)_&#34; &#34;_$zt(CollectTime),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">    ;Êé•Êî∂Ê†áÊú¨Êó•ÊúüÊó∂Èó¥
</span></span><span class="line"><span class="cl">    s ReceiveDate=$lg(VisitNumberData,66)
</span></span><span class="line"><span class="cl">	s ReceiveTime=$lg(VisitNumberData,67)
</span></span><span class="line"><span class="cl">	s InputObj.&#34;specimen_receiving_date&#34;=$s(($l(ReceiveDate)&amp;&amp;$l(ReceiveTime)):$zd($zdh(ReceiveDate,8),3)_&#34; &#34;_$zt(ReceiveTime),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÂåªÂ∏à
</span></span><span class="line"><span class="cl">	s AcceptUserDR=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),11)
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_physician_id&#34;=$s($l(AcceptUserDR):$lg($g(^dbo.SYSUserD(AcceptUserDR)),2),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÊó•Êúü
</span></span><span class="line"><span class="cl">	s:ReceiveDate&#39;=&#34;&#34; InputObj.&#34;examination_date&#34;=$zd($zdh(ReceiveDate,8),3)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÊä•ÂëäÂçïÁºñÂè∑
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_report_no&#34;=ReportDR
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÊä•ÂëäÁªìÊûú-ÂÆ¢ËßÇÊâÄËßÅ
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_objective_desc&#34;=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),40)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÊä•ÂëäÁªìÊûú-‰∏ªËßÇÊèêÁ§∫
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_subjective_desc&#34;=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),41)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÊä•ÂëäÂ§áÊ≥®
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_notes&#34;=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),40)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÊä•ÂëäÊó•Êúü
</span></span><span class="line"><span class="cl">	s ReportDate=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),19)
</span></span><span class="line"><span class="cl">	s ReportTime=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),20)
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_report _date&#34;=$s(($l(ReportDate)&amp;&amp;$l(ReportTime)):$zd($zdh(ReportDate,8),3),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	;Êä•ÂëäÂåªÂ∏à
</span></span><span class="line"><span class="cl">	s AuthUserDR=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),21)
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_report _id&#34;=$s($l(AuthUserDR):$lg($g(^dbo.SYSUserD(AuthUserDR)),2),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	;ÁßëÂÆ§‰ª£Á†Å  ÁßëÂÆ§ÂêçÁß∞
</span></span><span class="line"><span class="cl">	s InputObj.&#34;dept_code&#34;=&#34;A30&#34;
</span></span><span class="line"><span class="cl">	s InputObj.&#34;dept_name&#34;=&#34;ÂåªÂ≠¶Ê£ÄÈ™åÁßë&#34;
</span></span><span class="line"><span class="cl">	;ÂåªÁñóÊú∫ÊûÑ‰ª£Á†Å  ÂåªÁñóÊú∫ÊûÑÂêçÁß∞  Êìç‰Ωú‰∫∫
</span></span><span class="line"><span class="cl">	s InputObj.&#34;org_code&#34;=..#SQJGCode
</span></span><span class="line"><span class="cl">	s InputObj.&#34;org_name&#34;=..#SQJGName
</span></span><span class="line"><span class="cl">	s InputObj.&#34;operator_id&#34;=&#34;&#34;
</span></span><span class="line"><span class="cl">	;Êìç‰ΩúÊó∂Èó¥
</span></span><span class="line"><span class="cl">	s InputObj.&#34;operation_time&#34;=$zd(+$h,3)_&#34; &#34;_$zt($p($h,&#34;,&#34;,2),1)
</span></span><span class="line"><span class="cl">	s ReturnJson=InputObj.%ToJSON()
</span></span><span class="line"><span class="cl">	s stream=##class(%Stream.GlobalCharacter).%New()
</span></span><span class="line"><span class="cl"> 	d stream.Write(ReturnJson)
</span></span><span class="line"><span class="cl">	//*************************Âπ≥Âè∞ÊñπÊ≥ï****************************//
</span></span><span class="line"><span class="cl">	//s retStr=##Class(web.DHCENS.BLL.GJCRBSB.Method.CRBService).CRBService(&#34;MES0239&#34;,stream).Read()
</span></span><span class="line"><span class="cl">	b ;Report retStr
</span></span><span class="line"><span class="cl">	Q &#34;&#34;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// ÂõΩÂÆ∂‰º†ÊüìÁóÖÊô∫ËÉΩÁõëÊµãÈ¢ÑË≠¶ÂâçÁΩÆËΩØ‰ª∂Êé•Âè£ÈÉ®ÁΩ≤ÔºöÊ£ÄÈ™åÊä•ÂëäÈ°πÁõÆ emr_ex_lab_item
</span></span><span class="line"><span class="cl">/// w ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).SendResultInfo(361)
</span></span><span class="line"><span class="cl">ClassMethod SendResultInfo(ReportDR As %String) As %Stream.GlobalCharacter
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	i &#39;$l(ReportDR) q &#34;&#34;
</span></span><span class="line"><span class="cl">	s Status=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),22)
</span></span><span class="line"><span class="cl">	q:Status&#39;[&#34;3&#34; &#34;&#34;
</span></span><span class="line"><span class="cl">	s fTestSetDR=&#34;&#34; f  s fTestSetDR=$o(^dbo.RPVisitNumberReportResultI(&#34;IndexTestSet&#34;,ReportDR,fTestSetDR)) q:fTestSetDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	.s fTestCodeDR=&#34;&#34; f  s fTestCodeDR=$o(^dbo.RPVisitNumberReportResultI(&#34;IndexTestSet&#34;,ReportDR,fTestSetDR,fTestCodeDR)) q:fTestCodeDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	..s ResultDR=$o(^dbo.RPVisitNumberReportResultI(&#34;IndexTestSet&#34;,ReportDR,fTestSetDR,fTestCodeDR,&#34;&#34;)) 
</span></span><span class="line"><span class="cl">	..d ResultInfo
</span></span><span class="line"><span class="cl">	q &#34;&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ResultInfo
</span></span><span class="line"><span class="cl">	s InputObj={} ;##class(DHCDoc.Util.ArrayData).%New()
</span></span><span class="line"><span class="cl">	q:ResultDR=&#34;&#34; &#34;&#34;
</span></span><span class="line"><span class="cl">	q:&#39;$d(^dbo.RPVisitNumberReportResultD(ResultDR)) &#34;&#34;
</span></span><span class="line"><span class="cl">	s ResultData=$g(^dbo.RPVisitNumberReportResultD(ResultDR))
</span></span><span class="line"><span class="cl">	s AdmNo=$lg($g(^dbo.RPVisitNumberReportResultD(ResultDR)),23)
</span></span><span class="line"><span class="cl">	;Ê£ÄÊü•‰ø°ÊÅØÂú®Èô¢ÂÜÖÁöÑÂîØ‰∏ÄËØÜÂà´Ê†áËØÜ
</span></span><span class="line"><span class="cl">	s InputObj.&#34;id&#34;=ResultDR
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÊä•ÂëäID
</span></span><span class="line"><span class="cl">	s InputObj.&#34;ex_lab_id&#34;=$lg(ResultData,2)
</span></span><span class="line"><span class="cl">	s TestCodeDR=$lg(ResultData,3)
</span></span><span class="line"><span class="cl">	;Èô¢ÂÜÖÊ£ÄÈ™åÈ°πÁõÆ‰ª£Á†ÅÔºåÈô¢ÂÜÖÊ£ÄÈ™åÈ°πÁõÆÂêçÁß∞
</span></span><span class="line"><span class="cl">	s TestCodeCode=$s($l(TestCodeDR):$lg(^dbo.BTTestCodeD(TestCodeDR),2),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	s TestCodeName=$s($l(TestCodeDR):$lg(^dbo.BTTestCodeD(TestCodeDR),2),1:&#34;&#34;)
</span></span><span class="line"><span class="cl">	s TestCodeData=..GetData(&#34;TC&#34;,TestCodeCode)
</span></span><span class="line"><span class="cl">	i &#39;$l(TestCodeData),..#IsInput q &#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(TestCodeData) d
</span></span><span class="line"><span class="cl">	.s TestCodeCode=$p(TestCodeData,&#34;^&#34;,1)
</span></span><span class="line"><span class="cl">	.s TestCodeName=$p(TestCodeData,&#34;^&#34;,2)		//***HR***//
</span></span><span class="line"><span class="cl">	s InputObj.&#34;item_code&#34;=TestCodeCode
</span></span><span class="line"><span class="cl">	s InputObj.&#34;item_name&#34;=TestCodeName
</span></span><span class="line"><span class="cl">	s ResCode=$lg(ResultData,4)
</span></span><span class="line"><span class="cl">	s Result=$lg(ResultData,5)
</span></span><span class="line"><span class="cl">	s Ranges=$lg(ResultData,12)
</span></span><span class="line"><span class="cl">	s ResultFormat=$lg(^dbo.BTTestCodeD(TestCodeDR),9)
</span></span><span class="line"><span class="cl">	s (MinRanges,MaxRanges)=&#34;&#34;
</span></span><span class="line"><span class="cl">	s (NumberResult,StringResultCode,StringResult)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i ResultFormat=&#34;N&#34; d
</span></span><span class="line"><span class="cl">	.s RangesBak=Ranges	
</span></span><span class="line"><span class="cl">	.i RangesBak[&#34;-&#34; d		// Ëé∑ÂèñÊúÄÂ∞èÂÄºÂíåÊúÄÂ§ßÂÄº
</span></span><span class="line"><span class="cl">	..s MinRanges=$p(RangesBak,&#34;-&#34;,1)
</span></span><span class="line"><span class="cl">	..s MaxRanges=$p(RangesBak,&#34;-&#34;,2)
</span></span><span class="line"><span class="cl">	.i RangesBak[&#34;&lt;&#34; d
</span></span><span class="line"><span class="cl">	..s RangesBak=$tr(RangesBak,&#34;=&#34;)
</span></span><span class="line"><span class="cl">	..s MinRanges=$p(RangesBak,&#34;&lt;&#34;,1)
</span></span><span class="line"><span class="cl">	..s MaxRanges=$p(RangesBak,&#34;&lt;&#34;,2) 
</span></span><span class="line"><span class="cl">	.i RangesBak[&#34;&gt;&#34; d
</span></span><span class="line"><span class="cl">	..s RangesBak=$tr(RangesBak,&#34;=&#34;)
</span></span><span class="line"><span class="cl">	..s MinRanges=$p(RangesBak,&#34;&gt;&#34;,2)
</span></span><span class="line"><span class="cl">	..s MaxRanges=$p(RangesBak,&#34;&gt;&#34;,1) 
</span></span><span class="line"><span class="cl">	.s NumberResult=Result
</span></span><span class="line"><span class="cl">	e  d
</span></span><span class="line"><span class="cl">	.s StringResultCode=ResCode
</span></span><span class="line"><span class="cl">	.s StringResult=Result
</span></span><span class="line"><span class="cl">	;Èô¢ÂÜÖÊ£ÄÈ™åÂÆöÊÄßÁªìÊûú‰ª£Á†Å
</span></span><span class="line"><span class="cl">	s InputObj.&#34;source_examination_result_code&#34;=StringResultCode
</span></span><span class="line"><span class="cl">	;Èô¢ÂÜÖÊ£ÄÈ™åÂÆöÊÄßÁªìÊûúÂêçÁß∞
</span></span><span class="line"><span class="cl">	s InputObj.&#34;source_examination_result_name&#34;=StringResult
</span></span><span class="line"><span class="cl">	s examinationResultData=..examinationResult(StringResult)
</span></span><span class="line"><span class="cl">	s (examinationStringResultCode,examinationStringResultName)=&#34;&#34;
</span></span><span class="line"><span class="cl">	i $l(examinationResultData) d
</span></span><span class="line"><span class="cl">	.s examinationStringResultCode=$p(examinationResultData,&#34;^&#34;,1)
</span></span><span class="line"><span class="cl">	.s examinationStringResultName=$p(examinationResultData,&#34;^&#34;,2)
</span></span><span class="line"><span class="cl">	;Ê†áÂåñÊ£ÄÈ™åÂÆöÊÄßÁªìÊûú‰ª£Á†Å
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_result_code&#34;=$g(examinationStringResultCode)
</span></span><span class="line"><span class="cl">	;Ê†áÂåñÊ£ÄÈ™åÂÆöÊÄßÁªìÊûúÂêçÁß∞
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_result_name&#34;=$g(examinationStringResultName)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÂÆöÈáèÁªìÊûú
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_quantification&#34;=NumberResult
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÂÆöÈáèÁªìÊûúËÆ°ÈáèÂçï‰Ωç
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_quantification_unit&#34;=$lg(ResultData,11)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÂÆöÈáèÁªìÊûúÂèÇËÄÉÂå∫Èó¥-‰∏ãÈôê
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_quantification_lower&#34;=MinRanges
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÂÆöÈáèÁªìÊûúÂèÇËÄÉÂå∫Èó¥-‰∏äÈôê
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_quantification_upper&#34;=MaxRanges
</span></span><span class="line"><span class="cl">	s ABFlag=$lg(ResultData,9)
</span></span><span class="line"><span class="cl">	;Ê£ÄÈ™åÂÆöÈáèÁªìÊûúË∂ÖÂá∫Êàñ‰Ωé‰∫éÂèÇËÄÉÂÄº
</span></span><span class="line"><span class="cl">	s InputObj.&#34;examination_quantification_ri&#34;=$case(ResultFormat,&#34;N&#34;:$case(ABFlag,&#34;H&#34;:&#34;2&#34;,&#34;PH&#34;:&#34;2&#34;,&#34;L&#34;:&#34;1&#34;,&#34;PL&#34;:&#34;1&#34;,:&#34;0&#34;),:&#34;&#34;)
</span></span><span class="line"><span class="cl">	;ÂåªÁñóÊú∫ÊûÑ‰ª£Á†Å  ÂåªÁñóÊú∫ÊûÑÂêçÁß∞  Êìç‰Ωú‰∫∫
</span></span><span class="line"><span class="cl">	s InputObj.&#34;operator_id&#34;=&#34;&#34;
</span></span><span class="line"><span class="cl">	;Êìç‰ΩúÊó∂Èó¥
</span></span><span class="line"><span class="cl">	s InputObj.&#34;operation_time&#34;=$zd(+$h,3)_&#34; &#34;_$zt($p($h,&#34;,&#34;,2),1)
</span></span><span class="line"><span class="cl">	s ReturnJson=InputObj.%ToJSON()
</span></span><span class="line"><span class="cl">	s stream=##class(%Stream.GlobalCharacter).%New()
</span></span><span class="line"><span class="cl"> 	d stream.Write(ReturnJson)
</span></span><span class="line"><span class="cl">	//*************************Âπ≥Âè∞ÊñπÊ≥ï****************************//
</span></span><span class="line"><span class="cl">	//s retStr=##Class(web.DHCENS.BLL.GJCRBSB.Method.CRBService).CRBService(&#34;MES0240&#34;,stream).Read()
</span></span><span class="line"><span class="cl">	b ;Result retStr
</span></span><span class="line"><span class="cl">	Q &#34;&#34;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Time:Êó∂Èó¥(ÂàÜÈíü)
</span></span><span class="line"><span class="cl">/// d ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).Do(30)
</span></span><span class="line"><span class="cl">ClassMethod Do(Time)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s Time=$g(Time)
</span></span><span class="line"><span class="cl">	i &#39;$l(Time) s Time=120
</span></span><span class="line"><span class="cl">	s STime=+Time*60+60
</span></span><span class="line"><span class="cl">	s SttDT=..GetMinutesAgoTime($zdt($h,8),STime)
</span></span><span class="line"><span class="cl">	s EndDT=$zdt($h,8)
</span></span><span class="line"><span class="cl">	s SttDate=$p(SttDT,&#34; &#34;,1)
</span></span><span class="line"><span class="cl">	s SttTime=$zth($p(SttDT,&#34; &#34;,2))
</span></span><span class="line"><span class="cl">	s EndDate=$p(EndDT,&#34; &#34;,1)
</span></span><span class="line"><span class="cl">	s EndTime=$zth($p(EndDT,&#34; &#34;,2))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s WorkGroupMachineDR=&#34;&#34; f  s WorkGroupMachineDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR)) q:WorkGroupMachineDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	.s AuthDate=SttDate-1 f  s AuthDate=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR,AuthDate)) q:((AuthDate=&#34;&#34;)||(AuthDate&gt;EndDate))  d
</span></span><span class="line"><span class="cl">	..s ReportDR=&#34;&#34; f  s ReportDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR,AuthDate,ReportDR)) q:ReportDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	...s AuthTime=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),20)
</span></span><span class="line"><span class="cl">	...i AuthTime&lt;SttTime q
</span></span><span class="line"><span class="cl">	...i AuthTime&gt;EndTime q
</span></span><span class="line"><span class="cl">	...i &#39;$l($$IsReportOutPut(ReportDR)) q
</span></span><span class="line"><span class="cl">	...i $d(^TMP($zn,$j,$i,ReportDR,1)) q
</span></span><span class="line"><span class="cl">	...d ..SendReportInfo(ReportDR)
</span></span><span class="line"><span class="cl">	...s ^TMP($zn,$j,$i,ReportDR,1)=&#34;&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	//*************************Âª∂Êó∂Á≠âÂæÖ****************************//
</span></span><span class="line"><span class="cl">	h 30		// Á≠âÂæÖ30Áßí
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	s WorkGroupMachineDR=&#34;&#34; f  s WorkGroupMachineDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR)) q:WorkGroupMachineDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	.s AuthDate=SttDate-1 f  s AuthDate=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR,AuthDate)) q:((AuthDate=&#34;&#34;)||(AuthDate&gt;EndDate))  d
</span></span><span class="line"><span class="cl">	..s ReportDR=&#34;&#34; f  s ReportDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAuthDate&#34;,WorkGroupMachineDR,AuthDate,ReportDR)) q:ReportDR=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	...s AuthTime=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),20)
</span></span><span class="line"><span class="cl">	...i AuthTime&lt;SttTime q
</span></span><span class="line"><span class="cl">	...i AuthTime&gt;EndTime q
</span></span><span class="line"><span class="cl">	...i &#39;$l($$IsReportOutPut(ReportDR)) q
</span></span><span class="line"><span class="cl">	...i $d(^TMP($zn,$j,$i,ReportDR,2)) q
</span></span><span class="line"><span class="cl">	...d ..SendResultInfo(ReportDR)
</span></span><span class="line"><span class="cl">	...s ^TMP($zn,$j,$i,ReportDR,2)=&#34;&#34;
</span></span><span class="line"><span class="cl">	q
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">IsReportOutPut(ReportDR)
</span></span><span class="line"><span class="cl">	s ret=&#34;&#34;
</span></span><span class="line"><span class="cl">	i &#39;$l(ReportDR) q ret
</span></span><span class="line"><span class="cl">	s Status=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),22)
</span></span><span class="line"><span class="cl">	q:Status&#39;[&#34;3&#34; ret
</span></span><span class="line"><span class="cl">	s VisitNumberDR=$lg($g(^dbo.RPVisitNumberReportD(ReportDR)),2)
</span></span><span class="line"><span class="cl">	s HospitalDR=$lg($g(^dbo.RPVisitNumberD(VisitNumberDR)),21)		//ÈôêÂà∂Êù°‰ª∂
</span></span><span class="line"><span class="cl">	s ret=&#34;1&#34;
</span></span><span class="line"><span class="cl">	q ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// w ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).GetMinutesAgoTime(&#34;20241125 10:04:00&#34;,7200)
</span></span><span class="line"><span class="cl">ClassMethod GetMinutesAgoTime(DateTime, timeDiff)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	try{
</span></span><span class="line"><span class="cl">	s Date=$zdh($p(DateTime,&#34; &#34;,1),8)
</span></span><span class="line"><span class="cl">	s Time=$zth($p(DateTime,&#34; &#34;,2))}catch{s (Date,Time)=&#34;&#34;}
</span></span><span class="line"><span class="cl">	i &#39;$l(Date) q &#34;&#34;
</span></span><span class="line"><span class="cl">	s DateSince=$fn(timeDiff/86400,&#34;&#34;,0)
</span></span><span class="line"><span class="cl">	s TimeSince=(timeDiff#86400)
</span></span><span class="line"><span class="cl">	i Time&gt;=TimeSince d
</span></span><span class="line"><span class="cl">	.s Date=$zd(Date-DateSince,8)
</span></span><span class="line"><span class="cl">	.s Time=$zt(Time-TimeSince)
</span></span><span class="line"><span class="cl">	e  d
</span></span><span class="line"><span class="cl">	.s Date=$zd(Date-DateSince-1,8)
</span></span><span class="line"><span class="cl">	.s Time=$zt(86400+Time-TimeSince)
</span></span><span class="line"><span class="cl">	q Date_&#34; &#34;_Time
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// =============================Ëé∑Âèñ‰∫íËÆ§Êï∞ÊçÆ=============================///
</span></span><span class="line"><span class="cl">/// Ëé∑Âèñ‰∫íËÆ§Êï∞ÊçÆ
</span></span><span class="line"><span class="cl">/// dbo.CFBTHISData
</span></span><span class="line"><span class="cl">/// Input:‰∫íËÆ§Á≥ªÁªü‰ª£Á†ÅÔºåÂåªÈô¢‰ª£Á†ÅÔºåÊï∞ÊçÆÁ±ªÂûãÔºå‰ª£Á†Å
</span></span><span class="line"><span class="cl">/// Outpue:ÂØπÁÖß‰ª£Á†ÅÔºåÂØπÁÖßÂêçÁß∞ÔºåÂØπÁÖß‰∏ªÈîÆ
</span></span><span class="line"><span class="cl">/// w ##class(LISAPP.LIS.BLL.UplaodDataBSToD3C).GetData(&#34;SP&#34;,&#34;SP015&#34;,&#34;&#34;,&#34;&#34;)
</span></span><span class="line"><span class="cl">ClassMethod GetData(fDataType, fCode, HospitalCode, SYSCode)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s SYSCode=$g(SYSCode)
</span></span><span class="line"><span class="cl">	i &#39;$l(SYSCode) s SYSCode=&#34;GJCRB&#34;
</span></span><span class="line"><span class="cl">	s HospitalCode=$g(HospitalCode)
</span></span><span class="line"><span class="cl">	i &#39;$l(HospitalCode) s HospitalCode=..#SQJGCode
</span></span><span class="line"><span class="cl">	s fDataType=$g(fDataType),fCode=$g(fCode)
</span></span><span class="line"><span class="cl">	s ret=&#34;&#34;
</span></span><span class="line"><span class="cl">	i &#39;$l(fCode) q ret
</span></span><span class="line"><span class="cl">	i &#39;$l(fDataType) q ret
</span></span><span class="line"><span class="cl">	i &#39;$d(^dbo.CFBTHISDataI(&#34;IndexMaster&#34;,fDataType,fCode,SYSCode,HospitalCode)) q ret
</span></span><span class="line"><span class="cl">	s HISDataCode=$o(^dbo.CFBTHISDataI(&#34;IndexMaster&#34;,fDataType,fCode,SYSCode,HospitalCode,&#34;&#34;))
</span></span><span class="line"><span class="cl">	s HISDataDR=$o(^dbo.CFBTHISDataI(&#34;IndexMaster&#34;,fDataType,fCode,SYSCode,HospitalCode,HISDataCode,&#34;&#34;))
</span></span><span class="line"><span class="cl">	s HISDataData=$g(^dbo.CFBTHISDataD(HISDataDR))
</span></span><span class="line"><span class="cl">	s HISDataCode=$lg(HISDataData,6)
</span></span><span class="line"><span class="cl">	s HISDataName=$lg(HISDataData,8)
</span></span><span class="line"><span class="cl">	s HISDataID=$lg(HISDataData,7)
</span></span><span class="line"><span class="cl">	s ret=HISDataCode_&#34;^&#34;_HISDataName_&#34;^&#34;_HISDataID
</span></span><span class="line"><span class="cl">	q ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Ê†áÂåñÂÆöÊÄßÁªìÊûúËΩ¨Êç¢
</span></span><span class="line"><span class="cl">ClassMethod examinationResult(Result)
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	s ret=&#34;&#34;
</span></span><span class="line"><span class="cl">	i ((Result[&#34;Èò≥ÊÄß&#34;)||(Result[&#34;+&#34;)) s ret=&#34;01^Èò≥ÊÄß&#34;
</span></span><span class="line"><span class="cl">	i ((Result=&#34;Èò¥ÊÄß&#34;)||(Result=&#34;-&#34;)) s ret=&#34;02^Èò¥ÊÄß&#34;
</span></span><span class="line"><span class="cl">	i Result[&#34;++&#34; s ret=&#34;04^Âº∫Èò≥ÊÄß&#34;
</span></span><span class="line"><span class="cl">	i ((Result=&#34;Âº±Èò≥ÊÄß&#34;)||(Result=&#34;+-&#34;)) s ret=&#34;05^Âº±Èò≥ÊÄß&#34;
</span></span><span class="line"><span class="cl">	i Result=&#34;Ê£ÄÂá∫&#34; s ret=&#34;06^Ê£ÄÂá∫&#34;
</span></span><span class="line"><span class="cl">	i ((Result=&#34;Êú™Ê£ÄÂá∫&#34;)||(Result=&#34;Êú™Êü•Âá∫&#34;)) s ret=&#34;07^Êú™Ê£ÄÂá∫&#34;
</span></span><span class="line"><span class="cl">	q ret
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    <section>
        È°µÈù¢ÊµèËßàÈáè<span id="busuanzi_value_page_pv">Loading</span>
    </section>
</footer>


    
</article>

<div class="post-password">
	
</div>

    

    

     
    
        
    <script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet'/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }
</style><script>
    
    Waline.init({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo"],"lang":"zh-CN","locale":{"admin":"Admin","placeholder":null},"requiredMeta":["name","email","url"],"serverURL":"https://waline.717170.xyz"});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 muziyang
    </section>
    
    <section class="powerby">
        
            ÁΩëÁ´ôÊÄªËÆøÂÆ¢Êï∞Ôºö<span id='busuanzi_value_site_uv'>Loading</span><br/>ÁΩëÁ´ôÊÄªËÆøÈóÆÈáèÔºö<span id='busuanzi_value_site_pv'>Loading</span> <br/>
        ‰ΩøÁî® <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> ÊûÑÂª∫ <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<script defer src="https://cn.vercount.one/js"></script>

    </body>
</html>
