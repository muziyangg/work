<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="ä»ªå™¨å…¬å…±æ–¹æ³• æ–¹æ³•å­˜æ”¾åœ¨MI.Specialç›®å½•ä¸­ï¼ŒåæœŸæ•´åˆå…¬å…±æ–¹æ³•éƒ½ä¼šæ”¾è¿›Commonç±»ä¸­ï¼Œç§æœ‰æ–¹æ³•æ”¾å•ç‹¬ç±»æˆ–è€…å…¬å…±Commonä¸­\nå…¬å…±æ–¹æ³• é€šè¿‡é€šé“å·è·å–æ£€æµ‹é¡¹ç›® Code2TCDR 1 2 3 4 5 6 7 8 9 10 11 12 ClassMethod Code2TCDR(mi, code) { s mi=$g(mi),code=$g(code) s ret=&#34;&#34; i &#39;$l(mi) q ret i &#39;$l(code) q ret i $d(^dbo.BTMIMachineTestCodeI(&#34;IndexResultChannel&#34;,mi,code)) d .s BTMIMachineTestCodeDR=$o(^dbo.BTMIMachineTestCodeI(&#34;IndexResultChannel&#34;,mi,code,&#34;&#34;)) .s TestCodeDR=$lg($g(^dbo.BTMIMachineTestCodeD(BTMIMachineTestCodeDR)),3) .s ret=TestCodeDR q ret } ä¿å­˜æ¶å­å· SaveRackNo 20250329 ï¼ï¼ï¼é¢å¤–è°ƒç”¨ä¿å­˜æ ‡æœ¬æ“ä½œæ—¥å¿—æ¥å£ï¼ˆSaveRecordï¼‰ï¼Œdbo.BTOperatorType æ–°å¢101ï¼ˆæ¶å­å·æ›´æ–°ï¼‰æ•°æ®\n20250330 å¦‚æœæ¶å­å·ç›¸åŒæ—¶ä¸å¢åŠ æ ‡æœ¬æ“ä½œæ—¥å¿—\n">
<title></title>

<link rel='canonical' href='https://work.717170.xyz/p/'>

<link rel="stylesheet" href="/scss/style.min.9f449ccc662f48c455f81316fd5cb87099956cabbb7a108c4681662ea647628e.css"><meta property='og:title' content="">
<meta property='og:description' content="ä»ªå™¨å…¬å…±æ–¹æ³• æ–¹æ³•å­˜æ”¾åœ¨MI.Specialç›®å½•ä¸­ï¼ŒåæœŸæ•´åˆå…¬å…±æ–¹æ³•éƒ½ä¼šæ”¾è¿›Commonç±»ä¸­ï¼Œç§æœ‰æ–¹æ³•æ”¾å•ç‹¬ç±»æˆ–è€…å…¬å…±Commonä¸­\nå…¬å…±æ–¹æ³• é€šè¿‡é€šé“å·è·å–æ£€æµ‹é¡¹ç›® Code2TCDR 1 2 3 4 5 6 7 8 9 10 11 12 ClassMethod Code2TCDR(mi, code) { s mi=$g(mi),code=$g(code) s ret=&#34;&#34; i &#39;$l(mi) q ret i &#39;$l(code) q ret i $d(^dbo.BTMIMachineTestCodeI(&#34;IndexResultChannel&#34;,mi,code)) d .s BTMIMachineTestCodeDR=$o(^dbo.BTMIMachineTestCodeI(&#34;IndexResultChannel&#34;,mi,code,&#34;&#34;)) .s TestCodeDR=$lg($g(^dbo.BTMIMachineTestCodeD(BTMIMachineTestCodeDR)),3) .s ret=TestCodeDR q ret } ä¿å­˜æ¶å­å· SaveRackNo 20250329 ï¼ï¼ï¼é¢å¤–è°ƒç”¨ä¿å­˜æ ‡æœ¬æ“ä½œæ—¥å¿—æ¥å£ï¼ˆSaveRecordï¼‰ï¼Œdbo.BTOperatorType æ–°å¢101ï¼ˆæ¶å­å·æ›´æ–°ï¼‰æ•°æ®\n20250330 å¦‚æœæ¶å­å·ç›¸åŒæ—¶ä¸å¢åŠ æ ‡æœ¬æ“ä½œæ—¥å¿—\n">
<meta property='og:url' content='https://work.717170.xyz/p/'>
<meta property='og:site_name' content='æœ¨å­æ´‹'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='' /><meta property='article:published_time' content='2025-08-29T16:24:28&#43;00:00'/><meta property='article:modified_time' content='2025-08-29T16:24:28&#43;00:00'/>
<meta name="twitter:title" content="">
<meta name="twitter:description" content="ä»ªå™¨å…¬å…±æ–¹æ³• æ–¹æ³•å­˜æ”¾åœ¨MI.Specialç›®å½•ä¸­ï¼ŒåæœŸæ•´åˆå…¬å…±æ–¹æ³•éƒ½ä¼šæ”¾è¿›Commonç±»ä¸­ï¼Œç§æœ‰æ–¹æ³•æ”¾å•ç‹¬ç±»æˆ–è€…å…¬å…±Commonä¸­\nå…¬å…±æ–¹æ³• é€šè¿‡é€šé“å·è·å–æ£€æµ‹é¡¹ç›® Code2TCDR 1 2 3 4 5 6 7 8 9 10 11 12 ClassMethod Code2TCDR(mi, code) { s mi=$g(mi),code=$g(code) s ret=&#34;&#34; i &#39;$l(mi) q ret i &#39;$l(code) q ret i $d(^dbo.BTMIMachineTestCodeI(&#34;IndexResultChannel&#34;,mi,code)) d .s BTMIMachineTestCodeDR=$o(^dbo.BTMIMachineTestCodeI(&#34;IndexResultChannel&#34;,mi,code,&#34;&#34;)) .s TestCodeDR=$lg($g(^dbo.BTMIMachineTestCodeD(BTMIMachineTestCodeDR)),3) .s ret=TestCodeDR q ret } ä¿å­˜æ¶å­å· SaveRackNo 20250329 ï¼ï¼ï¼é¢å¤–è°ƒç”¨ä¿å­˜æ ‡æœ¬æ“ä½œæ—¥å¿—æ¥å£ï¼ˆSaveRecordï¼‰ï¼Œdbo.BTOperatorType æ–°å¢101ï¼ˆæ¶å­å·æ›´æ–°ï¼‰æ•°æ®\n20250330 å¦‚æœæ¶å­å·ç›¸åŒæ—¶ä¸å¢åŠ æ ‡æœ¬æ“ä½œæ—¥å¿—\n">
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/touxiang_hu_3261c9b36eb249a9.jpg" width="300"
                            height="285" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">æœ¨å­æ´‹</a></h1>
            <h2 class="site-description">To be or not to be.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/muziyangg'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://gitee.com/muziyangg'
                        target="_blank"
                        title="Gitee"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1756364241553" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1459" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M739.76 462H484.2a22.22 22.22 0 0 0-22.2 22.21v55.56A22.24 22.24 0 0 0 484.19 562h155.57A22.22 22.22 0 0 1 662 584.22v11.11A66.67 66.67 0 0 1 595.31 662H384.19A22.22 22.22 0 0 1 362 639.79V428.68A66.67 66.67 0 0 1 428.64 362h311.07a22.21 22.21 0 0 0 22.22-22.2v-55.56A22.22 22.22 0 0 0 739.79 262h-311.1A166.67 166.67 0 0 0 262 428.68v311.1A22.22 22.22 0 0 0 284.22 762H612a150 150 0 0 0 150-150V484.23A22.23 22.23 0 0 0 739.77 462z m0 0" fill="#231815" p-id="1460"></path></svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>é¦–é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/link/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹é“¾</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#ä¸Šæœºè¯·æ±‚åŒå‘">ä¸Šæœºè¯·æ±‚åŒå‘</a>
      <ol>
        <li><a href="#hl7-åè®®æ¥å£åŒå‘">HL7 åè®®æ¥å£åŒå‘</a>
          <ol>
            <li><a href="#å›ä¼ å¤šè¡Œ-dsp">å›ä¼ å¤šè¡Œ DSP</a></li>
            <li><a href="#å›ä¼ ä¸‰è¡Œ-dsp">å›ä¼ ä¸‰è¡Œ DSP</a></li>
            <li><a href="#å›ä¼ å¤šè¡Œ-obx">å›ä¼ å¤šè¡Œ OBX</a></li>
          </ol>
        </li>
        <li><a href="#astm-åè®®æ¥å£åŒå‘">ASTM åè®®æ¥å£åŒå‘</a>
          <ol>
            <li><a href="#ä¸€æ¬¡æ€§å‘é€æŒ‰ç…§å­—ç¬¦æ•°å¤šæ¬¡å‘é€">ä¸€æ¬¡æ€§å‘é€æŒ‰ç…§å­—ç¬¦æ•°å¤šæ¬¡å‘é€</a></li>
            <li><a href="#é€šè¿‡æ”¶åˆ°-ack-å‘é€å¤šæ¡æ•°æ®">é€šè¿‡æ”¶åˆ° ACK å‘é€å¤šæ¡æ•°æ®</a></li>
          </ol>
        </li>
        <li><a href="#é€šè¿‡æ–‡ä»¶è¯·æ±‚åŒå‘">é€šè¿‡æ–‡ä»¶è¯·æ±‚åŒå‘</a>
          <ol>
            <li><a href="#ä¸Šæœºç”Ÿæˆè¯·æ±‚æ–‡ä»¶è¯·æ±‚">ä¸Šæœºç”Ÿæˆè¯·æ±‚æ–‡ä»¶è¯·æ±‚</a></li>
          </ol>
        </li>
        <li><a href="#ç§æœ‰åè®®æ¥å£åŒå‘">ç§æœ‰åè®®æ¥å£åŒå‘</a>
          <ol>
            <li><a href="#ç±»-astm-åŒå‘å›å¤-ack">ç±» ASTM åŒå‘å›å¤ ACK</a></li>
            <li><a href="#å®‰å›¾åè®®">å®‰å›¾åè®®</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#ä¸»åŠ¨ä¸Šä¼ åŒå‘">ä¸»åŠ¨ä¸Šä¼ åŒå‘</a>
      <ol>
        <li><a href="#é€šè¿‡ç›‘å¬æ–‡ä»¶åŒå‘">é€šè¿‡ç›‘å¬æ–‡ä»¶åŒå‘</a>
          <ol>
            <li><a href="#ä¸åŒè·¯å¾„å›ä¼ æ‚£è€…ä¿¡æ¯å’Œæ£€æµ‹é¡¹ç›®ä¿¡æ¯">ä¸åŒè·¯å¾„å›ä¼ æ‚£è€…ä¿¡æ¯å’Œæ£€æµ‹é¡¹ç›®ä¿¡æ¯</a></li>
            <li><a href="#åŒä¸€è·¯å¾„å›ä¼ æ–‡ä»¶ä¸Šä¼ ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶">åŒä¸€è·¯å¾„å›ä¼ æ–‡ä»¶ä¸Šä¼ ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶</a></li>
          </ol>
        </li>
        <li><a href="#é€šè¿‡ä¸²å£ç½‘å£ä¸»åŠ¨ä¸Šä¼ ">é€šè¿‡ä¸²å£ç½‘å£ä¸»åŠ¨ä¸Šä¼ </a>
          <ol>
            <li><a href="#ä¸Šä¼ å’Œä¸‹è½½ä¸ºä¸åŒçš„ä¸²å£æˆ–ç«¯å£">ä¸Šä¼ å’Œä¸‹è½½ä¸ºä¸åŒçš„ä¸²å£æˆ–ç«¯å£</a></li>
          </ol>
        </li>
        <li><a href="#é€šè¿‡æ•°æ®åº“ä¸»åŠ¨ä¸Šä¼ ">é€šè¿‡æ•°æ®åº“ä¸»åŠ¨ä¸Šä¼ </a>
          <ol>
            <li><a href="#odbcè¿æ¥æ•°æ®åº“å›æ’æ•°æ®">ODBCè¿æ¥æ•°æ®åº“å›æ’æ•°æ®</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/"></a>
        </h2>
    
        
    </div>

        
        <footer class="article-time">
            
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                    <time class="article-time--published">2025-08-29</time>
                </div>
            

            
            
                        æœ€åæ›´æ–°äº
                        <time class="article-time--updated" datetime="2025-08-29 16:24:28 &#43;0000 UTC" title="2025-08-29 16:24:28 &#43;0000 UTC">
                            2025-08-29 16:24:28
                        </time>
			
			
			
				<div>
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



					<time class="article-words">
						6222å­—
					</time>
				</div>
			
			

            
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                    <time class="article-time--reading">
                        é˜…è¯»æ—¶é•¿: 13 åˆ†é’Ÿ
                    </time>
                </div>
            
        </footer>
    


    
</div>
</header>



    <section class="article-content">
    
    
    <h1 id="åŒå‘æ¥å£ç¨‹åºæ•´åˆ">åŒå‘æ¥å£ç¨‹åºæ•´åˆ
</h1><h2 id="ä¸Šæœºè¯·æ±‚åŒå‘">ä¸Šæœºè¯·æ±‚åŒå‘
</h2><h3 id="hl7-åè®®æ¥å£åŒå‘">HL7 åè®®æ¥å£åŒå‘
</h3><h4 id="å›ä¼ å¤šè¡Œ-dsp">å›ä¼ å¤šè¡Œ DSP
</h4><blockquote>
<p>å›ä¼ ä¿¡æ¯æ—¶è¦æ±‚æœ‰ DSP å­—æ®µï¼Œä¸” DSP å­—æ®µå‰ 28 è¡Œä¸ºæ‚£è€…ä¿¡æ¯ï¼Œç¬¬ 29 è¡Œä¹‹åä¸ºæ£€æµ‹é¡¹ç›®ä¿¡æ¯ã€‚</p></blockquote>
<h5 id="ç¤ºä¾‹æ¥å£äºšè¾‰é¾™-3000">ç¤ºä¾‹æ¥å£(äºšè¾‰é¾™ 3000)
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">///</span> <span class="err">åç§°</span><span class="p">:</span> <span class="n">MI</span><span class="o">.</span><span class="n">MIFI3000</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">æè¿°</span><span class="p">:</span> <span class="err">æ·±åœ³äºšè¾‰é¾™</span><span class="n">iFlash3000</span> <span class="err">åŒå‘ä»ªå™¨æ¥å£</span>
</span></span><span class="line"><span class="cl"><span class="n">MIFI3000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>   
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(mi)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">par11</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">12</span><span class="p">)</span>      <span class="o">//</span><span class="err">é¡¹ç›®åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">par10</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">13</span><span class="p">)</span>  <span class="o">//</span><span class="err">ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AntDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">14</span><span class="p">)</span>        <span class="o">//</span><span class="err">æŠ—ç”Ÿç´ åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SenDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span>        <span class="o">//</span><span class="err">è¯æ•ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">par4</span><span class="o">=</span><span class="s2">&#34;|TCP|&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>   <span class="o">//</span><span class="err">ç«¯å£å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi1</span><span class="o">=</span><span class="n">mi</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">stx</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">etx</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ack</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">enq</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">eot</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">etb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">lf</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">nak</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">21</span><span class="p">),(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">errFlag</span><span class="p">,</span><span class="n">resultType</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">StartUTF8</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Main</span>
</span></span><span class="line"><span class="cl">        <span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span> <span class="n">par4</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Main</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">ZT</span><span class="o">=</span><span class="s2">&#34;ErrHandler&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">EC</span><span class="o">=</span><span class="s2">&#34;&#34;</span> 
</span></span><span class="line"><span class="cl">    <span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$TEST    //å¦‚æœè¶…æ—¶åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=sb   //ä»¥sbå¼€å¤´</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">errFlag</span><span class="p">,</span><span class="n">resultType</span><span class="p">,</span><span class="n">msgType</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="n">mshStr</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">startTime</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="n">PLIST</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span> <span class="n">curTime</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">Q</span><span class="p">:</span><span class="n">curTime</span><span class="o">&gt;</span><span class="p">(</span><span class="n">startTime</span><span class="o">+</span><span class="mi">300</span><span class="p">)</span>  <span class="o">//</span><span class="mi">5</span><span class="err">åˆ†é’Ÿå†…æ²¡æœ‰å¤„ç†å®Œåˆ™é€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="cl">        <span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$TEST    //å¦‚æœè¶…æ—¶åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">        <span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span><span class="o">&gt;=</span><span class="mi">32700</span> <span class="p">{</span>  <span class="o">//</span><span class="mi">32767</span>
</span></span><span class="line"><span class="cl">            <span class="n">S</span> <span class="n">index</span><span class="o">=+$</span><span class="n">O</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">I</span> <span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=eb,$C(R)&#39;</span><span class="o">=</span><span class="n">cr</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">))</span><span class="n">_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">I</span> <span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">cr</span> <span class="p">{</span>    <span class="o">//</span><span class="err">è§£æä¸€æ¡è®°å½•</span>
</span></span><span class="line"><span class="cl">            <span class="n">D</span> <span class="n">Record</span>
</span></span><span class="line"><span class="cl">            <span class="n">K</span> <span class="n">PLIST</span>
</span></span><span class="line"><span class="cl">            <span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span>   
</span></span><span class="line"><span class="cl">        <span class="p">}</span>   
</span></span><span class="line"><span class="cl">        <span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eb</span>      <span class="o">//</span><span class="err">å¾ªç¯è¯»å–</span><span class="p">,</span><span class="err">å½“ä¸º</span><span class="n">ebçš„æ—¶å€™åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Save</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Record</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">isImage</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">isBinary</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span> <span class="n">index</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(index)</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span> <span class="n">record</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span><span class="n">cr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">Continue</span><span class="p">:</span><span class="s1">&#39;$L(record)</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">I</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">S</span> <span class="n">segmentType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="p">;</span><span class="err">æ¶ˆæ¯æ®µ</span><span class="p">(</span><span class="err">æ•°æ®ç±»å‹</span><span class="p">)</span> 	<span class="n">MSH</span>	  <span class="n">MSA</span> 	<span class="n">PID</span>   <span class="n">OBR</span>  	<span class="n">OBX</span>  <span class="n">ORD</span>  <span class="n">QRF</span> 	<span class="n">ERR</span>   <span class="n">QAK</span>    <span class="n">DSP</span>     <span class="n">DSC</span>   
</span></span><span class="line"><span class="cl">            <span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;MSH&#34;</span> <span class="p">{</span>   <span class="o">//</span><span class="err">ä¿¡æ¯å¤´ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">mshStr</span><span class="o">=</span><span class="n">record</span>
</span></span><span class="line"><span class="cl">                <span class="o">//</span><span class="err">æ¶ˆæ¯ç±»å‹</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">msgType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="o">//</span><span class="n">ORU</span><span class="p">,</span><span class="n">ACK</span><span class="p">,</span><span class="n">QRY</span><span class="p">,</span><span class="n">QCK</span><span class="p">,</span><span class="n">DSR</span> 
</span></span><span class="line"><span class="cl">                <span class="n">I</span> <span class="n">msgType</span><span class="o">=</span><span class="s2">&#34;ORU&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">D</span> <span class="n">SendACK</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">I</span> <span class="n">msgType</span><span class="o">=</span><span class="s2">&#34;ORM&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">I</span> <span class="n">msgType</span><span class="o">=</span><span class="s2">&#34;QRY&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	                <span class="n">D</span> <span class="n">SendQryACK</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">resultType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">            <span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;PID&#34;</span> <span class="p">{</span>   <span class="o">//</span><span class="err">æ‚£è€…ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">            <span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;PVI&#34;</span> <span class="p">{</span>   <span class="o">//</span><span class="err">å°±è¯Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">            <span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;OBR&#34;</span> <span class="p">{</span>   <span class="o">//</span><span class="err">åŒ»å˜±ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">epis</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">                <span class="n">S</span><span class="p">:</span><span class="s1">&#39;$l(epis) epis=$P(record,&#34;|&#34;,4)</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">dateStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">I</span> <span class="n">dateStr</span><span class="err">?</span><span class="mi">14</span><span class="n">N</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">S</span> <span class="n">date</span><span class="o">=$</span><span class="n">ZDH</span><span class="p">(</span><span class="o">$</span><span class="n">E</span><span class="p">(</span><span class="n">dateStr</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">E</span><span class="p">(</span><span class="n">dateStr</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">E</span><span class="p">(</span><span class="n">dateStr</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">S</span> <span class="n">time</span><span class="o">=$</span><span class="n">ZTH</span><span class="p">(</span><span class="o">$</span><span class="n">E</span><span class="p">(</span><span class="n">dateStr</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">E</span><span class="p">(</span><span class="n">dateStr</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">E</span><span class="p">(</span><span class="n">dateStr</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">code</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">            <span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;OBX&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">dataTye</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>  <span class="o">//</span><span class="n">NM</span> <span class="p">(</span><span class="n">numeric</span><span class="p">)</span> <span class="err">è¡¨ç¤ºæ•°å­—å€¼ï¼Œç”¨äºå®šé‡é¡¹ç›®</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                            <span class="o">//</span><span class="n">ST</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="err">è¡¨ç¤ºå­—ç¬¦ä¸²å€¼ï¼Œç”¨äºå®šæ€§é¡¹ç›®</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">channel</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">channel</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">value</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">                <span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span><span class="n">dataTye</span><span class="s1">&#39;=&#34;ED&#34;,dataTye&#39;</span><span class="o">=</span><span class="s2">&#34;IS&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel_par10_value_par11</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"> 			<span class="o">//</span><span class="err">æ ¹æ®æ¡ç å·è·å–</span><span class="n">LISæ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">            <span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;QRD&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">barcode</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>  <span class="o">//</span><span class="n">QRD</span><span class="o">|</span><span class="mi">20161208150935</span><span class="o">|</span><span class="n">R</span><span class="o">|</span><span class="n">D</span><span class="o">|</span><span class="mi">1</span><span class="o">|||</span><span class="n">RD</span><span class="o">|</span><span class="mi">16120703726</span><span class="o">|</span><span class="n">OTH</span><span class="o">|||</span><span class="n">T</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">barcode</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	                <span class="n">S</span> <span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;MSH&#34;</span><span class="p">)</span><span class="o">=</span><span class="n">mshStr</span>
</span></span><span class="line"><span class="cl">	                <span class="n">S</span> <span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;QRD&#34;</span><span class="p">)</span><span class="o">=</span><span class="n">record</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">//</span><span class="err">æ ¹æ®æŸ¥è¯¢æ¡ä»¶è·å–</span><span class="n">LISæ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">            <span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;QRF&#34;</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">            	<span class="n">S</span> <span class="n">tRecord</span><span class="o">=</span><span class="n">record</span>
</span></span><span class="line"><span class="cl">            	<span class="n">S</span> <span class="n">record</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            	<span class="n">S</span> <span class="n">qryStartDate</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">qryEndDate</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">sampleIdStart</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span> <span class="n">sampleIdEnd</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span><span class="p">:</span><span class="s1">&#39;$L(qryStartDate) qryStartDate=qryEndDate</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span><span class="p">:</span><span class="s1">&#39;$L(qryEndDate) qryEndDate=qryStartDate</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span><span class="p">:</span><span class="s1">&#39;$L(sampleIdStart) sampleIdStart=sampleIdEnd</span>
</span></span><span class="line"><span class="cl">                <span class="n">S</span><span class="p">:</span><span class="s1">&#39;$L(sampleIdEnd) sampleIdEnd=sampleIdStart</span>
</span></span><span class="line"><span class="cl">                <span class="o">//</span><span class="err">é€šè¿‡æ ·æœ¬å·æ®µæŸ¥è¯¢</span>  <span class="n">QRF</span><span class="o">|</span><span class="n">iFlash3000</span><span class="o">|||</span><span class="mi">1</span><span class="o">|</span><span class="mi">9</span><span class="o">|</span><span class="n">RCT</span><span class="o">|</span><span class="n">COR</span><span class="o">|</span><span class="n">ALL</span><span class="o">||</span> 
</span></span><span class="line"><span class="cl">                <span class="n">I</span> <span class="n">sampleIdStart</span><span class="err">?</span><span class="mf">1.</span><span class="n">N</span><span class="p">,</span><span class="n">sampleIdEnd</span><span class="err">?</span><span class="mf">1.</span><span class="n">N</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	                <span class="n">F</span> <span class="n">sampleId</span><span class="o">=</span><span class="n">sampleIdStart</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">sampleIdEnd</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		                <span class="n">S</span> <span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;S&#34;</span><span class="p">,</span><span class="n">sampleId</span><span class="p">,</span><span class="s2">&#34;MSH&#34;</span><span class="p">)</span><span class="o">=</span><span class="n">mshStr</span>
</span></span><span class="line"><span class="cl">		                <span class="n">S</span> <span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;S&#34;</span><span class="p">,</span><span class="n">sampleId</span><span class="p">,</span><span class="s2">&#34;QRF&#34;</span><span class="p">)</span><span class="o">=</span><span class="n">tRecord</span>
</span></span><span class="line"><span class="cl">		            <span class="p">}</span>
</span></span><span class="line"><span class="cl">	            <span class="p">}</span>
</span></span><span class="line"><span class="cl">	            <span class="o">//</span><span class="err">é€šè¿‡æ—¶é—´æ®µæŸ¥è¯¢</span>	<span class="n">QRF</span><span class="o">|</span><span class="n">iFlash3000</span><span class="o">|</span><span class="mi">20160122080000</span><span class="o">|</span><span class="mi">20160122120000</span><span class="o">|||</span><span class="n">RCT</span><span class="o">|</span><span class="n">COR</span><span class="o">|</span><span class="n">ALL</span><span class="o">||</span>
</span></span><span class="line"><span class="cl">	            <span class="n">I</span> <span class="n">qryStartDate</span><span class="err">?</span><span class="mf">1.</span><span class="n">N</span><span class="p">,</span><span class="n">qryEndDate</span><span class="err">?</span><span class="mf">1.</span><span class="n">N</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	                <span class="n">F</span> <span class="n">qryDate</span><span class="o">=</span><span class="n">qryStartDate</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">qryEndDate</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		                <span class="n">S</span> <span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;D&#34;</span><span class="p">,</span><span class="n">qryDate</span><span class="p">,</span><span class="s2">&#34;MSH&#34;</span><span class="p">)</span><span class="o">=</span><span class="n">mshStr</span>
</span></span><span class="line"><span class="cl">		                <span class="n">S</span> <span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;D&#34;</span><span class="p">,</span><span class="n">qryDate</span><span class="p">,</span><span class="s2">&#34;QRF&#34;</span><span class="p">)</span><span class="o">=</span><span class="n">tRecord</span>
</span></span><span class="line"><span class="cl">		            <span class="p">}</span>
</span></span><span class="line"><span class="cl">	            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æ ¹æœ¬æ ·æœ¬å·è·å–æ¡ç å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">sampleId</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">sampleId</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">sampleId</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(sampleId) </span>
</span></span><span class="line"><span class="cl">	    <span class="o">//</span><span class="err">æš‚ä¸å¤„ç†</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ ¹æœ¬æ—¥æœŸè·å–æ¡ç å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">qryDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">qryDate</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;D&#34;</span><span class="p">,</span><span class="n">qryDate</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(qryDate) </span>
</span></span><span class="line"><span class="cl">	    <span class="o">//</span><span class="err">æš‚ä¸å¤„ç†</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">ä¸Šä¼ æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">barcode</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">barcodeIndex</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">barcode</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">barcode</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(barcode)</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">barcode</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">barcodeIndex</span><span class="o">=</span><span class="n">barcodeIndex</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	    <span class="n">I</span> <span class="o">$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">barcode</span><span class="p">))</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		    <span class="n">S</span> <span class="n">barcodeIndex</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="o">//</span><span class="err">æœ€åä¸€ä¸ªä¸ºç©º</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;MSH&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">qrdStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;QRD&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">qrfStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;QRF&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="s1">&#39;$L(qrdStr) {</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">qrdStr</span><span class="o">=</span><span class="s2">&#34;QRD|&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZDT</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s2">&#34; :&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|R|D|1|||RD||OTH|||T|&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="s1">&#39;$L(qrfStr) {</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">qrfStr</span><span class="o">=</span><span class="s2">&#34;QRF|iFlash3000|||||RCT|COR|ALL||&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">qrdStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SendOrder</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="n">barcodeIndex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="o">^</span><span class="n">TMPMACHINEEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">Save</span>  
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;^&#34;</span><span class="n">_result</span><span class="p">,</span><span class="s2">&#34;Test&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span> <span class="n">QC</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">;</span><span class="n">S</span> <span class="n">result</span><span class="o">=$$</span><span class="n">TransResult</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">resultType</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">SendACK</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="n">errCode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">errDesc</span><span class="o">=</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">)</span> <span class="o">//</span><span class="n">send</span> <span class="s1">&#39;ack&#39;</span> <span class="n">to</span> <span class="n">instrument</span> 
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">ackType</span><span class="p">,</span><span class="n">errCode</span><span class="p">,</span><span class="n">errDesc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">ackType</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ackType</span><span class="p">),</span><span class="n">errCode</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">errCode</span><span class="p">),</span><span class="n">errDesc</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">errDesc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:(</span><span class="s1">&#39;$l(mi))||(&#39;</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">21</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">msgRoutine</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">seq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS|||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;ACK^&#34;</span><span class="n">_msgRoutine</span>
</span></span><span class="line"><span class="cl">    <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;MSA|&#34;</span><span class="n">_ackType_</span><span class="s2">&#34;|&#34;</span><span class="n">_seq_</span><span class="s2">&#34;|&#34;</span><span class="n">_errDesc_</span><span class="s2">&#34;|||&#34;</span><span class="n">_errCode_</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">S</span><span class="p">(</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AE&#34;</span><span class="p">:</span><span class="s2">&#34;Error&#34;</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;NULL&#34;</span><span class="p">),</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">SendQryACK</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="n">errCode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">errDesc</span><span class="o">=</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">)</span> <span class="o">//</span><span class="n">send</span> <span class="s1">&#39;ack&#39;</span> <span class="n">to</span> <span class="n">instrument</span> 
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">ackType</span><span class="p">,</span><span class="n">errCode</span><span class="p">,</span><span class="n">errDesc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">ackType</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ackType</span><span class="p">),</span><span class="n">errCode</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">errCode</span><span class="p">),</span><span class="n">errDesc</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">errDesc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:(</span><span class="s1">&#39;$l(mi))||(&#39;</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">msgRoutine</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">seq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS|||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;QCK^&#34;</span><span class="n">_msgRoutine</span>
</span></span><span class="line"><span class="cl">    <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;MSA|&#34;</span><span class="n">_ackType_</span><span class="s2">&#34;|&#34;</span><span class="n">_seq_</span><span class="s2">&#34;|&#34;</span><span class="n">_errDesc_</span><span class="s2">&#34;|||&#34;</span><span class="n">_errCode_</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;ERR|0|&#34;</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;QAK|SR|OK|&#34;</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">S</span><span class="p">(</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">:</span><span class="s2">&#34;QACK&#34;</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AE&#34;</span><span class="p">:</span><span class="s2">&#34;Error&#34;</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span><span class="p">:</span><span class="s2">&#34;QNAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;NULL&#34;</span><span class="p">),</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">ErrHandler</span>
</span></span><span class="line"><span class="cl">    <span class="n">h</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZERROR</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="s2">&#34;--&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;.é”™è¯¯ä»£ç :&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ECODE</span><span class="p">,</span><span class="s2">&#34;Runtime Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">åŒå‘ä¸Šä¼ åŒ»å˜±ä¿¡æ¯</span><span class="p">,</span><span class="n">wwh</span><span class="p">,</span><span class="mi">2015</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">05</span>
</span></span><span class="line"><span class="cl"><span class="n">SendOrder</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="n">DSC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="n">DSC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">barcode</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">barcode</span><span class="p">),</span><span class="n">DSC</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">DSC</span><span class="p">),</span><span class="n">qrdStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">qrdStr</span><span class="p">),</span><span class="n">qrfStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">qrfStr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(barcode) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç å·ä¸ºç©º&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>   
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>             <span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«æé”™è¯¯,æœºå™¨æœªè¯†åˆ«&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">labno</span><span class="o">=</span><span class="n">barcode</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">workGroupMachineDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">visiNumberDR</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(visiNumberDR) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„æ ‡æœ¬ä¿¡æ¯,ç¡®å®šæ¡ç æ­£ç¡®æˆ–æ ‡æœ¬å·²ç»æ¥æ”¶?&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">visNumberObj</span><span class="o">=</span><span class="c1">##Class(dbo.RPVisitNumber).%OpenId(visiNumberDR)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(visNumberObj) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„æ ‡æœ¬ä¿¡æ¯,ç¡®å®šæ¡ç æ­£ç¡®æˆ–æ ‡æœ¬å·²ç»æ¥æ”¶?&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="s2">&#34;Upload Start&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">chlStr</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">chlCnt</span><span class="o">=</span><span class="mi">29</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chl</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(chl)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlStr</span><span class="o">=</span><span class="n">chlStr_</span><span class="s2">&#34;DSP|&#34;</span><span class="n">_chlCnt_</span><span class="s2">&#34;||&#34;</span><span class="n">_chl_</span><span class="s2">&#34;^^^|||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlCnt</span><span class="o">=</span><span class="n">chlCnt</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="p">;</span><span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="n">result_chl_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;?&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">I</span> <span class="s1">&#39;$L(chlStr) {</span>
</span></span><span class="line"><span class="cl">	 	<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„åŒ–éªŒé¡¹ç›®ä¿¡æ¯,ç¡®å®šåŒ»å˜±æˆ–é¡¹ç›®ç»´æŠ¤æ­£ç¡®?&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">specimenDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">visiNumberDR</span><span class="p">)),</span><span class="mi">56</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">specimenName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">specimenDR</span><span class="p">)</span> <span class="n">specimenName</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpecimenD</span><span class="p">(</span><span class="n">specimenDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">sampleType</span><span class="o">=</span><span class="s2">&#34;å…¶ä»–&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">specimenName</span><span class="p">),</span><span class="s2">&#34;,è¡€æ¸…,è¡€æµ†,å°¿æ¶²,è„‘è„Šæ¶²,&#34;</span><span class="p">[(</span><span class="s2">&#34;,&#34;</span><span class="n">_specimenName_</span><span class="s2">&#34;,&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">sampleType</span><span class="o">=</span><span class="n">specimenName</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">birdthday</span><span class="o">=</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">BirthDate</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">birdthday</span><span class="p">)</span><span class="o">=</span><span class="mi">8</span> <span class="n">birdthday</span><span class="o">=</span><span class="n">birdthday_</span><span class="s2">&#34;000000&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="s1">&#39;$L(mshStr) mshStr=&#34;MSH|^~\&amp;|YHLO|iFlash3000|||20161208150935||QRY^Q02|18|P|2.3.1||||||ASCII|||&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshSeq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;DSR^Q03&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS|||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">episode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">workGroupMachineDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span> <span class="o">//</span><span class="c1">##Class(MI.Instrument).GetWorkGroupMachineRowId(mi)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">workGroupMachineDR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">S</span> <span class="n">OrderNo</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">visiNumberDR</span><span class="p">,</span><span class="n">workGroupMachineDR</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">OrderNo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    	<span class="n">S</span> <span class="n">reportDR</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">visiNumberDR</span><span class="p">,</span><span class="n">workGroupMachineDR</span><span class="p">,</span><span class="n">OrderNo</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	    	<span class="n">S</span> <span class="n">episode</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="o">//</span><span class="c1">##Class(LIS.Core.Report).GetEpisodeNumber(reportDR)</span>
</span></span><span class="line"><span class="cl">	    	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">reportDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Assayno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">reportDR</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">mshStr_cr</span> <span class="o">//</span><span class="s2">&#34;MSH|^~\&amp;|||||20160122110540||DSR^Q03|14|P|2.3.1||||||ASCII|||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;MSA|AA|&#34;</span><span class="n">_mshSeq_</span><span class="s2">&#34;|Message accepted|||0|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;ERR|0|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;QAK|SR|OK|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_qrdStr_cr</span>  <span class="o">//</span><span class="s2">&#34;QRD|20160122110540|R|D|1|||RD||OTH|||T|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_qrfStr_cr</span>  <span class="o">//</span><span class="s2">&#34;QRF|iFlash3000|||||RCT|COR|ALL||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|1||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">RegNo_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>		<span class="o">//</span><span class="err">ä½é™¢å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|2||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">BedNo_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>		<span class="o">//</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|3||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">SurName_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">	<span class="o">/*</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|1||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">RegNo_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>		<span class="o">//</span><span class="err">ä½é™¢å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|2||&#34;</span><span class="n">_episode_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>		<span class="o">//</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|3||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">SurName_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|3||&#34;</span><span class="n">_episode_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">	<span class="o">*/</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|4||&#34;</span><span class="n">_birdthday_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">å‡ºç”Ÿæ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|5||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">S</span><span class="p">(</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">SpeciesDR</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;M&#34;</span><span class="p">,</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">SpeciesDR</span><span class="o">=</span><span class="mi">2</span><span class="p">:</span><span class="s2">&#34;F&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;O&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|6|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">è¡€å‹</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|7|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">ç§æ—</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|8|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">åœ°å€</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|9|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">é‚®ç¼–</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|10|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">å®¶åº­ç”µè¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|11|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æ ·æœ¬ä½</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|12|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æ ·æœ¬é‡‡é›†æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|13|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æœªç”¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|14|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æœªç”¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|15|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">ç—…äººç±»åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|16|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">åŒ»ä¿å¸å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|17|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æ”¶è´¹ç±»å‹</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|18|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æ°‘æ—</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|19|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">ç±è´¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|20|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">å›½å®¶</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|21||&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//*</span><span class="err">æ ·æœ¬æ¡ç </span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|22||&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//*</span><span class="err">æ ·æœ¬ç¼–å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|23|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">é€æ£€æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|24||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">S</span><span class="p">(</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">Urgent</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;Y&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;N&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>				<span class="o">//*</span><span class="err">æ˜¯å¦æ€¥è¯Š</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|25|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æœªç”¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|26||&#34;</span><span class="n">_sampleType_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//*</span><span class="err">æ ·æœ¬ç±»å‹</span><span class="p">(</span><span class="err">è¡€æ¸…</span><span class="p">,</span><span class="err">è¡€æµ†</span><span class="p">,</span><span class="err">å°¿æ¶²</span><span class="p">,</span><span class="err">è„‘è„Šæ¶²</span><span class="p">,</span><span class="err">å…¶ä»–</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|27|||||&#34;</span><span class="n">_cr</span>	<span class="o">//</span><span class="err">é€æ£€åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|28|||||&#34;</span><span class="n">_cr</span>		<span class="o">//</span><span class="err">é€æ£€ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_chlStr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSC|&#34;</span><span class="n">_DSC_</span><span class="s2">&#34;|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">    <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">order</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">sb_order_eb_cr</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">//$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZDT</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s2">&#34; :&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">d</span> <span class="n">Test</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIFIFLASH3000N</span><span class="p">(</span><span class="s2">&#34;22&#34;</span><span class="p">,</span><span class="mi">9000000266</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Test</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">barcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">barcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">barcode</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">barcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=</span><span class="s2">&#34;MSH|^~\&amp;|YHLO|iFlash3000|||20160122110540||QRY^Q02|14|P|2.3.1||||||ASCII|||&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">DSC</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">qrdStr</span><span class="o">=</span><span class="s2">&#34;QRD|20160122110540|R|D|1|||RD|BarCode1|OTH|||T|&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">qrfStr</span><span class="o">=</span><span class="s2">&#34;QRF|iFlash3000|||||RCT|COR|ALL||&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">sb</span><span class="o">=</span><span class="s2">&#34;&lt;SB&gt;&#34;</span><span class="p">,</span><span class="n">eb</span><span class="o">=</span><span class="s2">&#34;&lt;EB&gt;&#34;</span><span class="p">,</span><span class="n">cr</span><span class="o">=</span><span class="s2">&#34;&lt;CR&gt;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(barcode) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">W</span> <span class="s2">&#34;æ¡ç å·ä¸ºç©º&#34;</span><span class="p">,</span><span class="o">!</span>
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>             <span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">        <span class="n">W</span> <span class="s2">&#34;æ¡ç æ‰«æé”™è¯¯,æœºå™¨æœªè¯†åˆ«&#34;</span><span class="p">,</span><span class="o">!</span>   
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">labno</span><span class="o">=</span><span class="n">barcode</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">workGroupMachineDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">visiNumberDR</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(visiNumberDR) {</span>
</span></span><span class="line"><span class="cl">    	<span class="n">W</span> <span class="s2">&#34;æ¡ç æœªæ¥æ”¶&#34;</span><span class="p">,</span><span class="o">!</span>   
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(visiNumberDR) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">W</span> <span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„æ ‡æœ¬ä¿¡æ¯,ç¡®å®šæ¡ç æ­£ç¡®æˆ–æ ‡æœ¬å·²ç»æ¥æ”¶?&#34;</span><span class="p">,</span><span class="o">!</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">visNumberObj</span><span class="o">=</span><span class="c1">##Class(dbo.RPVisitNumber).%OpenId(visiNumberDR)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(visNumberObj) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">W</span> <span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„æ ‡æœ¬ä¿¡æ¯,ç¡®å®šæ¡ç æ­£ç¡®æˆ–æ ‡æœ¬å·²ç»æ¥æ”¶?&#34;</span><span class="p">,</span><span class="o">!</span>   
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">chlStr</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span> <span class="p">;</span><span class="n">a102</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">chlCnt</span><span class="o">=</span><span class="mi">29</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chl</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(chl)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlStr</span><span class="o">=</span><span class="n">chlStr_</span><span class="s2">&#34;DSP|&#34;</span><span class="n">_chlCnt_</span><span class="s2">&#34;||&#34;</span><span class="n">_chl_</span><span class="s2">&#34;^^^|||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlCnt</span><span class="o">=</span><span class="n">chlCnt</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">I</span> <span class="s1">&#39;$L(chlStr) {</span>
</span></span><span class="line"><span class="cl">	 	<span class="n">W</span> <span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„åŒ–éªŒé¡¹ç›®ä¿¡æ¯,ç¡®å®šåŒ»å˜±æˆ–é¡¹ç›®ç»´æŠ¤æ­£ç¡®?&#34;</span><span class="p">,</span><span class="o">!</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">specimenDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">visiNumberDR</span><span class="p">)),</span><span class="mi">56</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">specimenName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">specimenDR</span><span class="p">)</span> <span class="n">specimenName</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpecimenD</span><span class="p">(</span><span class="n">specimenDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">sampleType</span><span class="o">=</span><span class="s2">&#34;å…¶ä»–&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">specimenName</span><span class="p">),</span><span class="s2">&#34;,è¡€æ¸…,è¡€æµ†,å°¿æ¶²,è„‘è„Šæ¶²,&#34;</span><span class="p">[(</span><span class="s2">&#34;,&#34;</span><span class="n">_specimenName_</span><span class="s2">&#34;,&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">sampleType</span><span class="o">=</span><span class="n">specimenName</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">birdthday</span><span class="o">=</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">BirthDate</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">birdthday</span><span class="p">)</span><span class="o">=</span><span class="mi">8</span> <span class="n">birdthday</span><span class="o">=</span><span class="n">birdthday_</span><span class="s2">&#34;000000&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshSeq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;DSR^Q03&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS|||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">mshStr_cr</span> <span class="o">//</span><span class="s2">&#34;MSH|^~\&amp;|||||20160122110540||DSR^Q03|14|P|2.3.1||||||ASCII|||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;MSA|AA|&#34;</span><span class="n">_mshSeq_</span><span class="s2">&#34;|Message accepted|||0|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;ERR|0|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;QAK|SR|OK|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_qrdStr_cr</span>  <span class="o">//</span><span class="s2">&#34;QRD|20160122110540|R|D|1|||RD||OTH|||T|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_qrfStr_cr</span>  <span class="o">//</span><span class="s2">&#34;QRF|iFlash3000|||||RCT|COR|ALL||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|1||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">RegNo_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>		<span class="o">//</span><span class="err">ä½é™¢å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|2||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">BedNo_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>		<span class="o">//</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|3||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">SurName_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">	<span class="n">b</span> <span class="p">;</span><span class="n">a101</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|4||&#34;</span><span class="n">_birdthday_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">å‡ºç”Ÿæ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|5||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">S</span><span class="p">(</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">SpeciesDR</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;M&#34;</span><span class="p">,</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">SpeciesDR</span><span class="o">=</span><span class="mi">2</span><span class="p">:</span><span class="s2">&#34;F&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;O&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|6|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">è¡€å‹</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|7|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">ç§æ—</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|8|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">åœ°å€</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|9|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">é‚®ç¼–</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|10|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">å®¶åº­ç”µè¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|11|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æ ·æœ¬ä½</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|12|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æ ·æœ¬é‡‡é›†æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|13|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æœªç”¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|14|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æœªç”¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|15|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">ç—…äººç±»åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|16|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">åŒ»ä¿å¸å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|17|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æ”¶è´¹ç±»å‹</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|18|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æ°‘æ—</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|19|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">ç±è´¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|20|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">å›½å®¶</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|21||&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//*</span><span class="err">æ ·æœ¬æ¡ç </span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|22||&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//*</span><span class="err">æ ·æœ¬ç¼–å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|23|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">é€æ£€æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|24||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">S</span><span class="p">(</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">Urgent</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;Y&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;N&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>				<span class="o">//*</span><span class="err">æ˜¯å¦æ€¥è¯Š</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|25|||||&#34;</span><span class="n">_cr</span>				<span class="o">//</span><span class="err">æœªç”¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|26||&#34;</span><span class="n">_sampleType_</span><span class="s2">&#34;|||&#34;</span><span class="n">_cr</span>	<span class="o">//*</span><span class="err">æ ·æœ¬ç±»å‹</span><span class="p">(</span><span class="err">è¡€æ¸…</span><span class="p">,</span><span class="err">è¡€æµ†</span><span class="p">,</span><span class="err">å°¿æ¶²</span><span class="p">,</span><span class="err">è„‘è„Šæ¶²</span><span class="p">,</span><span class="err">å…¶ä»–</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|27|||||&#34;</span><span class="n">_cr</span>	<span class="o">//</span><span class="err">é€æ£€åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|28|||||&#34;</span><span class="n">_cr</span>		<span class="o">//</span><span class="err">é€æ£€ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_chlStr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSC|&#34;</span><span class="n">_DSC_</span><span class="s2">&#34;|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">    <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">order</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">!</span> 
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">TransResult</span><span class="p">(</span><span class="n">miRowId</span><span class="p">,</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">N</span> <span class="p">(</span><span class="n">miRowId</span><span class="p">,</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">miRowId</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">miRowId</span><span class="p">),</span><span class="n">result</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">result</span><span class="p">),</span><span class="n">newRes</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Continue</span><span class="p">:</span><span class="s1">&#39;$L(chlStr)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chl</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">chlStr</span><span class="p">,</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,1)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">val</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">chlStr</span><span class="p">,</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,2)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Continue</span><span class="p">:</span><span class="s1">&#39;$L(chl)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">res</span><span class="o">=</span><span class="n">val</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="n">chl</span><span class="o">&gt;</span><span class="mi">97</span><span class="p">,</span><span class="n">chl</span><span class="o">&lt;</span><span class="mi">102</span><span class="p">,</span><span class="n">val</span><span class="s1">&#39;[&#34;?&#34; {</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">res</span><span class="o">=$$</span><span class="n">GetQuaResult</span><span class="p">(</span><span class="n">miRowId</span><span class="p">,</span><span class="n">chl</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">newRes</span><span class="o">=</span><span class="n">newRes_chl_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_res_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">newRes</span><span class="p">)</span> <span class="n">newRes</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">GetQuaResult</span><span class="p">(</span><span class="n">miRowId</span><span class="p">,</span><span class="n">chl</span><span class="p">,</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">N</span> <span class="p">(</span><span class="n">miRowId</span><span class="p">,</span><span class="n">chl</span><span class="p">,</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">miRowId</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">miRowId</span><span class="p">),</span><span class="n">chl</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">chl</span><span class="p">),</span><span class="n">res</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="n">res</span><span class="err">?</span><span class="mi">1</span><span class="s2">&#34;.&#34;</span><span class="mf">1.</span><span class="n">N</span> <span class="n">res</span><span class="o">=</span><span class="s2">&#34;0&#34;</span><span class="n">_res</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">orgRes</span><span class="o">=</span><span class="n">res</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">resPrefix</span><span class="o">=$</span><span class="n">E</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="s2">&#34;&lt;&gt;&#34;</span><span class="s1">&#39;[resPrefix resPrefix=&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">resPrefix</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">res</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">resPrefix</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(chl) orgRes</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:(</span><span class="n">res</span><span class="s1">&#39;?0.N1.&#34;.&#34;1.N)&amp;&amp;(res&#39;</span><span class="err">?</span><span class="mf">1.</span><span class="n">N</span><span class="p">)</span> <span class="n">orgRes</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tcRefRowId</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineTestCodeI</span><span class="p">(</span><span class="s2">&#34;IndexResultChannel&#34;</span><span class="p">,</span><span class="n">miRowId</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(chl),&#34;&#34;)) </span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(tcRefRowId) orgRes</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tcRowId</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineTestCodeD</span><span class="p">(</span><span class="n">tcRefRowId</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(tcRowId) orgRes</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">orderNo</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTTestCodeRangesI</span><span class="p">(</span><span class="s2">&#34;IndexMaster&#34;</span><span class="p">,</span><span class="n">tcRowId</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(orderNo) orgRes</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">rangeDR</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTTestCodeRangesI</span><span class="p">(</span><span class="s2">&#34;IndexMaster&#34;</span><span class="p">,</span><span class="n">tcRowId</span><span class="p">,</span><span class="n">orderNo</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(rangeDR) orgRes</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">rangeObj</span><span class="o">=</span><span class="c1">##Class(dbo.BTTestCodeRanges).%OpenId(rangeDR)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(rangeObj) orgRes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="n">res</span><span class="o">&gt;=</span><span class="n">rangeObj</span><span class="o">.</span><span class="n">ValueHigh</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="n">resPrefix</span><span class="o">=</span><span class="s2">&#34;&lt;&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Q</span> <span class="n">orgRes</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="s2">&#34;é˜³æ€§(&#34;</span><span class="n">_orgRes_</span><span class="s2">&#34;)&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="n">ELSE</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="n">resPrefix</span><span class="o">=</span><span class="s2">&#34;&gt;&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Q</span> <span class="n">orgRes</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="s2">&#34;é˜´æ€§(&#34;</span><span class="n">_orgRes_</span><span class="s2">&#34;)&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/assets/image-20250110220839-bac5x44.png"
	width="739"
	height="2110"
	srcset="/p/assets/image-20250110220839-bac5x44_hu_6dc426e318beae44.png 480w, /p/assets/image-20250110220839-bac5x44_hu_12e82eccffdfd945.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="35"
		data-flex-basis="84px"
	
></p>
<h4 id="å›ä¼ ä¸‰è¡Œ-dsp">å›ä¼ ä¸‰è¡Œ DSP
</h4><blockquote>
<p>åŒå‘è¦æ±‚å›ä¼ ä¸‰è¡Œ DSP ä¿¡æ¯ï¼ŒDSP1 ä¸ºæ‚£è€…ä¿¡æ¯ï¼ŒDSP2 ä¸ºæ ‡æœ¬ä¿¡æ¯ï¼ŒDSP3 ä¸ºæ£€æµ‹é¡¹ç›®ä¿¡æ¯ã€‚</p></blockquote>
<h5 id="ç¤ºä¾‹æ¥å£ç¾åº·ç”ŸåŒ–">ç¤ºä¾‹æ¥å£(ç¾åº·ç”ŸåŒ–)
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span><span class="lnt">513
</span><span class="lnt">514
</span><span class="lnt">515
</span><span class="lnt">516
</span><span class="lnt">517
</span><span class="lnt">518
</span><span class="lnt">519
</span><span class="lnt">520
</span><span class="lnt">521
</span><span class="lnt">522
</span><span class="lnt">523
</span><span class="lnt">524
</span><span class="lnt">525
</span><span class="lnt">526
</span><span class="lnt">527
</span><span class="lnt">528
</span><span class="lnt">529
</span><span class="lnt">530
</span><span class="lnt">531
</span><span class="lnt">532
</span><span class="lnt">533
</span><span class="lnt">534
</span><span class="lnt">535
</span><span class="lnt">536
</span><span class="lnt">537
</span><span class="lnt">538
</span><span class="lnt">539
</span><span class="lnt">540
</span><span class="lnt">541
</span><span class="lnt">542
</span><span class="lnt">543
</span><span class="lnt">544
</span><span class="lnt">545
</span><span class="lnt">546
</span><span class="lnt">547
</span><span class="lnt">548
</span><span class="lnt">549
</span><span class="lnt">550
</span><span class="lnt">551
</span><span class="lnt">552
</span><span class="lnt">553
</span><span class="lnt">554
</span><span class="lnt">555
</span><span class="lnt">556
</span><span class="lnt">557
</span><span class="lnt">558
</span><span class="lnt">559
</span><span class="lnt">560
</span><span class="lnt">561
</span><span class="lnt">562
</span><span class="lnt">563
</span><span class="lnt">564
</span><span class="lnt">565
</span><span class="lnt">566
</span><span class="lnt">567
</span><span class="lnt">568
</span><span class="lnt">569
</span><span class="lnt">570
</span><span class="lnt">571
</span><span class="lnt">572
</span><span class="lnt">573
</span><span class="lnt">574
</span><span class="lnt">575
</span><span class="lnt">576
</span><span class="lnt">577
</span><span class="lnt">578
</span><span class="lnt">579
</span><span class="lnt">580
</span><span class="lnt">581
</span><span class="lnt">582
</span><span class="lnt">583
</span><span class="lnt">584
</span><span class="lnt">585
</span><span class="lnt">586
</span><span class="lnt">587
</span><span class="lnt">588
</span><span class="lnt">589
</span><span class="lnt">590
</span><span class="lnt">591
</span><span class="lnt">592
</span><span class="lnt">593
</span><span class="lnt">594
</span><span class="lnt">595
</span><span class="lnt">596
</span><span class="lnt">597
</span><span class="lnt">598
</span><span class="lnt">599
</span><span class="lnt">600
</span><span class="lnt">601
</span><span class="lnt">602
</span><span class="lnt">603
</span><span class="lnt">604
</span><span class="lnt">605
</span><span class="lnt">606
</span><span class="lnt">607
</span><span class="lnt">608
</span><span class="lnt">609
</span><span class="lnt">610
</span><span class="lnt">611
</span><span class="lnt">612
</span><span class="lnt">613
</span><span class="lnt">614
</span><span class="lnt">615
</span><span class="lnt">616
</span><span class="lnt">617
</span><span class="lnt">618
</span><span class="lnt">619
</span><span class="lnt">620
</span><span class="lnt">621
</span><span class="lnt">622
</span><span class="lnt">623
</span><span class="lnt">624
</span><span class="lnt">625
</span><span class="lnt">626
</span><span class="lnt">627
</span><span class="lnt">628
</span><span class="lnt">629
</span><span class="lnt">630
</span><span class="lnt">631
</span><span class="lnt">632
</span><span class="lnt">633
</span><span class="lnt">634
</span><span class="lnt">635
</span><span class="lnt">636
</span><span class="lnt">637
</span><span class="lnt">638
</span><span class="lnt">639
</span><span class="lnt">640
</span><span class="lnt">641
</span><span class="lnt">642
</span><span class="lnt">643
</span><span class="lnt">644
</span><span class="lnt">645
</span><span class="lnt">646
</span><span class="lnt">647
</span><span class="lnt">648
</span><span class="lnt">649
</span><span class="lnt">650
</span><span class="lnt">651
</span><span class="lnt">652
</span><span class="lnt">653
</span><span class="lnt">654
</span><span class="lnt">655
</span><span class="lnt">656
</span><span class="lnt">657
</span><span class="lnt">658
</span><span class="lnt">659
</span><span class="lnt">660
</span><span class="lnt">661
</span><span class="lnt">662
</span><span class="lnt">663
</span><span class="lnt">664
</span><span class="lnt">665
</span><span class="lnt">666
</span><span class="lnt">667
</span><span class="lnt">668
</span><span class="lnt">669
</span><span class="lnt">670
</span><span class="lnt">671
</span><span class="lnt">672
</span><span class="lnt">673
</span><span class="lnt">674
</span><span class="lnt">675
</span><span class="lnt">676
</span><span class="lnt">677
</span><span class="lnt">678
</span><span class="lnt">679
</span><span class="lnt">680
</span><span class="lnt">681
</span><span class="lnt">682
</span><span class="lnt">683
</span><span class="lnt">684
</span><span class="lnt">685
</span><span class="lnt">686
</span><span class="lnt">687
</span><span class="lnt">688
</span><span class="lnt">689
</span><span class="lnt">690
</span><span class="lnt">691
</span><span class="lnt">692
</span><span class="lnt">693
</span><span class="lnt">694
</span><span class="lnt">695
</span><span class="lnt">696
</span><span class="lnt">697
</span><span class="lnt">698
</span><span class="lnt">699
</span><span class="lnt">700
</span><span class="lnt">701
</span><span class="lnt">702
</span><span class="lnt">703
</span><span class="lnt">704
</span><span class="lnt">705
</span><span class="lnt">706
</span><span class="lnt">707
</span><span class="lnt">708
</span><span class="lnt">709
</span><span class="lnt">710
</span><span class="lnt">711
</span><span class="lnt">712
</span><span class="lnt">713
</span><span class="lnt">714
</span><span class="lnt">715
</span><span class="lnt">716
</span><span class="lnt">717
</span><span class="lnt">718
</span><span class="lnt">719
</span><span class="lnt">720
</span><span class="lnt">721
</span><span class="lnt">722
</span><span class="lnt">723
</span><span class="lnt">724
</span><span class="lnt">725
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">MIFCL600OI</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">ä»ªå™¨åç§°</span><span class="p">:</span>	<span class="err">è¡€ç»†èƒåˆ†ææµæ°´çº¿</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">ä»ªå™¨å‹å·</span><span class="p">:</span>	<span class="err">è¿ˆç‘</span><span class="n">HL7</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">ä»ªå™¨å‚å•†</span><span class="p">:</span>	<span class="err">è¿ˆç‘</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">é€šä¿¡åè®®</span><span class="p">:</span>	<span class="n">HL7</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">äº¤äº’æ–¹å¼</span><span class="p">:</span>	<span class="err">åŒ</span> <span class="err">å‘</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">æ¥</span>    <span class="err">å£</span><span class="p">:</span>	<span class="n">TCP</span><span class="o">/</span><span class="ne">IP</span><span class="p">,</span><span class="n">RS232</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">å¤‡</span>    <span class="err">æ³¨</span><span class="p">:</span>	<span class="err">ä»ªå™¨é…ç½®</span><span class="p">:</span><span class="err">é€‰æ‹©</span><span class="n">HL7åè®®</span><span class="p">,</span><span class="err">æ•£ç‚¹å›¾é€‰æ‹©</span><span class="p">:</span><span class="err">ä½å›¾</span>   
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(mi)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">par11</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">12</span><span class="p">)</span> 		<span class="o">//</span><span class="err">é¡¹ç›®åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">par10</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">13</span><span class="p">)</span> 	<span class="o">//</span><span class="err">ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AntDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">14</span><span class="p">)</span> 		<span class="o">//</span><span class="err">æŠ—ç”Ÿç´ åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SenDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span> 		<span class="o">//</span><span class="err">è¯æ•ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">par4</span><span class="o">=</span><span class="s2">&#34;|TCP|&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>  	<span class="o">//</span><span class="err">ç«¯å£å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">stx</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">etx</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ack</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">enq</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">eot</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">etb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">lf</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">nak</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">21</span><span class="p">),(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">errFlag</span><span class="p">,</span><span class="n">resultType</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">ZT</span><span class="o">=</span><span class="s2">&#34;ErrHandler&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">EC</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">Start</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="ne">IP</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Port</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">LinkTime</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Device</span><span class="o">=</span><span class="s2">&#34;|TCP|&#34;</span><span class="n">_Port</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="p">;</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">ZA</span><span class="p">,</span><span class="s2">&#34;ZA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="err">æœªå¯åŠ¨å®¢æˆ·ç«¯</span><span class="o">/</span><span class="err">æœåŠ¡ç«¯</span><span class="mi">0</span><span class="err">ï¼Œå®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ ‡å¿—</span><span class="mi">20484</span><span class="err">ï¼Œæ— å®¢æˆ·ç«¯è¿æ¥</span><span class="mi">20480</span><span class="err">ï¼Œæœ‰å®¢æˆ·ç«¯è¿æ¥</span><span class="mi">28674</span><span class="err">ï¼Œè¿æ¥å¹¶å»ºç«‹æ•°æ®ä¼ è¾“</span><span class="mi">28672</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="n">lisæ–­å¼€</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="o">$</span><span class="n">ZA</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">h</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">				<span class="n">open</span> <span class="n">Device</span><span class="p">:(</span><span class="ne">IP</span><span class="p">:</span><span class="n">Port</span><span class="p">:</span><span class="o">/</span><span class="n">IOTABLE</span><span class="o">=</span><span class="s2">&#34;GB18030&#34;</span><span class="p">):</span><span class="mi">20</span>
</span></span><span class="line"><span class="cl">				<span class="n">use</span> <span class="n">Device</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;lisæ–­å¼€è¿æ¥&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;lisReConnect&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">throw</span> <span class="c1">##class(%Exception.General).%New(&#34;ConnectError&#34;,&#34;D&#34;,,&#34;é‡æ–°è¿æ¥å¤±è´¥&#34;)</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="err">ä»ªå™¨æ–­å¼€ï¼Œæˆ–è€…æ— æ•°æ®</span><span class="mi">1</span><span class="nb">min</span><span class="err">ï¼Œé‡å¯</span><span class="n">tcp</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="p">((</span><span class="o">$</span><span class="n">ZA</span><span class="o">=</span><span class="s2">&#34;20484&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">close</span> <span class="n">par4</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ä»ªå™¨æ–­å¼€è¿æ¥&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;blockConnect&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="n">h</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">				<span class="n">open</span> <span class="n">Device</span><span class="p">:(</span><span class="ne">IP</span><span class="p">:</span><span class="n">Port</span><span class="p">:</span><span class="o">/</span><span class="n">IOTABLE</span><span class="o">=</span><span class="s2">&#34;GB18030&#34;</span><span class="p">):</span><span class="mi">20</span>
</span></span><span class="line"><span class="cl">				<span class="n">use</span> <span class="n">Device</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;é‡æ–°è¿æ¥&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;reConnect&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="n">s</span> <span class="n">LinkTime</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">				<span class="k">continue</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="err">è¿æ¥æ— æ•°æ®ä¼ è¾“ï¼Œ</span><span class="n">mainæ¯æ‰§è¡Œ6æ¬¡</span><span class="err">ï¼Œå³</span><span class="mi">1</span><span class="nb">min</span><span class="err">ï¼Œé‡å¯</span><span class="n">tcp</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="o">$</span><span class="n">ZA</span><span class="o">=</span><span class="s2">&#34;28674&#34;</span> <span class="n">s</span> <span class="n">LinkTime</span><span class="o">=$</span><span class="n">i</span><span class="p">(</span><span class="n">LinkTime</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="err">æ­£å¸¸ä¼ è¾“äº†ï¼Œå°±æ¸…ç©ºè®¡æ•°</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="o">$</span><span class="n">ZA</span><span class="o">=</span><span class="s2">&#34;28672&#34;</span> <span class="n">s</span> <span class="n">LinkTime</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">			<span class="n">d</span> <span class="n">Main</span>
</span></span><span class="line"><span class="cl">	 	<span class="p">}</span><span class="n">catch</span> <span class="n">ex</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		 <span class="n">s</span> <span class="n">exception</span><span class="o">=</span><span class="s2">&#34;é”™è¯¯:&#34;</span><span class="n">_ex</span><span class="o">.</span><span class="n">Location_</span><span class="s2">&#34;^&#34;</span><span class="n">_ex</span><span class="o">.</span><span class="n">Data_ex</span><span class="o">.</span><span class="n">Name</span>
</span></span><span class="line"><span class="cl">		 <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">exception</span><span class="p">,</span><span class="s2">&#34;è¯»å–æˆ–å†™å…¥å¼‚å¸¸ï¼Œé‡å¯æœåŠ¡ç«¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 	<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span> <span class="n">par4</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Main</span>
</span></span><span class="line"><span class="cl">	<span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$TEST	//å¦‚æœè¶…æ—¶åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=sb   //ä»¥sbå¼€å¤´</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">errFlag</span><span class="p">,</span><span class="n">resultType</span><span class="p">,</span><span class="n">msgType</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="n">mshStr</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">startTime</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">PLIST</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">curTime</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="n">curTime</span><span class="o">&gt;</span><span class="p">(</span><span class="n">startTime</span><span class="o">+</span><span class="mi">300</span><span class="p">)</span>  <span class="o">//</span><span class="mi">5</span><span class="err">åˆ†é’Ÿå†…æ²¡æœ‰å¤„ç†å®Œåˆ™é€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$TEST	//å¦‚æœè¶…æ—¶åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span><span class="o">&gt;=</span><span class="mi">32700</span> <span class="p">{</span>  <span class="o">//</span><span class="mi">32767</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">index</span><span class="o">=+$</span><span class="n">O</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=eb,$C(R)&#39;</span><span class="o">=</span><span class="n">cr</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">))</span><span class="n">_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">cr</span> <span class="p">{</span>  	<span class="o">//</span><span class="err">è§£æä¸€æ¡è®°å½•</span>
</span></span><span class="line"><span class="cl">			<span class="n">D</span> <span class="n">Record</span>
</span></span><span class="line"><span class="cl">			<span class="n">K</span> <span class="n">PLIST</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eb</span>   	<span class="o">//</span><span class="err">å¾ªç¯è¯»å–</span><span class="p">,</span><span class="err">å½“ä¸º</span><span class="n">ebçš„æ—¶å€™åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="s2">&#34;result&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">Save</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Record</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">base64Stream</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">isImage</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">isBinary</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">OldgraphDataDIFF</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">index</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(index)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">record</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span><span class="n">cr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Continue</span><span class="p">:</span><span class="s1">&#39;$L(record)</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">segmentType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;MSH&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä¿¡æ¯å¤´ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">mshStr</span><span class="o">=</span><span class="n">record</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="err">æ¶ˆæ¯ç±»å‹</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">msgType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="o">//</span><span class="n">ORU</span><span class="p">,</span><span class="n">ACK</span><span class="p">,</span><span class="n">QRY</span><span class="p">,</span><span class="n">QCK</span><span class="p">,</span><span class="n">DSR</span>
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">msgType</span><span class="o">=</span><span class="s2">&#34;ORU&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">D</span> <span class="n">SendACK</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    		<span class="n">I</span> <span class="n">msgType</span><span class="o">=</span><span class="s2">&#34;ORM&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    		<span class="n">S</span> <span class="n">resultType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;PID&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">æ‚£è€…ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;PVI&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">å°±è¯Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;OBR&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">åŒ»å˜±ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">epis</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    			<span class="n">S</span><span class="p">:</span><span class="s1">&#39;$l(epis) epis=$P(record,&#34;|&#34;,3)</span>
</span></span><span class="line"><span class="cl">	     		<span class="n">S</span> <span class="n">code</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	     		<span class="n">I</span> <span class="n">code</span><span class="o">=</span><span class="s2">&#34;00003&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="n">LJ</span> <span class="n">QCR</span>
</span></span><span class="line"><span class="cl">		     	
</span></span><span class="line"><span class="cl">		     	<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;OBX&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">dataTye</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>  <span class="o">//</span><span class="n">NM</span> <span class="p">(</span><span class="n">numeric</span><span class="p">)</span> <span class="err">è¡¨ç¤ºæ•°å­—å€¼ï¼Œç”¨äºå®šé‡é¡¹ç›®</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     										<span class="o">//</span><span class="n">ST</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="err">è¡¨ç¤ºå­—ç¬¦ä¸²å€¼ï¼Œç”¨äºå®šæ€§é¡¹ç›®</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">channel</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">channel</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="o">//</span><span class="n">s</span><span class="p">:</span><span class="s1">&#39;$l(channel) channel=$P(record,&#34;|&#34;,5)</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">value</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="n">i</span> <span class="n">value</span><span class="p">[</span><span class="s2">&#34;&lt;&#34;</span> <span class="n">s</span> <span class="n">value</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;&lt;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="n">i</span> <span class="n">value</span><span class="p">[</span><span class="s2">&#34;&gt;&#34;</span> <span class="n">s</span> <span class="n">value</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;&gt;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;SI&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="n">value</span><span class="o">=</span><span class="err">æµŠåº¦</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">^</span><span class="err">æº¶è¡€</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">^</span><span class="err">é»„ç–¸</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel_</span><span class="s2">&#34;H&#34;</span><span class="n">_par10_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_par11</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel_</span><span class="s2">&#34;I&#34;</span><span class="n">_par10_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="n">_par11</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">value</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;ST&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    				<span class="n">S</span> <span class="n">value</span><span class="o">=$</span><span class="n">S</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&#34;Ã²?D?&#34;</span><span class="p">:</span><span class="s2">&#34;é˜´æ€§&#34;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s2">&#34;??D?&#34;</span><span class="p">:</span><span class="s2">&#34;é˜³æ€§&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span><span class="n">dataTye</span><span class="s1">&#39;=&#34;ED&#34;,dataTye&#39;</span><span class="o">=</span><span class="s2">&#34;IS&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel_par10_value_par11</span>
</span></span><span class="line"><span class="cl">    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;IS&#34;</span> <span class="p">{</span>	  
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;05001&#34;</span><span class="p">,</span><span class="n">resultType</span><span class="o">=</span><span class="s2">&#34;Q&#34;</span> <span class="p">{</span>		<span class="o">//</span><span class="err">è´¨æ§æµ“åº¦</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">S</span> <span class="n">epis</span><span class="o">=</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">		    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">graphTypeDesc</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34;U&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;ED&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">å›¾å½¢æ•°æ®</span>
</span></span><span class="line"><span class="cl">    				<span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Image&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">isImage</span><span class="o">=</span><span class="mi">1</span>  	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Octer-stream&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">S</span> <span class="n">isBinary</span><span class="o">=</span><span class="mi">1</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span><span class="p">(</span><span class="err">éœ€è¦ç»˜å›¾</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="n">channel</span>
</span></span><span class="line"><span class="cl">    				<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15050&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RBC&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15056&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RBC&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15100&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;PLT&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15116&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;PLT&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15200&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFFBMP&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15201&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFF&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">					<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15202&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFF&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15250&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;BASOBMP&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15251&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;BASO&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15300&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RET&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15306&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RET&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15301&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;PLT-0&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15302&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RET-EXT&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15350&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;NRBC&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15354&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;NRBC&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">graphData</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    		
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">graphDataType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">graphDataType</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Base64&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">graphType</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;RBC&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;RBC&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;Histogram#RBC#RBC######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RBC#RBC######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">mi</span><span class="p">),</span><span class="s2">&#34;ç»˜å›¾ï¼šRBC&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;PLT&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;PLT&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;Histogram#PLT#PLT######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#PLT#RBC######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">mi</span><span class="p">),</span><span class="s2">&#34;ç»˜å›¾ï¼šPLT&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;WBC&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="n">OldgraphDataDIFF</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">						<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;WBC-DIFF&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#DIFF#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#DIFF#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">mi</span><span class="p">),</span><span class="s2">&#34;ç»˜å›¾ï¼šwbc&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;WNB&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#WNB#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#Baso#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;ORC&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">å°±è¯Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">barcode</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="n">barcode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">barcode</span><span class="p">)</span> <span class="p">{</span>  <span class="o">//</span><span class="err">åŒå‘</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="p">}</span> <span class="n">Invalid</span> <span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span> <span class="n">SendORR</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">barcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;QRD&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">å°±è¯Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">barcode</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="n">s</span> <span class="n">qrdStr</span><span class="o">=</span><span class="n">record</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="n">barcode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">barcode</span><span class="p">)</span> <span class="p">{</span>  <span class="o">//</span><span class="err">åŒå‘</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="p">}</span> <span class="n">Invalid</span> <span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="n">barcode</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;QRF&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">å°±è¯Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				<span class="p">;</span><span class="n">S</span> <span class="n">barcode</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="n">s</span> <span class="n">qrfStr</span><span class="o">=</span><span class="n">record</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="n">barcode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">barcode</span><span class="p">)</span> <span class="p">{</span>  <span class="o">//</span><span class="err">åŒå‘</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="p">}</span> <span class="n">Invalid</span> <span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="n">barcode</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span> <span class="n">SendDSP</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="n">barcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="o">//</span><span class="n">I</span> <span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;ED&#34;</span><span class="p">,</span><span class="n">index</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">base64Stream</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="n">D</span> <span class="n">base64Stream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="n">i</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFFBMP&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//.</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;WBC-DIFF&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">OldgraphDataDIFF</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFBC6800BI&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#DIFF#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//</span><span class="n">i</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;BASOBMP&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//.</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">OldgraphDataBaso</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFBC6800BI&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#Baso#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="n">s</span> <span class="n">miCode</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//</span><span class="n">i</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFF&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">			<span class="o">//.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">miCode_</span><span class="s2">&#34;:&#34;</span><span class="n">_epis_</span><span class="s2">&#34;:&#34;</span><span class="n">_graphType</span><span class="p">,</span><span class="s2">&#34;SaveImage&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.Common.MIFBase).SaveBase64ToMachine(mi,epis,graphType,base64Stream,epis_&#34;-&#34;_graphType,miCode)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="o">//</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">D</span> <span class="n">SendDSP</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIFMEIKANG</span><span class="p">(</span><span class="mi">63</span><span class="p">,</span><span class="s2">&#34;MSH|^~\&amp;|HOST|Unkownâ–¡Device|FMIS||20240410153949||QRY^Q02|2|P|2.3.1||||0||ANSI||&#34;</span><span class="p">,</span><span class="s2">&#34;QRD|20240410153949|BC|D|0|||RD|1000860681||Rack^Pos|N|T&#34;</span><span class="p">,</span><span class="s2">&#34;QRF|Unkownâ–¡Device|20240410000000|20240410235959|||RCT|COR|ALL|&#34;</span><span class="p">,</span><span class="s2">&#34;1000860681&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">SendDSP</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="n">barcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="n">barcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">barcode</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">barcode</span><span class="p">),</span><span class="n">qrdStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">qrdStr</span><span class="p">),</span><span class="n">qrfStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">qrfStr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;å¼€å§‹ä¸Šä¼ &#34;</span><span class="p">,</span><span class="s2">&#34;Upload&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;Upload&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">qrdStr</span><span class="p">,</span><span class="s2">&#34;Upload&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">qrfStr</span><span class="p">,</span><span class="s2">&#34;Upload&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="p">;</span><span class="n">a102</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(barcode) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç å·ä¸ºç©º&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>   
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>             <span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«æé”™è¯¯,æœºå™¨æœªè¯†åˆ«&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> 
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">labno</span><span class="o">=</span><span class="n">barcode</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">workGroupMachineDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">visiNumberDR</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(visiNumberDR) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„æ ‡æœ¬ä¿¡æ¯,ç¡®å®šæ¡ç æ­£ç¡®æˆ–æ ‡æœ¬å·²ç»æ¥æ”¶?&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">visNumberObj</span><span class="o">=</span><span class="c1">##Class(dbo.RPVisitNumber).%OpenId(visiNumberDR)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="s1">&#39;$L(visNumberObj) {</span>
</span></span><span class="line"><span class="cl">        <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„æ ‡æœ¬ä¿¡æ¯,ç¡®å®šæ¡ç æ­£ç¡®æˆ–æ ‡æœ¬å·²ç»æ¥æ”¶?&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="s2">&#34;Upload Start&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">chlStr</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">chlCnt</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chl</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(chl)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlStr</span><span class="o">=</span><span class="n">chlStr_chl_</span><span class="s2">&#34;^&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlCnt</span><span class="o">=</span><span class="n">chlCnt</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="p">;</span><span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="n">result_chl_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;?&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">I</span> <span class="s1">&#39;$L(chlStr) {</span>
</span></span><span class="line"><span class="cl">	 	<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„åŒ–éªŒé¡¹ç›®ä¿¡æ¯,ç¡®å®šåŒ»å˜±æˆ–é¡¹ç›®ç»´æŠ¤æ­£ç¡®?&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">chlStr</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="n">chlStr</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">chlStr</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">*-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">/*</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chl</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(chl)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlStr</span><span class="o">=</span><span class="n">chlStr_</span><span class="s2">&#34;DSP|&#34;</span><span class="n">_chlCnt_</span><span class="s2">&#34;||&#34;</span><span class="n">_chl_</span><span class="s2">&#34;^^^|||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlCnt</span><span class="o">=</span><span class="n">chlCnt</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="p">;</span><span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="n">result_chl_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;?&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">I</span> <span class="s1">&#39;$L(chlStr) {</span>
</span></span><span class="line"><span class="cl">	 	<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_labno_</span><span class="s2">&#34;å¯¹åº”çš„åŒ–éªŒé¡¹ç›®ä¿¡æ¯,ç¡®å®šåŒ»å˜±æˆ–é¡¹ç›®ç»´æŠ¤æ­£ç¡®?&#34;</span><span class="p">,</span><span class="s2">&#34;Upload Error&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">        <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">*/</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">specimenDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">visiNumberDR</span><span class="p">)),</span><span class="mi">56</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">specimenName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">specimenDR</span><span class="p">)</span> <span class="n">specimenName</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpecimenD</span><span class="p">(</span><span class="n">specimenDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">sampleType</span><span class="o">=</span><span class="s2">&#34;å…¶ä»–&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">specimenName</span><span class="p">),</span><span class="s2">&#34;,è¡€æ¸…,è¡€æµ†,å°¿æ¶²,è„‘è„Šæ¶²,&#34;</span><span class="p">[(</span><span class="s2">&#34;,&#34;</span><span class="n">_specimenName_</span><span class="s2">&#34;,&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">sampleType</span><span class="o">=</span><span class="n">specimenName</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">birdthday</span><span class="o">=</span><span class="n">visNumberObj</span><span class="o">.</span><span class="n">BirthDate</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">birdthday</span><span class="p">)</span><span class="o">=</span><span class="mi">8</span> <span class="n">birdthday</span><span class="o">=</span><span class="n">birdthday_</span><span class="s2">&#34;000000&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="s1">&#39;$L(mshStr) mshStr=&#34;MSH|^~\&amp;|YHLO|iFlash3000|||20161208150935||QRY^Q02|18|P|2.3.1||||||ASCII|||&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshSeq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;DSR^Q03&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS|||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">episode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">workGroupMachineDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span> <span class="o">//</span><span class="c1">##Class(MI.Instrument).GetWorkGroupMachineRowId(mi)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">workGroupMachineDR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">S</span> <span class="n">OrderNo</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">visiNumberDR</span><span class="p">,</span><span class="n">workGroupMachineDR</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">OrderNo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    	<span class="n">S</span> <span class="n">reportDR</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">visiNumberDR</span><span class="p">,</span><span class="n">workGroupMachineDR</span><span class="p">,</span><span class="n">OrderNo</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	    	<span class="n">S</span> <span class="n">episode</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="o">//</span><span class="c1">##Class(LIS.Core.Report).GetEpisodeNumber(reportDR)</span>
</span></span><span class="line"><span class="cl">	    	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">reportDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Assayno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">reportDR</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Date</span><span class="o">=$</span><span class="n">h</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">datetime</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">Date</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>	<span class="o">//</span><span class="err">æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">JZHWZ</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">qrdStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>		<span class="o">//</span><span class="err">æ¶å­å·ä½ç½®</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">mshStr_cr</span> <span class="o">//</span><span class="s2">&#34;MSH|^~\&amp;|||||20160122110540||DSR^Q03|14|P|2.3.1||||||ASCII|||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;MSA|OK|&#34;</span><span class="n">_mshSeq_</span><span class="s2">&#34;||||0&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|1||&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">RegNo_</span><span class="s2">&#34;|&#34;</span><span class="n">_episode_</span><span class="s2">&#34;|&#34;</span><span class="n">_visNumberObj</span><span class="o">.</span><span class="n">SurName_</span><span class="s2">&#34;|||||||||||||||||||||||||&#34;</span><span class="n">_cr</span>	
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|2|&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;|&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;||N||&#34;</span><span class="n">_datetime_</span><span class="s2">&#34;||1|&#34;</span><span class="n">_JZHWZ_</span><span class="s2">&#34;||N||&#34;</span><span class="n">_datetime_</span><span class="s2">&#34;||||||||&#34;</span><span class="n">_datetime_</span><span class="s2">&#34;||||||||||||||||||||||||&#34;</span><span class="n">_cr</span>	
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">order</span><span class="o">=</span><span class="n">order_</span><span class="s2">&#34;DSP|3|&#34;</span><span class="n">_chlCnt_</span><span class="s2">&#34;|&#34;</span><span class="n">_chlStr_cr</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">order</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="p">;</span><span class="n">a101</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">sb_order_eb_cr</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="o">//$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZDT</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s2">&#34; :&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">Save</span>  
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;^&#34;</span><span class="n">_result</span><span class="p">,</span><span class="s2">&#34;Test&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  	<span class="n">I</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	  	<span class="n">S</span> <span class="n">QC</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  		<span class="n">D</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  	<span class="p">}</span>
</span></span><span class="line"><span class="cl">  	<span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">resultType</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  	<span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">SendACK</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="n">errCode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">errDesc</span><span class="o">=</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">)</span> <span class="o">//</span><span class="n">send</span> <span class="s1">&#39;ack&#39;</span> <span class="n">to</span> <span class="n">instrument</span> 
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">ackType</span><span class="p">,</span><span class="n">errCode</span><span class="p">,</span><span class="n">errDesc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">ackType</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ackType</span><span class="p">),</span><span class="n">errCode</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">errCode</span><span class="p">),</span><span class="n">errDesc</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">errDesc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:(</span><span class="s1">&#39;$l(mi))||(&#39;</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">21</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">msgRoutine</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">seq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS|||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;ACK^&#34;</span><span class="n">_msgRoutine</span>
</span></span><span class="line"><span class="cl">    <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;MSA|&#34;</span><span class="n">_ackType_</span><span class="s2">&#34;|&#34;</span><span class="n">_seq_</span><span class="s2">&#34;|&#34;</span><span class="n">_errDesc_</span><span class="s2">&#34;|||&#34;</span><span class="n">_errCode_</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">S</span><span class="p">(</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AE&#34;</span><span class="p">:</span><span class="s2">&#34;Error&#34;</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;NULL&#34;</span><span class="p">),</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">ErrHandler</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZERROR</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="s2">&#34;--&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;.é”™è¯¯ä»£ç :&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ECODE</span><span class="p">,</span><span class="s2">&#34;Runtime Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">h</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">ä¿å­˜ç›´æ–¹å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">SaveHistogram</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">graphType</span><span class="p">,</span><span class="n">graphOrder</span><span class="p">,</span><span class="n">base64Stream</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">graphType</span><span class="p">,</span><span class="n">graphOrder</span><span class="p">,</span><span class="n">base64Stream</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">epis</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="n">graphType</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">graphType</span><span class="p">),</span><span class="n">graphOrder</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">graphOrder</span><span class="p">),</span><span class="n">base64Stream</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">base64Stream</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(mi) 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(epis) 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(base64Stream) 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(graphType) 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span><span class="p">:</span><span class="s1">&#39;$L(graphOrder) graphOrder=0</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">glBinaryStream</span><span class="o">=</span><span class="c1">##Class(%GlobalBinaryStream).%New()</span>
</span></span><span class="line"><span class="cl">    <span class="n">While</span> <span class="s1">&#39;base64Stream.AtEnd {</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">base64</span><span class="o">=</span><span class="n">base64Stream</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">binary</span><span class="o">=$</span><span class="n">system</span><span class="o">.</span><span class="n">Encryption</span><span class="o">.</span><span class="n">Base64Decode</span><span class="p">(</span><span class="n">base64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="n">D</span> <span class="n">glBinaryStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">charStream</span><span class="o">=</span><span class="c1">##Class(%GlobalCharacterStream).%New()</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">maxDot</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">While</span> <span class="s1">&#39;glBinaryStream.AtEnd {</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">char</span><span class="o">=</span><span class="n">glBinaryStream</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">ascValue</span><span class="o">=$</span><span class="n">ASCII</span><span class="p">(</span><span class="n">char</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">maxDot</span><span class="o">=</span><span class="n">maxDot</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	    <span class="n">D</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">ascValue</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">glBinaryStream</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">title</span><span class="o">=</span><span class="n">graphType</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">foreColor</span><span class="o">=</span><span class="mi">12</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;PLT&#34;</span> <span class="n">foreColor</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">top</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">left</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">width</span><span class="o">=</span><span class="mi">300</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">maxValue</span><span class="p">,</span><span class="n">memo</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">error</span><span class="o">=</span><span class="c1">##Class(MI.Instrument).SaveHistogram(charStream,mi,epis,graphType,graphOrder,label,title,maxDot,maxValue,memo,foreColor,top,left,width,height)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="s2">&#34;--&#34;</span><span class="p">),</span><span class="s2">&#34;Graph Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="n">charStream</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">SendORR</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span> <span class="n">AckType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="n">ErrCode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ErrDesc</span><span class="o">=</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="n">AckType</span><span class="p">,</span><span class="n">ErrCode</span><span class="p">,</span><span class="n">ErrDesc</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">record</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">record</span><span class="p">),</span><span class="n">AckType</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">AckType</span><span class="p">),</span><span class="n">ErrCode</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ErrCode</span><span class="p">),</span><span class="n">ErrDesc</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ErrDesc</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">epis</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">Q</span><span class="p">:(</span><span class="s1">&#39;$l(mi))||(&#39;</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">seq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS||||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">   	 <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;ORR^O02&#34;</span>
</span></span><span class="line"><span class="cl">   	 <span class="n">s</span> <span class="n">isRecieve</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">   	 <span class="n">s</span> <span class="n">wgDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">   	 <span class="n">s</span> <span class="n">wgDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="o">//&amp;</span><span class="n">sql</span><span class="p">(</span><span class="n">SELECT</span> <span class="n">EpisodeNo</span> <span class="n">into</span> <span class="p">:</span><span class="n">isRecieve</span> <span class="n">FROM</span> <span class="n">dbo</span><span class="o">.</span><span class="n">RP_VisitNumberReport</span> <span class="n">where</span> <span class="n">AssayNo</span><span class="o">=</span><span class="p">:</span><span class="n">epis</span> <span class="ow">and</span> <span class="n">WorkGroupMachineDR</span><span class="o">=</span><span class="p">:</span><span class="n">wgDR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">isRecieve</span><span class="o">=</span><span class="n">epis</span> <span class="o">//</span><span class="c1">##class(HIS.DHCReportPrint).GetReportAssayNoMTHD(mi,epis)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">MSACode</span><span class="o">=</span><span class="n">seq</span>
</span></span><span class="line"><span class="cl">	 <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">isRecieve</span><span class="p">,</span><span class="s2">&#34;isRecieve is &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="p">(</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">isRecieve</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="p">{</span>
</span></span><span class="line"><span class="cl">		 <span class="n">s</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		 <span class="n">s</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">MSA</span><span class="o">=</span><span class="s2">&#34;MSA|&#34;</span><span class="n">_flag_</span><span class="s2">&#34;|&#34;</span><span class="n">_MSACode</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		 <span class="n">S</span> <span class="n">TMPCORDE</span><span class="o">=</span><span class="n">sb_mshStr_cr_MSA_cr_eb_cr</span>
</span></span><span class="line"><span class="cl">		 <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">MSA</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">		 <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">TMPCORDE</span><span class="p">,</span><span class="s2">&#34;H-&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PatInfomation</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PatInfomation</span><span class="o">=$$</span><span class="n">GetPatInfo</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;PatInfomation is&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="p">(</span><span class="n">RegNo</span><span class="p">,</span><span class="n">Name</span><span class="p">,</span><span class="n">Birth</span><span class="p">,</span><span class="n">Species</span><span class="p">,</span><span class="n">PatType</span><span class="p">,</span><span class="n">LOC</span><span class="p">,</span><span class="n">BedNo</span><span class="p">,</span><span class="n">Fee</span><span class="p">,</span><span class="n">Srcdocno</span><span class="p">,</span><span class="n">PatAge</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="k">if</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">RegNo</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Name</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Birth</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">29</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;1&#34;</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;Male&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;2&#34;</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;Fmale&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PatType</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">LOC</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Fee</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Srcdocno</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PatAge</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PID</span><span class="o">=</span><span class="s2">&#34;PID|1||&#34;</span><span class="n">_RegNo_</span><span class="s2">&#34;^^^^MR||&#34;</span><span class="n">_Name_</span><span class="s2">&#34;||&#34;</span><span class="n">_Birth_</span><span class="s2">&#34;|&#34;</span><span class="n">_Species</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PV1</span><span class="o">=</span><span class="s2">&#34;PV1|1|&#34;</span><span class="n">_PatType_</span><span class="s2">&#34;|&#34;</span><span class="n">_LOC_</span><span class="s2">&#34;^^&#34;</span><span class="n">_BedNo_</span><span class="s2">&#34;|||||||||||||||||&#34;</span><span class="n">_Fee</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">ORC</span><span class="o">=</span><span class="s2">&#34;ORC|AF||&#34;</span><span class="n">_epis</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">curTime</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">randomNumber</span><span class="o">=</span><span class="mi">1000</span><span class="o">+$</span><span class="n">r</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">OBR</span><span class="o">=</span><span class="s2">&#34;OBR|1|&#34;</span><span class="n">_epis_</span><span class="s2">&#34;||00001^Automated Count^99MRC||&#34;</span><span class="n">_curTime_randomNumber_</span><span class="s2">&#34;||||&#34;</span><span class="n">_Srcdocno_</span><span class="s2">&#34;||||||||||||||HM||||||||Bill&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">TestCodeDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">TestCodeDate</span><span class="o">=$$</span><span class="n">SearchTestItem</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">OBX</span><span class="o">=</span><span class="s2">&#34;OBX|1|IS|08003^Test Mode^99MRC||&#34;</span><span class="n">_TestCodeDate_</span><span class="s2">&#34;||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|2|IS|01002^Ref Group^99MRC||Child||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|3|NM|30525-0^Age^LN||&#34;</span><span class="n">_PatAge_</span><span class="s2">&#34;|yr|||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|4|ST|01001^Remark^99MRC||&#34;</span><span class="n">_PatType_</span><span class="s2">&#34;||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|5|ST|08005^SerialNumber^99MRC||&#34;</span><span class="n">_isRecieve_</span><span class="s2">&#34;||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|6|IS|01007^Sample Type^99MRC||Venous blood||||||&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|7|IS|01008^Patient Area^99MRC||A - 501||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|8|ST|01009^Custom patient info 1^99MRC||Nothing||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|9|ST|01010^Custom patient info 2^99MRC||Nothing||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|10|ST|01011^Custom patient info 3^99MRC||Nothing||||||F&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">TMPORDER</span><span class="o">=</span><span class="n">sb_mshStr_cr_MSA_cr_PID_cr_PV1_cr_ORC_cr_OBR_cr_OBX_cr_eb_cr</span>
</span></span><span class="line"><span class="cl">		<span class="n">w</span> <span class="n">sb</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">MSA</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">PID</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">PV1</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">ORC</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">OBR</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">OBX</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">TMPORDER</span><span class="p">,</span><span class="s2">&#34;H-&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="n">SearchTestItem</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">tc</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  	<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">	   <span class="n">f</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	 	<span class="n">s</span> <span class="n">tc</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">tc</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	 	 <span class="n">q</span><span class="p">:</span><span class="n">tc</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	 	 <span class="n">i</span> <span class="s1">&#39;$l(tcx){</span>
</span></span><span class="line"><span class="cl">		 	<span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tc</span> 
</span></span><span class="line"><span class="cl">	 	 <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_</span><span class="s2">&#34;+&#34;</span><span class="n">_tc</span>
</span></span><span class="line"><span class="cl">	 	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">  	<span class="p">}</span>
</span></span><span class="line"><span class="cl">  	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="n">tcx</span>
</span></span><span class="line"><span class="cl"><span class="n">GetPatInfo</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">labno</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">VisitNumberDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="n">_labno</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ ‡æœ¬ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RPVisitNumberData</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">LocationDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span><span class="n">Location</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Location</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">DoctorDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span><span class="n">Doctor</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Doctor</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTDoctorD</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ReceiveDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ReceiveTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">67</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ReceiveUserDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">68</span><span class="p">),</span><span class="n">ReceiveUser</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">ReceiveUser</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">SYSUserD</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RegNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SurName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">GivenName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">SurName</span><span class="o">=</span><span class="n">GivenName</span> <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName</span>
</span></span><span class="line"><span class="cl">	<span class="n">e</span>  <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName_GivenName</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SpeciesDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Species</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AdmTypeDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">AdmType</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AdmType</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAdmissionTypeD</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">BirthDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AgeUnitDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">19</span><span class="p">),</span><span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAgeUnitD</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">CollectDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">51</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">CollectTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Diagnose</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Sampleda</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s2">&#34;XN&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">s</span> <span class="n">Instrument</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">22</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Sampleno</span><span class="o">=</span><span class="n">labno</span>   <span class="o">//</span><span class="err">æ£€æµ‹å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Sampletype</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">Feetype</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">;</span><span class="err">è´¹åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Srcdepno</span><span class="o">=</span><span class="n">Location</span>  <span class="p">;</span><span class="err">é€æ£€ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Srcdocno</span><span class="o">=</span><span class="n">Doctor</span>   <span class="p">;</span><span class="err">é€æ£€åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Userno</span><span class="o">=</span><span class="n">ReceiveUser</span> <span class="p">;</span><span class="err">æ£€éªŒåŒ»ç”Ÿ</span><span class="p">(</span><span class="err">å½•å…¥è€…</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Patno</span><span class="o">=</span><span class="n">RegNo</span> <span class="p">;</span><span class="err">ç™»è®°å·</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">BarCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Patna</span><span class="o">=</span><span class="n">PatName</span>   <span class="p">;</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="mi">1</span>  <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;ç”·&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>     <span class="p">;</span><span class="mi">1</span><span class="p">:</span><span class="err">ç”·</span> <span class="err">ï¼Œ</span><span class="mi">2</span> <span class="err">å¥³</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">Species</span> <span class="o">=</span><span class="s2">&#34;å¥³&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Pattype</span><span class="o">=</span><span class="n">AdmType</span>   <span class="p">;</span><span class="err">ç—…äººç±»å‹</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Bedno</span> <span class="o">=</span> <span class="n">BedNo</span>    <span class="p">;</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Patage</span><span class="o">=</span><span class="n">Age</span>  <span class="p">;</span><span class="err">å¹´é¾„</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Ageunit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å¹´é¾„å•ä½</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Reqno</span><span class="o">=</span><span class="n">labno</span>  <span class="p">;</span><span class="err">ç”³è¯·å·</span> <span class="o">=</span> <span class="err">æ£€éªŒå·</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Reqda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Reqda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">ReceiveTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span><span class="err">é€æ£€æ—¥æœŸ</span> <span class="o">=</span> <span class="err">æ¥æ”¶æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Reportda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">æŠ¥å‘Šæ—¥æœŸ</span>  <span class="o">=</span> <span class="err">åˆå®¡</span><span class="p">(</span><span class="err">ä¿å­˜ç»“æœ</span><span class="p">)</span><span class="err">æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Printflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">æ‰“å°æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Resultflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç»“æœæ ‡å¿—</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Errflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">é”™è¯¯æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Diagnose</span> <span class="o">=</span> <span class="n">Diagnose</span>   <span class="p">;</span><span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Description</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">å¤‡æ³¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Reserve</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ä¿ç•™å­—æ®µ</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Patnamn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å§“åæ‹¼éŸ³ç </span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Getda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">CollectTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">e</span>  <span class="n">s</span> <span class="n">Getda</span><span class="o">=</span><span class="n">Reqda</span> <span class="p">;</span><span class="err">æ¥æ”¶æ—¶é—´</span><span class="o">/</span><span class="err">é‡‡æ ·æ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Wardno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç—…åŒº</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">EpisodeNo</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Diagnose</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">Sampleda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Instrument_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampleno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampletype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Feetype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdepno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdocno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Userno_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patna_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sex_</span><span class="s2">&#34;,&#34;</span><span class="n">_Pattype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Bedno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patage_</span><span class="s2">&#34;,&#34;</span><span class="n">_Ageunit_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqda_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Reportda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Printflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Resultflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Errflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Diagnose_</span><span class="s2">&#34;,&#34;</span><span class="n">_Description_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reserve_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patnamn_</span><span class="s2">&#34;,&#34;</span><span class="n">_Getda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Wardno_</span><span class="s2">&#34;,&#34;</span><span class="n">_BarCode_</span><span class="s2">&#34;,&#34;</span><span class="n">_BirthDate_</span><span class="s2">&#34;,&#34;</span><span class="n">_EpisodeNo</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">RetString</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">åŒå‘ä¸Šä¼ åŒ»å˜±ä¿¡æ¯</span><span class="p">,</span><span class="n">wwh</span><span class="p">,</span><span class="mi">2015</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">05</span><span class="p">,</span><span class="err">æœªæµ‹è¯•</span>
</span></span><span class="line"><span class="cl"><span class="n">SendOrder</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">record</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">record</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">record</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(mi) 1</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$D(^TMIF(mi)) 1</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">barcode</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="s1">&#39;$L(barcode) {</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç å·ä¸ºç©º&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>				<span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«æé”™è¯¯,æœºå™¨æœªè¯†åˆ«&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="s1">&#39;$D(^TEPI(barcode)) {</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;å¯¹åº”çš„æ ‡æœ¬ä¿¡æ¯,ç¡®å®šæ¡ç æ­£ç¡®æˆ–æ ‡æœ¬å·²ç»æ¥æ”¶?&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">uploadList</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tsCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">uploadList</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">tsCode</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tsCode</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(tsCode)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$D(^TMIF(mi,0,tsCode))</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">tsDesc</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TTAB</span><span class="p">(</span><span class="s2">&#34;TS&#34;</span><span class="p">,</span><span class="n">tsCode</span><span class="p">)),</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,1)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">tsCnt</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tsCode</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(tsCnt)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">status</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tsCode</span><span class="p">,</span><span class="n">tsCnt</span><span class="p">)),</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,31)</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="n">status</span><span class="o">=</span><span class="s2">&#34;A&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«:&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;,åŒ»å˜±:&#34;</span><span class="n">_tsCode_</span><span class="s2">&#34;||&#34;</span><span class="n">_tsDesc_</span><span class="s2">&#34;,ä¸æ˜¯ç™»è®°çŠ¶æ€,ä¸å†ä¸Šä¼ &#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>	
</span></span><span class="line"><span class="cl">			<span class="n">Continue</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">channel</span><span class="o">=$$</span><span class="n">GetTestSetChannel</span><span class="p">(</span><span class="n">tsCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="s1">&#39;$L(channel) {</span>
</span></span><span class="line"><span class="cl">			<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«:&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;,åŒ»å˜±:&#34;</span><span class="n">_tsCode_</span><span class="s2">&#34;||&#34;</span><span class="n">_tsDesc_</span><span class="s2">&#34;,æœªæ‰¾åˆ°é€šé“å·&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>	
</span></span><span class="line"><span class="cl">			<span class="n">Continue</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">Continue</span><span class="p">:</span><span class="o">$</span><span class="n">D</span><span class="p">(</span><span class="n">uploadList</span><span class="p">(</span><span class="n">tsCode</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">uploadList</span><span class="p">(</span><span class="n">tsCode</span><span class="p">)</span><span class="o">=</span><span class="n">channel</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">uploadList</span><span class="o">=$</span><span class="n">I</span><span class="p">(</span><span class="n">uploadList</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">+$</span><span class="n">G</span><span class="p">(</span><span class="n">uploadList</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«:&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;æœªæ‰¾å¯ä¸Šä¼ çš„åŒ»å˜±&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="mi">1</span><span class="p">,</span><span class="err">ä»ªå™¨å‘é€è¿‡æ¥çš„è¯·æ±‚ä¿¡æ¯</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSH</span><span class="o">|^~</span>\<span class="o">&amp;||</span><span class="n">Mindray</span><span class="o">|||</span><span class="mi">20081120174836</span><span class="o">||</span><span class="n">ORM</span><span class="o">^</span><span class="n">O01</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="n">P</span><span class="o">|</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">1</span><span class="o">||||||</span><span class="n">UNICODE</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">ORC</span><span class="o">|</span><span class="n">RF</span><span class="o">||</span><span class="n">SampleID1</span><span class="o">||</span><span class="ne">IP</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">msh</span><span class="o">=</span><span class="s2">&#34;MSH|^~\&amp;|LIS||||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZDT</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s2">&#34; :&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;||ORR^O02|1|P|2.3.1||||||UNICODE&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">huifu</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSH</span><span class="o">|^~</span>\<span class="o">&amp;|</span><span class="n">LIS</span><span class="o">||||</span><span class="mi">20081120174836</span><span class="o">||</span><span class="n">ORR</span><span class="o">^</span><span class="n">O02</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">P</span><span class="o">|</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">1</span><span class="o">||||||</span><span class="n">UNICODE</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSA</span><span class="o">|</span><span class="n">AA</span><span class="o">|</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">PID</span><span class="o">|</span><span class="mi">1</span><span class="o">||</span><span class="n">ChartNo</span><span class="o">^^^^</span><span class="n">MR</span><span class="o">||^</span><span class="n">FName</span><span class="o">||</span><span class="mi">19810506</span><span class="o">|</span><span class="n">NT</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">PV1</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">E</span><span class="o">|</span><span class="err">å†…ç§‘</span><span class="o">^^</span><span class="n">Bn4</span><span class="o">|||||||||||||||||</span><span class="n">NewCharge</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">ORC</span><span class="o">|</span><span class="n">AF</span><span class="o">|</span><span class="n">SampleID1</span><span class="o">|||</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBR</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">SampleID1</span><span class="o">||||</span><span class="mi">20060506</span><span class="o">||||</span><span class="n">tester</span><span class="o">|||</span><span class="n">Diagnose</span> <span class="n">content</span><span class="o">...|</span><span class="mi">20060504</span><span class="o">||||||||</span><span class="mi">20080821</span><span class="o">||</span><span class="n">HM</span><span class="o">||||</span><span class="err">å®¡æ ¸è€…</span><span class="o">||||</span><span class="err">æ£€éªŒè€…</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">IS</span><span class="o">|</span><span class="mi">08001</span><span class="o">^</span><span class="n">Take</span> <span class="n">Mode</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">A</span><span class="o">||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">2</span><span class="o">|</span><span class="n">IS</span><span class="o">|</span><span class="mi">08002</span><span class="o">^</span><span class="n">Blood</span> <span class="n">Mode</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">W</span><span class="o">||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">3</span><span class="o">|</span><span class="n">IS</span><span class="o">|</span><span class="mi">08003</span><span class="o">^</span><span class="n">Test</span> <span class="n">Mode</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">CBC</span><span class="o">||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="n">IS</span><span class="o">|</span><span class="mi">01002</span><span class="o">^</span><span class="n">Ref</span> <span class="n">Group</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">XXXX</span><span class="o">||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">5</span><span class="o">|</span><span class="n">NM</span><span class="o">|</span><span class="mi">30525</span><span class="o">-</span><span class="mi">0</span><span class="o">^</span><span class="n">Age</span><span class="o">^</span><span class="n">LN</span><span class="o">||</span><span class="mi">1</span><span class="o">|</span><span class="n">hr</span><span class="o">|||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">6</span><span class="o">|</span><span class="n">ST</span><span class="o">|</span><span class="mi">01001</span><span class="o">^</span><span class="n">Remark</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">remark</span> <span class="n">content</span><span class="o">...||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">æœªæ‰¾åˆ°æ£€æµ‹æ—¶</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSH</span><span class="o">|^~</span>\<span class="o">&amp;|</span><span class="n">LIS</span><span class="o">||||</span><span class="mi">20081120174836</span><span class="o">||</span><span class="n">ORR</span><span class="o">^</span><span class="n">O02</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">P</span><span class="o">|</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">1</span><span class="o">||||||</span><span class="n">UNICODE</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSA</span><span class="o">|</span><span class="n">AR</span><span class="o">|</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">GetTestSetChannel</span><span class="p">(</span><span class="n">tsCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">N</span> <span class="p">(</span><span class="n">tsCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tsCode</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">tsCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/assets/image-20250110221403-iayciez.png"
	width="740"
	height="1840"
	srcset="/p/assets/image-20250110221403-iayciez_hu_f060053a5bfcd25f.png 480w, /p/assets/image-20250110221403-iayciez_hu_42661246be2313bc.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="40"
		data-flex-basis="96px"
	
></p>
<h4 id="å›ä¼ å¤šè¡Œ-obx">å›ä¼ å¤šè¡Œ OBX
</h4><h5 id="ç¤ºä¾‹æ¥å£è¿ˆç‘-bc7500">ç¤ºä¾‹æ¥å£(è¿ˆç‘ BC7500)
</h5><blockquote>
<p>å°†æ‚£è€…ä¿¡æ¯å’Œé¡¹ç›®ä¿¡æ¯å­˜å…¥ OBX å›ä¼ ä»ªå™¨</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span><span class="lnt">513
</span><span class="lnt">514
</span><span class="lnt">515
</span><span class="lnt">516
</span><span class="lnt">517
</span><span class="lnt">518
</span><span class="lnt">519
</span><span class="lnt">520
</span><span class="lnt">521
</span><span class="lnt">522
</span><span class="lnt">523
</span><span class="lnt">524
</span><span class="lnt">525
</span><span class="lnt">526
</span><span class="lnt">527
</span><span class="lnt">528
</span><span class="lnt">529
</span><span class="lnt">530
</span><span class="lnt">531
</span><span class="lnt">532
</span><span class="lnt">533
</span><span class="lnt">534
</span><span class="lnt">535
</span><span class="lnt">536
</span><span class="lnt">537
</span><span class="lnt">538
</span><span class="lnt">539
</span><span class="lnt">540
</span><span class="lnt">541
</span><span class="lnt">542
</span><span class="lnt">543
</span><span class="lnt">544
</span><span class="lnt">545
</span><span class="lnt">546
</span><span class="lnt">547
</span><span class="lnt">548
</span><span class="lnt">549
</span><span class="lnt">550
</span><span class="lnt">551
</span><span class="lnt">552
</span><span class="lnt">553
</span><span class="lnt">554
</span><span class="lnt">555
</span><span class="lnt">556
</span><span class="lnt">557
</span><span class="lnt">558
</span><span class="lnt">559
</span><span class="lnt">560
</span><span class="lnt">561
</span><span class="lnt">562
</span><span class="lnt">563
</span><span class="lnt">564
</span><span class="lnt">565
</span><span class="lnt">566
</span><span class="lnt">567
</span><span class="lnt">568
</span><span class="lnt">569
</span><span class="lnt">570
</span><span class="lnt">571
</span><span class="lnt">572
</span><span class="lnt">573
</span><span class="lnt">574
</span><span class="lnt">575
</span><span class="lnt">576
</span><span class="lnt">577
</span><span class="lnt">578
</span><span class="lnt">579
</span><span class="lnt">580
</span><span class="lnt">581
</span><span class="lnt">582
</span><span class="lnt">583
</span><span class="lnt">584
</span><span class="lnt">585
</span><span class="lnt">586
</span><span class="lnt">587
</span><span class="lnt">588
</span><span class="lnt">589
</span><span class="lnt">590
</span><span class="lnt">591
</span><span class="lnt">592
</span><span class="lnt">593
</span><span class="lnt">594
</span><span class="lnt">595
</span><span class="lnt">596
</span><span class="lnt">597
</span><span class="lnt">598
</span><span class="lnt">599
</span><span class="lnt">600
</span><span class="lnt">601
</span><span class="lnt">602
</span><span class="lnt">603
</span><span class="lnt">604
</span><span class="lnt">605
</span><span class="lnt">606
</span><span class="lnt">607
</span><span class="lnt">608
</span><span class="lnt">609
</span><span class="lnt">610
</span><span class="lnt">611
</span><span class="lnt">612
</span><span class="lnt">613
</span><span class="lnt">614
</span><span class="lnt">615
</span><span class="lnt">616
</span><span class="lnt">617
</span><span class="lnt">618
</span><span class="lnt">619
</span><span class="lnt">620
</span><span class="lnt">621
</span><span class="lnt">622
</span><span class="lnt">623
</span><span class="lnt">624
</span><span class="lnt">625
</span><span class="lnt">626
</span><span class="lnt">627
</span><span class="lnt">628
</span><span class="lnt">629
</span><span class="lnt">630
</span><span class="lnt">631
</span><span class="lnt">632
</span><span class="lnt">633
</span><span class="lnt">634
</span><span class="lnt">635
</span><span class="lnt">636
</span><span class="lnt">637
</span><span class="lnt">638
</span><span class="lnt">639
</span><span class="lnt">640
</span><span class="lnt">641
</span><span class="lnt">642
</span><span class="lnt">643
</span><span class="lnt">644
</span><span class="lnt">645
</span><span class="lnt">646
</span><span class="lnt">647
</span><span class="lnt">648
</span><span class="lnt">649
</span><span class="lnt">650
</span><span class="lnt">651
</span><span class="lnt">652
</span><span class="lnt">653
</span><span class="lnt">654
</span><span class="lnt">655
</span><span class="lnt">656
</span><span class="lnt">657
</span><span class="lnt">658
</span><span class="lnt">659
</span><span class="lnt">660
</span><span class="lnt">661
</span><span class="lnt">662
</span><span class="lnt">663
</span><span class="lnt">664
</span><span class="lnt">665
</span><span class="lnt">666
</span><span class="lnt">667
</span><span class="lnt">668
</span><span class="lnt">669
</span><span class="lnt">670
</span><span class="lnt">671
</span><span class="lnt">672
</span><span class="lnt">673
</span><span class="lnt">674
</span><span class="lnt">675
</span><span class="lnt">676
</span><span class="lnt">677
</span><span class="lnt">678
</span><span class="lnt">679
</span><span class="lnt">680
</span><span class="lnt">681
</span><span class="lnt">682
</span><span class="lnt">683
</span><span class="lnt">684
</span><span class="lnt">685
</span><span class="lnt">686
</span><span class="lnt">687
</span><span class="lnt">688
</span><span class="lnt">689
</span><span class="lnt">690
</span><span class="lnt">691
</span><span class="lnt">692
</span><span class="lnt">693
</span><span class="lnt">694
</span><span class="lnt">695
</span><span class="lnt">696
</span><span class="lnt">697
</span><span class="lnt">698
</span><span class="lnt">699
</span><span class="lnt">700
</span><span class="lnt">701
</span><span class="lnt">702
</span><span class="lnt">703
</span><span class="lnt">704
</span><span class="lnt">705
</span><span class="lnt">706
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">MIFCL600OI</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">ä»ªå™¨åç§°</span><span class="p">:</span>	<span class="err">è¡€ç»†èƒåˆ†ææµæ°´çº¿</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">ä»ªå™¨å‹å·</span><span class="p">:</span>	<span class="err">è¿ˆç‘</span><span class="n">HL7</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">ä»ªå™¨å‚å•†</span><span class="p">:</span>	<span class="err">è¿ˆç‘</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">é€šä¿¡åè®®</span><span class="p">:</span>	<span class="n">HL7</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">äº¤äº’æ–¹å¼</span><span class="p">:</span>	<span class="err">åŒ</span> <span class="err">å‘</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">æ¥</span>    <span class="err">å£</span><span class="p">:</span>	<span class="n">TCP</span><span class="o">/</span><span class="ne">IP</span><span class="p">,</span><span class="n">RS232</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">å¤‡</span>    <span class="err">æ³¨</span><span class="p">:</span>	<span class="err">ä»ªå™¨é…ç½®</span><span class="p">:</span><span class="err">é€‰æ‹©</span><span class="n">HL7åè®®</span><span class="p">,</span><span class="err">æ•£ç‚¹å›¾é€‰æ‹©</span><span class="p">:</span><span class="err">ä½å›¾</span>   
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(mi)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">par11</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">12</span><span class="p">)</span> 		<span class="o">//</span><span class="err">é¡¹ç›®åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">par10</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">13</span><span class="p">)</span> 	<span class="o">//</span><span class="err">ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AntDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">14</span><span class="p">)</span> 		<span class="o">//</span><span class="err">æŠ—ç”Ÿç´ åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SenDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span> 		<span class="o">//</span><span class="err">è¯æ•ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">par4</span><span class="o">=</span><span class="s2">&#34;|TCP|&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>  	<span class="o">//</span><span class="err">ç«¯å£å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">stx</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">etx</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ack</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">enq</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">eot</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">etb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">lf</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">nak</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">21</span><span class="p">),(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">kk</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">errFlag</span><span class="p">,</span><span class="n">resultType</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">ZT</span><span class="o">=</span><span class="s2">&#34;ErrHandler&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">EC</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">StartUTF8</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="ne">IP</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Port</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">LinkTime</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Device</span><span class="o">=</span><span class="s2">&#34;|TCP|&#34;</span><span class="n">_Port</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">try</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="p">;</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">ZA</span><span class="p">,</span><span class="s2">&#34;ZA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="err">æœªå¯åŠ¨å®¢æˆ·ç«¯</span><span class="o">/</span><span class="err">æœåŠ¡ç«¯</span><span class="mi">0</span><span class="err">ï¼Œå®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ ‡å¿—</span><span class="mi">20484</span><span class="err">ï¼Œæ— å®¢æˆ·ç«¯è¿æ¥</span><span class="mi">20480</span><span class="err">ï¼Œæœ‰å®¢æˆ·ç«¯è¿æ¥</span><span class="mi">28674</span><span class="err">ï¼Œè¿æ¥å¹¶å»ºç«‹æ•°æ®ä¼ è¾“</span><span class="mi">28672</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="n">lisæ–­å¼€</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="o">$</span><span class="n">ZA</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">h</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">				<span class="n">open</span> <span class="n">Device</span><span class="p">:(</span><span class="ne">IP</span><span class="p">:</span><span class="n">Port</span><span class="p">:</span><span class="o">/</span><span class="n">IOTABLE</span><span class="o">=</span><span class="s2">&#34;GB18030&#34;</span><span class="p">):</span><span class="mi">20</span>
</span></span><span class="line"><span class="cl">				<span class="n">use</span> <span class="n">Device</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;lisæ–­å¼€è¿æ¥&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;lisReConnect&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">throw</span> <span class="c1">##class(%Exception.General).%New(&#34;ConnectError&#34;,&#34;D&#34;,,&#34;é‡æ–°è¿æ¥å¤±è´¥&#34;)</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="err">ä»ªå™¨æ–­å¼€ï¼Œæˆ–è€…æ— æ•°æ®</span><span class="mi">1</span><span class="nb">min</span><span class="err">ï¼Œé‡å¯</span><span class="n">tcp</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="p">((</span><span class="o">$</span><span class="n">ZA</span><span class="o">=</span><span class="s2">&#34;20484&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">close</span> <span class="n">par4</span>
</span></span><span class="line"><span class="cl">				<span class="p">;</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ä»ªå™¨æ–­å¼€è¿æ¥&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;blockConnect&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="n">h</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">				<span class="n">open</span> <span class="n">Device</span><span class="p">:(</span><span class="ne">IP</span><span class="p">:</span><span class="n">Port</span><span class="p">:</span><span class="o">/</span><span class="n">IOTABLE</span><span class="o">=</span><span class="s2">&#34;GB18030&#34;</span><span class="p">):</span><span class="mi">20</span>
</span></span><span class="line"><span class="cl">				<span class="n">use</span> <span class="n">Device</span>
</span></span><span class="line"><span class="cl">				<span class="p">;</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;é‡æ–°è¿æ¥&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;reConnect&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="n">s</span> <span class="n">LinkTime</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">				<span class="k">continue</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="err">è¿æ¥æ— æ•°æ®ä¼ è¾“ï¼Œ</span><span class="n">mainæ¯æ‰§è¡Œ6æ¬¡</span><span class="err">ï¼Œå³</span><span class="mi">1</span><span class="nb">min</span><span class="err">ï¼Œé‡å¯</span><span class="n">tcp</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="o">$</span><span class="n">ZA</span><span class="o">=</span><span class="s2">&#34;28674&#34;</span> <span class="n">s</span> <span class="n">LinkTime</span><span class="o">=$</span><span class="n">i</span><span class="p">(</span><span class="n">LinkTime</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="err">æ­£å¸¸ä¼ è¾“äº†ï¼Œå°±æ¸…ç©ºè®¡æ•°</span>
</span></span><span class="line"><span class="cl">			<span class="n">i</span> <span class="o">$</span><span class="n">ZA</span><span class="o">=</span><span class="s2">&#34;28672&#34;</span> <span class="n">s</span> <span class="n">LinkTime</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">			<span class="n">d</span> <span class="n">Main</span>
</span></span><span class="line"><span class="cl">	 	<span class="p">}</span><span class="n">catch</span> <span class="n">ex</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		 <span class="n">s</span> <span class="n">exception</span><span class="o">=</span><span class="s2">&#34;é”™è¯¯:&#34;</span><span class="n">_ex</span><span class="o">.</span><span class="n">Location_</span><span class="s2">&#34;^&#34;</span><span class="n">_ex</span><span class="o">.</span><span class="n">Data_ex</span><span class="o">.</span><span class="n">Name</span>
</span></span><span class="line"><span class="cl">		 <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">exception</span><span class="p">,</span><span class="s2">&#34;è¯»å–æˆ–å†™å…¥å¼‚å¸¸ï¼Œé‡å¯æœåŠ¡ç«¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 	<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span> <span class="n">par4</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Main</span>
</span></span><span class="line"><span class="cl">	<span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$TEST	//å¦‚æœè¶…æ—¶åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=sb   //ä»¥sbå¼€å¤´</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">errFlag</span><span class="p">,</span><span class="n">resultType</span><span class="p">,</span><span class="n">msgType</span><span class="p">,</span><span class="n">barcode</span><span class="p">,</span><span class="n">mshStr</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">startTime</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">PLIST</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">curTime</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="n">curTime</span><span class="o">&gt;</span><span class="p">(</span><span class="n">startTime</span><span class="o">+</span><span class="mi">300</span><span class="p">)</span>  <span class="o">//</span><span class="mi">5</span><span class="err">åˆ†é’Ÿå†…æ²¡æœ‰å¤„ç†å®Œåˆ™é€€å‡ºå¾ªç¯</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$TEST	//å¦‚æœè¶…æ—¶åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span><span class="o">&gt;=</span><span class="mi">32700</span> <span class="p">{</span>  <span class="o">//</span><span class="mi">32767</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">index</span><span class="o">=+$</span><span class="n">O</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=eb,$C(R)&#39;</span><span class="o">=</span><span class="n">cr</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">))</span><span class="n">_</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">cr</span> <span class="p">{</span>  	<span class="o">//</span><span class="err">è§£æä¸€æ¡è®°å½•</span>
</span></span><span class="line"><span class="cl">			<span class="n">D</span> <span class="n">Record</span>
</span></span><span class="line"><span class="cl">			<span class="n">K</span> <span class="n">PLIST</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eb</span>   	<span class="o">//</span><span class="err">å¾ªç¯è¯»å–</span><span class="p">,</span><span class="err">å½“ä¸º</span><span class="n">ebçš„æ—¶å€™åˆ™é€€å‡º</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="s2">&#34;result&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">Save</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Record</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">index</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">base64Stream</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">isImage</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">isBinary</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">OldgraphDataDIFF</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">Bracket</span><span class="p">,</span><span class="n">TestTube</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">index</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(index)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">record</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">index</span><span class="p">)),</span><span class="n">cr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Continue</span><span class="p">:</span><span class="s1">&#39;$L(record)</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">segmentType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;MSH&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä¿¡æ¯å¤´ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">mshStr</span><span class="o">=</span><span class="n">record</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="err">æ¶ˆæ¯ç±»å‹</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">msgType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="o">//</span><span class="n">ORU</span><span class="p">,</span><span class="n">ACK</span><span class="p">,</span><span class="n">QRY</span><span class="p">,</span><span class="n">QCK</span><span class="p">,</span><span class="n">DSR</span>
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">msgType</span><span class="o">=</span><span class="s2">&#34;ORU&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">D</span> <span class="n">SendACK</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    		<span class="n">I</span> <span class="n">msgType</span><span class="o">=</span><span class="s2">&#34;ORM&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    		<span class="n">S</span> <span class="n">resultType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;PID&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">æ‚£è€…ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;PVI&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">å°±è¯Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;OBR&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">åŒ»å˜±ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">epis</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    			<span class="n">S</span><span class="p">:</span><span class="s1">&#39;$l(epis) epis=$P(record,&#34;|&#34;,4)</span>
</span></span><span class="line"><span class="cl">    			<span class="n">i</span> <span class="n">epis</span><span class="p">[</span><span class="s2">&#34;Inv&#34;</span> <span class="n">d</span>		<span class="o">//</span><span class="n">Inv</span><span class="o">.</span><span class="mi">082526</span><span class="n">_6</span><span class="o">-</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl">    			<span class="o">.</span><span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">tr</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="s2">&#34;Inv.&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">),</span><span class="s2">&#34;_&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>		<span class="o">//</span><span class="n">YHR</span> <span class="mi">20230819</span> <span class="err">ä»ªå™¨æœªè¯†åˆ«åˆ°æ¡ç æ”¹ä¸ºæ¶å­å·è·å–ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">    			<span class="o">/*------</span><span class="err">è‡ªåŠ¨æ ¸æ”¶</span><span class="o">-------*/</span>		<span class="o">//</span><span class="n">YHR</span> <span class="mi">20230910</span> <span class="err">è¿ˆç‘</span><span class="n">BC7500è‡ªåŠ¨æ ¸æ”¶</span>
</span></span><span class="line"><span class="cl">    			<span class="p">;</span><span class="n">try</span><span class="p">{</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##class(MI.Special.AutomaticReceipt).ZDHS(mi,epis)}catch{}</span>
</span></span><span class="line"><span class="cl">	     	
</span></span><span class="line"><span class="cl">	     		<span class="n">S</span> <span class="n">code</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	     		<span class="n">I</span> <span class="n">code</span><span class="o">=</span><span class="s2">&#34;00003&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="n">LJ</span> <span class="n">QCR</span>
</span></span><span class="line"><span class="cl">		     	
</span></span><span class="line"><span class="cl">		     	<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;OBX&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">dataTye</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>  <span class="o">//</span><span class="n">NM</span> <span class="p">(</span><span class="n">numeric</span><span class="p">)</span> <span class="err">è¡¨ç¤ºæ•°å­—å€¼ï¼Œç”¨äºå®šé‡é¡¹ç›®</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     										<span class="o">//</span><span class="n">ST</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span> <span class="err">è¡¨ç¤ºå­—ç¬¦ä¸²å€¼ï¼Œç”¨äºå®šæ€§é¡¹ç›®</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">channel</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="n">s</span> <span class="n">InformationID</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">channel</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="o">//</span><span class="n">s</span><span class="p">:</span><span class="s1">&#39;$l(channel) channel=$P(record,&#34;|&#34;,5)</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">value</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="p">;</span><span class="n">i</span> <span class="n">value</span><span class="p">[</span><span class="s2">&#34;&lt;&#34;</span> <span class="n">s</span> <span class="n">value</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;&lt;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    			<span class="p">;</span><span class="n">i</span> <span class="n">value</span><span class="p">[</span><span class="s2">&#34;&gt;&#34;</span> <span class="n">s</span> <span class="n">value</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;&gt;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">s</span> <span class="n">value</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;FR-CRP&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    				<span class="n">i</span> <span class="n">value</span><span class="o">&gt;</span><span class="mi">10</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">channel1</span><span class="o">=</span><span class="s2">&#34;FCRP&#34;</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">channel2</span><span class="o">=</span><span class="s2">&#34;Fhs-CRP&#34;</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">value1</span><span class="o">=</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">value2</span><span class="o">=</span><span class="s2">&#34;&gt;10&#34;</span>
</span></span><span class="line"><span class="cl">    				<span class="n">i</span> <span class="n">value</span><span class="o">&lt;</span><span class="mi">10</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">channel1</span><span class="o">=</span><span class="s2">&#34;FCRP&#34;</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">channel2</span><span class="o">=</span><span class="s2">&#34;Fhs-CRP&#34;</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">value1</span><span class="o">=</span><span class="s2">&#34;&lt;10&#34;</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">value2</span><span class="o">=</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">    				<span class="n">i</span> <span class="n">value</span><span class="o">=</span><span class="mi">10</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">channel1</span><span class="o">=</span><span class="s2">&#34;FCRP&#34;</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">channel2</span><span class="o">=</span><span class="s2">&#34;Fhs-CRP&#34;</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">value1</span><span class="o">=</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">value2</span><span class="o">=</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">    			
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel1_par10_value1_par11</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel2_par10_value2_par11</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;SI&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="n">value</span><span class="o">=</span><span class="err">æµŠåº¦</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">^</span><span class="err">æº¶è¡€</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">^</span><span class="err">é»„ç–¸</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel_</span><span class="s2">&#34;H&#34;</span><span class="n">_par10_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_par11</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel_</span><span class="s2">&#34;I&#34;</span><span class="n">_par10_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="n">_par11</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">value</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;ST&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    				<span class="n">S</span> <span class="n">value</span><span class="o">=$</span><span class="n">S</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">&#34;Ã²?D?&#34;</span><span class="p">:</span><span class="s2">&#34;é˜´æ€§&#34;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s2">&#34;??D?&#34;</span><span class="p">:</span><span class="s2">&#34;é˜³æ€§&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    				<span class="n">i</span> <span class="n">InformationID</span><span class="o">=</span><span class="s2">&#34;01012&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">Bracket</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="o">^</span><span class="n">TMPBC7500</span><span class="p">(</span><span class="s2">&#34;Bracket&#34;</span><span class="p">)</span><span class="o">=</span><span class="n">Bracket</span>
</span></span><span class="line"><span class="cl">    				<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">TMPBC7500</span><span class="p">(</span><span class="s2">&#34;Bracket&#34;</span><span class="p">))),</span><span class="n">InformationID</span><span class="o">=</span><span class="s2">&#34;01013&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">TestTube</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">s</span> <span class="n">RackNo</span><span class="o">=</span><span class="s2">&#34;ä¸Šæœº:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">TMPBC7500</span><span class="p">(</span><span class="s2">&#34;Bracket&#34;</span><span class="p">))</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_TestTube</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">k</span> <span class="o">^</span><span class="n">TMPBC7500</span><span class="p">(</span><span class="s2">&#34;Bracket&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    				<span class="o">.</span><span class="n">try</span><span class="p">{</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##class(MI.Special.SaveInformation).SaveRackNo(mi,epis, RackNo)}catch{}		//YHR 20230914 ä¿å­˜æ¶å­å·</span>
</span></span><span class="line"><span class="cl">    			
</span></span><span class="line"><span class="cl">    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">channel</span><span class="p">),</span><span class="n">dataTye</span><span class="s1">&#39;=&#34;ED&#34;,dataTye&#39;</span><span class="o">=</span><span class="s2">&#34;IS&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">result</span><span class="o">=</span><span class="n">result_channel_par10_value_par11</span>
</span></span><span class="line"><span class="cl">    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;IS&#34;</span> <span class="p">{</span>	  
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;05001&#34;</span><span class="p">,</span><span class="n">resultType</span><span class="o">=</span><span class="s2">&#34;Q&#34;</span> <span class="p">{</span>		<span class="o">//</span><span class="err">è´¨æ§æµ“åº¦</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">S</span> <span class="n">epis</span><span class="o">=</span><span class="n">value</span>
</span></span><span class="line"><span class="cl">		    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		    	
</span></span><span class="line"><span class="cl">		    		<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">LISPolice</span><span class="p">(</span><span class="s2">&#34;BC7500&#34;</span><span class="p">,</span><span class="n">InformationID</span><span class="p">))</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    		<span class="o">.</span><span class="n">s</span> <span class="n">WarningMessage</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">LISPolice</span><span class="p">(</span><span class="s2">&#34;BC7500&#34;</span><span class="p">,</span><span class="n">InformationID</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		    		<span class="o">.</span><span class="n">try</span><span class="p">{</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.Special.SaveInformation).SaveAlarmInformation(mi,epis,WarningMessage)}catch{}		//YHR 20230914 ä¿å­˜æŠ¥è­¦ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">		    	
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">    			<span class="n">S</span> <span class="n">graphTypeDesc</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34;U&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    		
</span></span><span class="line"><span class="cl">    			<span class="n">I</span> <span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;ED&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">å›¾å½¢æ•°æ®</span>
</span></span><span class="line"><span class="cl">    				<span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Image&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">isImage</span><span class="o">=</span><span class="mi">1</span>  	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Octer-stream&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">S</span> <span class="n">isBinary</span><span class="o">=</span><span class="mi">1</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span><span class="p">(</span><span class="err">éœ€è¦ç»˜å›¾</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="n">channel</span>
</span></span><span class="line"><span class="cl">    				<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15050&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RBC&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15056&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RBC&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15100&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;PLT&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15116&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;PLT&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15200&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFFBMP&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15201&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFF&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">					<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15202&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFF&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15250&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;BASOBMP&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15251&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;BASO&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15300&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RET&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15306&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RET&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15301&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;PLT-0&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15302&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;RET-EXT&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15350&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">ä½å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;NRBC&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="n">channel</span><span class="o">=</span><span class="s2">&#34;15354&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="p">(</span><span class="n">isImage</span><span class="p">,</span><span class="n">isBinary</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>	<span class="o">//</span><span class="err">æš‚æ—¶ä¸å¤„ç†äºŒè¿›åˆ¶æ•°æ®</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">S</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;NRBC&#34;</span>
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">graphData</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    		
</span></span><span class="line"><span class="cl">	    			<span class="n">S</span> <span class="n">graphDataType</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    			<span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">graphDataType</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Base64&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">graphType</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">/*</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;RBC Histogram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">charStream</span><span class="o">=</span><span class="c1">##class(%GlobalCharacterStream).%New()</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">graphData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.TEST.TEST).SaveBase64ToMachine(mi,epis,&#34;RBC&#34;,charStream,epis_&#34;RBC.bmp&#34;,&#34;BC7500&#34;)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">ret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šRBC Histogram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;PLT Histogram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">charStream</span><span class="o">=</span><span class="c1">##class(%GlobalCharacterStream).%New()</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">graphData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.TEST.TEST).SaveBase64ToMachine(mi,epis,&#34;PLT&#34;,charStream,epis_&#34;PLT.bmp&#34;,&#34;BC7500&#34;)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">ret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šPLT Histogram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;WBC DIFF Scattergram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">charStream</span><span class="o">=</span><span class="c1">##class(%GlobalCharacterStream).%New()</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">graphData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.TEST.TEST).SaveBase64ToMachine(mi,epis,&#34;DIFF&#34;,charStream,epis_&#34;DIFF.bmp&#34;,&#34;BC7500&#34;)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">ret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šWBC DIFF Scattergram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;WNB Scattergram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">charStream</span><span class="o">=</span><span class="c1">##class(%GlobalCharacterStream).%New()</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">graphData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.TEST.TEST).SaveBase64ToMachine(mi,epis,&#34;Baso&#34;,charStream,epis_&#34;Baso.bmp&#34;,&#34;BC7500&#34;)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">ret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šWNB Scattergram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="o">*/</span>
</span></span><span class="line"><span class="cl">		    		
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;RBC Histogram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;RBC&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;Histogram#RBC#RBC######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RBC#RBC######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šRBC Histogram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;PLT Histogram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;PLT&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;Histogram#PLT#PLT######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#PLT#RBC######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šPLT Histogram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;WBC DIFF&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="n">OldgraphDataDIFF</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">						<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;WBC-DIFF&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#DIFF#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#DIFF#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šWBC DIFF&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    			<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;WNB Scattergram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#WNB#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#Baso#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šWNB Scattergram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;RET Scattergram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RET#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RET#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šRET Scattergram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;PLT-O Scattergram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RET#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#PLTO#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šPLT-O Scattergram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;RET-EXT Scattergram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RET#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RETEXT#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šRET-EXT Scattergram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;RBCVHF Scattergram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RET#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RBCVHF#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šRBCVHF Scattergram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="n">i</span> <span class="n">graphType</span><span class="p">[</span><span class="s2">&#34;RBCSCT Scattergram&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.</span><span class="n">s</span> <span class="n">OldgraphDataBaso</span><span class="o">=</span><span class="n">graphData</span>
</span></span><span class="line"><span class="cl">		    			<span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RET#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    				<span class="o">.</span><span class="n">s</span> <span class="n">tretObj</span><span class="o">=</span><span class="c1">##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()</span>
</span></span><span class="line"><span class="cl">    					<span class="o">.</span><span class="n">s</span> <span class="n">tret</span><span class="o">=</span><span class="n">tretObj</span><span class="o">.</span><span class="n">DrawImage</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">graphData</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFLISMonitorTest&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#RBCSCT#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">						<span class="o">.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tret_</span><span class="s2">&#34;!!&#34;</span><span class="n">_epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_mi</span><span class="p">,</span><span class="s2">&#34;ç»˜å›¾ï¼šRBCSCT Scattergram&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    			
</span></span><span class="line"><span class="cl">	    		
</span></span><span class="line"><span class="cl">	    			<span class="p">}</span>
</span></span><span class="line"><span class="cl">	    		<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="n">I</span> <span class="n">segmentType</span><span class="o">=</span><span class="s2">&#34;ORC&#34;</span> <span class="p">{</span>	<span class="o">//</span><span class="err">å°±è¯Šä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">S</span> <span class="n">barcode</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">				<span class="o">/*------</span><span class="err">è‡ªåŠ¨æ ¸æ”¶</span><span class="o">-------*/</span>		<span class="o">//</span><span class="n">YHR</span> <span class="mi">20230910</span> <span class="err">è¿ˆç‘</span><span class="n">BC7500è‡ªåŠ¨æ ¸æ”¶</span>
</span></span><span class="line"><span class="cl">    			<span class="p">;</span><span class="n">try</span><span class="p">{</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##class(MI.Special.AutomaticReceipt).ZDHS(mi,barcode)}catch{}</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="n">barcode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">barcode</span><span class="p">)</span> <span class="p">{</span>  <span class="o">//</span><span class="err">åŒå‘</span>
</span></span><span class="line"><span class="cl">				<span class="o">//</span><span class="p">}</span> <span class="n">Invalid</span> <span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">				<span class="n">d</span> <span class="n">SendORR</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">barcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		<span class="o">//</span><span class="n">I</span> <span class="n">dataTye</span><span class="o">=</span><span class="s2">&#34;ED&#34;</span><span class="p">,</span><span class="n">index</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">base64Stream</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="n">D</span> <span class="n">base64Stream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="n">i</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFFBMP&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//.</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;WBC-DIFF&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">OldgraphDataDIFF</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFBC6800BI&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#DIFF#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//</span><span class="n">i</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;BASOBMP&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//.</span><span class="n">s</span> <span class="o">^</span><span class="n">LISDrawImageTask</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;BASO&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">OldgraphDataBaso</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;MI.MIFBC6800BI&#34;</span><span class="p">,</span><span class="s2">&#34;-1&#34;</span><span class="p">,</span><span class="s2">&#34;DiffPlot#Baso#######10#10#320#138&#34;</span><span class="p">,</span><span class="s2">&#34;LIS.Mach.ImageDeal.Imagebc6800,LIS.Mach.ImageDeal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">			<span class="o">//</span><span class="n">s</span> <span class="n">miCode</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//</span><span class="n">i</span> <span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;WBC-DIFF&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">			<span class="o">//.</span><span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">miCode_</span><span class="s2">&#34;:&#34;</span><span class="n">_epis_</span><span class="s2">&#34;:&#34;</span><span class="n">_graphType</span><span class="p">,</span><span class="s2">&#34;SaveImage&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		    <span class="o">//.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.Common.MIFBase).SaveBase64ToMachine(mi,epis,graphType,base64Stream,epis_&#34;-&#34;_graphType,miCode)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="o">//</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">Save</span>  
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;^&#34;</span><span class="n">_result</span><span class="p">,</span><span class="s2">&#34;Test&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  	<span class="n">I</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	  	<span class="n">S</span> <span class="n">QC</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  		<span class="n">D</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  	<span class="p">}</span>
</span></span><span class="line"><span class="cl">  	<span class="n">S</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">resultType</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  	<span class="n">Q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">SendACK</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="n">errCode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">errDesc</span><span class="o">=</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">)</span> <span class="o">//</span><span class="n">send</span> <span class="s1">&#39;ack&#39;</span> <span class="n">to</span> <span class="n">instrument</span> 
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">ackType</span><span class="p">,</span><span class="n">errCode</span><span class="p">,</span><span class="n">errDesc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">ackType</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ackType</span><span class="p">),</span><span class="n">errCode</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">errCode</span><span class="p">),</span><span class="n">errDesc</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">errDesc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:(</span><span class="s1">&#39;$l(mi))||(&#39;</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">Q</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">21</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">msgRoutine</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">seq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS|||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;ACK^&#34;</span><span class="n">_msgRoutine</span>
</span></span><span class="line"><span class="cl">    <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;MSA|&#34;</span><span class="n">_ackType_</span><span class="s2">&#34;|&#34;</span><span class="n">_seq_</span><span class="s2">&#34;|&#34;</span><span class="n">_errDesc_</span><span class="s2">&#34;|||&#34;</span><span class="n">_errCode_</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">S</span><span class="p">(</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AE&#34;</span><span class="p">:</span><span class="s2">&#34;Error&#34;</span><span class="p">,</span><span class="n">ackType</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;NULL&#34;</span><span class="p">),</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">ErrHandler</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZERROR</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="s2">&#34;--&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;.é”™è¯¯ä»£ç :&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ECODE</span><span class="p">,</span><span class="s2">&#34;Runtime Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">h</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">ä¿å­˜ç›´æ–¹å›¾</span>
</span></span><span class="line"><span class="cl"><span class="n">SaveHistogram</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">graphType</span><span class="p">,</span><span class="n">graphOrder</span><span class="p">,</span><span class="n">base64Stream</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">graphType</span><span class="p">,</span><span class="n">graphOrder</span><span class="p">,</span><span class="n">base64Stream</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">epis</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="n">graphType</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">graphType</span><span class="p">),</span><span class="n">graphOrder</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">graphOrder</span><span class="p">),</span><span class="n">base64Stream</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">base64Stream</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(mi) 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(epis) 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(base64Stream) 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(graphType) 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span><span class="p">:</span><span class="s1">&#39;$L(graphOrder) graphOrder=0</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">glBinaryStream</span><span class="o">=</span><span class="c1">##Class(%GlobalBinaryStream).%New()</span>
</span></span><span class="line"><span class="cl">    <span class="n">While</span> <span class="s1">&#39;base64Stream.AtEnd {</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">base64</span><span class="o">=</span><span class="n">base64Stream</span><span class="o">.</span><span class="n">Read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">binary</span><span class="o">=$</span><span class="n">system</span><span class="o">.</span><span class="n">Encryption</span><span class="o">.</span><span class="n">Base64Decode</span><span class="p">(</span><span class="n">base64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="n">D</span> <span class="n">glBinaryStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">charStream</span><span class="o">=</span><span class="c1">##Class(%GlobalCharacterStream).%New()</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">maxDot</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">While</span> <span class="s1">&#39;glBinaryStream.AtEnd {</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">char</span><span class="o">=</span><span class="n">glBinaryStream</span><span class="o">.</span><span class="n">Read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">ascValue</span><span class="o">=$</span><span class="n">ASCII</span><span class="p">(</span><span class="n">char</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">	    <span class="n">S</span> <span class="n">maxDot</span><span class="o">=</span><span class="n">maxDot</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	    <span class="n">D</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="n">ascValue</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;0&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">glBinaryStream</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">title</span><span class="o">=</span><span class="n">graphType</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">foreColor</span><span class="o">=</span><span class="mi">12</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="n">graphType</span><span class="o">=</span><span class="s2">&#34;PLT&#34;</span> <span class="n">foreColor</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">top</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">left</span><span class="o">=</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">width</span><span class="o">=</span><span class="mi">300</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="n">maxValue</span><span class="p">,</span><span class="n">memo</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">error</span><span class="o">=</span><span class="c1">##Class(MI.Instrument).SaveHistogram(charStream,mi,epis,graphType,graphOrder,label,title,maxDot,maxValue,memo,foreColor,top,left,width,height)</span>
</span></span><span class="line"><span class="cl">    <span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="s2">&#34;--&#34;</span><span class="p">),</span><span class="s2">&#34;Graph Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="n">charStream</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">SendORR</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span> <span class="n">AckType</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span><span class="p">,</span><span class="n">ErrCode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ErrDesc</span><span class="o">=</span><span class="s2">&#34;Message accepted&#34;</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="n">AckType</span><span class="p">,</span><span class="n">ErrCode</span><span class="p">,</span><span class="n">ErrDesc</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">record</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">record</span><span class="p">),</span><span class="n">AckType</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">AckType</span><span class="p">),</span><span class="n">ErrCode</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ErrCode</span><span class="p">),</span><span class="n">ErrDesc</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ErrDesc</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">epis</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">sb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">eb</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">Q</span><span class="p">:(</span><span class="s1">&#39;$l(mi))||(&#39;</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">TR</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">seq</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">S</span> <span class="n">mshStr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;|LIS||||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mshStr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">   	 <span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">mshStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;ORR^O02&#34;</span>
</span></span><span class="line"><span class="cl">   	 <span class="n">s</span> <span class="n">isRecieve</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">   	 <span class="n">s</span> <span class="n">wgDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">   	 <span class="n">s</span> <span class="n">wgDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="o">//&amp;</span><span class="n">sql</span><span class="p">(</span><span class="n">SELECT</span> <span class="n">EpisodeNo</span> <span class="n">into</span> <span class="p">:</span><span class="n">isRecieve</span> <span class="n">FROM</span> <span class="n">dbo</span><span class="o">.</span><span class="n">RP_VisitNumberReport</span> <span class="n">where</span> <span class="n">AssayNo</span><span class="o">=</span><span class="p">:</span><span class="n">epis</span> <span class="ow">and</span> <span class="n">WorkGroupMachineDR</span><span class="o">=</span><span class="p">:</span><span class="n">wgDR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">isRecieve</span><span class="o">=</span><span class="n">epis</span> <span class="o">//</span><span class="c1">##class(HIS.DHCReportPrint).GetReportAssayNoMTHD(mi,epis)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;AA&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">MSACode</span><span class="o">=</span><span class="n">seq</span>
</span></span><span class="line"><span class="cl">	 <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">isRecieve</span><span class="p">,</span><span class="s2">&#34;isRecieve is &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="p">(</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">isRecieve</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="p">{</span>
</span></span><span class="line"><span class="cl">		 <span class="n">s</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">		 <span class="n">s</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">MSA</span><span class="o">=</span><span class="s2">&#34;MSA|&#34;</span><span class="n">_flag_</span><span class="s2">&#34;|&#34;</span><span class="n">_MSACode</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;AR&#34;</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		 <span class="n">S</span> <span class="n">TMPCORDE</span><span class="o">=</span><span class="n">sb_mshStr_cr_MSA_cr_eb_cr</span>
</span></span><span class="line"><span class="cl">		 <span class="n">W</span> <span class="n">sb</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">MSA</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">		 <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">TMPCORDE</span><span class="p">,</span><span class="s2">&#34;H-&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PatInfomation</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PatInfomation</span><span class="o">=$$</span><span class="n">GetPatInfo</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;PatInfomation is&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="p">(</span><span class="n">RegNo</span><span class="p">,</span><span class="n">Name</span><span class="p">,</span><span class="n">Birth</span><span class="p">,</span><span class="n">Species</span><span class="p">,</span><span class="n">PatType</span><span class="p">,</span><span class="n">LOC</span><span class="p">,</span><span class="n">BedNo</span><span class="p">,</span><span class="n">Fee</span><span class="p">,</span><span class="n">Srcdocno</span><span class="p">,</span><span class="n">PatAge</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="k">if</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">RegNo</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Name</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Birth</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">29</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;1&#34;</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;ç”·&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;2&#34;</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;å¥³&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PatType</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">LOC</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Fee</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">Srcdocno</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PatAge</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfomation</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PID</span><span class="o">=</span><span class="s2">&#34;PID|1||&#34;</span><span class="n">_RegNo_</span><span class="s2">&#34;^^^^MR||&#34;</span><span class="n">_Name_</span><span class="s2">&#34;^&#34;</span><span class="n">_Name_</span><span class="s2">&#34;||&#34;</span><span class="n">_Birth_</span><span class="s2">&#34;|&#34;</span><span class="n">_Species</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">PV1</span><span class="o">=</span><span class="s2">&#34;PV1|1|&#34;</span><span class="n">_PatType_</span><span class="s2">&#34;|&#34;</span><span class="n">_LOC_</span><span class="s2">&#34;^^&#34;</span><span class="n">_BedNo_</span><span class="s2">&#34;|||||||||||||||||&#34;</span><span class="n">_Fee</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">ORC</span><span class="o">=</span><span class="s2">&#34;ORC|AF||&#34;</span><span class="n">_epis</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">curTime</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">randomNumber</span><span class="o">=</span><span class="mi">1000</span><span class="o">+$</span><span class="n">r</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">OBR</span><span class="o">=</span><span class="s2">&#34;OBR|1|&#34;</span><span class="n">_epis_</span><span class="s2">&#34;||00001^Automated Count^99MRC||&#34;</span><span class="n">_curTime_randomNumber_</span><span class="s2">&#34;||||&#34;</span><span class="n">_Srcdocno_</span><span class="s2">&#34;||||||||||||||HM||||||||Bill&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">TestCodeDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">TestCodeDate</span><span class="o">=$$</span><span class="n">SearchTestItem</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="n">s</span> <span class="n">OBX</span><span class="o">=</span><span class="s2">&#34;OBX|1|IS|08003^Test Mode^99MRC||&#34;</span><span class="n">_TestCodeDate_</span><span class="s2">&#34;||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|2|IS|01002^Ref Group^99MRC||Child||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|3|NM|30525-0^Age^LN||&#34;</span><span class="n">_PatAge_</span><span class="s2">&#34;|yr|||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|4|ST|01001^Remark^99MRC||&#34;</span><span class="n">_PatType_</span><span class="s2">&#34;||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|5|ST|08005^SerialNumber^99MRC||&#34;</span><span class="n">_isRecieve_</span><span class="s2">&#34;||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|6|IS|01007^Sample Type^99MRC||Venous blood||||||&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|7|IS|01008^Patient Area^99MRC||A - 501||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|8|ST|01009^Custom patient info 1^99MRC||Nothing||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|9|ST|01010^Custom patient info 2^99MRC||Nothing||||||F&#34;</span><span class="n">_cr_</span>
</span></span><span class="line"><span class="cl">			<span class="s2">&#34;OBX|10|ST|01011^Custom patient info 3^99MRC||Nothing||||||F&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">TMPORDER</span><span class="o">=</span><span class="n">sb_mshStr_cr_MSA_cr_PID_cr_PV1_cr_ORC_cr_OBR_cr_OBX_cr_eb_cr</span>
</span></span><span class="line"><span class="cl">		<span class="n">w</span> <span class="n">sb</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">MSA</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">PID</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">PV1</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">ORC</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">OBR</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">OBX</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">eb</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">TMPORDER</span><span class="p">,</span><span class="s2">&#34;H-&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="n">SearchTestItem</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">tc</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  	<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">	   <span class="n">f</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	 	<span class="n">s</span> <span class="n">tc</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">tc</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	 	 <span class="n">q</span><span class="p">:</span><span class="n">tc</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	 	 <span class="n">i</span> <span class="s1">&#39;$l(tcx){</span>
</span></span><span class="line"><span class="cl">		 	<span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tc</span> 
</span></span><span class="line"><span class="cl">	 	 <span class="p">}</span><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    	<span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_</span><span class="s2">&#34;+&#34;</span><span class="n">_tc</span>
</span></span><span class="line"><span class="cl">	 	 <span class="p">}</span>
</span></span><span class="line"><span class="cl">  	<span class="p">}</span>
</span></span><span class="line"><span class="cl">  	<span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> <span class="n">tcx</span>
</span></span><span class="line"><span class="cl"><span class="n">GetPatInfo</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">labno</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">VisitNumberDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="n">_labno</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ ‡æœ¬ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RPVisitNumberData</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">LocationDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span><span class="n">Location</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Location</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">DoctorDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span><span class="n">Doctor</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Doctor</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTDoctorD</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ReceiveDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ReceiveTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">67</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ReceiveUserDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">68</span><span class="p">),</span><span class="n">ReceiveUser</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">ReceiveUser</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">SYSUserD</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RegNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SurName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">GivenName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">SurName</span><span class="o">=</span><span class="n">GivenName</span> <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName</span>
</span></span><span class="line"><span class="cl">	<span class="n">e</span>  <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName_GivenName</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SpeciesDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Species</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AdmTypeDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">AdmType</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AdmType</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAdmissionTypeD</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">BirthDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AgeUnitDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">19</span><span class="p">),</span><span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAgeUnitD</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">CollectDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">51</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">CollectTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Diagnose</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Sampleda</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s2">&#34;XN&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">s</span> <span class="n">Instrument</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">22</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Sampleno</span><span class="o">=</span><span class="n">labno</span>   <span class="o">//</span><span class="err">æ£€æµ‹å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Sampletype</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">Feetype</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">;</span><span class="err">è´¹åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Srcdepno</span><span class="o">=</span><span class="n">Location</span>  <span class="p">;</span><span class="err">é€æ£€ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Srcdocno</span><span class="o">=</span><span class="n">Doctor</span>   <span class="p">;</span><span class="err">é€æ£€åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Userno</span><span class="o">=</span><span class="n">ReceiveUser</span> <span class="p">;</span><span class="err">æ£€éªŒåŒ»ç”Ÿ</span><span class="p">(</span><span class="err">å½•å…¥è€…</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Patno</span><span class="o">=</span><span class="n">RegNo</span> <span class="p">;</span><span class="err">ç™»è®°å·</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">BarCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Patna</span><span class="o">=</span><span class="n">PatName</span>   <span class="p">;</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="mi">1</span>  <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;ç”·&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>     <span class="p">;</span><span class="mi">1</span><span class="p">:</span><span class="err">ç”·</span> <span class="err">ï¼Œ</span><span class="mi">2</span> <span class="err">å¥³</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">Species</span> <span class="o">=</span><span class="s2">&#34;å¥³&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Pattype</span><span class="o">=</span><span class="n">AdmType</span>   <span class="p">;</span><span class="err">ç—…äººç±»å‹</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Bedno</span> <span class="o">=</span> <span class="n">BedNo</span>    <span class="p">;</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Patage</span><span class="o">=</span><span class="n">Age</span>  <span class="p">;</span><span class="err">å¹´é¾„</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Ageunit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å¹´é¾„å•ä½</span>
</span></span><span class="line"><span class="cl">  	<span class="n">s</span> <span class="n">Reqno</span><span class="o">=</span><span class="n">labno</span>  <span class="p">;</span><span class="err">ç”³è¯·å·</span> <span class="o">=</span> <span class="err">æ£€éªŒå·</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Reqda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Reqda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">ReceiveTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span><span class="err">é€æ£€æ—¥æœŸ</span> <span class="o">=</span> <span class="err">æ¥æ”¶æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Reportda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">æŠ¥å‘Šæ—¥æœŸ</span>  <span class="o">=</span> <span class="err">åˆå®¡</span><span class="p">(</span><span class="err">ä¿å­˜ç»“æœ</span><span class="p">)</span><span class="err">æ—¶é—´</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Printflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">æ‰“å°æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Resultflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç»“æœæ ‡å¿—</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Errflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">é”™è¯¯æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Diagnose</span> <span class="o">=</span> <span class="n">Diagnose</span>   <span class="p">;</span><span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Description</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">å¤‡æ³¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Reserve</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ä¿ç•™å­—æ®µ</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Patnamn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å§“åæ‹¼éŸ³ç </span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Getda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">CollectTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">e</span>  <span class="n">s</span> <span class="n">Getda</span><span class="o">=</span><span class="n">Reqda</span> <span class="p">;</span><span class="err">æ¥æ”¶æ—¶é—´</span><span class="o">/</span><span class="err">é‡‡æ ·æ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Wardno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç—…åŒº</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">EpisodeNo</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Diagnose</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">Sampleda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Instrument_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampleno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampletype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Feetype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdepno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdocno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Userno_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patna_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sex_</span><span class="s2">&#34;,&#34;</span><span class="n">_Pattype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Bedno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patage_</span><span class="s2">&#34;,&#34;</span><span class="n">_Ageunit_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqda_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Reportda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Printflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Resultflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Errflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Diagnose_</span><span class="s2">&#34;,&#34;</span><span class="n">_Description_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reserve_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patnamn_</span><span class="s2">&#34;,&#34;</span><span class="n">_Getda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Wardno_</span><span class="s2">&#34;,&#34;</span><span class="n">_BarCode_</span><span class="s2">&#34;,&#34;</span><span class="n">_BirthDate_</span><span class="s2">&#34;,&#34;</span><span class="n">_EpisodeNo</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">RetString</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">åŒå‘ä¸Šä¼ åŒ»å˜±ä¿¡æ¯</span><span class="p">,</span><span class="n">wwh</span><span class="p">,</span><span class="mi">2015</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">05</span><span class="p">,</span><span class="err">æœªæµ‹è¯•</span>
</span></span><span class="line"><span class="cl"><span class="n">SendOrder</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">record</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mshStr</span><span class="p">,</span><span class="n">record</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">mshStr</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mshStr</span><span class="p">),</span><span class="n">record</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(mi) 1</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$D(^TMIF(mi)) 1</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">barcode</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="s1">&#39;$L(barcode) {</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç å·ä¸ºç©º&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">ZCVT</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span><span class="o">=$</span><span class="n">ZCVT</span><span class="p">(</span><span class="s2">&#34;Invalid&#34;</span><span class="p">,</span><span class="s2">&#34;U&#34;</span><span class="p">)</span> <span class="p">{</span>				<span class="o">//</span><span class="err">æ¡ç æ‰«æé”™è¯¯</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«æé”™è¯¯,æœºå™¨æœªè¯†åˆ«&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="s1">&#39;$D(^TEPI(barcode)) {</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;åœ¨æ£€éªŒç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç :&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;å¯¹åº”çš„æ ‡æœ¬ä¿¡æ¯,ç¡®å®šæ¡ç æ­£ç¡®æˆ–æ ‡æœ¬å·²ç»æ¥æ”¶?&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">uploadList</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tsCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">uploadList</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">tsCode</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tsCode</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(tsCode)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$D(^TMIF(mi,0,tsCode))</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">tsDesc</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TTAB</span><span class="p">(</span><span class="s2">&#34;TS&#34;</span><span class="p">,</span><span class="n">tsCode</span><span class="p">)),</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,1)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">tsCnt</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tsCode</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(tsCnt)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">status</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">barcode</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tsCode</span><span class="p">,</span><span class="n">tsCnt</span><span class="p">)),</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,31)</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="n">status</span><span class="o">=</span><span class="s2">&#34;A&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«:&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;,åŒ»å˜±:&#34;</span><span class="n">_tsCode_</span><span class="s2">&#34;||&#34;</span><span class="n">_tsDesc_</span><span class="s2">&#34;,ä¸æ˜¯ç™»è®°çŠ¶æ€,ä¸å†ä¸Šä¼ &#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>	
</span></span><span class="line"><span class="cl">			<span class="n">Continue</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">channel</span><span class="o">=$$</span><span class="n">GetTestSetChannel</span><span class="p">(</span><span class="n">tsCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="s1">&#39;$L(channel) {</span>
</span></span><span class="line"><span class="cl">			<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«:&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;,åŒ»å˜±:&#34;</span><span class="n">_tsCode_</span><span class="s2">&#34;||&#34;</span><span class="n">_tsDesc_</span><span class="s2">&#34;,æœªæ‰¾åˆ°é€šé“å·&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>	
</span></span><span class="line"><span class="cl">			<span class="n">Continue</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">Continue</span><span class="p">:</span><span class="o">$</span><span class="n">D</span><span class="p">(</span><span class="n">uploadList</span><span class="p">(</span><span class="n">tsCode</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">uploadList</span><span class="p">(</span><span class="n">tsCode</span><span class="p">)</span><span class="o">=</span><span class="n">channel</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">uploadList</span><span class="o">=$</span><span class="n">I</span><span class="p">(</span><span class="n">uploadList</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">+$</span><span class="n">G</span><span class="p">(</span><span class="n">uploadList</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">D</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;æ¡ç æ‰«:&#34;</span><span class="n">_barcode_</span><span class="s2">&#34;æœªæ‰¾å¯ä¸Šä¼ çš„åŒ»å˜±&#34;</span><span class="p">,</span><span class="s2">&#34;Order&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="mi">1</span><span class="p">,</span><span class="err">ä»ªå™¨å‘é€è¿‡æ¥çš„è¯·æ±‚ä¿¡æ¯</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSH</span><span class="o">|^~</span>\<span class="o">&amp;||</span><span class="n">Mindray</span><span class="o">|||</span><span class="mi">20081120174836</span><span class="o">||</span><span class="n">ORM</span><span class="o">^</span><span class="n">O01</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="n">P</span><span class="o">|</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">1</span><span class="o">||||||</span><span class="n">UNICODE</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">ORC</span><span class="o">|</span><span class="n">RF</span><span class="o">||</span><span class="n">SampleID1</span><span class="o">||</span><span class="ne">IP</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">msh</span><span class="o">=</span><span class="s2">&#34;MSH|^~\&amp;|LIS||||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZDT</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s2">&#34; :&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;||ORR^O02|1|P|2.3.1||||||UNICODE&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">huifu</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSH</span><span class="o">|^~</span>\<span class="o">&amp;|</span><span class="n">LIS</span><span class="o">||||</span><span class="mi">20081120174836</span><span class="o">||</span><span class="n">ORR</span><span class="o">^</span><span class="n">O02</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">P</span><span class="o">|</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">1</span><span class="o">||||||</span><span class="n">UNICODE</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSA</span><span class="o">|</span><span class="n">AA</span><span class="o">|</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">PID</span><span class="o">|</span><span class="mi">1</span><span class="o">||</span><span class="n">ChartNo</span><span class="o">^^^^</span><span class="n">MR</span><span class="o">||^</span><span class="n">FName</span><span class="o">||</span><span class="mi">19810506</span><span class="o">|</span><span class="n">NT</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">PV1</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">E</span><span class="o">|</span><span class="err">å†…ç§‘</span><span class="o">^^</span><span class="n">Bn4</span><span class="o">|||||||||||||||||</span><span class="n">NewCharge</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">ORC</span><span class="o">|</span><span class="n">AF</span><span class="o">|</span><span class="n">SampleID1</span><span class="o">|||</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBR</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">SampleID1</span><span class="o">||||</span><span class="mi">20060506</span><span class="o">||||</span><span class="n">tester</span><span class="o">|||</span><span class="n">Diagnose</span> <span class="n">content</span><span class="o">...|</span><span class="mi">20060504</span><span class="o">||||||||</span><span class="mi">20080821</span><span class="o">||</span><span class="n">HM</span><span class="o">||||</span><span class="err">å®¡æ ¸è€…</span><span class="o">||||</span><span class="err">æ£€éªŒè€…</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">IS</span><span class="o">|</span><span class="mi">08001</span><span class="o">^</span><span class="n">Take</span> <span class="n">Mode</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">A</span><span class="o">||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">2</span><span class="o">|</span><span class="n">IS</span><span class="o">|</span><span class="mi">08002</span><span class="o">^</span><span class="n">Blood</span> <span class="n">Mode</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">W</span><span class="o">||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">3</span><span class="o">|</span><span class="n">IS</span><span class="o">|</span><span class="mi">08003</span><span class="o">^</span><span class="n">Test</span> <span class="n">Mode</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">CBC</span><span class="o">||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="n">IS</span><span class="o">|</span><span class="mi">01002</span><span class="o">^</span><span class="n">Ref</span> <span class="n">Group</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">XXXX</span><span class="o">||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">5</span><span class="o">|</span><span class="n">NM</span><span class="o">|</span><span class="mi">30525</span><span class="o">-</span><span class="mi">0</span><span class="o">^</span><span class="n">Age</span><span class="o">^</span><span class="n">LN</span><span class="o">||</span><span class="mi">1</span><span class="o">|</span><span class="n">hr</span><span class="o">|||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">OBX</span><span class="o">|</span><span class="mi">6</span><span class="o">|</span><span class="n">ST</span><span class="o">|</span><span class="mi">01001</span><span class="o">^</span><span class="n">Remark</span><span class="o">^</span><span class="mi">99</span><span class="n">MRC</span><span class="o">||</span><span class="n">remark</span> <span class="n">content</span><span class="o">...||||||</span><span class="n">F</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">æœªæ‰¾åˆ°æ£€æµ‹æ—¶</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSH</span><span class="o">|^~</span>\<span class="o">&amp;|</span><span class="n">LIS</span><span class="o">||||</span><span class="mi">20081120174836</span><span class="o">||</span><span class="n">ORR</span><span class="o">^</span><span class="n">O02</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">P</span><span class="o">|</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">1</span><span class="o">||||||</span><span class="n">UNICODE</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">MSA</span><span class="o">|</span><span class="n">AR</span><span class="o">|</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">GetTestSetChannel</span><span class="p">(</span><span class="n">tsCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">N</span> <span class="p">(</span><span class="n">tsCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tsCode</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">tsCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="link" href="assets/8-%e8%a1%80%e7%bb%86%e8%83%9e%ef%bc%88%e8%bf%88%e7%91%9e7500%ef%bc%89%ef%bc%89H-046-011151-00-7.0%20labXpert%20%e9%80%9a%e4%bf%a1%e5%8d%8f%e8%ae%ae%ef%bc%88%e4%b8%ad%e6%96%87%ef%bc%89-20250111212208-ghft7fx.pdf" >8-è¡€ç»†èƒï¼ˆè¿ˆç‘7500ï¼‰ï¼‰H-046-011151-00-7.0 labXpert é€šä¿¡åè®®ï¼ˆä¸­æ–‡ï¼‰.pdf</a></p>
<p><img src="/p/assets/image-20250111002720-fzqnjdw.png"
	width="722"
	height="1627"
	srcset="/p/assets/image-20250111002720-fzqnjdw_hu_692a2af968a321e9.png 480w, /p/assets/image-20250111002720-fzqnjdw_hu_37ba8e8aa61e109f.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="44"
		data-flex-basis="106px"
	
></p>
<h3 id="astm-åè®®æ¥å£åŒå‘">ASTM åè®®æ¥å£åŒå‘
</h3><h4 id="ä¸€æ¬¡æ€§å‘é€æŒ‰ç…§å­—ç¬¦æ•°å¤šæ¬¡å‘é€">ä¸€æ¬¡æ€§å‘é€æŒ‰ç…§å­—ç¬¦æ•°å¤šæ¬¡å‘é€
</h4><blockquote>
<p>é™åˆ¶æ¯æ¬¡å‘é€å­—æ•°ä¸èƒ½è¶…è¿‡ 241 ä¸ªå­—æ•°ï¼Œåœ¨å›ä¼ æ—¶è¦æ ¹æ®å›ä¼ çš„å­—ç¬¦æ•°è¿›è¡Œåˆ†å‰²</p></blockquote>
<h5 id="ç¤ºä¾‹æ¥å£æ—¥ç«‹-008">ç¤ºä¾‹æ¥å£(æ—¥ç«‹ 008)
</h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">////</span> <span class="n">MI</span><span class="o">.</span><span class="n">MIFABH7600BI</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">åç§°</span><span class="p">:</span> <span class="n">MI</span><span class="o">.</span><span class="n">MIFDXC800BI</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">æè¿°</span><span class="p">:</span> <span class="n">DXC800</span> <span class="err">ä»ªå™¨æ¥å£</span>  
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">é€šè®¯æ–¹å¼ï¼šåŒå‘</span><span class="p">,</span><span class="err">åŠåŒå·¥</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">ç¼–å†™è€…</span><span class="p">:</span><span class="n">liuzf</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">ç¼–å†™æ—¥æœŸ</span><span class="p">:</span> <span class="mi">20150827</span>
</span></span><span class="line"><span class="cl"><span class="n">MIFABH7600BI</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="p">;</span> <span class="mi">3</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">04</span> <span class="p">;</span> <span class="n">ASTM</span> <span class="n">protocol</span> <span class="o">-</span> <span class="n">H7600</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">^</span><span class="n">TMPMACH10</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">104</span><span class="p">)</span><span class="o">=$</span><span class="n">H</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(mi) q</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ItemDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">12</span><span class="p">)</span> <span class="o">//</span><span class="err">é¡¹ç›®åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ResultDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">13</span><span class="p">)</span> <span class="o">//</span><span class="err">ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AntDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">14</span><span class="p">)</span> <span class="o">//</span><span class="err">æŠ—ç”Ÿç´ åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SenDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span> <span class="o">//</span><span class="err">è¯æ•ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Port</span><span class="o">=</span><span class="s2">&#34;|TCP|&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>  <span class="o">//</span><span class="err">ç«¯å£å·</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ§åˆ¶å­—ç¬¦</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">stx</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">etx</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ack</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">enq</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">eot</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">lf</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">nak</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">21</span><span class="p">),(</span><span class="n">result</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">etb</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">^</span><span class="n">TMPMACH10</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">102</span><span class="p">)</span><span class="o">=$</span><span class="n">H</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$$</span><span class="n">Start</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">	<span class="n">f</span>  <span class="n">d</span> <span class="n">Main</span> <span class="n">i</span> <span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  	<span class="n">c</span> <span class="n">Port</span>
</span></span><span class="line"><span class="cl">  	<span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">ErrHandler</span>
</span></span><span class="line"><span class="cl">	<span class="n">h</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZERROR</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="s2">&#34;--&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;.é”™è¯¯ä»£ç :&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ECODE</span><span class="p">,</span><span class="s2">&#34;Runtime Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">iERR</span><span class="o">=+$</span><span class="n">g</span><span class="p">(</span><span class="n">iERR</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">iERR</span><span class="o">&gt;</span><span class="mi">30</span> <span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl"><span class="n">Main</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">SET</span> <span class="o">$</span><span class="n">ZTRAP</span><span class="o">=</span><span class="s2">&#34;ErrHandler&#34;</span> <span class="n">S</span> <span class="n">iERR</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">   <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span> <span class="n">e</span>  <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">BUILD</span>
</span></span><span class="line"><span class="cl">  <span class="o">.//</span><span class="err">è‡ªåŠ¨ä¸Šä¼ </span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">BUILD2</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">ACK</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">f</span>  <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span> <span class="n">q</span><span class="p">:</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=stx q</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">record</span><span class="o">=$$</span><span class="n">Read</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">lf</span><span class="p">)</span> <span class="n">q</span><span class="p">:</span><span class="s1">&#39;$l(record)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">record</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="n">AllRecord_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="n">etb</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">d</span> <span class="n">ACK</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">:</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="p">(</span><span class="n">mid</span><span class="p">,</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">Pflag</span><span class="p">,</span><span class="n">code</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">cr</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">rec</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;rec&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">type</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;H&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="p">(</span><span class="n">mid</span><span class="p">,</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">racksid</span><span class="p">,</span><span class="n">rackno</span><span class="p">,</span><span class="n">code</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;Q&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">Q</span><span class="o">|</span><span class="mi">1</span><span class="o">|^^</span><span class="mi">0</span><span class="o">/*************/</span><span class="mi">1</span><span class="o">/</span><span class="mi">5527</span><span class="o">/</span><span class="mi">5</span><span class="o">/</span><span class="n">R1</span><span class="o">/</span><span class="n">R</span><span class="o">||||||||||</span><span class="n">A</span><span class="s2">&#34;_$c(13)_&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">temstr</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">temlabno</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">s</span> <span class="n">temlabno</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34;*&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">i</span> <span class="s1">&#39;$l(temlabno) q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">s</span> <span class="n">racksid</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">s</span> <span class="n">rackno</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">S</span> <span class="n">temlabno</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">temlabno</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">s</span> <span class="n">temlabno</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34;*&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">i</span> <span class="s1">&#39;$l(temlabno) q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">racksid</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">rackno</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;temlabnoInfo&#34;</span><span class="p">,</span><span class="n">temlabno</span><span class="p">)</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">temlabno</span><span class="p">,</span><span class="s2">&#34;temlabno&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">s</span> <span class="n">temlabno</span><span class="o">=</span><span class="mi">9000001621</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="s1">&#39;$l(temlabno) q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="n">temlabno</span><span class="p">)</span><span class="o">=</span><span class="n">racksid_</span><span class="s2">&#34;^&#34;</span><span class="n">_rackno</span>
</span></span><span class="line"><span class="cl">  <span class="o">...//------------------------------------</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;O&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="k">if</span> <span class="n">epis</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">s</span> <span class="n">epis</span><span class="o">=+$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">qcid</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">qcid</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">qcid</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">QCStat</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">SpecStat</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="n">SpecStat</span><span class="o">=</span><span class="s2">&#34;S&#34;</span> <span class="n">s</span> <span class="n">epis</span><span class="o">=</span><span class="n">epis</span> <span class="o">//</span><span class="n">s</span> <span class="n">epis</span><span class="o">=</span><span class="s2">&#34;E&#34;</span><span class="n">_epis</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="n">QCStat</span><span class="o">=</span><span class="s2">&#34;Q&#34;</span> <span class="n">s</span> <span class="n">QC</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">_qcid,epis=qcid</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">s</span> <span class="n">QC</span><span class="o">=$$</span><span class="n">findQC</span><span class="o">^</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">datex</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....//</span><span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;/&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;/&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">;,</span><span class="n">date</span><span class="o">=$$</span><span class="n">intdate</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....//</span><span class="n">s</span> <span class="n">time</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span> <span class="p">;,</span><span class="n">time</span><span class="o">=$$</span><span class="n">inttime</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="n">time1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...//--------------------</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;R&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">code</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">mid1</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....//</span><span class="n">DaiYi</span> <span class="mi">20111226</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">mid1</span><span class="o">=</span><span class="s2">&#34;ISE1&#34;</span> <span class="n">Set</span> <span class="n">mid1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">If</span> <span class="n">mid1</span><span class="o">=</span><span class="s2">&#34;D1&#34;</span> <span class="n">Set</span> <span class="n">mid1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">If</span> <span class="n">mid1</span><span class="s1">&#39;=&#34;&#34;,QC&#39;</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">Set</span> <span class="n">QC</span><span class="o">=$$</span><span class="n">findQC</span><span class="o">^</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_mid1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">If</span> <span class="n">mid1</span><span class="s1">&#39;=&#34;&#34;,QC&#39;</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">Set</span> <span class="n">epis</span><span class="o">=</span><span class="n">epis_mid1</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">mid1</span><span class="s1">&#39;=&#34;&#34; s mid=mid1</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">res</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;C&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....//-----</span><span class="n">FLAG</span><span class="o">---</span><span class="n">DaiYi</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">12</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">resFlag</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">0</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">26</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;$&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">5</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;Z&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">43</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;!&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">1</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;A&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">2</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;Q&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">3</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;V&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">4</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;T&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">6</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;P&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">7</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;I&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">8</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;J&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">9</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;K&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">10</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;W&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">11</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;F&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">12</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;H&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">13</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;U&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">14</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;S&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">15</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;Y&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">16</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;G&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">17</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;B&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">18</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;N&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">19</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;L&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">20</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;E&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">21</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;R&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">22</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;D&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">23</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;&amp;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">24</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;Z&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">25</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;M&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">27</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;$&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">28</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;@&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">29</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;#&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">30</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;#&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">31</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;#&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">32</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;#&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">33</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;#&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">34</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;#&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">35</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;+&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">36</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;+&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">37</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;%&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">38</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;O&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">39</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;X&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">42</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;&#39;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">43</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;!&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">44</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;=&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">45</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;=&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">46</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;&gt;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">51</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;:&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">52</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">53</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">55</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;r&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">62</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;g&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">63</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;a&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">64</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;b&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">65</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;p&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">66</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;q&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">67</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;h&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">68</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;k&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">69</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;m&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">70</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;f&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">71</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;d&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">72</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;e&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">74</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;y&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">75</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;t&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">76</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;s&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">77</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;c&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">86</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;u&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">87</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;n&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">93</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;z&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">94</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;]&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">95</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;[&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">96</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;[&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">97</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;}&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">98</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;v&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">99</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;w&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">100</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;&lt;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">If</span> <span class="n">resFlag</span><span class="o">=</span><span class="mi">101</span> <span class="n">Set</span> <span class="n">resFlag</span><span class="o">=</span><span class="s2">&#34;ï¿¥&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="p">;</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">result_code_ResultDeli_res_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">92</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span><span class="mi">92</span><span class="p">)</span><span class="n">_resFlag_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">result_code_ResultDeli_res_ItemDeli</span>
</span></span><span class="line"><span class="cl">  <span class="o">....//------------------------------------------------</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;L&#34;</span> <span class="n">d</span> <span class="n">Last</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Last</span>	<span class="p">;</span> <span class="n">file</span> <span class="n">result</span> <span class="k">if</span> <span class="n">exist</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">BUILD</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;1H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="s2">&#34;1H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">s</span> <span class="n">epis</span><span class="o">=</span><span class="mi">9775</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="n">d</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">BUILD</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="s1">&#39;$d(^TMP($zn)) q</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="s1">&#39;$d(^TMP($zn,$j)) q </span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">labno</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">labno</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="n">labno</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">labno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="err">æ ¹æ®é¢„ç½®æ¡ç å·å–å¾—æ£€éªŒæ¡ç å·</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="o">^</span><span class="n">aai200</span><span class="p">(</span><span class="mi">763</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.//</span><span class="n">s</span> <span class="n">labno1</span><span class="o">=$$</span><span class="n">GetLabNo</span><span class="o">^</span><span class="n">CHDhcLabDoEpis</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.//</span><span class="n">s</span> <span class="o">^</span><span class="n">aai200</span><span class="p">(</span><span class="mi">764</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="n">labno1_</span><span class="s2">&#34;,&#34;</span><span class="n">_labno_</span><span class="s2">&#34;,&#34;</span><span class="n">_mi</span>
</span></span><span class="line"><span class="cl">  <span class="o">.//----</span><span class="err">åˆ¤æ–­æ—¥å¿—æ¡ç å’Œç³»ç»Ÿæ¡ç æ˜¯å¦ä¸€æ ·</span><span class="o">----</span>
</span></span><span class="line"><span class="cl">  <span class="o">.//</span><span class="n">If</span> <span class="n">labno</span><span class="o">=</span><span class="n">labno1</span> <span class="n">Quit</span>
</span></span><span class="line"><span class="cl">  <span class="o">.//--------------------------------------</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">chl</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">chl</span><span class="p">,</span><span class="s2">&#34;_&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;^</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">tcx</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">tcx</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="n">xx</span><span class="o">=$$</span><span class="n">extdate2</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">),</span><span class="n">date</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="n">xx</span><span class="o">=$$</span><span class="n">exttime</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="n">time</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;00&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">temepis</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;1H|\^&amp;|||host^1|||||LST008AS|TSDWN^REPLY|P|1&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.//</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;P|1|||||||M||||||48^Y&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;P|1|||||||||||||&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">samtype</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">racksid</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="n">labno</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="n">rackno</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="n">labno</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">temlabnoInfo</span><span class="o">=^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;temlabnoInfo&#34;</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">i</span> <span class="n">labno</span><span class="o">=</span><span class="s2">&#34;N&#34;</span> <span class="n">s</span> <span class="n">labno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">d</span> <span class="n">SetTSMachine</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">racksid</span><span class="p">,</span><span class="n">rackno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;O|1|&#34;</span><span class="n">_labno_</span><span class="s2">&#34;|&#34;</span><span class="n">_temlabnoInfo_</span><span class="s2">&#34;|&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_tcx_</span><span class="s2">&#34;|R||&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zdt</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">),</span><span class="s2">&#34;:&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;||||A||||1||||||||||O&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;O|1|40045259602|0^00001^1^^S1^SC|^^^601^\^^^1011^dec</span><span class="se">\101</span><span class="s2">2^400|R||20000630131236||||A||||1||||||||||O&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;C|1|I|comment1^comment2^comment3^comment4^comment5|G&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;L|1|N&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">Send</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">k</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">k</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;temlabnoInfo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   <span class="o">//</span><span class="err">è¯»å–è‡ªåŠ¨ä¸Šä¼ çš„æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl"><span class="n">BUILD2</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">LabnoList</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MI&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">AddDate</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AddTime</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddTime</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate,AddTime)) q:AddTime=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">MiUploadDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate,AddTime,&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">Labno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="n">H</span> <span class="mi">1</span>  <span class="o">//</span><span class="err">æ¯éš”</span><span class="mi">2</span><span class="n">Så¤„ç†ä¸€ä¸ªæ ‡æœ¬ä¸Šä¼ </span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">S</span> <span class="n">SIMAck</span><span class="o">=$$</span><span class="n">BUILD3</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">I</span> <span class="n">SIMAck</span><span class="o">=</span><span class="mi">0</span> <span class="n">D</span>  
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">err</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,Labno,&#34;S&#34;,&#34;&#34;)  //æˆåŠŸ</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">E</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">err</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,Labno,&#34;F&#34;,&#34;&#34;)  //å¤±è´¥</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span>  
</span></span><span class="line"><span class="cl"><span class="n">BUILD3</span><span class="p">()</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">  	<span class="n">S</span> <span class="n">episx</span><span class="o">=</span><span class="n">Labno</span><span class="p">,</span><span class="n">Labno</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">Labno</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">RetAck</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(Labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">WorkGPMiDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">))</span> 
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">WorkGPMiDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RptOrder</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span> <span class="n">WorkGPMiDR</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span> 
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">RptOrder</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ReportDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span> <span class="n">WorkGPMiDR</span><span class="p">,</span><span class="n">RptOrder</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">ReportDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">EpisodeNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">ReportDR</span><span class="p">)),</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">EpisodeNo</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">epis</span><span class="o">=</span><span class="n">EpisodeNo</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">Labno</span><span class="p">)</span> <span class="p">;</span><span class="err">åˆ›å»ºä¸Šä¼ åŒ–éªŒé¡¹ç›®åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="s1">&#39;$D(^TMP(&#34;MIFTESTCODE&#34;,$j,mi,Labno)) q 1</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">chl</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">Labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">chl</span><span class="p">,</span><span class="s2">&#34;_&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;/</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">tcx</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">tcx</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">time</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;1H|\^&amp;|||H7600^1|||||host|TSDWN^REPLY|P|1&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;P|1&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;O|1|&#34;</span><span class="n">_epis_</span><span class="s2">&#34;^^1^^|R1|&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_tcx_</span><span class="s2">&#34;|R||&#34;</span><span class="n">_date_time_</span><span class="s2">&#34;||||N||||||||^^^^||||||O&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;L|1|N&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">d</span> <span class="n">Send</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="o">//</span><span class="err">ç»™æ£€éªŒå·èµ‹ä»ªå™¨å’Œä½ç½®å·</span>
</span></span><span class="line"><span class="cl"><span class="n">SetTSMachine</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">rack</span><span class="p">,</span><span class="n">pos</span><span class="p">)</span> <span class="n">n</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">rack</span><span class="p">,</span><span class="n">pos</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"> <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">rack</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">rack</span><span class="p">),</span><span class="n">pos</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> <span class="n">If</span> <span class="o">$</span><span class="n">Data</span><span class="p">(</span><span class="o">^</span><span class="n">DHCSndLabNo</span><span class="p">(</span><span class="n">labno</span><span class="p">))</span> <span class="n">Set</span> <span class="o">^</span><span class="n">DHCSndLabNo</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="n">labno_</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">_rack_&#34;</span><span class="o">-</span><span class="s2">&#34;_pos_&#34;</span>\<span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="n">q</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">ORDER</span>  <span class="p">;</span> <span class="n">create</span> <span class="n">list</span> <span class="n">of</span> <span class="n">orders</span> <span class="k">if</span> <span class="n">exists</span> <span class="p">;</span> <span class="o">^</span><span class="n">DHCMIFLoadList</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;PEND&#34;</span><span class="p">,</span><span class="n">flowno</span><span class="p">)</span> <span class="err">æš‚æ—¶å­˜å‚¨ä¸Šä¼ åŒ»å˜±åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">ord</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">f</span>  <span class="n">s</span> <span class="n">ord</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">DHCMIFLoadList</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;PEND&#34;</span><span class="p">,</span><span class="n">ord</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">ord</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">rectemp</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">DHCMIFLoadList</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;PEND&#34;</span><span class="p">,</span><span class="n">ord</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">epis</span><span class="o">=</span><span class="n">ord</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">tcs</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="err">åŒ–éªŒé¡¹ç›®åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">rectemp</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">)</span> <span class="n">d</span> 
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">tc</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rectemp</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">q</span><span class="p">:</span><span class="n">tc</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">tcs</span><span class="o">=</span><span class="n">tcs_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_tc_</span><span class="s2">&#34;/</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">tcs</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">tcs</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">tcs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="err">æ—¥æœŸæ—¶é—´</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">xx</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">time</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;00&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="n">xx</span><span class="o">=$$</span><span class="n">extdate2</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">),</span><span class="n">date</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="n">xx</span><span class="o">=$$</span><span class="n">exttime</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="n">time</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;00&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;1H|\^&amp;|||HOST^1|||||1-99999|TSDWN^REPLY|P|1&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;P|1&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;O|1|&#34;</span><span class="n">_epis_</span><span class="s2">&#34;^ ^1^^|R1|&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_tcs_</span><span class="s2">&#34;|R||&#34;</span><span class="n">_date_time_</span><span class="s2">&#34;||||N||||||||^^^^||||||O&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;L|1|N&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">Send</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="o">^</span><span class="n">DHCMIFLoadList</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;TRAN&#34;</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">DHCMIFLoadList</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;PEND&#34;</span><span class="p">,</span><span class="n">epis</span><span class="p">))</span> <span class="p">;</span><span class="err">ä¿å­˜å·²ä¼ è¾“æ•°æ®</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">k</span> <span class="o">^</span><span class="n">DHCMIFLoadList</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;PEND&#34;</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span> <span class="p">;</span><span class="err">åˆ é™¤å¾…ä¼ è¾“æ•°æ®</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Send</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span>  <span class="p">;</span> <span class="n">send</span> <span class="n">list</span> <span class="n">of</span> <span class="n">orders</span> <span class="k">if</span> <span class="n">exists</span>
</span></span><span class="line"><span class="cl">  <span class="n">h</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="cl">  <span class="p">;</span><span class="n">w</span> <span class="n">enq</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">trace</span><span class="o">^</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">w</span> <span class="n">enq</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">f</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span> <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">:</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">nak</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;1H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=ack w eot,*-3 d Trace^MI.MIF000(mi,&#34;EOT&#34;,&#34;H--&gt;M&#34;) q</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">240</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">str1</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">240</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">strS</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">strS</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">240</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">str2</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">strS</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">240</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">strS1</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">strS</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">strS</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">strS1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">240</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">str3</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">strS1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">240</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">str4</span><span class="o">=</span><span class="s2">&#34;4&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">strS1</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">strS1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">e</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">str3</span><span class="o">=</span><span class="s2">&#34;3&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">strS1</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">strS1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">e</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">str2</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">e</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">;</span><span class="n">f</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span> <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="p">;</span><span class="n">d</span> <span class="n">trace</span><span class="o">^</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">:</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">nak</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;2H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">w</span> <span class="n">eot</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Sendold</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="p">;</span> <span class="n">send</span> <span class="n">list</span> <span class="n">of</span> <span class="n">orders</span> <span class="k">if</span> <span class="n">exists</span>
</span></span><span class="line"><span class="cl">  <span class="n">w</span> <span class="n">enq</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">f</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span> <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">:</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">nak</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;1H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=ack w eot,*-3 d Trace^MI.MIF000(mi,&#34;EOT&#34;,&#34;H--&gt;M&#34;) q</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">241</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">str1</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">241</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">str2</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">e</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">w</span> <span class="n">eot</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">SEND</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span> <span class="p">;</span> <span class="n">send</span> <span class="n">string</span> <span class="n">to</span> <span class="n">instrument</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="n">flag</span><span class="o">=</span><span class="mi">1</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_etb</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">chsum</span><span class="o">=$$</span><span class="n">CHSUM</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">e</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_etx</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">chsum</span><span class="o">=$$</span><span class="n">CHSUM</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">w</span> <span class="n">stx</span><span class="p">,</span><span class="nb">str</span><span class="p">,</span><span class="n">chsum</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">lf</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">str_chsum</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">f</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span> <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">i</span> <span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">)</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span> <span class="n">q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span> <span class="n">q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span> <span class="n">w</span> <span class="n">nak</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">CHSUM</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">;</span> <span class="n">calculate</span> <span class="n">check</span> <span class="n">sum</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">s</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span> <span class="n">f</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">s</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">+$</span><span class="n">a</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">z</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="s2">&#34;0123456789ABCDEF&#34;</span><span class="p">,</span><span class="n">z</span><span class="c1">#256\16+1)_$e(&#34;0123456789ABCDEF&#34;,z#16+1)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="n">z</span>
</span></span><span class="line"><span class="cl"><span class="n">ACK</span>  <span class="p">;</span> <span class="n">send</span> <span class="s1">&#39;ack&#39;</span> <span class="n">to</span> <span class="n">instrument</span>
</span></span><span class="line"><span class="cl">  <span class="n">w</span> <span class="n">ack</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">NEXTTRAY</span><span class="p">(</span><span class="n">tray</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="n">tray</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/assets/image-20250110224136-youpa8q.png"
	width="784"
	height="192"
	srcset="/p/assets/image-20250110224136-youpa8q_hu_2f34ce67a3700519.png 480w, /p/assets/image-20250110224136-youpa8q_hu_3f4a00ee8f464669.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="408"
		data-flex-basis="980px"
	
></p>
<h4 id="é€šè¿‡æ”¶åˆ°-ack-å‘é€å¤šæ¡æ•°æ®">é€šè¿‡æ”¶åˆ° ACK å‘é€å¤šæ¡æ•°æ®
</h4><h5 id="ç¤ºä¾‹æ¥å£è´å…‹æ›¼-dxh900">ç¤ºä¾‹æ¥å£(è´å…‹æ›¼ DXH900)
</h5><blockquote>
<p>æ ‡å‡†çš„ ASTM å‘é€ç­‰æ”¶åˆ° ACK åç»§ç»­å›ä¼ ä¸‹ä¸€æ¡ä¿¡æ¯</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MIFDXH800I(MachID) 
</span></span><span class="line"><span class="cl">	s MachID=$g(MachID) 
</span></span><span class="line"><span class="cl">	S ^TMPMACH10(MachID,104)=$H
</span></span><span class="line"><span class="cl">	i &#39;$l(MachID) q
</span></span><span class="line"><span class="cl">	s ItemDeli=$li(^dbo.BTMIMachineParameterD(MachID),12) //é¡¹ç›®åˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s ResultDeli=$li(^dbo.BTMIMachineParameterD(MachID),13) //ç»“æœåˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s AntDeli=$li(^dbo.BTMIMachineParameterD(MachID),14) //æŠ—ç”Ÿç´ åˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s SenDeli=$li(^dbo.BTMIMachineParameterD(MachID),15) //è¯æ•ç»“æœåˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s Port=&#34;|TCP|&#34;_$li(^dbo.BTMIMachineParameterD(MachID),17) //ç«¯å£å·
</span></span><span class="line"><span class="cl">	//æ§åˆ¶å­—ç¬¦
</span></span><span class="line"><span class="cl">	s stx=$c(2),etx=$c(3),ack=$c(6),enq=$c(5),eot=$c(4),lf=$c(10),cr=$c(13),nak=$c(21)
</span></span><span class="line"><span class="cl">	//s stx=&#34;[&#34;,etx=&#34;]&#34;
</span></span><span class="line"><span class="cl">	S ^TMPMACH10(MachID,102)=$H
</span></span><span class="line"><span class="cl">	i $$Start^MI.MIF000(MachID) q
</span></span><span class="line"><span class="cl">	f  d Main i $$Stop^MI.MIF000(MachID) q
</span></span><span class="line"><span class="cl">  	c Port
</span></span><span class="line"><span class="cl">  	q
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	///ç»“æœé‡‡é›†å’Œæ•°æ®åˆ†è§£
</span></span><span class="line"><span class="cl">Main
</span></span><span class="line"><span class="cl">	r *R:10 e  d  q
</span></span><span class="line"><span class="cl">	.d ORDER
</span></span><span class="line"><span class="cl">  	i $c(R)&#39;=enq q
</span></span><span class="line"><span class="cl">  	d Trace^MI.MIF000(MachID,&#34;ENQ&#34;,&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl">  	d ACK
</span></span><span class="line"><span class="cl">  	s (Epis,Result,Date,Time,QC)=&#34;&#34;
</span></span><span class="line"><span class="cl">  	f  r *R:10 q:$c(R)=eot  q:R=-1  d
</span></span><span class="line"><span class="cl">  	.i $c(R)&#39;=stx q
</span></span><span class="line"><span class="cl">  	.s Record=$$Read^MI.MIF000(MachID,&#34;&#34;,lf) q:&#39;$l(Record)
</span></span><span class="line"><span class="cl">  	.d Trace^MI.MIF000(MachID,Record,&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl">  	.d ACK
</span></span><span class="line"><span class="cl">  	.i $e(Record,2)=&#34;C&#34; d  q
</span></span><span class="line"><span class="cl">  	..//æŠ¥è­¦ä¿¡æ¯
</span></span><span class="line"><span class="cl">  	..s PoliceInfo=$p(Record,&#34;|&#34;,4)
</span></span><span class="line"><span class="cl">  	..i $l(PoliceInfo),$d(^LISPolice(&#34;DXH900&#34;,PoliceInfo)) d
</span></span><span class="line"><span class="cl">  	...s InputInfo=$g(^LISPolice(&#34;DXH900&#34;,PoliceInfo))
</span></span><span class="line"><span class="cl">  	...d Trace^MI.MIF000(MachID,PoliceInfo_&#34;$$&#34;_InputInfo,&#34;æŠ¥è­¦ä¿¡æ¯&#34;)
</span></span><span class="line"><span class="cl">  	...try{s ret=##Class(MI.Special.Common).SaveAlarmInformation(MachID,Epis,InputInfo)}catch{}
</span></span><span class="line"><span class="cl">  	.i $e(Record,2)=&#34;Q&#34; d  q
</span></span><span class="line"><span class="cl">  	..//è¯¢é—®ä¿¡æ¯
</span></span><span class="line"><span class="cl">  	..s QEpis=$tr($p(Record,&#34;|&#34;,3),&#34;!&#34;)
</span></span><span class="line"><span class="cl">  	..;d Trace^MI.MIF000(MachID,QEpis,&#34;QEpis&#34;)
</span></span><span class="line"><span class="cl">    ..S ^TMPQUERY(MachID,1)=QEpis
</span></span><span class="line"><span class="cl">  	..i $l(QEpis) s ^TMP($zn,$j,&#34;ENQ&#34;,QEpis)=&#34;&#34;
</span></span><span class="line"><span class="cl">  	.i $e(Record,2)=&#34;H&#34; d  q
</span></span><span class="line"><span class="cl">  	..//ç»“æœå¤´ä¿¡æ¯
</span></span><span class="line"><span class="cl">  	..d Last s (Epis,Result,Date,Time,QC)=&#34;&#34;
</span></span><span class="line"><span class="cl">  	.i $e(Record,2)=&#34;P&#34; d  q
</span></span><span class="line"><span class="cl">  	..//ç—…äººä¿¡æ¯
</span></span><span class="line"><span class="cl">  	.i $e(Record,2)=&#34;O&#34; d  q
</span></span><span class="line"><span class="cl">  	..s Epis=$tr($p($p(Record,&#34;|&#34;,3),&#34;^&#34;,1),&#34; &#34;)
</span></span><span class="line"><span class="cl">  	..s QC=$tr($p(Record,&#34;|&#34;,12),&#34; &#34;) 
</span></span><span class="line"><span class="cl">  	..s:&#39;$l(Epis) Epis=$tr($p($p(Record,&#34;|&#34;,4),&#34;^&#34;,1),&#34; &#34;)
</span></span><span class="line"><span class="cl">  	..//åˆ¤æ–­æ˜¯å¦æ˜¯è´¨æ§ç¼–å·
</span></span><span class="line"><span class="cl">  	..//s QC=$$findQC^MIF000(mi,epis)
</span></span><span class="line"><span class="cl">  	.i $e(Record,2)=&#34;R&#34; d  q
</span></span><span class="line"><span class="cl">  	..//ç»“æœä¿¡æ¯
</span></span><span class="line"><span class="cl">  	..s Chl=$tr($tr($p($p(Record,&#34;|&#34;,3),&#34;!&#34;,4),&#34; &#34;),&#34;@&#34;)
</span></span><span class="line"><span class="cl">  	..//s ResStus=$tr($p($p(Record,&#34;|&#34;,3),&#34;^&#34;,11),&#34; &#34;)
</span></span><span class="line"><span class="cl">	..s Res=$p($tr($p(Record,&#34;|&#34;,4),&#34; &#34;),&#34;!&#34;,1)
</span></span><span class="line"><span class="cl">	..//i ResStus&#39;=&#34;F&#34; q //åˆ¤æ–­ç»“æœçŠ¶æ€
</span></span><span class="line"><span class="cl">	..i $l(Chl),$l(Res) s Result=Result_Chl_ResultDeli_Res_ItemDeli
</span></span><span class="line"><span class="cl">	.//ç»˜å›¾
</span></span><span class="line"><span class="cl">    .i $e(Record,2)=&#34;M&#34; d  q
</span></span><span class="line"><span class="cl">    ..//ç»“æœä¿¡æ¯
</span></span><span class="line"><span class="cl">    ..s Chl=$tr($p($p(Record,&#34;|&#34;,3),&#34;!&#34;,4),&#34; &#34;)
</span></span><span class="line"><span class="cl">    ..s Res=$P($tr($p(Record,&#34;|&#34;,4),&#34; |&#34;),&#34;!&#34;,1)
</span></span><span class="line"><span class="cl">    ..s Chl=$p(Chl,&#34;.&#34;,1)
</span></span><span class="line"><span class="cl">    ..i Chl=&#34;WBC&#34; d
</span></span><span class="line"><span class="cl">    ...s tretObj=##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()
</span></span><span class="line"><span class="cl">    ...s tret=tretObj.DrawImage(Epis,Res,MachID,&#34;MI.MIFDXH800&#34;,&#34;-1&#34;,&#34;Histogram#WBCF.bmp#######10#10#320#138&#34;,&#34;LIS.Mach.ImageDeal.ImageDealDXH800,LIS.Mach.ImageDeal&#34;) 
</span></span><span class="line"><span class="cl">    ...d Trace^MI.MIF000(MachID,tret,&#34;ç»˜å›¾è¿”å›&#34;)
</span></span><span class="line"><span class="cl">    ..i Chl=&#34;Plt&#34; d
</span></span><span class="line"><span class="cl">    ...s tretObj=##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()
</span></span><span class="line"><span class="cl">    ...s tret=tretObj.DrawImage(Epis,Res,MachID,&#34;MI.MIFDXH800&#34;,&#34;-1&#34;,&#34;Histogram#PLT.bmp#######10#10#320#138&#34;,&#34;LIS.Mach.ImageDeal.ImageDealDXH800,LIS.Mach.ImageDeal&#34;) 
</span></span><span class="line"><span class="cl">    ...d Trace^MI.MIF000(MachID,tret,&#34;ç»˜å›¾è¿”å›&#34;)
</span></span><span class="line"><span class="cl">    ..i Chl=&#34;RBC&#34; d
</span></span><span class="line"><span class="cl">    ...s tretObj=##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()
</span></span><span class="line"><span class="cl">    ...s tret=tretObj.DrawImage(Epis,Res,MachID,&#34;MI.MIFDXH800&#34;,&#34;-1&#34;,&#34;Histogram#RBCH.bmp#######10#10#320#138&#34;,&#34;LIS.Mach.ImageDeal.ImageDealDXH800,LIS.Mach.ImageDeal&#34;) 
</span></span><span class="line"><span class="cl">    ...d Trace^MI.MIF000(MachID,tret,&#34;ç»˜å›¾è¿”å›&#34;)
</span></span><span class="line"><span class="cl">    ..i Chl=&#34;5PD1&#34; d
</span></span><span class="line"><span class="cl">    ...s tretObj=##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()
</span></span><span class="line"><span class="cl">    ...s tret=tretObj.DrawImage(Epis,Res,MachID,&#34;MI.MIFDXH800&#34;,&#34;-1&#34;,&#34;DiffPlot#5PD1.bmp#######10#10#320#138&#34;,&#34;LIS.Mach.ImageDeal.ImageDealDXH800,LIS.Mach.ImageDeal&#34;) 
</span></span><span class="line"><span class="cl">    ...d Trace^MI.MIF000(MachID,tret,&#34;ç»˜å›¾è¿”å›&#34;)
</span></span><span class="line"><span class="cl">    ..i Chl=&#34;NRBC1&#34; d
</span></span><span class="line"><span class="cl">    ...s tretObj=##Class(wbsLisMsgAsyncHandler.LISMsg.wbsLisDrawImageAsyncHandlerSoap).%New()
</span></span><span class="line"><span class="cl">    ...s tret=tretObj.DrawImage(Epis,Res,MachID,&#34;MI.MIFDXH800&#34;,&#34;-1&#34;,&#34;DiffPlot#NRBC1.bmp#######10#10#320#138&#34;,&#34;LIS.Mach.ImageDeal.ImageDealDXH800,LIS.Mach.ImageDeal&#34;) 
</span></span><span class="line"><span class="cl">    ...d Trace^MI.MIF000(MachID,tret,&#34;ç»˜å›¾è¿”å›&#34;)
</span></span><span class="line"><span class="cl">	.i $e(Record,2)=&#34;L&#34; d Last q
</span></span><span class="line"><span class="cl">	d Trace^MI.MIF000(MachID,$s($c(R)=eot:&#34;EOT&#34;,1:R),&#34;H&lt;--M&#34;) 
</span></span><span class="line"><span class="cl">	d ORDER
</span></span><span class="line"><span class="cl">	q
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">	///ä¿å­˜ç»“æœ
</span></span><span class="line"><span class="cl">Last  ; file result if exist
</span></span><span class="line"><span class="cl">   i $l(Epis),$l(Result) d Save^MI.MIF000(MachID,Epis,Result,Date,Time,QC)
</span></span><span class="line"><span class="cl">   q
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	///ä¸Šä¼ é¡¹ç›®
</span></span><span class="line"><span class="cl">ORDER
</span></span><span class="line"><span class="cl">	s date=$tr($zdt($p($h,&#34;,&#34;,1),3),&#34;-&#34;)_$tr($zt($p($h,&#34;,&#34;,2)),&#34;:&#34;)
</span></span><span class="line"><span class="cl">	s ^TMPQUERY(MachID,2)=$d(^TMP($zn,$j))
</span></span><span class="line"><span class="cl">	i &#39;$d(^TMP($zn,$j)) q 
</span></span><span class="line"><span class="cl">	;d Trace^MI.MIF000(MachID,&#34;å‡†å¤‡ä¸Šä¼ ,æ¸…é™¤ç¼“å­˜&#34;,&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl">	k ^TMP(&#34;MIFTESTCODE&#34;,$j,MachID)
</span></span><span class="line"><span class="cl">	k ^TMPQUERY(MachID,4)
</span></span><span class="line"><span class="cl">  	s Epis=&#34;&#34; f  s Epis=$o(^TMP($zn,$j,&#34;ENQ&#34;,Epis)) q:Epis=&#34;&#34;  d
</span></span><span class="line"><span class="cl">   	.d ScanOne^MI.MIF000(MachID,Epis)
</span></span><span class="line"><span class="cl">   	.;d PATDET(Epis)
</span></span><span class="line"><span class="cl">   	.s LSH=&#34;&#34;
</span></span><span class="line"><span class="cl">   	.s LSH=$$CHANGEEPIS(MachID,Epis)
</span></span><span class="line"><span class="cl">   	.d Trace^MI.MIF000(MachID,Epis,&#34;Epis&#34;)
</span></span><span class="line"><span class="cl">   	.s TCx=&#34;&#34;,Episx=Epis
</span></span><span class="line"><span class="cl">   	.s chl=&#34;&#34; f  s chl=$o(^TMP(&#34;MIFTESTCODE&#34;,$j,MachID,Epis,chl)) q:chl=&#34;&#34;  d
</span></span><span class="line"><span class="cl">   	..s TCx=TCx_&#34;!!!&#34;_chl
</span></span><span class="line"><span class="cl">   	.;s TCx=TCx_&#34;\&#34;
</span></span><span class="line"><span class="cl">   	.i TCx[&#34;CDR&#34; s TCx=&#34;!!!CDR&#34;
</span></span><span class="line"><span class="cl">   	.s sam=&#34;Sam&#34;
</span></span><span class="line"><span class="cl">   	.s pat=&#34;219!King!Eric!T&#34;
</span></span><span class="line"><span class="cl">   	.s F=&#34;F&#34;
</span></span><span class="line"><span class="cl">   	.s FA=&#34;Fairview!952-121-1123&#34;
</span></span><span class="line"><span class="cl">   	.s ^TMPQUERY(MachID,3)=TCx
</span></span><span class="line"><span class="cl">   	.i $l(TCx) d
</span></span><span class="line"><span class="cl">   	..s line=$o(^TMPTMIF(MachID,22,&#34;&#34;),-1)+1,^TMPTMIF(MachID,22,line)=&#34;H|\!~|||LISHOST|||||||P|LIS2-A|&#34;_date
</span></span><span class="line"><span class="cl">   	..s line=$o(^TMPTMIF(MachID,22,&#34;&#34;),-1)+1,^TMPTMIF(MachID,22,line)=&#34;P|1||&#34;_LSH  
</span></span><span class="line"><span class="cl">   	..;s line=$o(^TMPTMIF(MachID,22,&#34;&#34;),-1)+1,^TMPTMIF(MachID,22,line)=&#34;O|1|&#34;_Episx_&#34;|&#34;_Pos_&#34;|&#34;_tcx_&#34;|R||||||A||||Whole blood|||||||||||&#34;
</span></span><span class="line"><span class="cl">   	..;s line=$o(^TMPTMIF(MachID,22,&#34;&#34;),-1)+1,^TMPTMIF(MachID,22,line)=&#34;O|1|&#34;_Episx_&#34;||&#34;_TCx_&#34;|R|&#34;_date_&#34;|&#34;_date_&#34;|||&#34;_sam_&#34;|A||||Whole blood|&#34;_pat_&#34;|||||||||&#34;_F_&#34;||&#34;_FA
</span></span><span class="line"><span class="cl">   	..s line=$o(^TMPTMIF(MachID,22,&#34;&#34;),-1)+1,^TMPTMIF(MachID,22,line)=&#34;O|1|&#34;_Episx_&#34;||&#34;_TCx_&#34;|R|&#34;_date_&#34;|&#34;_date_&#34;|||&#34;_sam_&#34;|A||||Whole blood&#34;
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">   	..s line=$o(^TMPTMIF(MachID,22,&#34;&#34;),-1)+1,^TMPTMIF(MachID,22,line)=&#34;L|1|N&#34;
</span></span><span class="line"><span class="cl">   	.e  d
</span></span><span class="line"><span class="cl">   	..s line=$o(^TMPTMIF(MachID,22,&#34;&#34;),-1)+1,^TMPTMIF(MachID,22,line)=&#34;Q|1|^&#34;_Epis_&#34;||^^^ALL||||||||X&#34;
</span></span><span class="line"><span class="cl">   	k ^TMP($zn,$j,&#34;ENQ&#34;)
</span></span><span class="line"><span class="cl">   	k ^TMP(&#34;MIFTESTCODE&#34;,$j,MachID)
</span></span><span class="line"><span class="cl">   	q:&#39;$d(^TMPTMIF(MachID,22))
</span></span><span class="line"><span class="cl">   	m ^TMPQUERY(MachID,4)=^TMPTMIF(MachID,22)
</span></span><span class="line"><span class="cl">   	d Send k ^TMPTMIF(MachID,22)
</span></span><span class="line"><span class="cl">   	q
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">	///ç—…äººåŸºæœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">PATDET(Epis)  ; set patient details record
</span></span><span class="line"><span class="cl"> 	s line=$o(^TMPTMIF(MachID,22,&#34;&#34;),-1)+1,^TMPTMIF(MachID,22,line)=&#34;P|1|&#34;_+$h_&#34;||||||U||||||||||||||||||||||||||&#34;
</span></span><span class="line"><span class="cl"> 	q 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">	///å‘é€æ£€æµ‹é¡¹ç›®
</span></span><span class="line"><span class="cl">Send  
</span></span><span class="line"><span class="cl">	w enq,*-3 d Trace^MI.MIF000(MachID,&#34;ENQ&#34;,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl"> 	f j=1:1:10 r *R:1 i $c(R)=ack!($c(R)=enq) q
</span></span><span class="line"><span class="cl"> 	d Trace^MI.MIF000(MachID,$s($c(R)=ack:&#34;ACK&#34;,$c(R)=enq:&#34;ENQ&#34;,$c(R)=nak:&#34;NAK&#34;,1:R),&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl"> 	i $c(R)=enq q
</span></span><span class="line"><span class="cl"> 	i $c(R)&#39;=ack w eot,*-3 d Trace^MI.MIF000(MachID,&#34;EOT&#34;,&#34;H--&gt;M&#34;) q
</span></span><span class="line"><span class="cl"> 	//q:$$SEND(&#34;1H|\^&amp;&#34;)
</span></span><span class="line"><span class="cl"> 	;q:$$SEND(&#34;1H|\^&amp;|||LIS||||||||LIS2-A|&#34;_date)
</span></span><span class="line"><span class="cl"> 	s x=&#34;&#34; f FRAME=1:1 s x=$O(^TMPQUERY(MachID,4,x)) q:x=&#34;&#34;  q:$$SEND(FRAME#8_^TMPQUERY(MachID,4,x))
</span></span><span class="line"><span class="cl">  	w eot,*-3 d Trace^MI.MIF000(MachID,&#34;EOT&#34;,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl"> 	k ^TMPTMIF(MachID,22)
</span></span><span class="line"><span class="cl"> 	q
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"> 	///å‘é€å­—ç¬¦ä¸²
</span></span><span class="line"><span class="cl">SEND(str)
</span></span><span class="line"><span class="cl">	s str=str_cr_etx,chsum=$$CHSUM(str)
</span></span><span class="line"><span class="cl"> 	w stx,str,chsum,cr,lf,*-3 d Trace^MI.MIF000(MachID,str_chsum,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl"> 	f j=1:1:6 r *R:1 i ($c(R)=ack)!($c(R)=eot) q
</span></span><span class="line"><span class="cl"> 	i $c(R)=ack d Trace^MI.MIF000(MachID,&#34;ACK&#34;,&#34;H&lt;--M&#34;) q 0
</span></span><span class="line"><span class="cl"> 	i $c(R)=eot d Trace^MI.MIF000(MachID,&#34;EOT&#34;,&#34;H&lt;--M&#34;) q 0
</span></span><span class="line"><span class="cl"> 	d Trace^MI.MIF000(MachID,R,&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl"> 	q 1 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"> 	///ç”Ÿæˆæ ¡éªŒç 
</span></span><span class="line"><span class="cl">CHSUM(x)
</span></span><span class="line"><span class="cl">	n (x) s z=0 f y=1:1:$l(x) s z=z+$a(x,y)
</span></span><span class="line"><span class="cl"> 	s z=$e(&#34;0123456789ABCDEF&#34;,z#256\16+1)_$e(&#34;0123456789ABCDEF&#34;,z#16+1)
</span></span><span class="line"><span class="cl"> 	q z  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  	///å‘é€å›åº”ç¬¦åˆ°ä»ªå™¨
</span></span><span class="line"><span class="cl">ACK
</span></span><span class="line"><span class="cl">	w ack,*-3 d Trace^MI.MIF000(MachID,&#34;ACK&#34;,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl">	q
</span></span><span class="line"><span class="cl">	     
</span></span><span class="line"><span class="cl">	  
</span></span><span class="line"><span class="cl">CHANGEEPIS(mi,epis)  
</span></span><span class="line"><span class="cl"> 	//æ ¹æ®æµæ°´å·æ‰¾æ£€æµ‹å·
</span></span><span class="line"><span class="cl">    S DATA=$zd($h,8)
</span></span><span class="line"><span class="cl">	s mi=$g(mi),epis=$g(epis)
</span></span><span class="line"><span class="cl">	s VisitNumberReportDR=&#34;&#34;
</span></span><span class="line"><span class="cl">	b ;//^dbo.RPVisitNumberReportI(&#34;IndexEpisodeNo&#34;,TransmitDate, WorkGroupMachineDR, EpisodeNo)
</span></span><span class="line"><span class="cl">    i &#39;$l(mi) q epis
</span></span><span class="line"><span class="cl">    i &#39;$l(epis) q epis  
</span></span><span class="line"><span class="cl">	s WorkGroupMachineDR=$lg($g(^dbo.BTMIMachineParameterD(mi)),6)
</span></span><span class="line"><span class="cl">	i &#39;$l(WorkGroupMachineDR) q epis
</span></span><span class="line"><span class="cl">	s VisitNumberReportDR=$o(^dbo.RPVisitNumberReportI(&#34;IndexAcceptDate&#34;,WorkGroupMachineDR,DATA,&#34; &#34;_epis,&#34;&#34;))
</span></span><span class="line"><span class="cl">	i &#39;$l(VisitNumberReportDR) q epis
</span></span><span class="line"><span class="cl">	s LSH=$lg($g(^dbo.RPVisitNumberReportD(VisitNumberReportDR)),8)
</span></span><span class="line"><span class="cl">	i &#39;$l(LSH) q epis 
</span></span><span class="line"><span class="cl">	B ;LSH
</span></span><span class="line"><span class="cl">	Q LSH
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">//// w $$GetName^MI.MIFBECKImage(70,3003497773)
</span></span><span class="line"><span class="cl">//// å–ç—…äººå§“åæŒ‰æ‹¼éŸ³è¾“å‡º,&#34;^&#34;åˆ†éš”
</span></span><span class="line"><span class="cl">GetName(MachID,epis)
</span></span><span class="line"><span class="cl">    s epis = $g(epis),MachID=$g(MachID)
</span></span><span class="line"><span class="cl">    s SurName=&#34;&#34;
</span></span><span class="line"><span class="cl">    i $l(epis)=0 q &#34;&#34;
</span></span><span class="line"><span class="cl">    s VisitNumberDR = $o(^dbo.RPVisitNumberI(&#34;IndexVisitNumber&#34;,##Class(LIS.Util.Common).IndexData(epis),&#34;&#34;))
</span></span><span class="line"><span class="cl">    i &#39;$l(VisitNumberDR) q &#34;&#34;
</span></span><span class="line"><span class="cl">    //æ ‡æœ¬ä¿¡æ¯
</span></span><span class="line"><span class="cl">    s RPVisitNumberData=$g(^dbo.RPVisitNumberD(VisitNumberDR))
</span></span><span class="line"><span class="cl">    s SurName=$lg(RPVisitNumberData,13)
</span></span><span class="line"><span class="cl">    i SurName&#39;=&#34;&#34; s SurName=$$GetCNCODE(SurName,3,&#34;^&#34;)
</span></span><span class="line"><span class="cl">    q SurName
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// Description:è¿”å›æ±‰å­—çš„ç¼–ç ä¿¡æ¯
</span></span><span class="line"><span class="cl">/// Inputï¼š	HANZI:æ±‰å­—
</span></span><span class="line"><span class="cl">/// 			FLAG:è¿”å›ä½•ç§ç¼–ç (1:ASCç ,2:æ±‰å­—,3:æ‹¼éŸ³,4:é¦–æ‹¼,5:å››è§’ç 6:äº”ç¬”ç 7:åŒºä½ç 8:ç¬”åˆ’æ•°9:éƒ‘ç )
</span></span><span class="line"><span class="cl">/// 			SPLIT:åˆ†å‰²ç¬¦(å¯ä»¥ä¸ºç©º)
</span></span><span class="line"><span class="cl">/// Outputï¼š
</span></span><span class="line"><span class="cl">/// 	é0:è¿”å›ç¼–ç ä¿¡æ¯:ASCç ^æ±‰å­—^æ‹¼éŸ³^é¦–æ‹¼^å››è§’ç ^äº”ç¬”ç ^åŒºä½ç ^ç¬”åˆ’æ•°^éƒ‘ç 
</span></span><span class="line"><span class="cl">/// 	0ï¼šæœªæ‰¾åˆ°ç¼–ç ä¿¡æ¯
</span></span><span class="line"><span class="cl">/// CreatDate:2011-06-08
</span></span><span class="line"><span class="cl">/// w ##class(web.DHCINSUPort).GetCNCODE(&#34;ä¸œå&#34;,4,&#34;^&#34;)
</span></span><span class="line"><span class="cl">/// w ##class(web.DHCINSUPort).GetCNCODE(&#34;ä¸œå&#34;,4,&#34;&#34;)
</span></span><span class="line"><span class="cl">GetCNCODE(HANZIS,FLAG, SPLIT)
</span></span><span class="line"><span class="cl">	s Rtnstr=&#34;0&#34;
</span></span><span class="line"><span class="cl">	q:$g(HANZIS)=&#34;&#34; Rtnstr
</span></span><span class="line"><span class="cl">	s Rtnstr=&#34;&#34;
</span></span><span class="line"><span class="cl">	f i=1:1:$l(HANZIS) d
</span></span><span class="line"><span class="cl">	.s HANZI=$EXTRACT(HANZIS,i)
</span></span><span class="line"><span class="cl">	.s ASCIICODE=$ASCII(HANZI)
</span></span><span class="line"><span class="cl">	.i $D(^DHCCharacterEncoding(&#34;0&#34;,&#34;ASCII&#34;,ASCIICODE))&#39;=0 d
</span></span><span class="line"><span class="cl">	..s rowid=$o(^DHCCharacterEncoding(&#34;0&#34;,&#34;ASCII&#34;,ASCIICODE,&#34;&#34;))
</span></span><span class="line"><span class="cl">	..s tmpstr=&#34;&#34;
</span></span><span class="line"><span class="cl">	..s:FLAG=&#34;&#34; tmpstr=$g(^DHCCharacterEncoding(rowid))
</span></span><span class="line"><span class="cl">	..s:FLAG&#39;=&#34;&#34; tmpstr=$p(^DHCCharacterEncoding(rowid),&#34;^&#34;,FLAG)
</span></span><span class="line"><span class="cl">	..i Rtnstr=&#34;&#34;  d
</span></span><span class="line"><span class="cl">	...s Rtnstr=tmpstr
</span></span><span class="line"><span class="cl">	..e  d
</span></span><span class="line"><span class="cl">	...s Rtnstr=Rtnstr_SPLIT_tmpstr
</span></span><span class="line"><span class="cl">	.e  d
</span></span><span class="line"><span class="cl">	..s:Rtnstr=&#34;&#34; Rtnstr=&#34;?&#34;
</span></span><span class="line"><span class="cl">	..s Rtnstr=Rtnstr_SPLIT_&#34;?&#34;
</span></span><span class="line"><span class="cl">	q Rtnstr
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/assets/image-20250111003210-lknq7r1.png"
	width="1206"
	height="1326"
	srcset="/p/assets/image-20250111003210-lknq7r1_hu_a64a5d5b88786628.png 480w, /p/assets/image-20250111003210-lknq7r1_hu_5283fae88e212d3.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="90"
		data-flex-basis="218px"
	
></p>
<h3 id="é€šè¿‡æ–‡ä»¶è¯·æ±‚åŒå‘">é€šè¿‡æ–‡ä»¶è¯·æ±‚åŒå‘
</h3><h4 id="ä¸Šæœºç”Ÿæˆè¯·æ±‚æ–‡ä»¶è¯·æ±‚">ä¸Šæœºç”Ÿæˆè¯·æ±‚æ–‡ä»¶è¯·æ±‚
</h4><h5 id="ç¤ºä¾‹ä»£ç çˆ±åº·-aigel400">ç¤ºä¾‹ä»£ç (çˆ±åº· Aigel400)
</h5><blockquote>
<p>ä»ªå™¨ä¸Šæœºæ‰«æ¡ç åç”Ÿæˆè¯·æ±‚æ–‡ä»¶ï¼Œé€šè¿‡ç›‘å¬è¯»å–æ–‡ä»¶ï¼Œè§£ææ•°æ®åå›ä¼ æ–‡ä»¶ï¼Œæ­¤å¤„éœ€ç‰¹æ®Šè§£æè®¾ç½®ã€‚å°†ä»ªå™¨é…ç½®ä¸ºä¸»åŠ¨ä¸Šä¼ æ¨¡å¼ï¼Œè§£ææ•°æ®æ—¶ï¼Œå°†ä¸»åŠ¨ä¸Šä¼ ä¿¡æ¯ä» C å˜ä¸º Xï¼ŒQryLabInfo å¾ªç¯è¯»å–ä¸º X çš„æ ‡æœ¬ï¼Œä»è€Œå®ç°æ–‡ä»¶åŒå‘ã€‚</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/*</span>
</span></span><span class="line"><span class="cl">	<span class="err">åŒå‘æ¯”è¾ƒç‰¹æ®Šï¼Œéœ€è¦é…ç½®ä¸¤å°ä»ªå™¨ï¼Œä¸€å°ç”¨äºæ¥æ”¶ï¼Œä¸€å°ç”¨äºåŒå‘ä¸Šä¼ </span>
</span></span><span class="line"><span class="cl"><span class="o">*/</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="p">[{</span><span class="s2">&#34;MachID&#34;</span><span class="p">:</span><span class="s2">&#34;#RowID&#34;</span><span class="p">,</span><span class="s2">&#34;Type&#34;</span><span class="p">:</span><span class="s2">&#34;Drect&#34;</span><span class="p">,</span><span class="s2">&#34;UpTime&#34;</span><span class="p">:</span><span class="s2">&#34;3000&#34;</span><span class="p">,</span><span class="s2">&#34;Address&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">OUTPUT</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">,</span><span class="s2">&#34;UpCDF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;UpREF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;DealProcess&#34;</span><span class="p">:</span><span class="s2">&#34;MI.MIFAigel400&#34;</span><span class="p">,</span><span class="s2">&#34;Para&#34;</span><span class="p">:</span><span class="s2">&#34;.txt&#34;</span><span class="p">,</span><span class="s2">&#34;PreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoMAll,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UPPreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;UpPara&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">},{</span><span class="s2">&#34;MachID&#34;</span><span class="p">:</span><span class="s2">&#34;41&#34;</span><span class="p">,</span><span class="s2">&#34;Type&#34;</span><span class="p">:</span><span class="s2">&#34;Drect&#34;</span><span class="p">,</span><span class="s2">&#34;UpTime&#34;</span><span class="p">:</span><span class="s2">&#34;3000&#34;</span><span class="p">,</span><span class="s2">&#34;Address&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Aigel400</span><span class="se">\\</span><span class="s2">Data</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">,</span><span class="s2">&#34;UpCDF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;UpREF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;DealProcess&#34;</span><span class="p">:</span><span class="s2">&#34;MI.MIFAigel400&#34;</span><span class="p">,</span><span class="s2">&#34;Para&#34;</span><span class="p">:</span><span class="s2">&#34;regexImport.dat&#34;</span><span class="p">,</span><span class="s2">&#34;PreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoMAll,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UPPreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoM,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UpPara&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Aigel400</span><span class="se">\\</span><span class="s2">Data</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">}]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Class</span> <span class="n">MI</span><span class="o">.</span><span class="n">MIFAigel400</span> <span class="n">Extends</span> <span class="o">%</span><span class="n">RegisteredObject</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">H</span><span class="o">|</span>\<span class="o">^&amp;|||</span><span class="n">Across</span><span class="err">â–¡</span><span class="n">Auto</span><span class="err">â–¡</span><span class="n">System</span><span class="err">â–¡</span><span class="n">OCTO</span><span class="o">-</span><span class="n">M</span><span class="o">^^</span><span class="mf">1.00</span><span class="o">.</span><span class="mi">25</span><span class="err">â–¡</span><span class="p">(</span><span class="n">build17062603</span><span class="p">)</span><span class="o">|||||||</span><span class="n">P</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="mi">20230503095046</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="n">P</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">12</span><span class="o">|</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="n">O</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">12</span><span class="o">^^^^^^|</span><span class="mi">69449292212011757621</span><span class="o">|^^^</span><span class="n">ABO</span><span class="o">/</span><span class="n">RhDè¡€å‹å®šå‹è¯•å‰‚å¡</span><span class="o">|</span><span class="n">R</span><span class="o">|</span><span class="mi">20230503094655</span><span class="o">||||||||||||||||||</span><span class="n">Across</span><span class="err">â–¡</span><span class="n">Auto</span><span class="err">â–¡</span><span class="n">System</span><span class="err">â–¡</span><span class="n">OCTO</span><span class="o">-</span><span class="n">M</span><span class="o">^^</span><span class="mf">1.00</span><span class="o">.</span><span class="mi">25</span><span class="err">â–¡</span><span class="p">(</span><span class="n">build17062603</span><span class="p">)</span><span class="o">|</span><span class="n">C</span><span class="o">|</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="n">R</span><span class="o">|</span><span class="mi">1</span><span class="o">|^^^</span><span class="n">ABO</span><span class="o">/</span><span class="n">RhDè¡€å‹å®šå‹è¯•å‰‚å¡</span><span class="o">|-</span><span class="n">A</span><span class="o">=-^-</span><span class="n">B</span><span class="o">=</span><span class="mi">4</span><span class="o">+^-</span><span class="n">D</span><span class="o">=</span><span class="mi">3</span><span class="o">+^</span><span class="n">control</span><span class="o">=-^</span><span class="n">Ac</span><span class="o">=</span><span class="mi">3</span><span class="o">+^</span><span class="n">Bc</span><span class="o">=-^</span><span class="n">B</span><span class="o">/</span><span class="n">Rh</span><span class="o">+|||</span><span class="n">N</span><span class="o">||</span><span class="n">F</span><span class="o">||</span><span class="n">A1</span><span class="o">|</span><span class="mi">20230503091546</span><span class="o">|</span><span class="mi">20230503094655</span><span class="o">|</span><span class="n">Across</span><span class="err">â–¡</span><span class="n">Auto</span><span class="err">â–¡</span><span class="n">System</span><span class="err">â–¡</span><span class="n">OCTO</span><span class="o">-</span><span class="n">M</span><span class="o">^^</span><span class="mf">1.00</span><span class="o">.</span><span class="mi">25</span><span class="err">â–¡</span><span class="p">(</span><span class="n">build17062603</span><span class="p">)</span><span class="o">|</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="n">L</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">N</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">H</span><span class="o">|</span>\<span class="o">^&amp;|||</span><span class="n">Across</span><span class="err">â–¡</span><span class="n">Auto</span><span class="err">â–¡</span><span class="n">System</span><span class="err">â–¡</span><span class="n">OCTO</span><span class="o">-</span><span class="n">M</span><span class="o">^^</span><span class="mf">1.00</span><span class="o">.</span><span class="mi">25</span><span class="err">â–¡</span><span class="p">(</span><span class="n">build17062603</span><span class="p">)</span><span class="o">|||||||</span><span class="n">P</span><span class="o">|</span><span class="mi">4</span><span class="o">|</span><span class="mi">20230602161519</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="n">P</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">102</span><span class="o">|</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="n">O</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">102</span><span class="o">^^^^^^|</span><span class="mi">69449292211011587452</span><span class="o">|^^^</span><span class="err">æŠ—äººçƒè›‹ç™½æ£€æµ‹å¡</span><span class="p">(</span><span class="err">æŠ—ç­›</span><span class="p">)</span><span class="o">|</span><span class="n">R</span><span class="o">|</span><span class="mi">20230602094910</span><span class="o">||||||||||||||||||</span><span class="n">Across</span><span class="err">â–¡</span><span class="n">Auto</span><span class="err">â–¡</span><span class="n">System</span><span class="err">â–¡</span><span class="n">OCTO</span><span class="o">-</span><span class="n">M</span><span class="o">^^</span><span class="mf">1.00</span><span class="o">.</span><span class="mi">25</span><span class="err">â–¡</span><span class="p">(</span><span class="n">build17062603</span><span class="p">)</span><span class="o">|</span><span class="n">F</span><span class="o">|</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="n">R</span><span class="o">|</span><span class="mi">1</span><span class="o">|^^^</span><span class="err">æŠ—äººçƒè›‹ç™½æ£€æµ‹å¡</span><span class="p">(</span><span class="err">æŠ—ç­›</span><span class="p">)</span><span class="o">|</span><span class="n">IgG</span><span class="o">=-^</span><span class="n">C3d</span><span class="o">=-^</span><span class="n">Ctl</span><span class="o">=-^-|||</span><span class="n">N</span><span class="o">||</span><span class="n">F</span><span class="o">||</span><span class="n">A1</span><span class="o">|</span><span class="mi">20230602091802</span><span class="o">|</span><span class="mi">20230602094910</span><span class="o">|</span><span class="n">Across</span><span class="err">â–¡</span><span class="n">Auto</span><span class="err">â–¡</span><span class="n">System</span><span class="err">â–¡</span><span class="n">OCTO</span><span class="o">-</span><span class="n">M</span><span class="o">^^</span><span class="mf">1.00</span><span class="o">.</span><span class="mi">25</span><span class="err">â–¡</span><span class="p">(</span><span class="n">build17062603</span><span class="p">)</span><span class="o">|</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="n">L</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="n">N</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">d</span> <span class="c1">##class(MI.MIFAigel300).fileMTHD(28,&#34;H|\^&amp;|||Acrossâ–¡Autoâ–¡Systemâ–¡OCTO-M^^1.00.25â–¡(build17062603)|||||||P|4|20230503095046[13][10]P|1|12|[13][10]O|1|12^^^^^^|69449292212011757621|^^^ABO/RhDè¡€å‹å®šå‹è¯•å‰‚å¡|R|20230503094655||||||||||||||||||Acrossâ–¡Autoâ–¡Systemâ–¡OCTO-M^^1.00.25â–¡(build17062603)|C|[13][10]R|1|^^^ABO/RhDè¡€å‹å®šå‹è¯•å‰‚å¡|-A=-^-B=4+^-D=3+^control=-^Ac=3+^Bc=-^B/Rh+|||N||F||A1|20230503091546|20230503094655|Acrossâ–¡Autoâ–¡Systemâ–¡OCTO-M^^1.00.25â–¡(build17062603)|[13][10]L|1|N[13][10]&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">fileMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(record) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">P3</span><span class="s1">&#39;[&#34;Import&#34; d Result</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">d</span> <span class="n">Upload</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Upload</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AllEpis</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;[13][10]&#34;</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">rec</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;[13][10]&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">rtype</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="n">rtype</span><span class="o">=</span><span class="s2">&#34;H&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">ASTMH</span><span class="o">=</span><span class="n">rec</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">ASTMH</span><span class="p">,</span><span class="s2">&#34;ASTMH&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;DATA&#34;</span><span class="p">)</span><span class="o">=</span><span class="n">ASTMH</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="n">rtype</span><span class="o">=</span><span class="s2">&#34;Q&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="s1">&#39;$l(AllEpis) s AllEpis=epis</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">e</span>  <span class="n">s</span> <span class="n">AllEpis</span><span class="o">=</span><span class="n">AllEpis_</span><span class="s2">&#34;^&#34;</span><span class="n">_epis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AllEpis</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;Epis&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">AllEpis</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">AllEpis</span><span class="p">,</span><span class="s2">&#34;AllEpis&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;OutFlag&#34;</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">d</span> <span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,&#34;9000000256&#34;,&#34;X&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Result</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;[13][10]&#34;</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">rec</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;[13][10]&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">rtype</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="n">rtype</span><span class="o">=</span><span class="s2">&#34;O&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="n">rtype</span><span class="o">=</span><span class="s2">&#34;R&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">TestSet</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">TestSet</span><span class="p">[</span><span class="s2">&#34;ABO&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">allres</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">code1</span><span class="o">=</span><span class="s2">&#34;ABO&#34;</span> <span class="n">s</span> <span class="n">res1</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">allres</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;å‹&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">code2</span><span class="o">=</span><span class="s2">&#34;Rh&#34;</span> <span class="n">s</span> <span class="n">res2</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">allres</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">res2</span><span class="p">[</span><span class="s2">&#34;+&#34;</span> <span class="n">s</span> <span class="n">res2</span><span class="o">=</span><span class="s2">&#34;é˜³æ€§&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">res2</span><span class="p">[</span><span class="s2">&#34;-&#34;</span> <span class="n">s</span> <span class="n">res2</span><span class="o">=</span><span class="s2">&#34;é˜´æ€§&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">code1_</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">_res1_&#34;</span><span class="p">,</span><span class="s2">&#34;_code2_&#34;</span>\<span class="s2">&#34;_res2_&#34;</span><span class="p">,</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">TestSet</span><span class="p">[</span><span class="s2">&#34;äº¤å‰é…è¡€&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">code1</span><span class="o">=</span><span class="s2">&#34;JCPX&#34;</span> <span class="n">s</span> <span class="n">res1</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">res1</span><span class="o">=</span><span class="s2">&#34;+&#34;</span> <span class="n">s</span> <span class="n">res1</span><span class="o">=</span><span class="s2">&#34;é˜³æ€§&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">res1</span><span class="o">=</span><span class="s2">&#34;-&#34;</span> <span class="n">s</span> <span class="n">res1</span><span class="o">=</span><span class="s2">&#34;é˜´æ€§&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">code1_</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">_res1_&#34;</span><span class="p">,</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">TestSet</span><span class="p">[</span><span class="s2">&#34;ä¸è§„åˆ™æŠ—ä½“ç­›æŸ¥&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">code1</span><span class="o">=</span><span class="s2">&#34;KRQDB&#34;</span> <span class="n">s</span> <span class="n">res1</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">res1</span><span class="p">[</span><span class="s2">&#34;=&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">....</span><span class="n">s</span> <span class="n">res1</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">res1</span><span class="p">,</span><span class="s2">&#34;=&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">res1</span><span class="o">=</span><span class="s2">&#34;+&#34;</span> <span class="n">s</span> <span class="n">res1</span><span class="o">=</span><span class="s2">&#34;é˜³æ€§&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">res1</span><span class="o">=</span><span class="s2">&#34;-&#34;</span> <span class="n">s</span> <span class="n">res1</span><span class="o">=</span><span class="s2">&#34;é˜´æ€§&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">code1_</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">_res1_&#34;</span><span class="p">,</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_result</span><span class="p">,</span><span class="s2">&#34;AllResult&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="n">d</span> <span class="c1">##Class(MI.Common.MIFBase).Save(mi, epis, result, date, time, QC)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveImageMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">ImageClass</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FullName</span><span class="p">,</span> <span class="n">SaveImageRetName</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">é€šè¿‡</span><span class="n">OtherParaé…ç½®å–å›¾çš„åœ¨è¿™é‡Œé€šè¿‡episå’ŒImageClassçš„å›¾ç‰‡åå­—æå–å‡ºæµæ°´å·å’Œå›¾ç‰‡ç±»åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ImageClass</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ImageClass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FileName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">FileName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FullName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">FullName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SaveImageRetName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">SaveImageRetName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="c1">##Class(MI.Common.MIFBase).Trace(mi,epis_&#34;:&#34;_ImageClass_&#34;:&#34;_FileName,&#34;H&lt;--M&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span> <span class="n">ImageOrder</span><span class="p">,</span> <span class="n">Caption</span><span class="p">,</span> <span class="n">DisplayRatio</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">åŠ ä¸Šå½“å‰æ—¶é—´ï¼Œé˜²æ­¢æµè§ˆå™¨ç¼“å­˜</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FileName</span><span class="o">=</span><span class="n">FileName_</span><span class="s2">&#34;?&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">OtherParaç”¨</span><span class="o">^</span><span class="err">åˆ†éš”ç¬¬å››ä½æŒ‡å®š</span><span class="n">SaveImageRetNameçš„è¯åœ¨è¿™é‡Œæ”¹FileNameä¸ºæ–°åç§°</span><span class="err">ã€‚åŒæ—¶è®©æ–¹æ³•è¿”å›æ–°å›¾ç‰‡åå­—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">NewFileName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">SaveImageRetName</span><span class="o">=</span><span class="s2">&#34;SaveImageRetName&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="err">å›¾ç‰‡æ–°åå­—</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">NewFileName</span><span class="o">=</span><span class="n">epis_</span><span class="s2">&#34;-&#34;</span><span class="n">_ImageClass_</span><span class="s2">&#34;-&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="err">è·¯å¾„æ–°åå­—</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">NewPathName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">SPLen</span><span class="o">=$</span><span class="n">l</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">f</span> <span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">SPLen</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">ii</span><span class="o">&lt;</span><span class="n">SPLen</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">NewPathName</span><span class="o">=</span><span class="n">NewPathName_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="n">ii</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">ii</span><span class="o">=</span><span class="n">SPLen</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">NewFileName</span><span class="o">=</span><span class="n">NewFileName_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="n">ii</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">NewPathName</span><span class="o">=</span><span class="n">NewPathName_NewFileName</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">FileName</span><span class="o">=</span><span class="n">NewPathName</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æœ€åè¿”å›</span><span class="n">NewFileName</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.Common.MachineResult).SaveImage(ReceiveDate, epis, ImageClass, ImageOrder, FileName, mi, Caption, DisplayRatio, Height, Width, Sequence)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è¿”å›å€¼æ§åˆ¶å›¾ç‰‡åç§°æ¨¡å¼</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">SaveImageRetName</span><span class="o">=</span><span class="s2">&#34;SaveImageRetName&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="n">NewFileName</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">w</span> <span class="c1">##class(MI.XN9000).GetFtpMTHD(&#34;7&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetFtpMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ–‡ä»¶æœåŠ¡æ¨¡å¼å¿…é¡»æ”¹çš„åœ°æ–¹ï¼Œè€çš„</span><span class="n">FTPæ¨¡å¼è¿™ä¹ˆæ”¹äº†ä¹Ÿæ²¡é—®é¢˜</span><span class="err">ï¼Œæ‰€ä»¥å»ºè®®éƒ½è¿™æ ·</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="c1">##Class(MI.Common.MIFBase).GetMiFtpPath(mi)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Creator</span><span class="err">ï¼š</span>      <span class="err">æŸ¥è¯¢æ‚£è€…ä¿¡æ¯ï¼Œç›‘å¬é…ç½®ä¸Šä¼ å‰å¤„ç†ç±»åä¼šå®šæ—¶è°ƒç”¨è¿™ä¸ª</span><span class="n">queryæŸ¥è¯¢æ•°æ®è¿›è¡Œä¸Šä¼ æ“ä½œ</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">CreatDate</span><span class="err">ï¼š</span>    <span class="mi">20140919</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Description</span><span class="p">:</span><span class="err">ï¼š</span> 
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Table</span><span class="err">ï¼š</span>    
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="ne">Input</span><span class="err">ï¼š</span>        <span class="n">mi</span><span class="err">ï¼šä»ªå™¨ä¸»é”®</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Output</span><span class="err">ï¼š</span>       <span class="err">ä»ªå™¨ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Return</span><span class="err">ï¼š</span>       <span class="err">ä»ªå™¨ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Others</span><span class="err">ï¼š</span>   
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">QryLabInfo</span><span class="p">(</span><span class="n">mi</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Query</span><span class="p">(</span><span class="n">ROWSPEC</span> <span class="o">=</span> <span class="s2">&#34;labno,labnoInfo,patInfo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Queryçš„æ‰§è¡Œæ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">d</span> <span class="c1">##class(%ResultSet).RunQuery(&#34;MI.MIFAigel400&#34;,&#34;QryLabInfo&#34;,&#34;41&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoExecute</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">,</span> <span class="n">mi</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">i</span><span class="p">(</span><span class="o">^</span><span class="n">CacheTemp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">flag</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">LabnoList</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">DeleteFlag</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;Epis&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">DeleteFlag</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">b</span> <span class="p">;</span><span class="n">MiUploadDR</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;Epis&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="n">EpisNo</span><span class="o">=$$</span><span class="n">getEpis</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="p">;</span><span class="n">i</span> <span class="s1">&#39;$l(EpisNo) q</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="s1">&#39;$l(labno) q</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="err">æµ‹è¯•ç±»å‹</span><span class="mi">0</span><span class="err">ï¼šæ–‡æœ¬ï¼Œ</span><span class="mi">1</span><span class="err">ï¼šæ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">TestType</span><span class="o">=</span><span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="n">TestType</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">æ–‡æœ¬åŒå‘ä¸Šä¼ å¼€å§‹</span><span class="o">******************************************************</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">æ§åˆ¶è¾“å‡ºæ–‡æœ¬çš„å†…å®¹</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">txtInfo</span><span class="o">=..</span><span class="n">GetLabnoInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="p">;</span><span class="n">s</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&#34;L&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">8</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;_&#34;</span><span class="n">_labno_</span><span class="s2">&#34;.txt&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&#34;Servers.dat&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">labno1</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutFileInfo(filename,txtInfo,labno1,0,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">txtInfo</span><span class="p">,</span><span class="s2">&#34;ä¸Šä¼ ä¿¡æ¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">æ–‡æœ¬åŒå‘ä¸Šä¼ ç»“æŸ</span><span class="o">******************************************************</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">DeleteFlag</span><span class="o">=</span><span class="mi">1</span> <span class="n">k</span> <span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;Epis&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ColFields</span><span class="o">=</span><span class="s2">&#34;labno,labnoInfo,patInfo&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="o">=</span><span class="c1">##Class(LIS.Util.Common).TransListNull(Data,ColFields)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">quit</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoClose</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span> <span class="p">[</span> <span class="n">PlaceAfter</span> <span class="o">=</span> <span class="n">QryLabInfoExecute</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Kill</span> <span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoFetch</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Row</span> <span class="n">As</span> <span class="o">%</span><span class="n">List</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">AtEnd</span> <span class="n">As</span> <span class="o">%</span><span class="n">Integer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span> <span class="p">[</span> <span class="n">PlaceAfter</span> <span class="o">=</span> <span class="n">QryLabInfoExecute</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">AtEnd</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">ind</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">AtEnd</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">Row</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Else</span>      <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">Row</span><span class="o">=^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">AtEnd</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFAigel400).GetLabnoInfo(41,&#34;9000000256^9000000258&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetLabnoInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="s2">&#34;labno&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ASTMH</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;DATA&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">ASTMP</span><span class="p">,</span><span class="n">ASTMO</span><span class="p">,</span><span class="n">ASTMPO</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">labnoi</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMP</span><span class="o">=</span><span class="s2">&#34;P|1|&#34;</span><span class="n">_labnoi_</span><span class="s2">&#34;|&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMO</span><span class="o">=$$</span><span class="n">GetASTMO</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labnoi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMPO</span><span class="o">=</span><span class="n">ASTMPO_ASTMP_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTMO_</span><span class="s2">&#34;[13]&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ASTML</span><span class="o">=</span><span class="s2">&#34;L|1|N&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ASTMP</span><span class="p">,</span><span class="n">ASTMO</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">ASTMH_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTMPO_ASTML</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">tcx</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">GetASTMO</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">VisitNumber</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">patInfo</span><span class="o">=..</span><span class="n">GetPatInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">VisitNumber</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">PatName</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">patInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è·å–é¡¹ç›®é€šé“å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">VisitNumber</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ASTMO</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Num</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">chl</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">VisitNumber</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">Num</span><span class="o">=</span><span class="n">Num</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;O|&#34;</span><span class="n">_Num_</span><span class="s2">&#34;|&#34;</span><span class="n">_VisitNumber_</span><span class="s2">&#34;^&#34;</span><span class="n">_PatName_</span><span class="s2">&#34;^^^^|||^^^^&#34;</span><span class="n">_chl</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="s1">&#39;$l(ASTMO) s ASTMO=str</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">e</span>  <span class="n">s</span> <span class="n">ASTMO</span><span class="o">=</span><span class="n">ASTMO_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_str</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">ASTMO</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFKRD).GetLabnoInfo(22,&#34;9000000253&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetLabnoInfoBak</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">OutFlag</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;OutFlag&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">OutFlag</span><span class="o">=</span><span class="mi">1</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMH</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">LISAigel400</span><span class="p">(</span><span class="s2">&#34;DATA&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMP</span><span class="o">=</span><span class="s2">&#34;P|1|001&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMO1</span><span class="o">=</span><span class="s2">&#34;O|1|001^æµ‹è¯•^^^^|||^^^^ABO/RhDè¡€å‹æŠ—åŸæ£€æµ‹å¡&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMO2</span><span class="o">=</span><span class="s2">&#34;O|2|001^æµ‹è¯•^^^^|||^^^^ABOæ­£åå®šå‹åŠRh(D/C/E)è¡€å‹æ£€æµ‹å¡&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMO3</span><span class="o">=</span><span class="s2">&#34;O|3|001^æµ‹è¯•^^^^|||^^^^æŠ—äººçƒè›‹ç™½æ£€æµ‹å¡(IgG+C3d)ä¸è§„åˆ™æŠ—ä½“ç­›æŸ¥&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMO4</span><span class="o">=</span><span class="s2">&#34;O|1|001^æµ‹è¯•^^^^|||^^^^O|4|001^æµ‹è¯•^^^^|||^^^^æŠ—äººçƒè›‹ç™½æ£€æµ‹å¡(æŠ—IgG+C3d)äº¤å‰é…è¡€&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTMO5</span><span class="o">=</span><span class="s2">&#34;O|1|001^æµ‹è¯•^^^^|||^^^^Rhè¡€å‹æŠ—åŸæ£€æµ‹å¡&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ASTML</span><span class="o">=</span><span class="s2">&#34;L|1|N&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">ASTMH_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTMP_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTMO1_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTMO2_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTMO3_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTMO4_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTMO5_</span><span class="s2">&#34;[13]&#34;</span><span class="n">_ASTML</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">tcx</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è·å–é¡¹ç›®é€šé“å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">chl</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_chl_</span><span class="s2">&#34;[9]&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">labno_</span><span class="s2">&#34;[9]&#34;</span><span class="n">_str</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">tcx</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFLISMonitorTest).GetPatInfo(6,1001367)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetPatInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">labno</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æ ‡æœ¬ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RPVisitNumberData</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">LocationDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span><span class="n">Location</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Location</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">DoctorDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span><span class="n">Doctor</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Doctor</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTDoctorD</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">67</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveUserDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">68</span><span class="p">),</span><span class="n">ReceiveUser</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">ReceiveUser</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">SYSUserD</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RegNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SurName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">GivenName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">SurName</span><span class="o">=</span><span class="n">GivenName</span> <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName_GivenName</span>  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SpeciesDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Species</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AdmTypeDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">AdmType</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AdmType</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAdmissionTypeD</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AgeUnitDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">19</span><span class="p">),</span><span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAgeUnitD</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">CollectDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">51</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">CollectTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Diagnose</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampleda</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s2">&#34;XN&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">s</span> <span class="n">Instrument</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">22</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampleno</span><span class="o">=</span><span class="n">labno</span>   <span class="o">//</span><span class="err">æ£€æµ‹å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampletype</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Feetype</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">;</span><span class="err">è´¹åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Srcdepno</span><span class="o">=</span><span class="n">Location</span>  <span class="p">;</span><span class="err">é€æ£€ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Srcdocno</span><span class="o">=</span><span class="n">Doctor</span>   <span class="p">;</span><span class="err">é€æ£€åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Userno</span><span class="o">=</span><span class="n">ReceiveUser</span> <span class="p">;</span><span class="err">æ£€éªŒåŒ»ç”Ÿ</span><span class="p">(</span><span class="err">å½•å…¥è€…</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patno</span><span class="o">=</span><span class="n">RegNo</span> <span class="p">;</span><span class="err">ç™»è®°å·</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">BarCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patna</span><span class="o">=</span><span class="n">PatName</span>   <span class="p">;</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="mi">1</span>  <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;ç”·&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>     <span class="p">;</span><span class="mi">1</span><span class="p">:</span><span class="err">ç”·</span> <span class="err">ï¼Œ</span><span class="mi">2</span> <span class="err">å¥³</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Species</span> <span class="o">=</span><span class="s2">&#34;å¥³&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Pattype</span><span class="o">=</span><span class="n">AdmType</span>   <span class="p">;</span><span class="err">ç—…äººç±»å‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Bedno</span> <span class="o">=</span> <span class="n">BedNo</span>    <span class="p">;</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patage</span><span class="o">=</span><span class="n">Age</span>  <span class="p">;</span><span class="err">å¹´é¾„</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Ageunit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å¹´é¾„å•ä½</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reqno</span><span class="o">=</span><span class="n">labno</span>  <span class="p">;</span><span class="err">ç”³è¯·å·</span> <span class="o">=</span> <span class="err">æ£€éªŒå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reqda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Reqda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">ReceiveTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span><span class="err">é€æ£€æ—¥æœŸ</span> <span class="o">=</span> <span class="err">æ¥æ”¶æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reportda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">æŠ¥å‘Šæ—¥æœŸ</span>  <span class="o">=</span> <span class="err">åˆå®¡</span><span class="p">(</span><span class="err">ä¿å­˜ç»“æœ</span><span class="p">)</span><span class="err">æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Printflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">æ‰“å°æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Resultflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç»“æœæ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Errflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">é”™è¯¯æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Diagnose</span> <span class="o">=</span> <span class="n">Diagnose</span>   <span class="p">;</span><span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Description</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">å¤‡æ³¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reserve</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ä¿ç•™å­—æ®µ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patnamn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å§“åæ‹¼éŸ³ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Getda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">CollectTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">Getda</span><span class="o">=</span><span class="n">Reqda</span> <span class="p">;</span><span class="err">æ¥æ”¶æ—¶é—´</span><span class="o">/</span><span class="err">é‡‡æ ·æ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Wardno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç—…åŒº</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">Sampleda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Instrument_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampleno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampletype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Feetype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdepno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdocno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Userno_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patna_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sex_</span><span class="s2">&#34;,&#34;</span><span class="n">_Pattype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Bedno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patage_</span><span class="s2">&#34;,&#34;</span><span class="n">_Ageunit_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqda_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Reportda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Printflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Resultflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Errflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Diagnose_</span><span class="s2">&#34;,&#34;</span><span class="n">_Description_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reserve_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patnamn_</span><span class="s2">&#34;,&#34;</span><span class="n">_Getda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Wardno_</span><span class="s2">&#34;,&#34;</span><span class="n">_BarCode</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">RetString</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">ç›‘å¬åšä¸Šä¼ æ“ä½œåè°ƒç”¨æ”¹æ–¹æ³•è®¾ç½®æ ‡æœ¬ä¸Šä¼ è¡¨çŠ¶æ€</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveSDFMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">epis</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="n">filename</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,labno,&#34;S&#34;,filename)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç§æœ‰åè®®æ¥å£åŒå‘">ç§æœ‰åè®®æ¥å£åŒå‘
</h3><h4 id="ç±»-astm-åŒå‘å›å¤-ack">ç±» ASTM åŒå‘å›å¤ ACK
</h4><h5 id="ç¤ºä¾‹æ¥å£ä¸‡æ³°-wan200">ç¤ºä¾‹æ¥å£(ä¸‡æ³° Wan200)
</h5><blockquote>
<p>W1N1111222222222222222200334S555555556666abcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghij 2 1141123</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MIFCARIS200BI(mi)
</span></span><span class="line"><span class="cl"> 	s mi=$g(mi) 
</span></span><span class="line"><span class="cl">	S ^TMPMACH10(mi,104)=$H
</span></span><span class="line"><span class="cl">	i &#39;$l(mi) q
</span></span><span class="line"><span class="cl">	s ItemDeli=$li(^dbo.BTMIMachineParameterD(mi),12) //é¡¹ç›®åˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s ResultDeli=$li(^dbo.BTMIMachineParameterD(mi),13) //ç»“æœåˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s AntDeli=$li(^dbo.BTMIMachineParameterD(mi),14) //æŠ—ç”Ÿç´ åˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s SenDeli=$li(^dbo.BTMIMachineParameterD(mi),15) //è¯æ•ç»“æœåˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s Port=&#34;|TCP|&#34;_$li(^dbo.BTMIMachineParameterD(mi),17)  //ç«¯å£å·
</span></span><span class="line"><span class="cl">	//æ§åˆ¶å­—ç¬¦
</span></span><span class="line"><span class="cl">	SET $ZTRAP=&#34;ErrHandler&#34;
</span></span><span class="line"><span class="cl">	S iERR=0
</span></span><span class="line"><span class="cl">	s stx=$c(2),etx=$c(3),ack=$c(6),enq=$c(5),eot=$c(4)
</span></span><span class="line"><span class="cl">	s lf=$c(10),cr=$c(13),nak=$c(21),(result,epis)=&#34;&#34;,etb=$c(23)
</span></span><span class="line"><span class="cl">	S ^TMPMACH10(mi,102)=$H
</span></span><span class="line"><span class="cl">	i $$Start^MI.MIF000(mi) q
</span></span><span class="line"><span class="cl">	f  d Main i $$Stop^MI.MIF000(mi) q
</span></span><span class="line"><span class="cl">  	c Port
</span></span><span class="line"><span class="cl">  	q
</span></span><span class="line"><span class="cl">ErrHandler
</span></span><span class="line"><span class="cl">	h 10
</span></span><span class="line"><span class="cl">	d Trace^MI.MIF000(mi,$TR($ZERROR,&#34;^&#34;,&#34;--&#34;)_&#34;.é”™è¯¯ä»£ç :&#34;_$ECODE,&#34;Runtime Error&#34;)
</span></span><span class="line"><span class="cl">	s iERR=+$g(iERR)+1
</span></span><span class="line"><span class="cl">	i iERR&gt;30 s ret=$$Stop^MI.MIF000(mi)
</span></span><span class="line"><span class="cl">    Q
</span></span><span class="line"><span class="cl">Main 
</span></span><span class="line"><span class="cl"> r *R:10 e  d  q
</span></span><span class="line"><span class="cl"> .d BUILD
</span></span><span class="line"><span class="cl"> i $c(R)=enq d
</span></span><span class="line"><span class="cl"> .s record1=&#34;&#34;
</span></span><span class="line"><span class="cl"> .d Trace^MI.MIF000(mi,&#34;ENQ&#34;,&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl"> .d ACK
</span></span><span class="line"><span class="cl"> .f  r *R:10 q:$c(R)=eot  d
</span></span><span class="line"><span class="cl"> ..i $c(R)&#39;=stx q
</span></span><span class="line"><span class="cl"> ..s record=$$Read^MI.MIF000(mi,&#34;&#34;,etx) q:&#39;$l(record)
</span></span><span class="line"><span class="cl"> ..d Trace^MI.MIF000(mi,record,&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl"> ..d ACK
</span></span><span class="line"><span class="cl"> ..s (sample,epis,surname,result,date,time,QC)=&#34;&#34;
</span></span><span class="line"><span class="cl"> ..//&#34;D1N15    15             xx500015S        1                                                                                     1 3975631111.05                              12016121020170223165831&#34;_$C(3)
</span></span><span class="line"><span class="cl"> ..s Type=$e(record,1)
</span></span><span class="line"><span class="cl"> ..//è¯·æ±‚
</span></span><span class="line"><span class="cl"> ..i Type=&#34;R&#34; d  q
</span></span><span class="line"><span class="cl"> ...s epis=$tr($e(record,4,19),&#34; &#34;)
</span></span><span class="line"><span class="cl"> ...i $l(epis) s ^TMP($zn,$j,&#34;ENQ&#34;,epis)=record
</span></span><span class="line"><span class="cl"> ..//ç»“æœ   D1N7008â–¡â–¡11â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡800383Sâ–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡1â–¡â–¡â–¡Tâ–¡â–¡â–¡â–¡â–¡
</span></span><span class="line"><span class="cl"> ..//       D1N7001â–¡â–¡â–¡1â–¡â–¡â–¡â–¡â–¡â–¡900023407700382Sâ–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡1â–¡â–¡â–¡Nâ–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡â–¡
</span></span><span class="line"><span class="cl"> ..i Type=&#34;D&#34; d  q
</span></span><span class="line"><span class="cl"> ...s ResultType=$e(record,3)
</span></span><span class="line"><span class="cl"> ...i ResultType=&#34;C&#34; d
</span></span><span class="line"><span class="cl"> ....s epis=$tr($e(record,8,16),&#34; &#34;)
</span></span><span class="line"><span class="cl"> ...e  d
</span></span><span class="line"><span class="cl"> ....s epis=$tr($e(record,17,27),&#34; &#34;)
</span></span><span class="line"><span class="cl"> ...s code=$tr($e(record,126,128),&#34; &#34;)
</span></span><span class="line"><span class="cl"> ...i code=28 s code=$tr($e(record,45,46),&#34; &#34;)_code
</span></span><span class="line"><span class="cl"> ...s res=$tr($e(record,137,142),&#34; &#34;)
</span></span><span class="line"><span class="cl"> ...;try{s res1=##class(MI.Special.JudgeResult).IsYang(mi,epis,code,res)}catch{s res1=&#34;&#34;}
</span></span><span class="line"><span class="cl"> ...s PoliceInfo=$e(record,157,172)
</span></span><span class="line"><span class="cl"> ...try{s ret=$$GetPolice(PoliceInfo)}catch{}
</span></span><span class="line"><span class="cl"> ...s resFuHao=&#34;&#34;
</span></span><span class="line"><span class="cl"> ...i $d(^LISCaris200(&#34;Data&#34;,43)) s resFuHao=&#34;&lt;&#34;
</span></span><span class="line"><span class="cl"> ...i $d(^LISCaris200(&#34;Data&#34;,42)) s resFuHao=&#34;&gt;&#34;
</span></span><span class="line"><span class="cl"> ...k ^LISCaris200(&#34;Data&#34;)
</span></span><span class="line"><span class="cl"> ...i $l(resFuHao) s res=resFuHao_res
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> ...i $l(code),$l(res) s result=result_code_$c(92)_res_$c(92)_res1_$c(44)
</span></span><span class="line"><span class="cl"> ...d Trace^MI.MIF000(mi,epis_&#34;$$&#34;_result,&#34;Result&#34;)
</span></span><span class="line"><span class="cl"> ...i $l(epis),$l(result) d Save^MI.MIF000(mi,epis,result,date,time,QC)
</span></span><span class="line"><span class="cl"> .d Trace^MI.MIF000(mi,$s($c(R)=eot:&#34;EOT&#34;,1:R),&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl"> .d BUILD
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> q
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">GetPolice(PoliceInfo)
</span></span><span class="line"><span class="cl">	s str=$$scale(PoliceInfo,&#34;16&#34;,&#34;2&#34;)
</span></span><span class="line"><span class="cl">	k ^LISCaris200(&#34;Data&#34;)
</span></span><span class="line"><span class="cl">	s strLong=$l(str)
</span></span><span class="line"><span class="cl">	f i=1:1:strLong d
</span></span><span class="line"><span class="cl">	.s stri=$e(str,i)
</span></span><span class="line"><span class="cl">	.i stri=1 d
</span></span><span class="line"><span class="cl">	..s ^LISCaris200(&#34;Data&#34;,strLong+1-i)=1
</span></span><span class="line"><span class="cl">	q &#34;&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/// è¿›åˆ¶è½¬æ¢ï¼Œå°†snumä»scale1è¿›åˆ¶è½¬æ¢ä¸ºscale2è¿›åˆ¶
</span></span><span class="line"><span class="cl">scale(snum, scale1, scale2)
</span></span><span class="line"><span class="cl">	// è½¬åè¿›åˆ¶
</span></span><span class="line"><span class="cl">	s snum=$g(snum)
</span></span><span class="line"><span class="cl">	s tnum=0
</span></span><span class="line"><span class="cl">	s numlong=$l(snum)
</span></span><span class="line"><span class="cl">	f i=1:1:$L(snum) d
</span></span><span class="line"><span class="cl">	.s numi=$e(snum,i)
</span></span><span class="line"><span class="cl">	.s numi=$$Sixteen2Ten(numi)
</span></span><span class="line"><span class="cl">	.s tnum=tnum+(numi*(scale1**(numlong-i)))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	// è½¬scale2è¿›åˆ¶
</span></span><span class="line"><span class="cl">	s tnum=$g(tnum)
</span></span><span class="line"><span class="cl">	s num=&#34;&#34;
</span></span><span class="line"><span class="cl">	s GoTo=1
</span></span><span class="line"><span class="cl">	while (GoTo=1){ 
</span></span><span class="line"><span class="cl">		s pnum1=tnum
</span></span><span class="line"><span class="cl">		s tnum=$p(tnum/scale2,&#34;.&#34;,1)
</span></span><span class="line"><span class="cl">		s pnum2=pnum1#scale2
</span></span><span class="line"><span class="cl">		s pnum2=$$Ten2Sixteen(pnum2)
</span></span><span class="line"><span class="cl">		i tnum&lt;scale2 d
</span></span><span class="line"><span class="cl">		.s num=tnum_pnum2_num
</span></span><span class="line"><span class="cl">		.s GoTo=0
</span></span><span class="line"><span class="cl">		e  s num=pnum2_num
</span></span><span class="line"><span class="cl">		if (tnum=0)||&#39;$l(tnum) s GoTo=0
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	q num
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ten2Sixteen(pnum2)
</span></span><span class="line"><span class="cl">	i pnum2=10 s pnum2=&#34;A&#34;
</span></span><span class="line"><span class="cl">	i pnum2=11 s pnum2=&#34;B&#34;
</span></span><span class="line"><span class="cl">	i pnum2=12 s pnum2=&#34;C&#34;
</span></span><span class="line"><span class="cl">	i pnum2=13 s pnum2=&#34;D&#34;
</span></span><span class="line"><span class="cl">	i pnum2=14 s pnum2=&#34;E&#34;
</span></span><span class="line"><span class="cl">	i pnum2=15 s pnum2=&#34;F&#34;
</span></span><span class="line"><span class="cl">	q pnum2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Sixteen2Ten(numi)
</span></span><span class="line"><span class="cl">	i (numi=&#34;A&#34;)||(numi=&#34;a&#34;) s numi=10
</span></span><span class="line"><span class="cl">	i (numi=&#34;B&#34;)||(numi=&#34;b&#34;) s numi=11
</span></span><span class="line"><span class="cl">	i (numi=&#34;C&#34;)||(numi=&#34;c&#34;) s numi=12
</span></span><span class="line"><span class="cl">	i (numi=&#34;D&#34;)||(numi=&#34;d&#34;) s numi=13
</span></span><span class="line"><span class="cl">	i (numi=&#34;E&#34;)||(numi=&#34;e&#34;) s numi=14
</span></span><span class="line"><span class="cl">	i (numi=&#34;F&#34;)||(numi=&#34;f&#34;) s numi=15
</span></span><span class="line"><span class="cl">	q numi
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">  //W1N11112222222222222222aa&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">BUILD  
</span></span><span class="line"><span class="cl">    i &#39;$d(^TMP($zn)) q
</span></span><span class="line"><span class="cl">    i &#39;$d(^TMP($zn,$j)) q 
</span></span><span class="line"><span class="cl">    s labno=&#34;&#34; f  s labno=$o(^TMP($zn,$j,&#34;ENQ&#34;,labno)) q:labno=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    .d ScanOne^MI.MIF000(mi,labno)  
</span></span><span class="line"><span class="cl">    .s tcx=&#34;&#34;,tcNum=0
</span></span><span class="line"><span class="cl">    .s chl=&#34;&#34; f  s chl=$o(^TMP(&#34;MIFTESTCODE&#34;,$j,mi,labno,chl)) q:chl=&#34;&#34;  d
</span></span><span class="line"><span class="cl">    ..s AutoDil=1 ///è‡ªåŠ¨ç¨€é‡Šå€æ•°
</span></span><span class="line"><span class="cl">    ..i $l(chl)=1 s tcx=tcx_&#34;  &#34;_chl_AutoDil
</span></span><span class="line"><span class="cl">    ..i $l(chl)=2 s tcx=tcx_&#34; &#34;_chl_AutoDil
</span></span><span class="line"><span class="cl">    ..i $l(chl)=3 s tcx=tcx_chl_AutoDil
</span></span><span class="line"><span class="cl">    ..s tcNum=tcNum+1
</span></span><span class="line"><span class="cl">	.//ç»„ä¸²
</span></span><span class="line"><span class="cl">    .s tStr=$g(^TMP($zn,$j,&#34;ENQ&#34;,labno))
</span></span><span class="line"><span class="cl">    .s TNUM=$e($p($h,&#34;,&#34;,2),2,5)
</span></span><span class="line"><span class="cl">    .
</span></span><span class="line"><span class="cl">    .//&#34;W1N1111222222222222222200334S555555556666abcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghij 2 1141123&#34;
</span></span><span class="line"><span class="cl">    .s str=&#34;W1N&#34;_TNUM_$e(tStr,4,19)_&#34;     S        1   &#34;
</span></span><span class="line"><span class="cl">    .s Commend=&#34;                                                                                &#34;      
</span></span><span class="line"><span class="cl">    .//i $l(tcNum)=1 s str=str_Commend_&#34; &#34;_tcNum
</span></span><span class="line"><span class="cl">    .//i $l(tcNum)=2 s str=str_Commend_tcNum
</span></span><span class="line"><span class="cl">    .s str=str_Commend_&#34; &#34;_tcNum_tcx
</span></span><span class="line"><span class="cl">    .d Send(str)
</span></span><span class="line"><span class="cl">	k ^TMP($zn,$j,&#34;ENQ&#34;)
</span></span><span class="line"><span class="cl">    q
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">Send(str) ; send list of orders if exists
</span></span><span class="line"><span class="cl"> w enq,*-3 d Trace^MI.MIF000(mi,&#34;ENQ&#34;,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl"> f j=1:1:10 r *R:1 i $c(R)=ack!($c(R)=enq) q
</span></span><span class="line"><span class="cl"> d Trace^MI.MIF000(mi,$s($c(R)=ack:&#34;ACK&#34;,$c(R)=enq:&#34;ENQ&#34;,$c(R)=nak:&#34;NAK&#34;,1:R),&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl"> i $c(R)=enq q
</span></span><span class="line"><span class="cl"> i $c(R)&#39;=ack w eot,*-3 d Trace^MI.MIF000(mi,&#34;EOT&#34;,&#34;H--&gt;M&#34;) q
</span></span><span class="line"><span class="cl"> q:$$SEND(str)
</span></span><span class="line"><span class="cl"> w eot,*-3 d Trace^MI.MIF000(mi,&#34;EOT&#34;,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl"> q
</span></span><span class="line"><span class="cl">SEND(str) ; send string to instrument
</span></span><span class="line"><span class="cl"> s str=str,chsum=$$CHSUM(str_etx)
</span></span><span class="line"><span class="cl"> w stx,str,etx,chsum,*-3 d Trace^MI.MIF000(mi,str_chsum,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl"> f j=1:1:6 r *R:1 i ($c(R)=ack)!($c(R)=eot) q
</span></span><span class="line"><span class="cl"> i $c(R)=ack d Trace^MI.MIF000(mi,&#34;ACK&#34;,&#34;H&lt;--M&#34;) q 0
</span></span><span class="line"><span class="cl"> i $c(R)=eot d Trace^MI.MIF000(mi,&#34;EOT&#34;,&#34;H&lt;--M&#34;) q 0
</span></span><span class="line"><span class="cl"> d Trace^MI.MIF000(mi,R,&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl"> q 1
</span></span><span class="line"><span class="cl">CHSUM(x) ; calculate check sum
</span></span><span class="line"><span class="cl"> n (x) s z=0 f y=1:1:$l(x) s z=z+$a(x,y)
</span></span><span class="line"><span class="cl"> s z=$zh(z)  //è½¬16è¿›åˆ¶
</span></span><span class="line"><span class="cl"> i $l(z)=3 s z=&#34;0&#34;_z
</span></span><span class="line"><span class="cl"> q z
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">aa(val)
</span></span><span class="line"><span class="cl">	s ret = &#34;&#34;
</span></span><span class="line"><span class="cl">	f j=1:1:$l(val) d
</span></span><span class="line"><span class="cl">	.s ascii = $a($e(val,j)) 
</span></span><span class="line"><span class="cl">	.if ascii&lt;16 set ret = ret_&#34;0&#34;_$zh(ascii)
</span></span><span class="line"><span class="cl">	.else  set ret = ret_$zh(ascii)
</span></span><span class="line"><span class="cl">	q ret 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">ACK ; send &#39;ack&#39; to instrument
</span></span><span class="line"><span class="cl"> w ack,*-3
</span></span><span class="line"><span class="cl"> d Trace^MI.MIF000(mi,&#34;ACK&#34;,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl"> q
</span></span><span class="line"><span class="cl">NEXTTRAY(tray) 
</span></span><span class="line"><span class="cl"> q tray
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/assets/image-20250110231540-2sl4pxn.png"
	width="964"
	height="754"
	srcset="/p/assets/image-20250110231540-2sl4pxn_hu_5c1240445ba0fe61.png 480w, /p/assets/image-20250110231540-2sl4pxn_hu_fddcd052b501ece7.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="306px"
	
></p>
<p><img src="/p/assets/image-20250110231815-rg5llua.png"
	width="814"
	height="833"
	srcset="/p/assets/image-20250110231815-rg5llua_hu_c41ba47104b4caf9.png 480w, /p/assets/image-20250110231815-rg5llua_hu_7f25a3da1f1b02d.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="97"
		data-flex-basis="234px"
	
></p>
<p><img src="/p/assets/image-20250110233605-g55e7du.png"
	width="1034"
	height="1058"
	srcset="/p/assets/image-20250110233605-g55e7du_hu_85544e8f2fde4238.png 480w, /p/assets/image-20250110233605-g55e7du_hu_ee40ecb35d5c95bb.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="97"
		data-flex-basis="234px"
	
></p>
<h4 id="å®‰å›¾åè®®">å®‰å›¾åè®®
</h4><h5 id="ç¤ºä¾‹æ¥å£å®‰å›¾-2000">ç¤ºä¾‹æ¥å£(å®‰å›¾ 2000)
</h5><blockquote>
<p>{10,0,[S]41,1,0,[S]0,[S]BL07,3,[S]100,1,[S]112,1,[S]113,1}</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MIFAUTOLUMOA2000(mi)
</span></span><span class="line"><span class="cl">	///ä»ªå™¨åç§°:	å…¨è‡ªåŠ¨åŒ–å­¦å‘å…‰æµ‹å®šä»ª
</span></span><span class="line"><span class="cl">	///ä»ªå™¨å‹å·:	A2000 
</span></span><span class="line"><span class="cl">	///ä»ªå™¨å‚å•†:	AutoLumo
</span></span><span class="line"><span class="cl">	///é€šä¿¡åè®®:	è‡ªå®šä¹‰V0.07
</span></span><span class="line"><span class="cl">	///äº¤äº’æ–¹å¼:	åŒå‘
</span></span><span class="line"><span class="cl">	///æ¥    å£:	RS232
</span></span><span class="line"><span class="cl">	///ç¼– å†™ è€…:	wwh
</span></span><span class="line"><span class="cl">	///ç¼–å†™æ—¥æœŸ:	2015-11-05
</span></span><span class="line"><span class="cl">	///å¤‡    æ³¨:	ä»ªå™¨é…ç½®:ç³»ç»Ÿè®¾ç½®--&gt;LISé€šä¿¡è®¾ç½®
</span></span><span class="line"><span class="cl">	///				ä»ªå™¨ä¹Ÿå¯è¯»å–æ–‡ä»¶,æ–‡ä»¶è·¯å¾„log/LisData/,æ–‡ä»¶å†…å®¹ä¸é€šä¿¡åè®®ä¸­ä¸€è‡´
</span></span><span class="line"><span class="cl">	///æ¥å£ç‰ˆæœ¬:	V0.0.1
</span></span><span class="line"><span class="cl">	///æ›´æ–°æ—¥å¿—:
</span></span><span class="line"><span class="cl">	///-1.æ›´æ–°æ—¥æœŸ:
</span></span><span class="line"><span class="cl">	///---æ›´ æ–° è€…:
</span></span><span class="line"><span class="cl">	///---æ›´æ–°å¤‡æ³¨:  
</span></span><span class="line"><span class="cl">	s mi=$g(mi) 
</span></span><span class="line"><span class="cl">	i &#39;$l(mi) q
</span></span><span class="line"><span class="cl">	s ItemDeli=$li(^dbo.BTMIMachineParameterD(mi),12) //é¡¹ç›®åˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s ResultDeli=$li(^dbo.BTMIMachineParameterD(mi),13) //ç»“æœåˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s AntDeli=$li(^dbo.BTMIMachineParameterD(mi),14) //æŠ—ç”Ÿç´ åˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s SenDeli=$li(^dbo.BTMIMachineParameterD(mi),15) //è¯æ•ç»“æœåˆ†éš”ç¬¦
</span></span><span class="line"><span class="cl">	s Port=&#34;|TCP|&#34;_$li(^dbo.BTMIMachineParameterD(mi),10) //ç«¯å£å·
</span></span><span class="line"><span class="cl">	//æ§åˆ¶å­—ç¬¦
</span></span><span class="line"><span class="cl">    S stx=$C(2),etx=$C(3),ack=$C(6),enq=$C(5),eot=$C(4),etb=$C(23)
</span></span><span class="line"><span class="cl">    S sb=$C(11),eb=$C(28),cr=$C(13)  
</span></span><span class="line"><span class="cl">    S lf=$C(10),nak=$C(21),(AllRecord,result,epis)=&#34;&#34;,kk=1 
</span></span><span class="line"><span class="cl">	s ^TMPMACHDATA1(mi,10)=mi
</span></span><span class="line"><span class="cl">    S leftBrace=&#34;{&#34;,rightBrace=&#34;}&#34;
</span></span><span class="line"><span class="cl">	i $$Start^MI.MIF000(mi) q
</span></span><span class="line"><span class="cl">	f  d Main i $$Stop^MI.MIF000(mi) q
</span></span><span class="line"><span class="cl">	s ^TMPMACH10(mi,50)=$h
</span></span><span class="line"><span class="cl">  	c Port
</span></span><span class="line"><span class="cl">  	q
</span></span><span class="line"><span class="cl">    /*
</span></span><span class="line"><span class="cl">    S mi=$G(mi) 
</span></span><span class="line"><span class="cl">    Q:&#39;$L(mi)
</span></span><span class="line"><span class="cl">    Q:$$select^LVBMIMP(mi)
</span></span><span class="line"><span class="cl">    F j=1:1:PLIST {
</span></span><span class="line"><span class="cl">	    S @(&#34;par&#34;_j)=PLIST(j)
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	S mi1=$P($G(par36),&#34;,&#34;,1)
</span></span><span class="line"><span class="cl">    S stx=$C(2),etx=$C(3),ack=$C(6),enq=$C(5),eot=$C(4),etb=$C(23)
</span></span><span class="line"><span class="cl">    S sb=$C(11),eb=$C(28),cr=$C(13)  
</span></span><span class="line"><span class="cl">    S lf=$C(10),nak=$C(21),(AllRecord,result,epis)=&#34;&#34;,kk=1
</span></span><span class="line"><span class="cl">    S $ZT=&#34;ErrHandler&#34;,$EC=&#34;&#34;
</span></span><span class="line"><span class="cl">    S leftBrace=&#34;{&#34;,rightBrace=&#34;}&#34;
</span></span><span class="line"><span class="cl">    S (sample,epis,surname,rec,res,result,date,time,QC,errFlag,resultType)=&#34;&#34;
</span></span><span class="line"><span class="cl">    Q:$$start^MIF000()
</span></span><span class="line"><span class="cl">	F {
</span></span><span class="line"><span class="cl">		D Main
</span></span><span class="line"><span class="cl">		Q:$$stop^MIF000()
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    C par4
</span></span><span class="line"><span class="cl">    Q
</span></span><span class="line"><span class="cl">    */
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">Main  
</span></span><span class="line"><span class="cl">    S $ZT=&#34;ErrHandler&#34;,$EC=&#34;&#34;
</span></span><span class="line"><span class="cl">    S record=$$Read^MI.MIF000(mi,leftBrace,rightBrace) 
</span></span><span class="line"><span class="cl">    Q:&#39;$l(record)
</span></span><span class="line"><span class="cl">  	d Trace^MI.MIF000(mi,record,&#34;H&lt;--M&#34;)
</span></span><span class="line"><span class="cl">  	S (epis,result,date,time,QC,data)=&#34;&#34;
</span></span><span class="line"><span class="cl">  	S cmd=$P(record,&#34;,&#34;,1)
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  	I cmd=&#34;1&#34; {		//è·å–æŒ‡å®šæ ·æœ¬ç¼–å·å’ŒæŒ‡å®šç—…å†å·çš„æ ·æœ¬è¯¦ç»†æµ‹è¯•è¯·æ±‚æ•°æ®
</span></span><span class="line"><span class="cl">  		S instrumentId=$P(record,&#34;,&#34;,2)		//ç³»ç»Ÿæ ‡è¯†
</span></span><span class="line"><span class="cl">		S:instrumentId[&#34;[S]&#34; instrumentId=$P(instrumentId,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		S sampleId=$P(record,&#34;,&#34;,3)		//æµ‹è¯•è¯·æ±‚ID
</span></span><span class="line"><span class="cl">		S epis=sampleId
</span></span><span class="line"><span class="cl">		S:epis[&#34;[S]&#34; epis=$P(epis,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		K PLIST
</span></span><span class="line"><span class="cl">	 	S error=$$BuildItems(mi,epis)
</span></span><span class="line"><span class="cl">	 	I $L(error) {
</span></span><span class="line"><span class="cl">			S ack=&#34;{2,1,&#34;_sampleId_&#34;}&#34;
</span></span><span class="line"><span class="cl">			D ACK(mi,ack)
</span></span><span class="line"><span class="cl">			;D trace^MIF000(mi,error,&#34;Error&#34;)
</span></span><span class="line"><span class="cl">			Q
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">		S tc=&#34;&#34;,items=&#34;&#34;
</span></span><span class="line"><span class="cl">		F {
</span></span><span class="line"><span class="cl">			S tc=$O(PLIST(tc))
</span></span><span class="line"><span class="cl">			Q:&#39;$L(tc)
</span></span><span class="line"><span class="cl">			S itemDiluFactor=$G(PLIST(tc))
</span></span><span class="line"><span class="cl">			S:&#39;$L(itemDiluFactor) itemDiluFactor=1		//ç¨€é‡Šå€æ•°,æœºå™¨å†…éƒ¨ç¨€é‡Š,å¿…é¡»åœ¨è¯¥æµ‹è¯•é¡¹ç›®çš„æ”¯æŒèŒƒå›´å†…
</span></span><span class="line"><span class="cl">			S items=items_&#34;[S]&#34;_tc_&#34;,&#34;_itemDiluFactor_&#34;,&#34;
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">		S itemCount=+$G(PLIST)
</span></span><span class="line"><span class="cl">		S items=$E(items,1,$L(items)-1)
</span></span><span class="line"><span class="cl">		S dilutionFactor=1	//ç¨€é‡Šå€æ•°
</span></span><span class="line"><span class="cl">		S isEmergency=0		//æ˜¯å¦æ€¥è¯Š:0=æ™®é€š,1=æ€¥è¯Š
</span></span><span class="line"><span class="cl">		S medicareId=&#34;[S]&#34;	//ç—…æ¡ˆå·
</span></span><span class="line"><span class="cl">		S secondName=&#34;[S]&#34;	//å§“
</span></span><span class="line"><span class="cl">		S firstName=&#34;[S]&#34;	//å
</span></span><span class="line"><span class="cl">		S sex=&#34;&#34;			//æ€§åˆ« 0:å¥³ 1:ç”·
</span></span><span class="line"><span class="cl">		S age=&#34;&#34;			//å¹´é¾„:æ•´æ•°
</span></span><span class="line"><span class="cl">		S location=&#34;[S]&#34;	//ç§‘å®¤
</span></span><span class="line"><span class="cl">		S ward=&#34;[S]&#34;		//ç—…åŒº
</span></span><span class="line"><span class="cl">		S bed=&#34;[S]&#34;			//åºŠå·
</span></span><span class="line"><span class="cl">		S reqDoctor=&#34;[S]&#34;	//é€æ£€åŒ»ç”Ÿ
</span></span><span class="line"><span class="cl">		S reqDate=&#34;&#34;		//é€æ£€æ—¥æœŸ(æ ¼å¼:YYYY/MM/DD)
</span></span><span class="line"><span class="cl">		S receiveUser=&#34;[S]&#34;	//æ£€éªŒäººå‘˜
</span></span><span class="line"><span class="cl">		S remark=&#34;[S]&#34;			//å¤‡æ³¨
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		S ack=&#34;{2,0,&#34;_sampleId_&#34;,&#34;_dilutionFactor_&#34;,&#34;_isEmergency_&#34;,&#34;_medicareId_&#34;,&#34;
</span></span><span class="line"><span class="cl">		S ack=ack_secondName_&#34;,&#34;_firstName_&#34;,&#34;_sex_&#34;,&#34;_age_&#34;,&#34;_location_&#34;,&#34;_ward_&#34;,&#34;
</span></span><span class="line"><span class="cl">		S ack=ack_bed_&#34;,&#34;_reqDoctor_&#34;,&#34;_reqDate_&#34;,&#34;_receiveUser_&#34;,&#34;_remark_&#34;,&#34;
</span></span><span class="line"><span class="cl">		S ack=ack_itemCount_&#34;,&#34;_items_&#34;}&#34;
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		D ACK(mi,ack)
</span></span><span class="line"><span class="cl">		Q 
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	I cmd=&#34;3&#34; {		//è·å–åˆ†é…ç»™æŒ‡å®šä»ªå™¨æ‰€æœ‰æ‚£è€…æµ‹è¯•æ ·æœ¬çš„ä¸ªæ•°
</span></span><span class="line"><span class="cl">		S instrumentId=$P(record,&#34;,&#34;,2)		//ç³»ç»Ÿæ ‡è¯†
</span></span><span class="line"><span class="cl">		S:instrumentId[&#34;[S]&#34; instrumentId=$P(instrumentId,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">	 	S sampleTotal=&#34;0&#34;
</span></span><span class="line"><span class="cl">		S ack=&#34;{4,1}&#34;		//æš‚æ—¶ä¸å¤„ç†
</span></span><span class="line"><span class="cl">		D ACK(mi,ack)
</span></span><span class="line"><span class="cl">		Q 
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	I cmd=&#34;5&#34; {	//æŒ‰æµ‹è¯•æ¨¡å¼å‘é€ç»“æœåˆ°LIS
</span></span><span class="line"><span class="cl">		//{5,[S]A2000,[S]41,[S]132,47925,970200L,183.145F}
</span></span><span class="line"><span class="cl">		S instrumentId=$P(record,&#34;,&#34;,2)		//ç³»ç»Ÿæ ‡è¯†
</span></span><span class="line"><span class="cl">		S:instrumentId[&#34;[S]&#34; instrumentId=$P(instrumentId,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		S sampleId=$P(record,&#34;,&#34;,5)		//æµ‹è¯•è¯·æ±‚ID
</span></span><span class="line"><span class="cl">		S sampleNo=$P(record,&#34;,&#34;,3)		//æµ‹è¯•æ ·æœ¬ç¼–å·
</span></span><span class="line"><span class="cl">		S itemId=$P(record,&#34;,&#34;,4)		//æµ‹è¯•é¡¹ç›®ç¼–å·
</span></span><span class="line"><span class="cl">		S medicareId=&#34;[S]&#34;				//ç—…æ¡ˆå·
</span></span><span class="line"><span class="cl">		//{6,0,47925,[S]41,[S],[S]132}
</span></span><span class="line"><span class="cl">		S ack=&#34;{6,0,&#34;_sampleId_&#34;,&#34;_sampleNo_&#34;,&#34;_medicareId_&#34;,&#34;_itemId_&#34;}&#34;
</span></span><span class="line"><span class="cl">		D ACK(mi,ack)
</span></span><span class="line"><span class="cl">		S epis=sampleNo  //sampleId
</span></span><span class="line"><span class="cl">		S:epis[&#34;[S]&#34; epis=$P(epis,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		// 2017-09-13 WxC è´¨æ§æ ‡ç¤ºç‰¹æ®Šå¤„ç†
</span></span><span class="line"><span class="cl">		;I &#34;H1,L1,P1,C1&#34;[epis S epis=&#34;liver1&#34;
</span></span><span class="line"><span class="cl">		;I &#34;H2,L2,P2,C2&#34;[epis S epis=&#34;liver2&#34;
</span></span><span class="line"><span class="cl">		;I &#34;M1,G1&#34;[epis S epis=&#34;HEV1&#34;
</span></span><span class="line"><span class="cl">		;I &#34;M2,G2&#34;[epis S epis=&#34;HEV2&#34;
</span></span><span class="line"><span class="cl">		//
</span></span><span class="line"><span class="cl">		S channel=itemId
</span></span><span class="line"><span class="cl">		S:channel[&#34;[S]&#34; channel=$P(channel,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		S valueL=$P(record,&#34;,&#34;,6)		//RLU((æ£€æµ‹ç»“æœç›¸å¯¹å‘å…‰å€¼)
</span></span><span class="line"><span class="cl">		S valueL=$P(valueL,&#34;L&#34;,1)
</span></span><span class="line"><span class="cl">		S valueF=$P(record,&#34;,&#34;,7)		//æµ“åº¦å€¼æˆ–S/COå€¼
</span></span><span class="line"><span class="cl">		S valueF=$P(valueF,&#34;F&#34;,1)
</span></span><span class="line"><span class="cl">		S:valueF[&#34;[S]&#34; valueF=$tr(valueF,&#34;[S]&#34;,&#34;&#34;)
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		Q:&#39;$L(channel)
</span></span><span class="line"><span class="cl">		S result=&#34;&#34;
</span></span><span class="line"><span class="cl">		//S result=result_channel_&#34;-L&#34;_$C(par10)_valueL_$C(par11)
</span></span><span class="line"><span class="cl">		//S result=result_channel_&#34;-F&#34;_$C(par10)_valueF_$C(par11)
</span></span><span class="line"><span class="cl">		S result=result_channel_ResultDeli_valueF_ItemDeli
</span></span><span class="line"><span class="cl">		D Save
</span></span><span class="line"><span class="cl">		Q 
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	I cmd=&#34;7&#34; {	//æŒ‰æ ·æœ¬æ¨¡å¼å‘é€ç»“æœåˆ°LIS
</span></span><span class="line"><span class="cl">		//{7,[S]A2000,101,[S]41,3,[S]132,970200L,183.145F,[S]112,673200L,13.15F,[S]113,1378200L,13.5F
</span></span><span class="line"><span class="cl">		S instrumentId=$P(record,&#34;,&#34;,2)		//ç³»ç»Ÿæ ‡è¯†
</span></span><span class="line"><span class="cl">		S:instrumentId[&#34;[S]&#34; instrumentId=$P(instrumentId,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		S sampleId=$P(record,&#34;,&#34;,3)			//æ ·æœ¬ID
</span></span><span class="line"><span class="cl">		S sampleNo=$P(record,&#34;,&#34;,4)			//æµ‹è¯•æ ·æœ¬ç¼–å·
</span></span><span class="line"><span class="cl">		S itemCount=+$P(record,&#34;,&#34;,5)		//æµ‹è¯•æ ·æœ¬åŒ…å«çš„æµ‹è¯•ä¸ªæ•°
</span></span><span class="line"><span class="cl">		S items=$P(record,&#34;,&#34;,6,$L(record,&#34;,&#34;))
</span></span><span class="line"><span class="cl">		S medicareId=&#34;[S]&#34;					//ç—…æ¡ˆå· 
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">		//{8,0,101,[S]41,[S]
</span></span><span class="line"><span class="cl">		S ack=&#34;{8,0,&#34;_sampleId_&#34;,&#34;_sampleNo_&#34;,&#34;_medicareId_&#34;}&#34;
</span></span><span class="line"><span class="cl">		D ACK(mi,ack)
</span></span><span class="line"><span class="cl">		S epis=sampleId
</span></span><span class="line"><span class="cl">		S:epis[&#34;[S]&#34; epis=$P(epis,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		// 2017-09-13 WxC è´¨æ§æ ‡ç¤ºç‰¹æ®Šå¤„ç†
</span></span><span class="line"><span class="cl">		I &#34;H1,L1,P1,C1&#34;[epis S epis=&#34;liver1&#34;
</span></span><span class="line"><span class="cl">		I &#34;H2,L2,P2,C2&#34;[epis S epis=&#34;liver2&#34;
</span></span><span class="line"><span class="cl">		I &#34;M1,G1&#34;[epis S epis=&#34;HEV1&#34;
</span></span><span class="line"><span class="cl">		I &#34;M2,G2&#34;[epis S epis=&#34;HEV2&#34;
</span></span><span class="line"><span class="cl">		//
</span></span><span class="line"><span class="cl">		S result=&#34;&#34;
</span></span><span class="line"><span class="cl">		F itemIndex=1:3:$L(items,&#34;,&#34;) {
</span></span><span class="line"><span class="cl">			S itemId=$P(items,&#34;,&#34;,itemIndex)	//æµ‹è¯•é¡¹ç›®ç¼–å·
</span></span><span class="line"><span class="cl">			S channel=itemId
</span></span><span class="line"><span class="cl">			S:channel[&#34;[S]&#34; channel=$P(channel,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">			Continue:&#39;$L(channel)
</span></span><span class="line"><span class="cl">			S valueL=$P(items,&#34;,&#34;,itemIndex+1)	//RLU((æ£€æµ‹ç»“æœç›¸å¯¹å‘å…‰å€¼)
</span></span><span class="line"><span class="cl">			S valueL=$P(valueL,&#34;L&#34;,1)
</span></span><span class="line"><span class="cl">			S valueF=$P(items,&#34;,&#34;,itemIndex+2)	//æµ“åº¦å€¼æˆ–S/COå€¼
</span></span><span class="line"><span class="cl">			S valueF=$P(valueF,&#34;F&#34;,1)
</span></span><span class="line"><span class="cl">			S:valueF[&#34;[S]&#34; valueF=$tr(valueF,&#34;[S]&#34;,&#34;&#34;) 
</span></span><span class="line"><span class="cl">			//S result=result_channel_&#34;-L&#34;_$C(par10)_valueL_$C(par11)
</span></span><span class="line"><span class="cl">			//S result=result_channel_&#34;-F&#34;_$C(par10)_valueF_$C(par11)
</span></span><span class="line"><span class="cl">			S result=result_channel_ResultDeli_valueF_ItemDeli
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">		D Save
</span></span><span class="line"><span class="cl">		Q  
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	I cmd=&#34;9&#34; {	//åŒå‘  
</span></span><span class="line"><span class="cl">		//{9,[S]A2000,[S]41}
</span></span><span class="line"><span class="cl">		S instrumentId=$P(record,&#34;,&#34;,2)		//ç³»ç»Ÿæ ‡è¯†
</span></span><span class="line"><span class="cl">		S:instrumentId[&#34;[S]&#34; instrumentId=$P(instrumentId,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		S sampleId=$P(record,&#34;,&#34;,3)			//æ ·æœ¬ID
</span></span><span class="line"><span class="cl">		S epis=sampleId
</span></span><span class="line"><span class="cl">		S:epis[&#34;[S]&#34; epis=$P(epis,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		///2016-04-13 WXC æ‰«æ¡ç è½¬æ¢ä»ªå™¨
</span></span><span class="line"><span class="cl">		///D SetTSMachine^MIF000(mi,epis)
</span></span><span class="line"><span class="cl">  		;s Err=##Class(LIS.Common.DHCVisitNumber).ReceiveLabNoByWGM(mi,epis,&#34;&#34;) 
</span></span><span class="line"><span class="cl">  		;d Trace^MI.MIF000(mi,Err,&#34;æ ¸æ”¶åˆ°ä»ªå™¨è¿”å›&#34;)
</span></span><span class="line"><span class="cl">  		s Err=&#34;&#34;
</span></span><span class="line"><span class="cl">  		s RetLL=$$SaveLastMachine^MI.MIF000(mi,epis)
</span></span><span class="line"><span class="cl">    	d Trace^MI.MIF000(mi,RetLL,&#34;ä¿å­˜æœ€åä»ªå™¨&#34;)
</span></span><span class="line"><span class="cl">		K PLIST
</span></span><span class="line"><span class="cl">		S error=$$BuildItems(mi,epis)
</span></span><span class="line"><span class="cl">		I $L(error) {
</span></span><span class="line"><span class="cl">			S ack=&#34;{10,1,&#34;_sampleId_&#34;}&#34;
</span></span><span class="line"><span class="cl">			D ACK(mi,ack)
</span></span><span class="line"><span class="cl">			d Trace^MI.MIF000(mi,error,&#34;Error&#34;)
</span></span><span class="line"><span class="cl">			Q
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">		S tc=&#34;&#34;,items=&#34;&#34;
</span></span><span class="line"><span class="cl">		F {
</span></span><span class="line"><span class="cl">			S tc=$O(PLIST(tc))
</span></span><span class="line"><span class="cl">			Q:&#39;$L(tc)
</span></span><span class="line"><span class="cl">			S itemDiluFactor=$G(PLIST(tc))
</span></span><span class="line"><span class="cl">			S:&#39;$L(itemDiluFactor) itemDiluFactor=1		//ç¨€é‡Šå€æ•°,æœºå™¨å†…éƒ¨ç¨€é‡Š,å¿…é¡»åœ¨è¯¥æµ‹è¯•é¡¹ç›®çš„æ”¯æŒèŒƒå›´å†…
</span></span><span class="line"><span class="cl">			S items=items_&#34;[S]&#34;_tc_&#34;,&#34;_itemDiluFactor_&#34;,&#34;
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">		S items=$E(items,1,$L(items)-1)
</span></span><span class="line"><span class="cl">		S dilutionFactor=1						//ç¨€é‡Šå› å­
</span></span><span class="line"><span class="cl">		S isEmergency=0							//æ˜¯å¦æ€¥è¯Š:0=æ™®é€š,1=æ€¥è¯Š
</span></span><span class="line"><span class="cl">		S specimen=&#34;[S]&#34;_$$GetSpecimen(epis)	//æ ·æœ¬ç±»å‹:å­—ç¬¦ä¸²,å¦‚æœä»ªå™¨ä¸èƒ½è¯†åˆ«åˆ™é»˜è®¤ä¸ºè¡€æ¸…
</span></span><span class="line"><span class="cl">		 
</span></span><span class="line"><span class="cl">		S itemCount=+$G(PLIST)
</span></span><span class="line"><span class="cl">		//{10,0,[S]41,1,0,[S],3,[S]132,1,[S]112,1,[S]113,1}
</span></span><span class="line"><span class="cl">		S ack=&#34;{10,0,[S]&#34;_sampleId_&#34;,&#34;_dilutionFactor_&#34;,&#34;_isEmergency_&#34;,&#34;_specimen_&#34;,&#34;_itemCount_&#34;,&#34;_items_&#34;}&#34;
</span></span><span class="line"><span class="cl">		D Trace^MI.MIF000(mi,ack,&#34;ack&lt;--M&#34;)
</span></span><span class="line"><span class="cl">		D ACK(mi,ack)
</span></span><span class="line"><span class="cl">		Q  
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	I cmd=&#34;11&#34; {	//è¿æ¥LISç³»ç»Ÿå¼€å§‹é€šä¿¡ 
</span></span><span class="line"><span class="cl">		S instrumentId=$P(record,&#34;,&#34;,2)		//ç³»ç»Ÿæ ‡è¯†
</span></span><span class="line"><span class="cl">		S:instrumentId[&#34;[S]&#34; instrumentId=$P(instrumentId,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		S lisCommVersion=$P(record,&#34;,&#34;,3)		//LISé€šä¿¡æ¨¡å—ç‰ˆæœ¬å·
</span></span><span class="line"><span class="cl">		S lisVersion=&#34;[S]V0.0.1&#34;				//LISç³»ç»Ÿç‰ˆæœ¬å·
</span></span><span class="line"><span class="cl">		S ack=&#34;{12,0,&#34;_lisVersion_&#34;}&#34;
</span></span><span class="line"><span class="cl">		D ACK(mi,ack)
</span></span><span class="line"><span class="cl">		Q  
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	I cmd=&#34;15&#34; {	//å¿«é€Ÿè·å–æŒ‡å®šæ ·æœ¬æ¶ç¼–å·æµ‹è¯•è¯·æ±‚æ•°æ® 
</span></span><span class="line"><span class="cl">		S instrumentId=$P(record,&#34;,&#34;,2)		//ç³»ç»Ÿæ ‡è¯†
</span></span><span class="line"><span class="cl">		S:instrumentId[&#34;[S]&#34; instrumentId=$P(instrumentId,&#34;[S]&#34;,2)
</span></span><span class="line"><span class="cl">		S rackId=$P(record,&#34;,&#34;,3)		//æ ·æœ¬æ¶ç¼–å·
</span></span><span class="line"><span class="cl">		S position=$P(record,&#34;,&#34;,4)		//æ ·æœ¬ä½ç½®å·
</span></span><span class="line"><span class="cl">		S ack=&#34;{16,1,&#34;_rackId_&#34;,&#34;_position_&#34;0,[S]}&#34;	//ä¸å¤„ç†æ­¤æ¨¡å¼
</span></span><span class="line"><span class="cl">		D ACK(mi,ack)
</span></span><span class="line"><span class="cl">		Q  
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">    Q 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">ErrHandler
</span></span><span class="line"><span class="cl">    h 10
</span></span><span class="line"><span class="cl">	d Trace^MI.MIF000(mi,$TR($ZERROR,&#34;^&#34;,&#34;--&#34;)_&#34;.é”™è¯¯ä»£ç :&#34;_$ECODE,&#34;Runtime Error&#34;)
</span></span><span class="line"><span class="cl">    Q 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">GetSpecimen(Labno) n (Labno)
</span></span><span class="line"><span class="cl">  s Labno=$G(Labno)
</span></span><span class="line"><span class="cl">  i &#39;$l(Labno) q &#34;&#34;
</span></span><span class="line"><span class="cl">  s SpecName=&#34;&#34;
</span></span><span class="line"><span class="cl">  s SpecDR=&#34;&#34;
</span></span><span class="line"><span class="cl">  &amp;sql(SELECT SpecimenDR into :SpecDR FROM dbo.RP_VisitNumber WHERE VisitNumber=:Labno)
</span></span><span class="line"><span class="cl">  i SQLCODE q &#34;&#34;
</span></span><span class="line"><span class="cl">  q:SpecDR=&#34;&#34; &#34;&#34;
</span></span><span class="line"><span class="cl">  &amp;sql(select IName into :SpecName from dbo.BT_Specimen where RowID=:SpecDR)
</span></span><span class="line"><span class="cl">  q SpecName
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">	//æ„å»ºæµ‹è¯•é¡¹ç›®,è¿”å›é”™è¯¯ä»£ç 
</span></span><span class="line"><span class="cl">BuildItems(mi,epis)
</span></span><span class="line"><span class="cl">	N (mi,epis,PLIST)
</span></span><span class="line"><span class="cl">	K PLIST
</span></span><span class="line"><span class="cl">	S mi=$G(mi),epis=$G(epis)
</span></span><span class="line"><span class="cl">	Q:&#39;$L(mi) &#34;ä»ªå™¨ä»£ç ä¸ºç©º&#34;
</span></span><span class="line"><span class="cl">	Q:&#39;$L(epis) &#34;æ ‡æœ¬å·ä¸ºç©º&#34;
</span></span><span class="line"><span class="cl">	//Q:&#39;$D(^TMIF(mi)) &#34;ä»ªå™¨ä»£ç é”™è¯¯&#34;
</span></span><span class="line"><span class="cl">	//Q:&#39;$D(^TEPI(epis)) &#34;åœ¨LISç³»ç»Ÿæœªæ‰¾åˆ°æ ·æœ¬å·:&#34;_epis_&#34;,ç¡®å®šæ ·æœ¬å·æ­£ç¡®æˆ–å·²ç»åœ¨LISç³»ç»Ÿæ¥æ”¶&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	S error=&#34;&#34;,PLIST=0
</span></span><span class="line"><span class="cl">	K ^TMP(&#34;MIFTESTCODE&#34;,$J,mi,epis)
</span></span><span class="line"><span class="cl">	d ScanOneNew^MI.MIF000(mi,epis)
</span></span><span class="line"><span class="cl">	K PLIST
</span></span><span class="line"><span class="cl">	S tc=&#34;&#34;
</span></span><span class="line"><span class="cl">	F {
</span></span><span class="line"><span class="cl">		S tc=$O(^TMP(&#34;MIFTESTCODE&#34;,$J,mi,epis,tc))
</span></span><span class="line"><span class="cl">		Q:&#39;$L(tc)
</span></span><span class="line"><span class="cl">		S tc=$P(tc,&#34;-&#34;,1)
</span></span><span class="line"><span class="cl">		Continue:&#39;$L(tc)
</span></span><span class="line"><span class="cl">		Continue:$D(PLIST(tc))
</span></span><span class="line"><span class="cl">		S PLIST(tc)=&#34;&#34;
</span></span><span class="line"><span class="cl">		S PLIST=$I(PLIST)
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	Q:+$G(PLIST)&lt;1 &#34;æœªæ‰¾åˆ°æ ·æœ¬å·:&#34;_epis_&#34;éœ€è¦ä¸Šä¼ çš„é¡¹ç›®,ç¡®å®šæ ·æœ¬ä¸ºç™»è®°çŠ¶æ€ä¸”æ‰€å¼€åŒ»å˜±å·²ç»æ­£ç¡®ç»´æŠ¤åˆ°ä»ªå™¨&#34;
</span></span><span class="line"><span class="cl">	Q &#34;&#34;
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">ACK(mi,data)
</span></span><span class="line"><span class="cl">	N (mi,data)
</span></span><span class="line"><span class="cl">	S mi=$G(mi),data=$G(data)
</span></span><span class="line"><span class="cl">	Q:&#39;$L(mi) &#34;&#34;
</span></span><span class="line"><span class="cl">	Q:&#39;$L(data) &#34;&#34;
</span></span><span class="line"><span class="cl">	//Q:&#39;$D(^TMIF(mi)) &#34;&#34;
</span></span><span class="line"><span class="cl">	W data,*-3
</span></span><span class="line"><span class="cl">    d Trace^MI.MIF000(mi,data,&#34;H--&gt;M&#34;)
</span></span><span class="line"><span class="cl">	Q &#34;&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Save   
</span></span><span class="line"><span class="cl">	d Trace^MI.MIF000(mi,epis_&#34;$$&#34;_result,&#34;Result&#34;)
</span></span><span class="line"><span class="cl">  	I $l(epis),$l(result) {
</span></span><span class="line"><span class="cl">	  	//S QC=$$findQC^MIF000(mi,epis)
</span></span><span class="line"><span class="cl">  		d Save^MI.MIF000(mi,epis,result,date,time,QC) //file^MIF000(mi,sample,epis,surname,result,date,time,QC,mi1)
</span></span><span class="line"><span class="cl">  	}
</span></span><span class="line"><span class="cl">  	S (epis,rec,res,result,date,time,QC,resultType)=&#34;&#34;
</span></span><span class="line"><span class="cl">  	Q
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/assets/image-20250110233658-ylcmi5y.png"
	width="710"
	height="665"
	srcset="/p/assets/image-20250110233658-ylcmi5y_hu_12c536a0f47a4c56.png 480w, /p/assets/image-20250110233658-ylcmi5y_hu_45edc6bc02b7a0c0.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="106"
		data-flex-basis="256px"
	
></p>
<h2 id="ä¸»åŠ¨ä¸Šä¼ åŒå‘">ä¸»åŠ¨ä¸Šä¼ åŒå‘
</h2><h3 id="é€šè¿‡ç›‘å¬æ–‡ä»¶åŒå‘">é€šè¿‡ç›‘å¬æ–‡ä»¶åŒå‘
</h3><h4 id="ä¸åŒè·¯å¾„å›ä¼ æ‚£è€…ä¿¡æ¯å’Œæ£€æµ‹é¡¹ç›®ä¿¡æ¯">ä¸åŒè·¯å¾„å›ä¼ æ‚£è€…ä¿¡æ¯å’Œæ£€æµ‹é¡¹ç›®ä¿¡æ¯
</h4><h5 id="ç¤ºä¾‹æ¥å£å¸Œæ£®ç¾åº·-xn1000">ç¤ºä¾‹æ¥å£(å¸Œæ£®ç¾åº· XN1000)
</h5><blockquote>
<p>é€šè¿‡é…ç½®ç›‘å¬ UPPreDealClass å­—æ®µâ€œPreDeal.DealStandSysmexImage,PreDealâ€œï¼Œé€šè¿‡ M è¿›è¡Œç¼–å†™ä¸Šä¼ ä¿¡æ¯ï¼Œä¼šåŒæ—¶ä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ–‡ä»¶ä¼ æ‚£è€…ä¿¡æ¯ï¼Œä¸€ä¸ªæ–‡ä»¶ä¼ æ ‡æœ¬é¡¹ç›®ã€‚</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">///</span><span class="p">[{</span><span class="s2">&#34;MachID&#34;</span><span class="p">:</span><span class="s2">&#34;#RowID&#34;</span><span class="p">,</span><span class="s2">&#34;Type&#34;</span><span class="p">:</span><span class="s2">&#34;Drect&#34;</span><span class="p">,</span><span class="s2">&#34;UpTime&#34;</span><span class="p">:</span><span class="s2">&#34;1000&#34;</span><span class="p">,</span><span class="s2">&#34;Address&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Laboman6.0</span><span class="se">\\</span><span class="s2">2&#34;</span><span class="p">,</span><span class="s2">&#34;UpCDF&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Laboman6.0</span><span class="se">\\</span><span class="s2">1&#34;</span><span class="p">,</span><span class="s2">&#34;UpREF&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Laboman6.0&#34;</span><span class="p">,</span><span class="s2">&#34;DealProcess&#34;</span><span class="p">:</span><span class="s2">&#34;MI.MIFXN1000&#34;</span><span class="p">,</span><span class="s2">&#34;Para&#34;</span><span class="p">:</span><span class="s2">&#34;.CDF&#34;</span><span class="p">,</span><span class="s2">&#34;PreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoM,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UPPreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealStandSysmexImage,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UpPara&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Laboman6.0</span><span class="se">\\</span><span class="s2">1,D:</span><span class="se">\\</span><span class="s2">Laboman6.0&#34;</span><span class="p">,</span><span class="s2">&#34;IsCombineLines&#34;</span><span class="p">:</span><span class="s2">&#34;1&#34;</span><span class="p">}]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="p">[{</span><span class="s2">&#34;MachID&#34;</span><span class="p">:</span><span class="s2">&#34;#RowID&#34;</span><span class="p">,</span><span class="s2">&#34;Type&#34;</span><span class="p">:</span><span class="s2">&#34;Drect&#34;</span><span class="p">,</span><span class="s2">&#34;UpTime&#34;</span><span class="p">:</span><span class="s2">&#34;1000&#34;</span><span class="p">,</span><span class="s2">&#34;Address&#34;</span><span class="p">:</span><span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Laboman</span><span class="se">\\</span><span class="s2">2&#34;</span><span class="p">,</span><span class="s2">&#34;UpCDF&#34;</span><span class="p">:</span><span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Laboman</span><span class="se">\\</span><span class="s2">1&#34;</span><span class="p">,</span><span class="s2">&#34;UpREF&#34;</span><span class="p">:</span><span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Laboman&#34;</span><span class="p">,</span><span class="s2">&#34;DealProcess&#34;</span><span class="p">:</span><span class="s2">&#34;MI.MIFXN1000&#34;</span><span class="p">,</span><span class="s2">&#34;Para&#34;</span><span class="p">:</span><span class="s2">&#34;.CDF&#34;</span><span class="p">,</span><span class="s2">&#34;PreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoM,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UPPreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealStandSysmexImage,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UpPara&#34;</span><span class="p">:</span><span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Laboman</span><span class="se">\\</span><span class="s2">1,C:</span><span class="se">\\</span><span class="s2">Laboman&#34;</span><span class="p">,</span><span class="s2">&#34;IsCombineLines&#34;</span><span class="p">:</span><span class="s2">&#34;1&#34;</span><span class="p">}]</span>
</span></span><span class="line"><span class="cl"><span class="n">Class</span> <span class="n">MI</span><span class="o">.</span><span class="n">MIFXN1000</span> <span class="n">Extends</span> <span class="o">%</span><span class="n">RegisteredObject</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">D</span> <span class="c1">##class(MI.MIFLISMonitorTest).fileMTHD(&#34;38&#34;,&#34;1,BASO#,1,0.02,,,,,&#34;,&#34;1&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨ä¸»é”®</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">record</span><span class="p">:</span><span class="err">ä¸€ä¸ªæ•°æ®è¡Œåˆå¹¶æäº¤ç”¨</span><span class="c1">#enter#åˆ†å‰²å¤šè¡Œæ•°æ®</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">epis</span><span class="p">:</span><span class="err">æµæ°´å·ï¼Œå‰å¤„ç†æå–å‡ºäº†çš„ç”»</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">fileNameOrColName</span><span class="p">:</span><span class="err">è¯»æ–‡ä»¶çš„æ˜¯æ–‡ä»¶å…¨åï¼Œæ•°æ®åº“çš„æ˜¯æ•°æ®åº“æŸ¥è¯¢çš„åˆ—åç”¨</span><span class="o">~</span><span class="err">åˆ†å‰²</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="p">[{</span><span class="s2">&#34;MachID&#34;</span><span class="p">:</span><span class="s2">&#34;#RowID&#34;</span><span class="p">,</span><span class="s2">&#34;Type&#34;</span><span class="p">:</span><span class="s2">&#34;Drect&#34;</span><span class="p">,</span><span class="s2">&#34;UpTime&#34;</span><span class="p">:</span><span class="s2">&#34;3000&#34;</span><span class="p">,</span><span class="s2">&#34;Address&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Result</span><span class="se">\\</span><span class="s2">2&#34;</span><span class="p">,</span><span class="s2">&#34;UpCDF&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Result</span><span class="se">\\</span><span class="s2">1&#34;</span><span class="p">,</span><span class="s2">&#34;UpREF&#34;</span><span class="p">:</span><span class="s2">&#34;D:</span><span class="se">\\</span><span class="s2">Result</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">,</span><span class="s2">&#34;DealProcess&#34;</span><span class="p">:</span><span class="s2">&#34;MI.MIFXEMSYS&#34;</span><span class="p">,</span><span class="s2">&#34;Para&#34;</span><span class="p">:</span><span class="s2">&#34;.cdf&#34;</span><span class="p">,</span><span class="s2">&#34;PreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoMAll,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UPPreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealImage,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UpPara&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">}]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">fileMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">record</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">(</span><span class="n">MAXLEN</span><span class="o">=</span><span class="mi">99999999</span><span class="p">),</span> <span class="n">epis</span><span class="p">,</span> <span class="n">fileNameOrColName</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(record) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">å¤šè¡Œæ•°æ®</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">recordbak</span><span class="o">=</span><span class="n">record</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è¿”å›å€¼</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">retcode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è§£æå¤šè¡Œåˆå¹¶æ•°æ®ï¼ŒæŒ‰</span><span class="c1">#enter#åˆ†éš”ï¼Œç›‘å¬configå¼€å¯ä¸å¦åˆå¹¶æäº¤éƒ½æ”¯æŒ</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">image</span><span class="p">,</span><span class="n">retimage</span><span class="p">,</span><span class="n">imageR</span><span class="p">,</span><span class="n">retimageR</span><span class="p">,</span><span class="n">imageres</span><span class="p">,</span><span class="n">Ipcode</span><span class="p">,</span><span class="n">IpName</span><span class="p">,</span><span class="n">conclusion</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;#enter#&#34;</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.</span><span class="n">S</span> <span class="n">resVal</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;#enter#&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.//</span><span class="mi">0</span><span class="p">,</span><span class="mi">2020</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">XS500</span><span class="p">,</span><span class="mi">17944</span><span class="p">,</span><span class="mi">35</span><span class="p">,[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.//</span><span class="mi">1</span><span class="p">,</span><span class="n">RDW</span><span class="o">-</span><span class="n">SD</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">41.60</span><span class="p">,,,,,[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span><span class="mi">1</span><span class="p">,</span><span class="n">WBC</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">4.15</span><span class="p">,,,,,[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.//</span><span class="mi">3</span><span class="p">,,</span><span class="n">HPLT</span><span class="p">,</span><span class="n">C</span><span class="p">:</span>\<span class="n">Laboman4</span><span class="o">.</span><span class="mi">0</span>\<span class="n">XS500</span>\<span class="n">gram</span>\<span class="mi">20201210</span>\<span class="mi">0000000040</span><span class="n">_201210153004_HPLT</span><span class="o">.</span><span class="n">gif</span><span class="p">,</span><span class="mi">1</span><span class="p">[</span><span class="mi">13</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.</span><span class="n">s</span> <span class="n">type</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">resVal</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="mi">0</span> <span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">resVal</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="mi">1</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">s</span> <span class="n">code</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">resVal</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">res</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">resVal</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">result_code_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_res_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="mi">3</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">s</span> <span class="n">image</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">resVal</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">s</span> <span class="n">retimage</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">resVal</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">s</span> <span class="n">imageR</span><span class="o">=</span><span class="n">imageR_image_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">s</span> <span class="n">retimageR</span><span class="o">=</span><span class="n">retimageR_retimage_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="mi">4</span> <span class="n">d</span>   <span class="o">//</span><span class="err">è®°å½•ä»ªå™¨æŠ¥è­¦ä¿¡æ¯</span><span class="p">,</span><span class="n">Ipcode</span> <span class="err">ä¿¡æ¯ä»£ç </span><span class="p">,</span><span class="n">IpName</span> <span class="err">ä¿¡æ¯å†…å®¹</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">s</span> <span class="n">Ipcode</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">resVal</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">s</span> <span class="n">IpName</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">resVal</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..//</span><span class="n">s</span> <span class="n">conclusion</span><span class="o">=</span><span class="n">conclusion_Ipcode_</span><span class="s2">&#34;^&#34;</span><span class="n">_IpName</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">conclusion</span><span class="p">)</span> <span class="n">s</span> <span class="n">conclusion</span><span class="o">=</span><span class="n">conclusion_</span><span class="s2">&#34;ï¼Œ&#34;</span><span class="n">_Ipcode_</span><span class="s2">&#34;ï¼š&#34;</span><span class="n">_IpName</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">..</span><span class="n">e</span>  <span class="n">s</span> <span class="n">conclusion</span><span class="o">=</span><span class="n">Ipcode_</span><span class="s2">&#34;ï¼š&#34;</span><span class="n">_IpName</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="mi">9</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">imageR</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">imageR</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">imageR</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">retimageR</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">retimageR</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">retimageR</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">conversion</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">imageres</span><span class="o">=</span><span class="s2">&#34;getimage#&#34;</span><span class="n">_epis_</span><span class="s2">&#34;#&#34;</span><span class="n">_imageR_</span><span class="s2">&#34;#&#34;</span><span class="n">_retimageR</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">imageres</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;:&#34;</span><span class="n">_result</span><span class="p">,</span><span class="s2">&#34;æç¤º&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">conclusion</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">epis1</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">6</span> <span class="n">s</span> <span class="n">epis1</span><span class="o">=$$</span><span class="n">ChangeEpisnew</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">6</span> <span class="n">s</span> <span class="n">epis1</span><span class="o">=</span><span class="n">epis</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis1_</span><span class="s2">&#34;:&#34;</span><span class="n">_conclusion</span><span class="p">,</span><span class="s2">&#34;æŠ¥è­¦ä¿¡æ¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis1</span><span class="p">)</span> <span class="n">d</span> <span class="c1">##Class(MI.Common.MIFBase).SaveMajorConclusion(epis1, conclusion, mi)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">conclusion</span><span class="p">)</span> <span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">result_</span><span class="s2">&#34;BJ&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_conclusion_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="n">d</span> <span class="c1">##Class(MI.Common.MIFBase).Save(mi, epis, result, date, time, QC)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">imageres</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">conversion</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">imageR</span><span class="o">=</span><span class="s2">&#34;HPLT&#34;</span> <span class="n">s</span> <span class="n">imageR</span><span class="o">=</span><span class="s2">&#34;PLT&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">imageR</span><span class="o">=</span><span class="s2">&#34;HRBC&#34;</span> <span class="n">s</span> <span class="n">imageR</span><span class="o">=</span><span class="s2">&#34;RBC&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">imageR</span><span class="o">=</span><span class="s2">&#34;HWBC&#34;</span> <span class="n">s</span> <span class="n">imageR</span><span class="o">=</span><span class="s2">&#34;DIFF&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">imageR</span><span class="o">=</span><span class="s2">&#34;SBASO&#34;</span> <span class="n">s</span> <span class="n">imageR</span><span class="o">=</span><span class="s2">&#34;Baso&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">D</span> <span class="c1">##class(MI.MIFLISMonitorTest)SaveImageMTHD(&#34;7&#34;,&#34;9999&#34;, &#34;&#34;,&#34;175&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">epis</span><span class="err">ï¼šæµæ°´å·ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡åç§°ï¼Œè‡ªå·±åœ¨ä¿å­˜å‰æå–æµæ°´</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">ImageClass</span><span class="p">:</span><span class="err">å›¾ç‰‡ç±»åˆ«ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡åç§°ï¼Œè‡ªå·±åœ¨ä¿å­˜å‰æå–å›¾ç‰‡ç±»å‹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">FileName</span><span class="p">:</span><span class="err">ä¿å­˜åœ¨æ–‡ä»¶æœåŠ¡çš„ç›¸å¯¹è·¯å¾„ï¼Œé»˜è®¤ä¸åŠ¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">FullName</span><span class="p">:</span><span class="err">æ–‡ä»¶å…¨è·¯å¾„ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡å…¨è·¯å¾„åç§°ï¼Œæ»¡è¶³æœ‰çš„å›¾ç‰‡åç§°æ— æ³•å¾—åˆ°æµæ°´å’Œå›¾ç‰‡ç±»åˆ«çš„æƒ…å†µ</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveImageMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">ImageClass</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FullName</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">é€šè¿‡</span><span class="n">OtherParaé…ç½®å–å›¾çš„åœ¨è¿™é‡Œé€šè¿‡episå’ŒImageClassçš„å›¾ç‰‡åå­—æå–å‡ºæµæ°´å·å’Œå›¾ç‰‡ç±»åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ImageClass</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ImageClass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FileName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">FileName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FullName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">FullName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;:&#34;</span><span class="n">_ImageClass_</span><span class="s2">&#34;:&#34;</span><span class="n">_FileName</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span> <span class="n">ImageOrder</span><span class="p">,</span> <span class="n">Caption</span><span class="p">,</span> <span class="n">DisplayRatio</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.Common.MachineResult).SaveImage(ReceiveDate, epis, ImageClass, ImageOrder, FileName, mi, Caption, DisplayRatio, Height, Width, Sequence)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="err">è¿”å›ç»™ç›‘å¬å½“å‰ä¸Šä¼ æ–‡ä»¶è·¯å¾„åç§°ï¼Œé»˜è®¤ä¸è¦åŠ¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">w</span> <span class="c1">##class(MI.MIFLISMonitorTest).GetFtpMTHD(&#34;7&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetFtpMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ–‡ä»¶æœåŠ¡æ¨¡å¼å¿…é¡»æ”¹çš„åœ°æ–¹ï¼Œè€çš„</span><span class="n">FTPæ¨¡å¼è¿™ä¹ˆæ”¹äº†ä¹Ÿæ²¡é—®é¢˜</span><span class="err">ï¼Œæ‰€ä»¥å»ºè®®éƒ½è¿™æ ·</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="c1">##Class(MI.Common.MIFBase).GetMiFtpPath(mi)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Creator</span><span class="err">ï¼š</span>      <span class="err">æŸ¥è¯¢æ‚£è€…ä¿¡æ¯ï¼Œç›‘å¬é…ç½®ä¸Šä¼ å‰å¤„ç†ç±»åä¼šå®šæ—¶è°ƒç”¨è¿™ä¸ª</span><span class="n">queryæŸ¥è¯¢æ•°æ®è¿›è¡Œä¸Šä¼ æ“ä½œ</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">CreatDate</span><span class="err">ï¼š</span>    <span class="mi">20140919</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Description</span><span class="p">:</span><span class="err">ï¼š</span> 
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Table</span><span class="err">ï¼š</span>    
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="ne">Input</span><span class="err">ï¼š</span>        <span class="n">mi</span><span class="err">ï¼šä»ªå™¨ä¸»é”®</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Output</span><span class="err">ï¼š</span>       <span class="err">ä»ªå™¨ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Return</span><span class="err">ï¼š</span>       <span class="err">ä»ªå™¨ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Others</span><span class="err">ï¼š</span>   
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">QryLabInfo</span><span class="p">(</span><span class="n">mi</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Query</span><span class="p">(</span><span class="n">ROWSPEC</span> <span class="o">=</span> <span class="s2">&#34;labno,labnoInfo,patInfo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Queryçš„æ‰§è¡Œæ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">d</span> <span class="c1">##class(%ResultSet).RunQuery(&#34;MI.MIFXN1000&#34;,&#34;QryLabInfo&#34;,&#34;11&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoExecute</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">,</span> <span class="n">mi</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">i</span><span class="p">(</span><span class="o">^</span><span class="n">CacheTemp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">flag</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">LabnoList</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AddDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="n">AddDate</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">AddDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">AddTime</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddTime</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="n">AddDate</span><span class="p">,</span><span class="n">AddTime</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">AddTime</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">MiUploadDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="n">AddDate</span><span class="p">,</span><span class="n">AddTime</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">labno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="s1">&#39;$l(labno) q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="n">ref</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">labnoInfo</span><span class="o">=..</span><span class="n">GetLabnoInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="n">cdf</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">patInfo</span><span class="o">=..</span><span class="n">GetPatInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">Data</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="n">labnoInfo</span><span class="p">,</span><span class="n">patInfo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ColFields</span><span class="o">=</span><span class="s2">&#34;labno,labnoInfo,patInfo&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="o">=</span><span class="c1">##Class(LIS.Util.Common).TransListNull(Data,ColFields)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">quit</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoClose</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span> <span class="p">[</span> <span class="n">PlaceAfter</span> <span class="o">=</span> <span class="n">QryLabInfoExecute</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Kill</span> <span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoFetch</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Row</span> <span class="n">As</span> <span class="o">%</span><span class="n">List</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">AtEnd</span> <span class="n">As</span> <span class="o">%</span><span class="n">Integer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span> <span class="p">[</span> <span class="n">PlaceAfter</span> <span class="o">=</span> <span class="n">QryLabInfoExecute</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">AtEnd</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">ind</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">AtEnd</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">Row</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Else</span>      <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">Row</span><span class="o">=^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">AtEnd</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.XN9000).GetLabnoInfo(2,1709040020)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetLabnoInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">s</span> <span class="o">^</span><span class="n">TMPLIS</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è·å–é¡¹ç›®é€šé“å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;*&#34;</span> <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">chl</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_chl_</span><span class="s2">&#34;+&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">tcx</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">tcx</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">k</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span> <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">labno_</span><span class="s2">&#34;,&#34;</span><span class="n">_tcx_</span><span class="s2">&#34;|&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">tcx</span><span class="p">,</span><span class="s2">&#34;å·¥å•&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">tcx</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFLISMonitorTest).GetPatInfo(6,1001367)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetPatInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">labno</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æ ‡æœ¬ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RPVisitNumberData</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">LocationDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span><span class="n">Location</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Location</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">DoctorDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span><span class="n">Doctor</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Doctor</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTDoctorD</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">67</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveUserDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">68</span><span class="p">),</span><span class="n">ReceiveUser</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">ReceiveUser</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">SYSUserD</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RegNo</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SurName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">GivenName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">SurName</span><span class="o">=</span><span class="n">GivenName</span> <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName_GivenName</span>  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SpeciesDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Species</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AdmTypeDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">AdmType</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AdmType</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAdmissionTypeD</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AgeUnitDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">19</span><span class="p">),</span><span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAgeUnitD</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">CollectDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">51</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">CollectTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Diagnose</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampleda</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s2">&#34;XN&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">s</span> <span class="n">Instrument</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">22</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampleno</span><span class="o">=</span><span class="n">labno</span>   <span class="o">//</span><span class="err">æ£€æµ‹å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampletype</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Feetype</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">;</span><span class="err">è´¹åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Srcdepno</span><span class="o">=</span><span class="n">Location</span>  <span class="p">;</span><span class="err">é€æ£€ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Srcdocno</span><span class="o">=</span><span class="n">Doctor</span>   <span class="p">;</span><span class="err">é€æ£€åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Userno</span><span class="o">=</span><span class="n">ReceiveUser</span> <span class="p">;</span><span class="err">æ£€éªŒåŒ»ç”Ÿ</span><span class="p">(</span><span class="err">å½•å…¥è€…</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patno</span><span class="o">=</span><span class="n">RegNo</span> <span class="p">;</span><span class="err">ç™»è®°å·</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">BarCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">))</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">WorkGroupMachineDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">OrderNo</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span><span class="n">WorkGroupMachineDR</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ReportDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span><span class="n">WorkGroupMachineDR</span><span class="p">,</span><span class="n">OrderNo</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">EpisodeNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">ReportDR</span><span class="p">)),</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">BarCode</span><span class="o">=</span><span class="n">EpisodeNo</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patna</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">PatName</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="p">)</span>   <span class="p">;</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">b</span> <span class="p">;</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="mi">1</span> <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;ç”·&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>     <span class="p">;</span><span class="mi">1</span><span class="p">:</span><span class="err">ç”·</span> <span class="err">ï¼Œ</span><span class="mi">2</span> <span class="err">å¥³</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Species</span> <span class="o">=</span><span class="s2">&#34;å¥³&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Pattype</span><span class="o">=</span><span class="n">AdmType</span>   <span class="p">;</span><span class="err">ç—…äººç±»å‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Bedno</span> <span class="o">=</span> <span class="n">BedNo</span>    <span class="p">;</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patage</span><span class="o">=</span><span class="n">Age</span>  <span class="p">;</span><span class="err">å¹´é¾„</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Ageunit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å¹´é¾„å•ä½</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reqno</span><span class="o">=</span><span class="n">labno</span>  <span class="p">;</span><span class="err">ç”³è¯·å·</span> <span class="o">=</span> <span class="err">æ£€éªŒå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reqda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Reqda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">ReceiveTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span><span class="err">é€æ£€æ—¥æœŸ</span> <span class="o">=</span> <span class="err">æ¥æ”¶æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reportda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">æŠ¥å‘Šæ—¥æœŸ</span> <span class="o">=</span> <span class="err">åˆå®¡</span><span class="p">(</span><span class="err">ä¿å­˜ç»“æœ</span><span class="p">)</span><span class="err">æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Printflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">æ‰“å°æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Resultflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç»“æœæ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Errflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">é”™è¯¯æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Diagnose</span> <span class="o">=</span> <span class="n">Diagnose</span>   <span class="p">;</span><span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Description</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">å¤‡æ³¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reserve</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ä¿ç•™å­—æ®µ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patnamn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å§“åæ‹¼éŸ³ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Getda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">CollectTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">Getda</span><span class="o">=</span><span class="n">Reqda</span> <span class="p">;</span><span class="err">æ¥æ”¶æ—¶é—´</span><span class="o">/</span><span class="err">é‡‡æ ·æ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Wardno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç—…åŒº</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">Sampleda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Instrument_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampleno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampletype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Feetype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdepno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdocno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Userno_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patna_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sex_</span><span class="s2">&#34;,&#34;</span><span class="n">_Pattype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Bedno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patage_</span><span class="s2">&#34;,&#34;</span><span class="n">_Ageunit_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqda_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Reportda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Printflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Resultflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Errflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Diagnose_</span><span class="s2">&#34;,&#34;</span><span class="n">_Description_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reserve_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patnamn_</span><span class="s2">&#34;,&#34;</span><span class="n">_Getda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Wardno_</span><span class="s2">&#34;,&#34;</span><span class="n">_BarCode</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">RetString</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="err">ç›‘å¬åšä¸Šä¼ æ“ä½œåè°ƒç”¨æ”¹æ–¹æ³•è®¾ç½®æ ‡æœ¬ä¸Šä¼ è¡¨çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveSDFMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">epis</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="n">filename</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,labno,&#34;S&#34;,filename)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFX1800IA).QueryCDF(-6,&#34;2015-09-10&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QueryCDF</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">date</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">retList</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">time</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">time</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34; S&#34;</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">time</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">MiUploadDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34; S&#34;</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">labno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">datetime</span><span class="o">=</span><span class="n">date_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">cnt</span><span class="o">=</span><span class="n">cnt</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="n">cnt</span><span class="o">&gt;</span><span class="mi">300</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">retList</span><span class="o">=</span><span class="n">retList_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="n">_cnt_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="n">_datetime_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="n">_labno_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="n">_labno_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="n">_filename_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">retList</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">retList</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">retList</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">retList</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="åŒä¸€è·¯å¾„å›ä¼ æ–‡ä»¶ä¸Šä¼ ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶">åŒä¸€è·¯å¾„å›ä¼ æ–‡ä»¶ä¸Šä¼ ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶
</h4><h5 id="ç¤ºä¾‹æ¥å£è´å…‹æ›¼æµæ°´çº¿">ç¤ºä¾‹æ¥å£(è´å…‹æ›¼æµæ°´çº¿)
</h5><blockquote>
<p>é€šè¿‡é…ç½®ç›‘å¬ UPPreDealClass å­—æ®µâ€œPreDeal.DealDemoM,PreDealâ€ï¼Œé€šè¿‡ M è¿›è¡Œç¼–å†™ä¸Šä¼ ä¿¡æ¯ï¼Œåªè¾“å‡ºä¸€æ¬¡ OutPut å°±å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œé€šè¿‡è¾“å‡ºä¸¤æ¬¡ OutPut ä¿®æ”¹ç¬¬äºŒæ¬¡ OutPut å†…å®¹å¯ä»¥åœ¨åŒä¸€è·¯å¾„å›ä¼ ä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶ã€‚</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span><span class="lnt">513
</span><span class="lnt">514
</span><span class="lnt">515
</span><span class="lnt">516
</span><span class="lnt">517
</span><span class="lnt">518
</span><span class="lnt">519
</span><span class="lnt">520
</span><span class="lnt">521
</span><span class="lnt">522
</span><span class="lnt">523
</span><span class="lnt">524
</span><span class="lnt">525
</span><span class="lnt">526
</span><span class="lnt">527
</span><span class="lnt">528
</span><span class="lnt">529
</span><span class="lnt">530
</span><span class="lnt">531
</span><span class="lnt">532
</span><span class="lnt">533
</span><span class="lnt">534
</span><span class="lnt">535
</span><span class="lnt">536
</span><span class="lnt">537
</span><span class="lnt">538
</span><span class="lnt">539
</span><span class="lnt">540
</span><span class="lnt">541
</span><span class="lnt">542
</span><span class="lnt">543
</span><span class="lnt">544
</span><span class="lnt">545
</span><span class="lnt">546
</span><span class="lnt">547
</span><span class="lnt">548
</span><span class="lnt">549
</span><span class="lnt">550
</span><span class="lnt">551
</span><span class="lnt">552
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">///</span> <span class="p">[{</span><span class="s2">&#34;MachID&#34;</span><span class="p">:</span><span class="s2">&#34;#RowID&#34;</span><span class="p">,</span><span class="s2">&#34;Type&#34;</span><span class="p">:</span><span class="s2">&#34;Drect&#34;</span><span class="p">,</span><span class="s2">&#34;UpTime&#34;</span><span class="p">:</span><span class="s2">&#34;2000&#34;</span><span class="p">,</span><span class="s2">&#34;Address&#34;</span><span class="p">:</span><span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Inetpub</span><span class="se">\\</span><span class="s2">UL</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">,</span><span class="s2">&#34;UpCDF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;UpREF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;DealProcess&#34;</span><span class="p">:</span><span class="s2">&#34;MI.MIFRemisolN&#34;</span><span class="p">,</span><span class="s2">&#34;Para&#34;</span><span class="p">:</span><span class="s2">&#34;.hpr,.ok&#34;</span><span class="p">,</span><span class="s2">&#34;UpPara&#34;</span><span class="p">:</span><span class="s2">&#34;C:</span><span class="se">\\</span><span class="s2">Inetpub</span><span class="se">\\</span><span class="s2">DL</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">,</span><span class="s2">&#34;PreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoMALL,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UPPreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoM,PreDeal&#34;</span><span class="p">}]</span>
</span></span><span class="line"><span class="cl"><span class="n">Class</span> <span class="n">MI</span><span class="o">.</span><span class="n">MIFRemisolN</span> <span class="n">Extends</span> <span class="o">%</span><span class="n">RegisteredObject</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">D</span> <span class="c1">##class(MI.MIFBeckmanRemisol).fileMTHD(&#34;38&#34;,&#34;1,BASO#,1,0.02,,,,,&#34;,&#34;1&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨ä¸»é”®</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">record</span><span class="p">:</span><span class="err">ä¸€ä¸ªæ•°æ®è¡Œåˆå¹¶æäº¤ç”¨</span><span class="c1">#enter#åˆ†å‰²å¤šè¡Œæ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">epis</span><span class="p">:</span><span class="err">æµæ°´å·ï¼Œå‰å¤„ç†æå–å‡ºäº†çš„ç”»</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">fileNameOrColName</span><span class="p">:</span><span class="err">è¯»æ–‡ä»¶çš„æ˜¯æ–‡ä»¶å…¨åï¼Œæ•°æ®åº“çš„æ˜¯æ•°æ®åº“æŸ¥è¯¢çš„åˆ—åç”¨</span><span class="o">~</span><span class="err">åˆ†å‰²</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">D</span> <span class="c1">##class(MI.MIFRemisolN).fileMTHD(&#34;1&#34;,&#34;H|\^&amp;|||REMISOL||||||UPLOAD_SIGN=0\INTERPRETATION_FLAG=1\INSTRUMENT_FLAG=1|P|1|20231207134318[13][10]Q|1|^ssss||||||||||O[13][10]L|1[13][10]&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">D</span> <span class="c1">##class(MI.MIFRemisolN).fileMTHD(&#34;24&#34;,&#34;H|\^&amp;|||Lb1kâ–¡V1.5.5||||||UPLOAD_SIGN=1\INTERPRETATION_FLAG=0\INSTRUMENT_FLAG=1|P|1|20241011155213[13][10]P|1||0000000072||å½­å‡ç§€^||19480902|F|||||||||||||||||æ™®å¤–ç§‘é—¨è¯Š[13][10]O|1|24101100017^0020^01|||RO|20241011155213|20241011155213||||||||S|||UV[13][10]R|1|^^^GLU^^2286\2286^1598\1609^^0|7.05^M|||N||R||||20241011102518|AU5800[13][10]R|2|^^^LIPEM^^^^^0|0|||N||R||||20241011102518|AU5800[13][10]R|3|^^^ICTER^^^^^0|0|||N||R||||20241011102518|AU5800[13][10]R|4|^^^HEMOL^^^^^0|0|||N||R||||20241011102518|AU5800[13][10]L|1[13][10]&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">fileMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">record</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">(</span><span class="n">MAXLEN</span><span class="o">=</span><span class="mi">99999999</span><span class="p">),</span> <span class="n">epis</span><span class="p">,</span> <span class="n">fileNameOrColName</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(record) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">Code</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;record&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;[13][10]&#34;</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">rec</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;[13][10]&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="s1">&#39;$l(rec) q</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;rec&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">type</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;O&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;R&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">code</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">S</span> <span class="n">res</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">ResNoes</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">ResNoes</span><span class="o">=</span><span class="c1">##class(MI.MIFRemisolN).ConvertResNoes(ResNoes) </span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">res</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">resKZJG</span><span class="o">=</span><span class="c1">##class(MI.MIFRemisolN).ConvertresKZJG(mi,epis,code,res)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">result_code_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_res_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_resKZJG_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span><span class="n">_ResNoes_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   	<span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;L&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">   	<span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis_</span><span class="s2">&#34;$$&#34;</span><span class="n">_result</span><span class="p">,</span><span class="s2">&#34;Result&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   	<span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="n">d</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   	<span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">è·å–æ‰©å±•ç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">ConvertresKZJG</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">code</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">code</span><span class="p">),</span><span class="n">res</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Labno</span><span class="o">=$$</span><span class="n">GetLabnoByEpis</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">Labno</span><span class="p">),</span><span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="n">Labno</span><span class="p">))</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">VisitNumberDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="n">Labno</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">)),</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">Age</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(code),&#39;</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="n">q</span> <span class="n">OutPut</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">code</span><span class="o">=</span><span class="s2">&#34;BNP&#34;</span><span class="p">,</span><span class="mi">0</span> <span class="n">d</span>		<span class="o">//</span> <span class="n">BNP</span> <span class="n">Nç«¯è„‘é’ è‚½å‰ä½“</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="s1">&#39;$l(Age) q</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="n">Age</span><span class="o">&lt;=</span><span class="mi">50</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="n">res</span><span class="o">&lt;=</span><span class="mi">450</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;æ­£å¸¸&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="n">res</span><span class="o">&gt;</span><span class="mi">450</span><span class="p">,</span><span class="n">res</span><span class="o">&lt;=</span><span class="mi">600</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;æ€¥æ€§å¿ƒè¡°&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="n">res</span><span class="o">&gt;</span><span class="mi">600</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;æ…¢æ€§å¿ƒè¡°&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="p">((</span><span class="n">Age</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">Age</span><span class="o">&lt;=</span><span class="mi">75</span><span class="p">))</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="n">res</span><span class="o">&lt;=</span><span class="mi">900</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;æ­£å¸¸&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="n">res</span><span class="o">&gt;</span><span class="mi">900</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;æ€¥æ€§å¿ƒè¡°&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="n">Age</span><span class="o">&gt;</span><span class="mi">75</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="n">res</span><span class="o">&lt;=</span><span class="mi">1800</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;æ­£å¸¸&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="n">res</span><span class="o">&gt;</span><span class="mi">1800</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;æ€¥æ€§å¿ƒè¡°&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">code</span><span class="o">=</span><span class="s2">&#34;25OHD&#34;</span> <span class="n">d</span>		<span class="o">//</span> <span class="mi">25</span><span class="err">ç¾Ÿç»´ç”Ÿç´ </span><span class="n">D</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="n">res</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;ç¼ºä¹&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="n">res</span><span class="o">&gt;</span><span class="mi">20</span><span class="p">,</span><span class="n">res</span><span class="o">&lt;=</span><span class="mi">30</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;ä¸è¶³&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="n">res</span><span class="o">&gt;</span><span class="mi">30</span><span class="p">,</span><span class="n">res</span><span class="o">&lt;=</span><span class="mi">100</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;å……è¶³&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">i</span> <span class="n">res</span><span class="o">&gt;</span><span class="mi">100</span> <span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;è¶…ä¸Šé™&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">OutPut</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">GetLabnoByEpis</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">Epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="n">Epis</span><span class="p">,</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(mi) q Epis</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">WGMachineID</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(WGMachineID) q Epis</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexEpisodeNo&#34;</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">WGMachineID</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(Epis))) {</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="n">ReportDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexEpisodeNo&#34;</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">WGMachineID</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(Epis),&#34;&#34;),-1)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">VisitNumberDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">ReportDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="n">ret</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">è½¬æ¢æŠ¥è­¦ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">ConvertResNoes</span><span class="p">(</span><span class="n">ResNoes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ResNoes</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ResNoes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">OutPut</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(ResNoes) q OutPut</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">LISPolice</span><span class="p">(</span><span class="s2">&#34;BKMLSX&#34;</span><span class="p">,</span><span class="n">ResNoes</span><span class="p">))</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">OutPut</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">LISPolice</span><span class="p">(</span><span class="s2">&#34;BKMLSX&#34;</span><span class="p">,</span><span class="n">ResNoes</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ResNoes</span><span class="p">),</span><span class="s1">&#39;$l(OutPut) s OutPut=&#34;æ——æ ‡:&#34;_ResNoes</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">OutPut</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">D</span> <span class="c1">##class(MI.MIFBeckmanRemisol)SaveImageMTHD(&#34;7&#34;,&#34;9999&#34;, &#34;&#34;,&#34;175&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">epis</span><span class="err">ï¼šæµæ°´å·ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡åç§°ï¼Œè‡ªå·±åœ¨ä¿å­˜å‰æå–æµæ°´</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">ImageClass</span><span class="p">:</span><span class="err">å›¾ç‰‡ç±»åˆ«ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡åç§°ï¼Œè‡ªå·±åœ¨ä¿å­˜å‰æå–å›¾ç‰‡ç±»å‹</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">FileName</span><span class="p">:</span><span class="err">ä¿å­˜åœ¨æ–‡ä»¶æœåŠ¡çš„ç›¸å¯¹è·¯å¾„ï¼Œé»˜è®¤ä¸åŠ¨</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">FullName</span><span class="p">:</span><span class="err">æ–‡ä»¶å…¨è·¯å¾„ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡å…¨è·¯å¾„åç§°ï¼Œæ»¡è¶³æœ‰çš„å›¾ç‰‡åç§°æ— æ³•å¾—åˆ°æµæ°´å’Œå›¾ç‰‡ç±»åˆ«çš„æƒ…å†µ</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveImageMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">ImageClass</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FullName</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">é€šè¿‡</span><span class="n">OtherParaé…ç½®å–å›¾çš„åœ¨è¿™é‡Œé€šè¿‡episå’ŒImageClassçš„å›¾ç‰‡åå­—æå–å‡ºæµæ°´å·å’Œå›¾ç‰‡ç±»åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ImageClass</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ImageClass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è§£ææµæ°´å·å’Œå›¾ç‰‡ç±»åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Name</span><span class="o">=</span><span class="n">epis</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="s2">&#34;_&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ImageClass</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="s2">&#34;_&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ImageClass</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">ImageClass</span><span class="p">,</span><span class="s2">&#34;.&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FileName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">FileName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FullName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">FullName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="c1">##Class(MI.Common.MIFBase).Trace(mi,epis_&#34;:&#34;_ImageClass_&#34;:&#34;_FileName,&#34;H&lt;--M&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span> <span class="n">ImageOrder</span><span class="p">,</span> <span class="n">Caption</span><span class="p">,</span> <span class="n">DisplayRatio</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">åŠ ä¸Šå½“å‰æ—¶é—´ï¼Œé˜²æ­¢æµè§ˆå™¨ç¼“å­˜</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FileName</span><span class="o">=</span><span class="n">FileName_</span><span class="s2">&#34;?&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.Common.MachineResult).SaveImage(ReceiveDate, epis, ImageClass, ImageOrder, FileName, mi, Caption, DisplayRatio, Height, Width, Sequence)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">è¿”å›ç»™ç›‘å¬å½“å‰ä¸Šä¼ æ–‡ä»¶è·¯å¾„åç§°ï¼Œé»˜è®¤ä¸è¦åŠ¨</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##class(MI.MIFBeckmanRemisol).GetFtpMTHD(&#34;7&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetFtpMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ–‡ä»¶æœåŠ¡æ¨¡å¼å¿…é¡»æ”¹çš„åœ°æ–¹ï¼Œè€çš„</span><span class="n">FTPæ¨¡å¼è¿™ä¹ˆæ”¹äº†ä¹Ÿæ²¡é—®é¢˜</span><span class="err">ï¼Œæ‰€ä»¥å»ºè®®éƒ½è¿™æ ·</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="c1">##Class(MI.Common.MIFBase).GetMiFtpPath(mi)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Creator</span><span class="err">ï¼š</span>      <span class="err">æŸ¥è¯¢æ‚£è€…ä¿¡æ¯ï¼Œç›‘å¬é…ç½®ä¸Šä¼ å‰å¤„ç†ç±»åä¼šå®šæ—¶è°ƒç”¨è¿™ä¸ª</span><span class="n">queryæŸ¥è¯¢æ•°æ®è¿›è¡Œä¸Šä¼ æ“ä½œ</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">CreatDate</span><span class="err">ï¼š</span>    <span class="mi">20140919</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Description</span><span class="p">:</span><span class="err">ï¼š</span> 
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Table</span><span class="err">ï¼š</span>    
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="ne">Input</span><span class="err">ï¼š</span>        <span class="n">mi</span><span class="err">ï¼šä»ªå™¨ä¸»é”®</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Output</span><span class="err">ï¼š</span>       <span class="err">ä»ªå™¨ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Return</span><span class="err">ï¼š</span>       <span class="err">ä»ªå™¨ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Others</span><span class="err">ï¼š</span>   
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">QryLabInfo</span><span class="p">(</span><span class="n">mi</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Query</span><span class="p">(</span><span class="n">ROWSPEC</span> <span class="o">=</span> <span class="s2">&#34;labno,labnoInfo,patInfo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Queryçš„æ‰§è¡Œæ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">d</span> <span class="c1">##class(%ResultSet).RunQuery(&#34;MI.MIFRemisolN&#34;,&#34;QryLabInfo&#34;,&#34;24&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoExecute</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">,</span> <span class="n">mi</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">i</span><span class="p">(</span><span class="o">^</span><span class="n">CacheTemp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">flag</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">//*--------------------------------&gt;*</span><span class="err">ç”³è¯·é¡¹ç›®</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate)) q:AddDate=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">AddTime</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddTime</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate,AddTime)) q:AddTime=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="mi">20</span><span class="err">ç§’ä»¥å†…çš„å…ˆä¸ä¸Šä¼ ï¼Œé˜²æ­¢æ²¡æ¥æ”¶å®Œ</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="p">(</span><span class="n">AddDate</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)),((</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">AddTime</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">MiUploadDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate,AddTime,&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">labno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="s1">&#39;$l(labno) q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">labnoInfo</span><span class="o">=..</span><span class="n">GetLabnoInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">patInfo</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">FileName</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">+$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_MiUploadDR</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">è¾“å‡º</span><span class="n">hpræ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutFileInfo(FileName_&#34;.hpr&#34;,labnoInfo,labno,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">FileName_</span><span class="s2">&#34;.hpr&#34;</span><span class="n">_</span><span class="s2">&#34;$$&#34;</span><span class="n">_labno_</span><span class="s2">&#34;$$&#34;</span><span class="n">_labnoInfo</span><span class="p">,</span><span class="s2">&#34;ä¸Šä¼ ä¿¡æ¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">è¾“å‡º</span><span class="n">OKæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutFileInfo(FileName_&#34;.OK&#34;,patInfo,labno,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">FileName_</span><span class="s2">&#34;.OK&#34;</span><span class="n">_</span><span class="s2">&#34;$$&#34;</span><span class="n">_labno_</span><span class="s2">&#34;$$&#34;</span><span class="n">_patInfo</span><span class="p">,</span><span class="s2">&#34;ä¸Šä¼ ä¿¡æ¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">/*</span>
</span></span><span class="line"><span class="cl">    <span class="o">//*--------------------------------&gt;*</span><span class="err">å¤æŸ¥é¡¹ç›®</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;U&#34;),AddDate)) q:AddDate=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">AddTime</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddTime</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;U&#34;),AddDate,AddTime)) q:AddTime=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="mi">20</span><span class="err">ç§’ä»¥å†…çš„å…ˆä¸ä¸Šä¼ ï¼Œé˜²æ­¢æ²¡æ¥æ”¶å®Œ</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="p">(</span><span class="n">AddDate</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)),((</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">AddTime</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">MiUploadDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;U&#34;),AddDate,AddTime,&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">labno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="s1">&#39;$l(labno) q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">labnoInfo</span><span class="o">=..</span><span class="n">GetLabnoInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">patInfo</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">FileName</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">+$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_MiUploadDR</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">è¾“å‡º</span><span class="n">hpræ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutFileInfo(FileName_&#34;.hpr&#34;,labnoInfo,labno,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">FileName_</span><span class="s2">&#34;.hpr&#34;</span><span class="n">_</span><span class="s2">&#34;$$&#34;</span><span class="n">_labno_</span><span class="s2">&#34;$$&#34;</span><span class="n">_labnoInfo</span><span class="p">,</span><span class="s2">&#34;ä¸Šä¼ ä¿¡æ¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">è¾“å‡º</span><span class="n">OKæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutFileInfo(FileName_&#34;.OK&#34;,patInfo,labno,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">FileName_</span><span class="s2">&#34;.OK&#34;</span><span class="n">_</span><span class="s2">&#34;$$&#34;</span><span class="n">_labno_</span><span class="s2">&#34;$$&#34;</span><span class="n">_patInfo</span><span class="p">,</span><span class="s2">&#34;ä¸Šä¼ ä¿¡æ¯&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="o">*/</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ColFields</span><span class="o">=</span><span class="s2">&#34;labno,labnoInfo,patInfo&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="o">=</span><span class="c1">##Class(LIS.Util.Common).TransListNull(Data,ColFields)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">quit</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoClose</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span> <span class="p">[</span> <span class="n">PlaceAfter</span> <span class="o">=</span> <span class="n">QryLabInfoExecute</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Kill</span> <span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoFetch</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Row</span> <span class="n">As</span> <span class="o">%</span><span class="n">List</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">AtEnd</span> <span class="n">As</span> <span class="o">%</span><span class="n">Integer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span> <span class="p">[</span> <span class="n">PlaceAfter</span> <span class="o">=</span> <span class="n">QryLabInfoExecute</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">AtEnd</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">ind</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">AtEnd</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">Row</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Else</span>      <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">Row</span><span class="o">=^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">AtEnd</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">å¾—åˆ°æ ‡æœ¬ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##class(MI.MIFRemisolN).GetLabnoInfo(24,&#34;24092600054&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetLabnoInfo</span><span class="p">(</span><span class="n">miRowId</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">miRowId</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">miRowId</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">PLIST</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(miRowId)||&#39;</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">	 
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">J</span><span class="p">,</span><span class="n">miRowId</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">visitNumberDR</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(visitNumberDR) 1</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">visitNumberData</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">visitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(visitNumberData) 2</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">miRowId</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   	<span class="n">S</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">chlList</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">hcg5d</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">chlCnt</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">   	<span class="n">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chl</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">J</span><span class="p">,</span><span class="n">miRowId</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">chl</span><span class="p">)</span><span class="s1">&#39;=0   </span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">		    <span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">E</span><span class="p">(</span><span class="n">chl</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;A&#34;</span> <span class="n">chlCnt</span><span class="o">=</span><span class="n">chlCnt</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">		    <span class="n">S</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;A179&#34;</span> <span class="n">hcg5d</span><span class="o">=</span><span class="n">chl</span>
</span></span><span class="line"><span class="cl">		    <span class="n">Continue</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;A179&#34;</span>
</span></span><span class="line"><span class="cl">		    <span class="n">S</span> <span class="n">chlList</span><span class="o">=</span><span class="n">chlList_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_chl_</span><span class="s2">&#34;</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>  
</span></span><span class="line"><span class="cl">		<span class="k">else</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(chl)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		 
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	 
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">hcg5d</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="p">(</span><span class="n">chlCnt</span><span class="s1">&#39;=2)&amp;&amp;(chlCnt&#39;</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">chlCnt</span><span class="s1">&#39;=4) {</span>
</span></span><span class="line"><span class="cl">			<span class="n">S</span> <span class="n">hcg5d</span><span class="o">=</span><span class="s2">&#34;A178&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">chlList</span><span class="o">=</span><span class="n">chlList_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_hcg5d_</span><span class="s2">&#34;</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">chlList</span><span class="o">=$</span><span class="n">E</span><span class="p">(</span><span class="n">chlList</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">chlList</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(chlList) 3</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">locationDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span><span class="n">location</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">locationDR</span><span class="p">)</span> <span class="n">location</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">locationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">doctorDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span><span class="n">doctor</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">doctorCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">doctorDR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">doctor</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTDoctorD</span><span class="p">(</span><span class="n">doctorDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">doctorCode</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTDoctorD</span><span class="p">(</span><span class="n">doctorDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">receiveDate</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">receiveTime</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">67</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">receiveUserDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">68</span><span class="p">),</span><span class="n">receiveUser</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">receiveUserDR</span><span class="p">)</span> <span class="n">receiveUser</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">SYSUserD</span><span class="p">(</span><span class="n">receiveUserDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">patientId</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">surName</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">S</span> <span class="n">givenName</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">S</span> <span class="n">patName</span><span class="o">=</span><span class="n">surName_givenName</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="n">surName</span><span class="o">=</span><span class="n">givenName</span> <span class="n">patName</span><span class="o">=</span><span class="n">surName</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">speciesDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">species</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">speciesCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">speciesDR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">species</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">speciesDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">speciesCode</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">speciesDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">admTypeDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">admType</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">admTypeDR</span><span class="p">)</span> <span class="n">admType</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAdmissionTypeD</span><span class="p">(</span><span class="n">admTypeDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">bed</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">age</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">ageUnitDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">19</span><span class="p">),</span><span class="n">ageUnit</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">ageUnitCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">ageUnitDR</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">ageUnit</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAgeUnitD</span><span class="p">(</span><span class="n">ageUnitDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">ageUnitCode</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAgeUnitD</span><span class="p">(</span><span class="n">ageUnitDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">collectDate</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">51</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">collectTime</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">collectDateTime</span><span class="o">=</span><span class="n">collectDate_</span><span class="c1">##Class(LIS.Core.Util).CvtClientTime(collectTime,&#34;HHMMSS&#34;)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">diagnosis</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">birthday</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="n">visitNumberData</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="s2">&#34;MF&#34;</span><span class="s1">&#39;[speciesCode speciesCode=&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span><span class="p">:</span><span class="s2">&#34;YMD&#34;</span><span class="s1">&#39;[ageUnitCode ageUnitCode=&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">S</span> <span class="n">PLIST</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="o">$</span><span class="n">I</span><span class="p">(</span><span class="n">PLIST</span><span class="p">))</span><span class="o">=</span><span class="s2">&#34;H|\^&amp;|||LIS^1|||||REMISOL||P|1|&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ZD</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">TR</span><span class="p">(</span><span class="o">$</span><span class="n">ZT</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34;:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">patRecord</span><span class="o">=</span><span class="s2">&#34;P|1||||||||||||||||||||||||||||||||||&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">patRecord</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">patientId</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">givenName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">patRecord</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="n">surName_</span><span class="s2">&#34;^&#34;</span><span class="n">_givenName_</span><span class="s2">&#34;^^^&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">patRecord</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span><span class="n">birthday_</span><span class="s2">&#34;^&#34;</span><span class="n">_age_</span><span class="s2">&#34;^&#34;</span><span class="n">_ageUnitCode</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">patRecord</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="o">=</span> <span class="n">speciesCode</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">patRecord</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span><span class="o">=</span> <span class="n">doctorCode</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">patRecord</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">22</span><span class="p">)</span><span class="o">=</span> <span class="n">diagnosis</span>  	<span class="o">//</span><span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">patRecord</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">26</span><span class="p">)</span><span class="o">=</span><span class="n">location</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="o">$</span><span class="n">I</span><span class="p">(</span><span class="n">PLIST</span><span class="p">))</span><span class="o">=</span><span class="n">patRecord</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">order</span><span class="o">=</span><span class="s2">&#34;O|1|&#34;</span><span class="n">_labno_</span><span class="s2">&#34;||&#34;</span><span class="n">_chlList_</span><span class="s2">&#34;|||||||||||||||||||||&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">specType</span><span class="o">=..</span><span class="n">GetSpecimen</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;S&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span> <span class="err">æ ·å“ç±»å‹ï¼Œå¦‚è¡€æ¸…ã€è¡€æµ†ã€å°¿æ¶²ç­‰ã€‚</span><span class="mi">0</span><span class="o">-</span><span class="err">è¡€æ¸…ï¼Œ</span><span class="mi">1</span><span class="o">-</span><span class="err">è¡€æµ†ï¼Œ</span><span class="mi">2</span><span class="o">-</span><span class="err">å°¿æ¶²ï¼Œ</span><span class="mi">3</span><span class="o">-</span><span class="err">è„‘è„Šæ¶²ï¼Œ</span><span class="mi">4</span><span class="o">-</span><span class="err">èƒƒæ¶²ï¼Œ</span><span class="mi">5</span><span class="o">-</span><span class="err">èƒ¸æ°´ï¼Œ</span><span class="mi">6</span><span class="o">-</span><span class="err">è…¹æ°´ï¼Œ</span><span class="mi">7</span><span class="o">-</span><span class="err">å…¶ä»–</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="n">specType</span><span class="p">[</span><span class="s2">&#34;è¡€æ¸…&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">ELSEIF</span> <span class="n">specType</span><span class="p">[</span><span class="s2">&#34;è¡€æµ†&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">ELSEIF</span> <span class="n">specType</span><span class="p">[</span><span class="s2">&#34;å°¿&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">ELSEIF</span> <span class="n">specType</span><span class="p">[</span><span class="s2">&#34;è„‘è„Šæ¶²&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">ELSEIF</span> <span class="n">specType</span><span class="p">[</span><span class="s2">&#34;èƒƒæ¶²&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;4&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">ELSEIF</span> <span class="n">specType</span><span class="p">[</span><span class="s2">&#34;èƒ¸æ°´&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;5&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">ELSEIF</span> <span class="n">specType</span><span class="p">[</span><span class="s2">&#34;è…¹æ°´&#34;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;6&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="n">ELSE</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">specTypeId</span><span class="o">=</span><span class="s2">&#34;7&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;R&#34;</span>  <span class="o">//</span><span class="n">priority</span><span class="p">:</span><span class="n">R</span><span class="o">=</span><span class="n">Routine</span><span class="p">,</span><span class="n">S</span><span class="o">=</span><span class="n">Stat</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span><span class="n">collectDateTime</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;A&#34;</span> <span class="o">//</span><span class="n">Action</span> <span class="n">Code</span><span class="p">:</span> <span class="n">A</span><span class="o">=</span><span class="n">Add</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="n">Clear</span><span class="p">,</span><span class="n">Q</span><span class="o">=</span><span class="ne">Control</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span><span class="o">=</span><span class="n">specTypeId</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="o">$</span><span class="n">I</span><span class="p">(</span><span class="n">PLIST</span><span class="p">))</span><span class="o">=</span><span class="n">order</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">PLIST</span><span class="p">(</span><span class="o">$</span><span class="n">I</span><span class="p">(</span><span class="n">PLIST</span><span class="p">))</span><span class="o">=</span><span class="s2">&#34;L|1|&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">del</span><span class="o">=</span><span class="s2">&#34;[13][10]&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">seq</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">f</span>  <span class="n">s</span> <span class="n">seq</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">seq</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="n">ret_PLIST</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="n">_del</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">å¾—åˆ°æ ‡æœ¬ç±»å‹</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetSpecimen</span><span class="p">(</span><span class="n">labno</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">labno</span><span class="o">=</span><span class="s2">&#34; &#34;</span><span class="n">_labno</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$d(^dbo.RPVisitNumberI(&#34;IndexVisitNumber&#34;,labno)) q ret</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">RowId</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">obj</span><span class="o">=</span><span class="c1">##class(dbo.RPVisitNumber).%OpenId(RowId)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">spDr</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">SpecimenDR</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">spDesc</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">spDr</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">objSp</span><span class="o">=</span><span class="c1">##class(dbo.BTSpecimen).%OpenId(spDr)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">spDesc</span><span class="o">=</span><span class="n">objSp</span><span class="o">.</span><span class="n">IName</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="n">spDesc</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFBeckmanRemisol).GetPatInfo(6,1001367)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetPatInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">labno</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æ ‡æœ¬ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RPVisitNumberData</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">LocationDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span><span class="n">Location</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Location</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">DoctorDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span><span class="n">Doctor</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Doctor</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTDoctorD</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">67</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveUserDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">68</span><span class="p">),</span><span class="n">ReceiveUser</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">ReceiveUser</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">SYSUserD</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RegNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SurName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">GivenName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">SurName</span><span class="o">=</span><span class="n">GivenName</span> <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName_GivenName</span>  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SpeciesDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Species</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AdmTypeDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">AdmType</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AdmType</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAdmissionTypeD</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AgeUnitDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">19</span><span class="p">),</span><span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAgeUnitD</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">CollectDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">51</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">CollectTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Diagnose</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampleda</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s2">&#34;XN&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">s</span> <span class="n">Instrument</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">22</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampleno</span><span class="o">=</span><span class="n">labno</span>   <span class="o">//</span><span class="err">æ£€æµ‹å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampletype</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Feetype</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">;</span><span class="err">è´¹åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Srcdepno</span><span class="o">=</span><span class="n">Location</span>  <span class="p">;</span><span class="err">é€æ£€ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Srcdocno</span><span class="o">=</span><span class="n">Doctor</span>   <span class="p">;</span><span class="err">é€æ£€åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Userno</span><span class="o">=</span><span class="n">ReceiveUser</span> <span class="p">;</span><span class="err">æ£€éªŒåŒ»ç”Ÿ</span><span class="p">(</span><span class="err">å½•å…¥è€…</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patno</span><span class="o">=</span><span class="n">RegNo</span> <span class="p">;</span><span class="err">ç™»è®°å·</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">BarCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patna</span><span class="o">=</span><span class="n">PatName</span>   <span class="p">;</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="mi">1</span>  <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;ç”·&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>     <span class="p">;</span><span class="mi">1</span><span class="p">:</span><span class="err">ç”·</span> <span class="err">ï¼Œ</span><span class="mi">2</span> <span class="err">å¥³</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Species</span> <span class="o">=</span><span class="s2">&#34;å¥³&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Pattype</span><span class="o">=</span><span class="n">AdmType</span>   <span class="p">;</span><span class="err">ç—…äººç±»å‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Bedno</span> <span class="o">=</span> <span class="n">BedNo</span>    <span class="p">;</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patage</span><span class="o">=</span><span class="n">Age</span>  <span class="p">;</span><span class="err">å¹´é¾„</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Ageunit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å¹´é¾„å•ä½</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reqno</span><span class="o">=</span><span class="n">labno</span>  <span class="p">;</span><span class="err">ç”³è¯·å·</span> <span class="o">=</span> <span class="err">æ£€éªŒå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reqda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Reqda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">ReceiveTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span><span class="err">é€æ£€æ—¥æœŸ</span> <span class="o">=</span> <span class="err">æ¥æ”¶æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reportda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">æŠ¥å‘Šæ—¥æœŸ</span>  <span class="o">=</span> <span class="err">åˆå®¡</span><span class="p">(</span><span class="err">ä¿å­˜ç»“æœ</span><span class="p">)</span><span class="err">æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Printflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">æ‰“å°æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Resultflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç»“æœæ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Errflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">é”™è¯¯æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Diagnose</span> <span class="o">=</span> <span class="n">Diagnose</span>   <span class="p">;</span><span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Description</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">å¤‡æ³¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reserve</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ä¿ç•™å­—æ®µ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patnamn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å§“åæ‹¼éŸ³ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Getda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">CollectTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">Getda</span><span class="o">=</span><span class="n">Reqda</span> <span class="p">;</span><span class="err">æ¥æ”¶æ—¶é—´</span><span class="o">/</span><span class="err">é‡‡æ ·æ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Wardno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç—…åŒº</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">Sampleda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Instrument_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampleno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampletype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Feetype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdepno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdocno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Userno_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patna_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sex_</span><span class="s2">&#34;,&#34;</span><span class="n">_Pattype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Bedno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patage_</span><span class="s2">&#34;,&#34;</span><span class="n">_Ageunit_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqda_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Reportda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Printflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Resultflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Errflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Diagnose_</span><span class="s2">&#34;,&#34;</span><span class="n">_Description_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reserve_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patnamn_</span><span class="s2">&#34;,&#34;</span><span class="n">_Getda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Wardno_</span><span class="s2">&#34;,&#34;</span><span class="n">_BarCode</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">RetString</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="err">ç›‘å¬åšä¸Šä¼ æ“ä½œåè°ƒç”¨æ”¹æ–¹æ³•è®¾ç½®æ ‡æœ¬ä¸Šä¼ è¡¨çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveSDFMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">epis</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="n">filename</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,labno,&#34;S&#34;,filename)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">ä¿å­˜å›¾ç‰‡</span><span class="n">Base64ä¸²åˆ°ä»ªå™¨</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨ä¸»é”®</span><span class="p">(</span><span class="o">*</span><span class="err">å¿…å¡«</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">epis</span><span class="p">:</span><span class="err">æµæ°´å·</span><span class="p">(</span><span class="o">*</span><span class="err">å¿…å¡«</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">ImageClass</span><span class="p">:</span><span class="err">å›¾ç‰‡ç±»åˆ«</span><span class="p">(</span><span class="o">*</span><span class="err">å¿…å¡«</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">base64Stream</span><span class="p">:</span><span class="err">å›¾ç‰‡çš„</span><span class="n">Base64æµ</span><span class="p">(</span><span class="o">*</span><span class="err">å¿…å¡«</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">fileName</span><span class="p">:</span><span class="err">æ–‡ä»¶å</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">ftpFfolderName</span><span class="p">:</span><span class="err">æ–‡ä»¶æœåŠ¡çš„æ–‡ä»¶å¤¹åç§°</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFBeckmanRemisol).SaveBase64ToMachineTest()</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveBase64ToMachineTest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">charStream</span><span class="o">=</span><span class="c1">##class(%GlobalCharacterStream).%New()</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;Qk02fQAAAAAAADYEAAAoAAAAsAAAALAAAAABAAgAAAAAAAB5AAB0EgAAdBIAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADA3MAA8MqmAKo/KgD/PyoAAF8qAFVfKgCqXyoA/18qAAB/KgBVfyoAqn8qAP9/KgAAnyoAVZ8qAKqfKgD/nyoAAL8qAFW/KgCqvyoA/78qAADfKgBV3yoAqt8qAP/fKgAA/yoAVf8qAKr/KgD//yoAAABVAFUAVQCqAFUA/wBVAAAfVQBVH1UAqh9VAP8fVQAAP1UAVT9VAKo/VQD/P1UAAF9VAFVfVQCqX1UA/19VAAB/VQBVf1UAqn9VAP9/VQAAn1UAVZ9VAKqfVQD/n1UAAL9VAFW/VQCqv1UA/79VAADfVQBV31UAqt9VAP/fVQAA/1UAVf9VAKr/VQD//1UAAAB/AFUAfwCqAH8A/wB/AAAffwBVH38Aqh9/AP8ffwAAP38AVT9/AKo/fwD/P38AAF9/AFVffwCqX38A/19/AAB/fwBVf38Aqn9/AP9/fwAAn38AVZ9/AKqffwD/n38AAL9/AFW/fwCqv38A/79/AADffwBV338Aqt9/AP/ffwAA/38AVf9/AKr/fwD//38AAACqAFUAqgCqAKoA/wCqAAAfqgBVH6oAqh+qAP8fqgAAP6oAVT+qAKo/qgD/P6oAAF+qAFVfqgCqX6oA/1+qAAB/qgBVf6oAqn+qAP9/qgAAn6oAVZ+qAKqfqgD/n6oAAL+qAFW/qgCqv6oA/7+qAADfqgBV36oAqt+qAP/fqgAA/6oAVf+qAKr/qgD//6oAAADUAFUA1ACqANQA/wDUAAAf1ABVH9QAqh/UAP8f1AAAP9QAVT/UAKo/1AD/P9QAAF/UAFVf1ACqX9QA/1/UAAB/1ABVf9QAqn/UAP9/1AAAn9QAVZ/UAKqf1AD/n9QAAL/UAFW/1ACqv9QA/7/UAADf1ABV39QAqt/UAP/f1AAA/9QAVf/UAKr/1AD//9QAVQD/AKoA/wAAH/8AVR//AKof/wD/H/8AAD//AFU//wCqP/8A/z//AABf/wBVX/8Aql//AP9f/wAAf/8AVX//AKp//wD/f/8AAJ//AFWf/wCqn/8A/5//AAC//wBVv/8Aqr//AP+//wAA3/8AVd//AKrf/wD/3/8AVf//AKr//wD/zMwA/8z/AP//MwD//2YA//+ZAP//zAAAfwAAVX8AAKp/AAD/fwAAAJ8AAFWfAACqnwAA/58AAAC/AABVvwAAqr8AAP+/AAAA3wAAVd8AAKrfAAD/3wAAVf8AAKr/AAAAACoAVQAqAKoAKgD/ACoAAB8qAFUfKgCqHyoA/x8qAAA/KgBVPyoA8Pv/AKSgoACAgIAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADx8fHx8fEAAADxAAAA8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPHxAPHx8fEAAPEA8QAA8QDxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8QDxAADx8fHx8fHx8fHxAPHx8QAA8fEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8fHxAPHx8fHx8fHx8fEA8QDxAAAAAADxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPEA8fHx8QDx8fHx8fHx8fEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPEA8QAAAADx8fHx8fHx8QDx8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8QAA8fHx8fEA8fHx8fHxAPEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8QDxAAAAAPHx8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPEAAPHx8fHxAPEA8fEA8fEAAPE&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxAAAAAPEAAPEA8QAA8QDxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8QDx8QDx8QAA8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8fHx8QAAAPEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxAADx8fEA8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxAADxAAAAAPEAAAAAAPEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8QAA8fEA8fHxAAAAAADxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8QAAAAAAAADxAADxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADx8QAA8QAAAAAA8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPEA8fEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPEAAPEA8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxAPEA8QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADxAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgICAAACAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgAAAgAAAgIAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAgICAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAC+gACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAgIAAgAAAPoCAAIAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgD6APr6AvoAAgACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAICAgICAAACAPr6AAIAAgACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIA+voAAgAAAgD6AAAA+gIAAgAAAgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAD6AAACAAIAAAIAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgD6AAAAAPr6AgL6AAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAPoC+gAC+gAAAgAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvoAAAD6AgAC+gD6+gD6AgIAAgIAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD6+gIAAPr6+gD6+gL6AAD6AAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAACAPoA+gD6+vr6AgL6AAICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPoAAAACAvoCAgD6AvoCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAL6APoCAgAC+vr6+gICAAAAAgACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+gACAgAAAgIAAAACAgACAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD6+gAC+gIC+voC+gIAAAD6AAIAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgIAAvr6+gAAAgICAgD6AAACAPoCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPoAAgD6+voCAvr6AvoAAgIAAgACAAAAAAAAAAAAAAAAAAAAAAAAAAA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAICAAACAAACAgD6+gIA+voC+gACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+gIAAAICAAIAAAL6AvoAAgIAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAgIA+gAAAgL6+vr6+gACAAICAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAQABAQAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAIA+gAA+voCAPoAAgIA+gACAAICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAEAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAvoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAQAAAAABAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD6+gICAgIAAPr6+gAAAAAAAAIAAgAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAICAAACAAAAAAL6AgICAAACAgAAAAIAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAABAAABAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL6AgACAgD6AAIA+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAICAAAAAAAAAgACAgIAAAIAAAACAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAABAAAAAAD5AQAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAICAAIAAPoAAgL6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAAAAAAAAAAAAQAAAAABAAEAAAABAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAD6AAAAAAAAAAAAAAAAAgACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAgAAAAIAAgAAAgAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAQEAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAgAAAAIAAAAAAAAAAgIAAAAA+gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAA+QAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgACAPoAAAIAAAAAAAAAAAIAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAEAAQABAQAAAAEBAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAACAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEAAQABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+QAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAD5AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP0AAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFBQAFAAAAAAD9AAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD9AAAFBQAFAAX9AAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAABgAAAAAGAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAFBf0ABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAYGAAAABgYGAAAAAAAGBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUFAAUAAAUAAAAFAAAFBQUAAAAAAAAAAAAAAAAAAAYAAAAABgAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUFAAUAAAUABQAAAAUFAAAAAAAFAAAAAAAAAAAAAAAAAAAAAP4GBgYGBv4AAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQUFBQD9AAAFBQAAAP0AAAUAAP0AAAUFAAAAAAAAAAAAAAAAAP4GAAAABgb+BgYABgAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAF/QX9BQAFBf0AAAAABQAAAAAAAAAAAAAAAAAABgD+BgAABgYGAP4GBgYAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/QAFBQD9/f0ABQAFBf0AAAAFAAAAAAAAAAAAAAAAAAAABgb+AAD+BgYGBv4GAP4G/gYGAAAGBgYAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFBQD9AAX9/QAABQAFBQAAAP0ABQAAAAAAAAYABgAGAAb+Bgb+AP4ABgb+/v4GBgAGAAAGAAYGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAP0F/QD9Bf39AP39AAAAAAAFAAAAAAAAAAAABgYABgYGAP7+/v4GBgb+Bv4ABgAABgAGBgYGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAFAAX9/f39AAX9AAUF/QUAAAAAAAAAAAAABgAAAAAABgYGBv4G/v7+/v7+/v7+/v7+AAYGBgYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUF/QX9AP39BQAFAP39/QUA/QAAAAAAAAAGAAAAAAAGAP4GBv7+/v7+/v7+/v7+/gYGBgb+BgD+AAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUFBQX9AAUABQUABf0AAP0AAAX9AAAFAAAAAAAGBgYABv7+/v7+AAb+/v7+/v7+/v7+/v4GBv4GAAb+AAAGBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAA/QUFAAX9/QX9AP0FBQAA/QAAAAAAAAAAAAYGAAD+AAD+/v7+/v7+/v7+/v7+/v7+Bv4GBgYAAAAGBgAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAX9Bf39AAD9BQAA/QD9/QAABQAFAAYAAAAABgAG/gYG/v7+/v7+/v7+/v7+/v7+/v4GBv7+AAYGBgAAAAYGBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF/QAF/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;QUF/QAFBf0AAAAFAAAAAAAAAAAAAAAAAAAAAP7+/gb+/v7+/v7+/v7+/v7+/v7+/v4GAAYGAAAGBgYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/f0A/QD9AAAFBQAABQAAAAAAAAAAAAAAAAAABgAGAP4G/v7+/v7+/v7+/v7+/v7+/v7+/v4G/gAGBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAA/QUAAAAFAAD9BQAABQAAAAAAAAAAAAAAAAYABgYGBgb+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/gAABgYGAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP0FAAUABQAA/QX9BQAFBQAAAAAAAAAAAAAAAAAAAAAG/v7+/gb+/v7+/v7+/v7+/v7+/v7+/v7+/gYGBgYGBgYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQUAAAD9/QX9BQAAAAAABQAAAAAAAAAAAAYGAAAAAAYA/gD+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v4ABgYAAAYGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUFAAAAAAAAAAAABgYAAAYA/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v4GAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUFAAAABQAAAAAAAAAAAAUAAAAAAAAABgAAAAYAAAb+/gYGBv7+/v7+/v7+/v7+/v7+/v7+Bv7+/v4GBgAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAFAAAAAAAAAAAABgYGAAAGBgYGBv7+/v7+/v7+/v7+/v7+/v4G/v7+BgAABgYGAAYGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAAABgYGBv7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/gYA/gAG/gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgYG/v7+/v7+/v7+/v7+/v7+/v7+Bgb+AAYGAAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgYABgAG/v4G/gb+/v7+/v7+/v7+/v7+BgAGBgAGAAYGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYABv4G/v4A/v7+/v4G/v7+/v7+/gb+BgAABgYGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYABgAA/v7+/v7+BgYA/v4GBv4GBv4GAAYGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYABgYAAP7+/v4G/v4GBgYGBgYGBgYAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYABgYABgYABgYAAAb+/gAGBgYABgYGBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAGBgYAAAYGBgAGAAYABgYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAABgAAAAAABgAGBgAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAYAAAAGBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">charStream</span><span class="o">.</span><span class="n">Write</span><span class="p">(</span><span class="s2">&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=</span><span class="mi">16</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">epis</span><span class="o">=</span><span class="mi">999</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.Common.MIFBase).SaveBase64ToMachine(mi,epis,&#34;DIFF&#34;,charStream,epis_&#34;-DIFF.bmp&#34;,&#34;ZLZ&#34;)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">ret</span><span class="s1">&#39;=1 d Trace^MI.MIF000(mi,&#34;é”™è¯¯&#34;_ret,&#34;H&lt;--M&#34;)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">è½¬ç§»æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFRemisolN).TransMachineGroup(1,9000000071,&#34;DXI800&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFRemisolN).TransMachineGroup(1,9000000071,&#34;AU5800&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">TransMachineGroup</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">machineName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">7</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">epis</span><span class="o">=$$</span><span class="n">GetLabnoByEpis</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">WGMachineID</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">VisitnumberDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)),</span><span class="n">ReportDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitnumberDR</span><span class="p">,</span><span class="n">WGMachineID</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">ReportDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitnumberDR</span><span class="p">,</span><span class="n">WGMachineID</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">//----------------------</span><span class="err">è½¬ç§»æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">machineName</span><span class="o">=</span><span class="s2">&#34;AU5800&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">TransMachineGroupDR</span><span class="o">=</span><span class="mi">61</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">ParamList</span><span class="o">=</span><span class="n">TransMachineGroupDR_</span><span class="s2">&#34;^@&#34;</span><span class="n">_ReportDR</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(LISSP.DHCRPVisitNumberReport).TransMachineGroup(ParamList,&#34;&lt;Data&gt;&lt;P10&gt;&lt;/P10&gt;&lt;P6&gt;&lt;/P6&gt;&lt;P3&gt;&lt;/P3&gt;&lt;P7&gt;&lt;/P7&gt;&lt;P12&gt;&lt;/P12&gt;&lt;P9&gt;&lt;/P9&gt;&lt;P4&gt;&lt;/P4&gt;&lt;P1&gt;&lt;/P1&gt;&lt;P0&gt;&lt;/P0&gt;&lt;P2&gt;&lt;/P2&gt;&lt;P14&gt;&lt;/P14&gt;&lt;P11&gt;&lt;/P11&gt;&lt;P13&gt;&lt;/P13&gt;&lt;P8&gt;&lt;/P8&gt;&lt;P5&gt;&lt;/P5&gt;&lt;/Data&gt;&#34;,&#34;8280^18^0^2^1&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="p">;</span><span class="n">i</span> <span class="n">ret</span><span class="p">[</span><span class="s2">&#34;æµæ°´å·å·²å­˜åœ¨&#34;</span> <span class="n">d</span>		<span class="o">//</span><span class="n">YHR</span> <span class="mi">20230101</span> <span class="err">å¦‚æœæµæ°´å·å†²çªæ˜¯å¦è·å–æœ€å¤§æµæ°´å·ä¿è¯è½¬ç§»æˆåŠŸ</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">objReport</span><span class="o">=</span><span class="c1">##class(dbo.RPVisitNumberReport).%OpenId(ReportDR)</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">NewEpis</span><span class="o">=</span><span class="c1">##Class(LISSP.DHCRPVisitNumberReport).GetMaxEpisodeNo(TransMachineGroupDR,&#34;&lt;Data&gt;&lt;P6&gt;&lt;/P6&gt;&lt;P9&gt;&lt;/P9&gt;&lt;P8&gt;&lt;/P8&gt;&lt;P0&gt;&#34;_$zd($h,3)_&#34;&lt;/P0&gt;&lt;P12&gt;&lt;/P12&gt;&lt;P13&gt;&lt;/P13&gt;&lt;P10&gt;&lt;/P10&gt;&lt;P11&gt;&lt;/P11&gt;&lt;P4&gt;&lt;/P4&gt;&lt;P14&gt;&lt;/P14&gt;&lt;P7&gt;&lt;/P7&gt;&lt;P1&gt;&lt;/P1&gt;&lt;P3&gt;&lt;/P3&gt;&lt;P2&gt;&lt;/P2&gt;&lt;P5&gt;&lt;/P5&gt;&lt;/Data&gt;&#34;,$c(0))</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">objReport</span><span class="o">.</span><span class="n">EpisodeNo</span><span class="o">=</span><span class="n">NewEpis</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">sc</span><span class="o">=</span><span class="n">objReport</span><span class="o">.%</span><span class="n">Save</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(LISSP.DHCRPVisitNumberReport).TransMachineGroup(ParamList,&#34;&lt;Data&gt;&lt;P10&gt;&lt;/P10&gt;&lt;P6&gt;&lt;/P6&gt;&lt;P3&gt;&lt;/P3&gt;&lt;P7&gt;&lt;/P7&gt;&lt;P12&gt;&lt;/P12&gt;&lt;P9&gt;&lt;/P9&gt;&lt;P4&gt;&lt;/P4&gt;&lt;P1&gt;&lt;/P1&gt;&lt;P0&gt;&lt;/P0&gt;&lt;P2&gt;&lt;/P2&gt;&lt;P14&gt;&lt;/P14&gt;&lt;P11&gt;&lt;/P11&gt;&lt;P13&gt;&lt;/P13&gt;&lt;P8&gt;&lt;/P8&gt;&lt;P5&gt;&lt;/P5&gt;&lt;/Data&gt;&#34;,&#34;8280^18^0^2^1&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">machineName</span><span class="o">=</span><span class="s2">&#34;DXI800&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">TransMachineGroupDR</span><span class="o">=</span><span class="mi">71</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">ParamList</span><span class="o">=</span><span class="n">TransMachineGroupDR_</span><span class="s2">&#34;^@&#34;</span><span class="n">_ReportDR</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(LISSP.DHCRPVisitNumberReport).TransMachineGroup(ParamList,&#34;&lt;Data&gt;&lt;P10&gt;&lt;/P10&gt;&lt;P6&gt;&lt;/P6&gt;&lt;P3&gt;&lt;/P3&gt;&lt;P7&gt;&lt;/P7&gt;&lt;P12&gt;&lt;/P12&gt;&lt;P9&gt;&lt;/P9&gt;&lt;P4&gt;&lt;/P4&gt;&lt;P1&gt;&lt;/P1&gt;&lt;P0&gt;&lt;/P0&gt;&lt;P2&gt;&lt;/P2&gt;&lt;P14&gt;&lt;/P14&gt;&lt;P11&gt;&lt;/P11&gt;&lt;P13&gt;&lt;/P13&gt;&lt;P8&gt;&lt;/P8&gt;&lt;P5&gt;&lt;/P5&gt;&lt;/Data&gt;&#34;,&#34;8280^18^0^2^1&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="p">;</span><span class="n">i</span> <span class="n">ret</span><span class="p">[</span><span class="s2">&#34;æµæ°´å·å·²å­˜åœ¨&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">objReport</span><span class="o">=</span><span class="c1">##class(dbo.RPVisitNumberReport).%OpenId(ReportDR)</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">NewEpis</span><span class="o">=</span><span class="c1">##Class(LISSP.DHCRPVisitNumberReport).GetMaxEpisodeNo(TransMachineGroupDR,&#34;&lt;Data&gt;&lt;P6&gt;&lt;/P6&gt;&lt;P9&gt;&lt;/P9&gt;&lt;P8&gt;&lt;/P8&gt;&lt;P0&gt;&#34;_$zd($h,3)_&#34;&lt;/P0&gt;&lt;P12&gt;&lt;/P12&gt;&lt;P13&gt;&lt;/P13&gt;&lt;P10&gt;&lt;/P10&gt;&lt;P11&gt;&lt;/P11&gt;&lt;P4&gt;&lt;/P4&gt;&lt;P14&gt;&lt;/P14&gt;&lt;P7&gt;&lt;/P7&gt;&lt;P1&gt;&lt;/P1&gt;&lt;P3&gt;&lt;/P3&gt;&lt;P2&gt;&lt;/P2&gt;&lt;P5&gt;&lt;/P5&gt;&lt;/Data&gt;&#34;,$c(0))</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">objReport</span><span class="o">.</span><span class="n">EpisodeNo</span><span class="o">=</span><span class="n">NewEpis</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">sc</span><span class="o">=</span><span class="n">objReport</span><span class="o">.%</span><span class="n">Save</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(LISSP.DHCRPVisitNumberReport).TransMachineGroup(ParamList,&#34;&lt;Data&gt;&lt;P10&gt;&lt;/P10&gt;&lt;P6&gt;&lt;/P6&gt;&lt;P3&gt;&lt;/P3&gt;&lt;P7&gt;&lt;/P7&gt;&lt;P12&gt;&lt;/P12&gt;&lt;P9&gt;&lt;/P9&gt;&lt;P4&gt;&lt;/P4&gt;&lt;P1&gt;&lt;/P1&gt;&lt;P0&gt;&lt;/P0&gt;&lt;P2&gt;&lt;/P2&gt;&lt;P14&gt;&lt;/P14&gt;&lt;P11&gt;&lt;/P11&gt;&lt;P13&gt;&lt;/P13&gt;&lt;P8&gt;&lt;/P8&gt;&lt;P5&gt;&lt;/P5&gt;&lt;/Data&gt;&#34;,&#34;8280^18^0^2^1&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">GetLabnoByEpis</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">Epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(mi) q Epis</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">WGMachineID</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(WGMachineID) q Epis</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexEpisodeNo&#34;</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">WGMachineID</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(Epis))) {</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="n">ReportDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexEpisodeNo&#34;</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">WGMachineID</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(Epis),&#34;&#34;),-1)</span>
</span></span><span class="line"><span class="cl">		<span class="n">S</span> <span class="n">VisitNumberDR</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">ReportDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="n">ret</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é€šè¿‡ä¸²å£ç½‘å£ä¸»åŠ¨ä¸Šä¼ ">é€šè¿‡ä¸²å£ç½‘å£ä¸»åŠ¨ä¸Šä¼ 
</h3><h4 id="ä¸Šä¼ å’Œä¸‹è½½ä¸ºä¸åŒçš„ä¸²å£æˆ–ç«¯å£">ä¸Šä¼ å’Œä¸‹è½½ä¸ºä¸åŒçš„ä¸²å£æˆ–ç«¯å£
</h4><h5 id="ç¤ºä¾‹ä»£ç è¥¿é—¨å­æµæ°´çº¿">ç¤ºä¾‹ä»£ç (è¥¿é—¨å­æµæ°´çº¿)
</h5><blockquote>
<p>ä»ªå™¨ä¸ºä¸¤ä¸ªæ¥å£ï¼Œä¸€ä¸ªæ¥å£ä¸Šä¼ ï¼Œä¸€ä¸ªæ¥å£æ¥æ”¶æ•°æ®è§£ææ•°æ®ã€‚ä¸Šä¼ æ•°æ®ä¸ºåœ¨ main è°ƒç”¨ Build2 æ–¹æ³•å¾ªç¯è°ƒç”¨è¯»å– dbo.RPMachineUpload è¡¨ä¸­çš„æ•°æ®ã€‚</p></blockquote>
<h6 id="æ¥æ”¶æ•°æ®">æ¥æ”¶æ•°æ®
</h6><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">MIFNYSIMRec</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>  <span class="p">;</span> <span class="mi">7</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">14</span> <span class="p">;</span> <span class="n">ASTM</span> <span class="n">protocol</span>  <span class="o">-</span> <span class="err">è¥¿é—¨å­æµæ°´çº¿</span><span class="p">(</span><span class="n">MCR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(mi) q</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">^</span><span class="n">TMPMACHDATA1</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">=</span><span class="n">mi</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ItemDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">12</span><span class="p">)</span> <span class="o">//</span><span class="err">é¡¹ç›®åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ResultDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">13</span><span class="p">)</span> <span class="o">//</span><span class="err">ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AntDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">14</span><span class="p">)</span> <span class="o">//</span><span class="err">æŠ—ç”Ÿç´ åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SenDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span> <span class="o">//</span><span class="err">è¯æ•ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Port</span><span class="o">=</span><span class="s2">&#34;|TCP|&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">17</span><span class="p">)</span>  <span class="o">//</span><span class="err">ç«¯å£å·</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">$</span><span class="n">ECODE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="o">//</span><span class="err">æ•è·è¿è¡Œæ—¶é”™è¯¯</span><span class="p">,</span><span class="err">å¹¶æ˜¾ç¤º</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ§åˆ¶å­—ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">stx</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">etx</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ack</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">enq</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">eot</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">lf</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">nak</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">21</span><span class="p">),(</span><span class="n">result</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">etb</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">isDebug</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">iError</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">^</span><span class="n">TMPMACHDATA1</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">=</span><span class="n">mi</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$$</span><span class="n">StartUTF8</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">	<span class="n">f</span>  <span class="n">d</span> <span class="n">Main</span> <span class="n">i</span> <span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">^</span><span class="n">TMPMACH10</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span><span class="o">=$</span><span class="n">h</span>
</span></span><span class="line"><span class="cl">  	<span class="n">c</span> <span class="n">Port</span>
</span></span><span class="line"><span class="cl">  	<span class="n">q</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">Main</span> 
</span></span><span class="line"><span class="cl">  <span class="p">;</span><span class="n">s</span> <span class="o">^</span><span class="n">MIFSIMENSTRecive</span><span class="o">=$</span><span class="n">zdt</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">S</span> <span class="o">$</span><span class="n">ZT</span><span class="o">=</span><span class="s2">&#34;RuntimeError&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span> <span class="n">e</span>  <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="p">;</span><span class="n">d</span> <span class="n">BUILD2</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=enq Q</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">ACK</span>
</span></span><span class="line"><span class="cl">  <span class="n">f</span>  <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span> <span class="n">q</span><span class="p">:</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=stx q</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">record</span><span class="o">=$$</span><span class="n">Read</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">lf</span><span class="p">)</span> <span class="n">q</span><span class="p">:</span><span class="s1">&#39;$l(record)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">record</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="n">etb</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="n">AllRecord_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">etb</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="n">etx</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="n">AllRecord_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">etx</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">ACK</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">type</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;M&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">Intype</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">Inlabno</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">Inlabno</span><span class="p">,</span><span class="s2">&#34;Inlabno&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">try</span><span class="p">{</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##class(MI.Special.AutomaticReceipt).ZDHS(mi,Inlabno)}catch{}		//YHR 20230910 ç”ŸåŒ–æµæ°´çº¿è‡ªåŠ¨æ ¸æ”¶</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">:</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">AllRecord</span><span class="p">,</span><span class="s2">&#34;AllRecord&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="p">(</span><span class="n">mid</span><span class="p">,</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">flag</span><span class="p">,</span><span class="n">machiecode</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">cr</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">rec</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">type</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;H&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;M&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">Intype</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">Inlabno</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">Inlabno</span><span class="p">,</span><span class="s2">&#34;Inlabno&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="p">;</span><span class="n">try</span><span class="p">{</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##class(MI.Special.AutomaticReceipt).ZDHS(mi,Inlabno)}catch{}		//YHR 20230910 ç”ŸåŒ–æµæ°´çº¿è‡ªåŠ¨æ ¸æ”¶</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;O&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;R&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">code</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">flag</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">machiecode</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="s2">&#34;_&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">machiecode</span><span class="o">=</span><span class="s2">&#34;CentaurXP&#34;</span><span class="p">,</span><span class="n">flag</span><span class="s1">&#39;=&#34;DOSE&#34; Q</span>
</span></span><span class="line"><span class="cl">  <span class="o">...//</span><span class="n">R</span><span class="o">|</span><span class="mi">1</span><span class="o">|^^^</span><span class="n">Glu</span><span class="o">^</span><span class="n">Neat</span><span class="o">^</span><span class="mf">1.0</span><span class="o">^^^</span><span class="n">N</span><span class="o">|</span><span class="mf">7.70</span><span class="o">|||||||^</span><span class="n">batch</span><span class="o">|</span><span class="mi">20191116093550</span><span class="o">||</span><span class="n">Advia2400_1</span><span class="err">ã€</span><span class="mi">13</span><span class="err">ã€‘ã€</span><span class="mi">3</span><span class="err">ã€‘</span><span class="n">C2</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">MachID</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="o">$</span><span class="n">C</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">res</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">I</span> <span class="n">res</span><span class="o">=</span><span class="s2">&#34;No Result&#34;</span> <span class="n">s</span> <span class="n">res</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="s1">&#39;$l(code) q</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="s1">&#39;$l(res) q</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">result_code_ResultDeli_res_ItemDeli</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">DateStr</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span><span class="p">:</span><span class="s1">&#39;$L(DateStr) DateStr=$p(rec,&#34;|&#34;,12)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">DateStr</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">zdh</span><span class="p">(</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">DateStr</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">DateStr</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">DateStr</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">time</span><span class="o">=</span><span class="p">(</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">DateStr</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="mi">3600</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">DateStr</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span><span class="o">+$</span><span class="n">e</span><span class="p">(</span><span class="n">DateStr</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;L&#34;</span> <span class="n">d</span> <span class="n">Last</span> <span class="n">q</span> 
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Last</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">s</span> <span class="n">resultmi</span><span class="o">=</span><span class="mi">40</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ä»ªå™¨rowid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">date_</span><span class="s2">&#34;^&#34;</span><span class="n">_time_</span><span class="s2">&#34;^&#34;</span><span class="n">_epis_</span><span class="s2">&#34;^:&#34;</span><span class="n">_result</span><span class="p">,</span><span class="s2">&#34;Save in SIMENS&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="n">d</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">///</span><span class="err">æ ‡æœ¬æ ¸æ”¶</span>
</span></span><span class="line"><span class="cl">   <span class="p">;</span> <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="s1">&#39;$d(^DHCUploadAllBAK(&#34;B&#34;,epis)) s retVal=$$ReceiveLabno^MI.MIF000(28,epis,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">RuntimeError</span>
</span></span><span class="line"><span class="cl">	<span class="n">h</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">iError</span><span class="o">=</span><span class="n">iError</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;Error Code:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ECODE_</span><span class="s2">&#34;,Error:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ZERROR</span><span class="p">,</span><span class="s2">&#34;Runtime Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">iError</span><span class="o">&gt;</span><span class="mi">100</span>  <span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">     <span class="o">///</span><span class="n">CreateDate</span><span class="err">ï¼š</span>  <span class="mi">20140717</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Description</span><span class="err">ï¼š</span> <span class="err">æ„å»ºåŒ»å˜±åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Table</span> <span class="n">DHC_LoadSpecimen</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="ne">Input</span><span class="err">ï¼š</span>		
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Output</span><span class="err">ï¼š</span>	
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Return</span><span class="err">ï¼š</span>		
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Others</span><span class="err">ï¼š</span><span class="n">DHCLoadSpecimen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;DateTime&#34;</span><span class="p">,</span><span class="s2">&#34;TDMTS&#34;</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="mi">62301</span><span class="p">,</span><span class="mi">42467</span><span class="p">,</span><span class="s2">&#34;T623010010&#34;</span><span class="p">,</span><span class="s2">&#34;T101&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span> <span class="o">^</span><span class="n">DHCLoadSpecimen</span><span class="p">({</span><span class="n">DHC_LoadSpecimen</span><span class="o">.</span><span class="n">DLSP_LabNo</span><span class="p">},{</span><span class="n">DHC_LoadSpecimen</span><span class="o">.</span><span class="n">DLSP_TS</span><span class="p">},{</span><span class="n">DHC_LoadSpecimen</span><span class="o">.</span><span class="n">DLSP_TSCNT</span><span class="p">},</span><span class="s2">&#34;TC&#34;</span><span class="p">,{</span><span class="n">DLST_TestCode</span><span class="p">})</span> 
</span></span><span class="line"><span class="cl">    <span class="o">///</span> <span class="o">^</span><span class="n">DHCLoadSpecimen</span><span class="p">({</span><span class="n">DLSP_LabNo</span><span class="p">},{</span><span class="n">DLSP_TS</span><span class="p">},{</span><span class="n">DLSP_TSCNT</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="o">///</span>   <span class="n">W</span> <span class="o">$$</span><span class="n">BUILD2</span><span class="o">^</span><span class="n">DEBUG</span>
</span></span><span class="line"><span class="cl"><span class="n">BUILD2</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">DHCENQ</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">d</span> <span class="n">SendENQ</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">k</span> <span class="o">^</span><span class="n">DHCENQ</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span>  <span class="o">//</span><span class="n">wwh</span><span class="p">,</span><span class="mi">20140812</span><span class="p">,</span><span class="err">ä¸ä¸Šä¼ æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="s1">&#39;$D(^DHCLoadSpecimen(0,&#34;DateTime&#34;,mi,&#34;C&#34;,+$h)) H 10 Q</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">SIMTT</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">F</span>  <span class="n">S</span> <span class="n">SIMTT</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">DHCLoadSpecimen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;DateTime&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="n">SIMTT</span><span class="p">))</span> <span class="n">Q</span><span class="p">:</span><span class="n">SIMTT</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">SIMEpis</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">F</span>  <span class="n">S</span> <span class="n">SIMEpis</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">DHCLoadSpecimen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;DateTime&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="n">SIMTT</span><span class="p">,</span><span class="n">SIMEpis</span><span class="p">))</span> <span class="n">Q</span><span class="p">:</span><span class="n">SIMEpis</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">S</span> <span class="n">SIMTS</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">F</span>  <span class="n">S</span> <span class="n">SIMTS</span><span class="o">=$</span><span class="n">O</span><span class="p">(</span><span class="o">^</span><span class="n">DHCLoadSpecimen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;DateTime&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="n">SIMTT</span><span class="p">,</span><span class="n">SIMEpis</span><span class="p">,</span><span class="n">SIMTS</span><span class="p">))</span> <span class="n">Q</span><span class="p">:</span><span class="n">SIMTS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">	<span class="o">...</span><span class="n">S</span> <span class="n">epis</span><span class="o">=</span><span class="n">SIMEpis</span>
</span></span><span class="line"><span class="cl">	<span class="o">...</span><span class="n">S</span> <span class="n">SIMAck</span><span class="o">=$$</span><span class="n">BUILD</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="o">...</span><span class="p">;;;</span><span class="n">I</span> <span class="p">(</span><span class="n">SIMAck</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">!</span><span class="p">(</span><span class="n">SIMAck</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="n">D</span>  
</span></span><span class="line"><span class="cl">	<span class="o">...</span><span class="n">I</span> <span class="n">SIMAck</span><span class="o">=</span><span class="mi">0</span> <span class="n">D</span>  
</span></span><span class="line"><span class="cl">	<span class="o">....</span><span class="p">;;</span><span class="n">S</span> <span class="n">err</span><span class="o">=$$</span><span class="n">UpdSendStatus</span><span class="o">^</span><span class="n">DHCLABLoadSpecimen</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">SIMTS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">....</span><span class="n">S</span> <span class="n">err</span><span class="o">=$$</span><span class="n">UpdSendStatus</span><span class="o">^</span><span class="n">DHCLABLoadSpecimen</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">...</span><span class="n">E</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">	<span class="o">....</span><span class="n">S</span> <span class="n">err</span><span class="o">=$$</span><span class="n">UpdSendStatus</span><span class="o">^</span><span class="n">DHCLABLoadSpecimen</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">BUILD</span><span class="p">()</span> 
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">episx</span><span class="o">=</span><span class="n">epis</span><span class="p">,</span><span class="n">epis</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">RetAck</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">^</span><span class="n">TMPsim</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">epis</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="s1">&#39;$D(^TEPI(epis,1)) S suffix=$E(epis,$L(epis)),epis=$E(epis,1,$L(epis)-1) I $L(epis),&#39;</span><span class="o">$</span><span class="n">D</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="n">Q</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">^</span><span class="n">TMPsim</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">epis_</span><span class="s2">&#34;,&#34;</span><span class="n">_mi_</span><span class="s2">&#34;,&#34;</span><span class="n">_suffix</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">;;;</span><span class="n">S</span> <span class="n">err</span><span class="o">=$$</span><span class="n">CreateTCList</span><span class="o">^</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">SIMTS</span><span class="p">)</span>  <span class="p">;</span><span class="err">åˆ›å»ºä¸Šä¼ åŒ»å˜±åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">err</span><span class="o">=$$</span><span class="n">CreateTCList</span><span class="o">^</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>  <span class="p">;</span><span class="err">åˆ›å»ºä¸Šä¼ åŒ»å˜±åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">M</span> <span class="o">^</span><span class="n">TMPCHL</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">=^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIF-SINGLE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$D(^TMP(&#34;MIF-SINGLE&#34;,$j,mi,epis_suffix))</span>
</span></span><span class="line"><span class="cl">	<span class="n">M</span> <span class="o">^</span><span class="n">TMPCHL</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIF-SINGLE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="p">(</span><span class="n">surn</span><span class="p">,</span><span class="n">givn</span><span class="p">,</span><span class="n">sex</span><span class="p">,</span><span class="n">dob</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">urno</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="n">loc</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">	<span class="p">;</span> <span class="n">check</span> <span class="k">for</span> <span class="n">entered</span><span class="o">/</span><span class="n">pre</span><span class="o">-</span><span class="n">entered</span> <span class="n">patient</span> <span class="n">details</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">PLIST</span> <span class="n">I</span> <span class="s1">&#39;$$select^LVBEPVIS(epis,&#34;Y&#34;) D</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">F</span> <span class="n">j</span><span class="o">=</span><span class="s2">&#34;surn;3&#34;</span><span class="p">,</span><span class="s2">&#34;givn;4&#34;</span><span class="p">,</span><span class="s2">&#34;sex;5&#34;</span><span class="p">,</span><span class="s2">&#34;dob;6&#34;</span><span class="p">,</span><span class="s2">&#34;date;12&#34;</span><span class="p">,</span><span class="s2">&#34;urno;20&#34;</span><span class="p">,</span><span class="s2">&#34;age;26&#34;</span><span class="p">,</span><span class="s2">&#34;loc;66&#34;</span> <span class="n">S</span> <span class="err">@</span><span class="p">(</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;;&#34;</span><span class="p">))</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">PLIST</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="s2">&#34;;&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="n">PLIST</span> <span class="n">S</span> <span class="n">sex</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">sex</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="n">s</span><span class="p">:</span><span class="n">sex</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">sex</span><span class="o">=</span><span class="s2">&#34;M&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">urno</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">urno</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="n">givn</span><span class="o">=</span><span class="n">surn</span> <span class="n">s</span> <span class="n">givn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">diag</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="mi">8</span><span class="p">)),</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,15) ;;; è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">SpecType</span><span class="o">=$$</span><span class="n">GetSpecType</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span>  <span class="p">;;;</span> <span class="err">æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">D</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">epis</span><span class="p">))</span> <span class="n">D</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">D</span> <span class="n">scanone</span><span class="o">^</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>  <span class="p">;</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIF-SINGLE&#34;</span><span class="p">,</span><span class="mi">208912</span><span class="p">,</span><span class="s2">&#34;AH7471&#34;</span><span class="p">,</span><span class="s2">&#34;A611071030&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">F</span>  <span class="n">S</span> <span class="n">chl</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIF-SINGLE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span> <span class="n">Q</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="p">;</span><span class="n">s</span> <span class="n">tcs</span><span class="o">=</span><span class="n">tcs_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_chl_</span><span class="s2">&#34;/</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">S</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_chl_</span><span class="s2">&#34;^0</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">tcx</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">tcx</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">I</span> <span class="s1">&#39;$L(tcx) S tcx=&#34;^^^^^^0&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">xx</span><span class="o">=$$</span><span class="n">extdate2</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">),</span><span class="n">date</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">xx</span><span class="o">=$$</span><span class="n">exttime</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="n">time</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;00&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">temepis</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="p">;</span><span class="mi">1</span><span class="n">H</span><span class="o">|</span>\<span class="o">^&amp;|||</span><span class="n">BSLIS</span><span class="o">^</span><span class="n">V3</span><span class="o">.</span><span class="mi">00</span><span class="o">|||||||</span><span class="n">P</span><span class="o">|</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;1H|\^&amp;|||BSLIS^V3.00|||||host|TSDWN^REPLY|P|1&#34;</span><span class="n">_cr</span>   <span class="p">;</span><span class="err">å¤´ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="p">;</span><span class="mi">2</span><span class="n">P</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">0010332409</span><span class="o">|</span><span class="mi">0010332409</span><span class="o">||</span><span class="n">Doe</span><span class="o">^</span><span class="n">JohnlSmith</span><span class="o">||</span><span class="mi">19150826</span><span class="o">|</span><span class="n">F</span><span class="o">|||||||||||||||||</span><span class="mi">5500</span><span class="o">|||||||||&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;2P|1&#34;</span><span class="n">_cr</span>  <span class="p">;</span><span class="err">ç—…äººä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;2P|1&#34;</span><span class="n">_cr</span> 
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">I</span> <span class="n">epis</span><span class="o">=</span><span class="s2">&#34;N&#34;</span> <span class="n">s</span> <span class="n">epis</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="p">;</span><span class="mi">3</span><span class="n">O</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">112448100</span><span class="o">||^^^</span><span class="n">TP</span><span class="o">^^^</span><span class="mi">0</span>\<span class="o">^^^</span><span class="n">ALB</span><span class="o">^^^</span><span class="mi">0</span><span class="o">|</span><span class="n">R</span><span class="o">||</span><span class="mi">20110826112206</span><span class="o">||||</span><span class="n">A</span><span class="o">|</span><span class="n">hep</span><span class="o">|</span><span class="n">lipemic</span><span class="o">||</span><span class="n">Serum</span><span class="o">||||||||||</span><span class="n">Q</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;3O|1|&#34;</span><span class="n">_epis_</span><span class="s2">&#34;||&#34;</span><span class="n">_tcx_</span><span class="s2">&#34;|R||&#34;</span><span class="n">_date_time_</span><span class="s2">&#34;||||A|hep|lipemic||&#34;</span><span class="n">_SpecType_</span><span class="s2">&#34;||||||||||&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;Q&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="p">;</span><span class="mi">4</span><span class="n">L</span><span class="o">|</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;4L|1|&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">RetAck</span><span class="o">=$$</span><span class="n">Send</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">K</span> <span class="o">^</span><span class="n">TMIF</span><span class="p">(</span><span class="s2">&#34;MIF_SINGLE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">^</span><span class="n">TMPsim</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;||&#34;</span><span class="n">_RetAck</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="n">RetAck</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Send</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span>  <span class="p">;</span> <span class="n">send</span> <span class="n">list</span> <span class="n">of</span> <span class="n">orders</span> <span class="k">if</span> <span class="n">exists</span>
</span></span><span class="line"><span class="cl">  <span class="n">W</span> <span class="n">enq</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">F</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span> <span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">)</span>  <span class="n">Q</span> 
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">:</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">nak</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;1H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span> <span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=ack W eot,*-3 d Trace^MI.MIF000(mi,&#34;EOT&#34;,&#34;H--&gt;M&#34;) Q ret</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">241</span> <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">str1</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">241</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">str2</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">E</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">E</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">;</span><span class="n">f</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span> <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="p">;</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">:</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">nak</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;2H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">W</span> <span class="n">eot</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">SEND</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span>  <span class="p">;</span> <span class="n">send</span> <span class="n">string</span> <span class="n">to</span> <span class="n">instrument</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="n">flag</span><span class="o">=</span><span class="mi">1</span> <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_etb</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">chsum</span><span class="o">=$$</span><span class="n">CHSUM</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">E</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_etx</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">chsum</span><span class="o">=$$</span><span class="n">CHSUM</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">W</span> <span class="n">stx</span><span class="p">,</span><span class="nb">str</span><span class="p">,</span><span class="n">chsum</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">lf</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">str_chsum</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">F</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span> <span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">I</span> <span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">)</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">)</span> <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span> <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span> <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span> <span class="n">W</span> <span class="n">nak</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">CHSUM</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="p">;</span> <span class="n">calculate</span> <span class="n">check</span> <span class="n">sum</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">s</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span> <span class="n">f</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">s</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">+$</span><span class="n">a</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">z</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="s2">&#34;0123456789ABCDEF&#34;</span><span class="p">,</span><span class="n">z</span><span class="c1">#256\16+1)_$e(&#34;0123456789ABCDEF&#34;,z#16+1)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="n">z</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">ACK</span>  <span class="p">;</span> <span class="n">send</span> <span class="s1">&#39;ack&#39;</span> <span class="n">to</span> <span class="n">instrument</span>
</span></span><span class="line"><span class="cl">  <span class="n">w</span> <span class="n">ack</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">NEXTTRAY</span><span class="p">(</span><span class="n">tray</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="n">tray</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="o">///</span>  
</span></span><span class="line"><span class="cl"><span class="n">GetSpecType</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span> <span class="n">n</span> <span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">spdr</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">labno</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">RetVal</span><span class="o">=</span><span class="s2">&#34;SE&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">spec</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">spdr</span><span class="p">),</span><span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">TTAB</span><span class="p">(</span><span class="s2">&#34;SPEC&#34;</span><span class="p">,</span><span class="n">spdr</span><span class="p">))</span> <span class="n">s</span> <span class="n">spec</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">^</span><span class="n">TTAB</span><span class="p">(</span><span class="s2">&#34;SPEC&#34;</span><span class="p">,</span><span class="n">spdr</span><span class="p">),</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,1)</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="n">spec</span><span class="p">[</span><span class="s2">&#34;è¡€&#34;</span> <span class="n">s</span> <span class="n">RetVal</span><span class="o">=</span><span class="s2">&#34;SE&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="n">spec</span><span class="p">[</span><span class="s2">&#34;å°¿&#34;</span> <span class="n">s</span> <span class="n">RetVal</span><span class="o">=</span><span class="s2">&#34;UR&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="n">RetVal</span>  
</span></span><span class="line"><span class="cl"><span class="n">SendENQ</span>  <span class="p">;</span> <span class="n">send</span> <span class="n">list</span> <span class="n">of</span> <span class="n">orders</span> <span class="k">if</span> <span class="n">exists</span>
</span></span><span class="line"><span class="cl">  <span class="n">W</span> <span class="n">enq</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span><span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span> <span class="n">e</span>  <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">//.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">:</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">nak</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;1H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">F</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span> <span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">:</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">nak</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;1H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span> <span class="n">Q</span> 
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=ack W eot,*-3 d Trace^MI.MIF000(mi,&#34;EOT&#34;,&#34;H--&gt;M&#34;)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>  
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="å‘é€æ•°æ®">å‘é€æ•°æ®
</h6><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">MIFNYSIMSend</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>  <span class="p">;</span> <span class="mi">7</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">14</span> <span class="p">;</span> <span class="n">ASTM</span> <span class="n">protocol</span>  <span class="o">-</span> <span class="err">è¥¿é—¨å­æµæ°´çº¿</span><span class="p">(</span><span class="n">MCR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(mi) q</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">^</span><span class="n">TMPMACHDATA1</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">=</span><span class="n">mi</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ItemDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">12</span><span class="p">)</span> <span class="o">//</span><span class="err">é¡¹ç›®åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ResultDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">13</span><span class="p">)</span> <span class="o">//</span><span class="err">ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AntDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">14</span><span class="p">)</span> <span class="o">//</span><span class="err">æŠ—ç”Ÿç´ åˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SenDeli</span><span class="o">=$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span> <span class="o">//</span><span class="err">è¯æ•ç»“æœåˆ†éš”ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Port</span><span class="o">=</span><span class="s2">&#34;|TCP|&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">li</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">10</span><span class="p">)</span>  <span class="o">//</span><span class="err">ç«¯å£å·</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ§åˆ¶å­—ç¬¦</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">isDebug</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">iError</span><span class="o">=</span><span class="mi">100</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">stx</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">etx</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ack</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">enq</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">eot</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">lf</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">cr</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">nak</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">21</span><span class="p">),(</span><span class="n">result</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">etb</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">^</span><span class="n">TMPMACHDATA1</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">=</span><span class="n">mi</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$$</span><span class="n">Start</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">	<span class="n">f</span>  <span class="n">d</span> <span class="n">Main</span> <span class="n">i</span> <span class="o">$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">^</span><span class="n">TMPMACH10</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span><span class="o">=$</span><span class="n">h</span>
</span></span><span class="line"><span class="cl">  	<span class="n">c</span> <span class="n">Port</span>
</span></span><span class="line"><span class="cl">  	<span class="n">q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Main</span>
</span></span><span class="line"><span class="cl">  <span class="n">S</span> <span class="o">$</span><span class="n">ZT</span><span class="o">=</span><span class="s2">&#34;RuntimeError&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">ECODE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="o">//</span><span class="err">æ•è·è¿è¡Œæ—¶é”™è¯¯</span><span class="p">,</span><span class="err">å¹¶æ˜¾ç¤º</span>
</span></span><span class="line"><span class="cl">  <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span> <span class="n">e</span>  <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">D</span> <span class="n">BUILD2</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">ACK</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">f</span>  <span class="n">r</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">10</span> <span class="n">q</span><span class="p">:</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=stx q</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">record</span><span class="o">=$$</span><span class="n">Read</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">lf</span><span class="p">)</span> <span class="n">q</span><span class="p">:</span><span class="s1">&#39;$l(record)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">record</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="n">etb</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="n">AllRecord_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">etb</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="n">etx</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="n">AllRecord_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">record</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">etx</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="p">;</span><span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="n">AllRecord_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="n">etb</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="p">;</span><span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="n">AllRecord_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="n">etx</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">d</span> <span class="n">ACK</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">:</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">i</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="p">(</span><span class="n">mid</span><span class="p">,</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">cr</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">rec</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">AllRecord</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">s</span> <span class="n">type</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;H&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;M&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">Intype</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">Inlabno</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">Inlabno</span><span class="p">,</span><span class="s2">&#34;Inlabno&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">try</span><span class="p">{</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##class(MI.Special.AutomaticReceipt).ZDHS(mi,Inlabno)}catch{}		//YHR 20230910 ç”ŸåŒ–æµæ°´çº¿è‡ªåŠ¨æ ¸æ”¶</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="n">Intype</span><span class="o">=</span><span class="s2">&#34;I&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.....</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">Inlabno</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">.....</span><span class="n">q</span><span class="p">:</span><span class="s1">&#39;$d(^TEPI(Inlabno))</span>
</span></span><span class="line"><span class="cl">  <span class="o">.....</span><span class="n">s</span> <span class="n">temts</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">temts</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">Inlabno</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">temts</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">temts</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">......</span><span class="p">;</span><span class="n">q</span><span class="p">:</span><span class="s1">&#39;$d(^TMIF(mi,0,temts))</span>
</span></span><span class="line"><span class="cl">  <span class="o">......</span><span class="n">s</span> <span class="n">temtscnt</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">temtscnt</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">Inlabno</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">temts</span><span class="p">,</span><span class="n">temtscnt</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">temtscnt</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.......</span><span class="n">s</span><span class="p">:</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">Inlabno</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">temts</span><span class="p">,</span><span class="n">temtscnt</span><span class="p">),</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,27)=&#34;&#34; $P(^TEPI(Inlabno,1,temts,temtscnt),&#34;</span>\<span class="s2">&#34;,27)=mi</span>
</span></span><span class="line"><span class="cl">  <span class="o">.......</span><span class="n">s</span><span class="p">:</span><span class="o">$</span><span class="n">P</span><span class="p">(</span><span class="o">^</span><span class="n">TEPI</span><span class="p">(</span><span class="n">Inlabno</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">temts</span><span class="p">,</span><span class="n">temtscnt</span><span class="p">),</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">,36)=&#34;&#34; $P(^TEPI(Inlabno,1,temts,temtscnt),&#34;</span>\<span class="s2">&#34;,36)=$P(^TEPI(Inlabno,1,temts,temtscnt),&#34;</span>\<span class="s2">&#34;,60) </span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;O&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">qcid</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">qcid</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="n">qcid</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">QCStat</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">SpecStat</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="n">SpecStat</span><span class="o">=</span><span class="s2">&#34;S&#34;</span> <span class="n">s</span> <span class="n">epis</span><span class="o">=</span><span class="s2">&#34;E&#34;</span><span class="n">_epis</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="n">QCStat</span><span class="o">=</span><span class="s2">&#34;Q&#34;</span> <span class="n">s</span> <span class="n">QC</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">_qcid,epis=qcid</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">datex</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">date</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;/&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;/&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">date</span><span class="o">=$$</span><span class="n">intdate</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">time1</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">datex</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="n">time1</span><span class="o">=$$</span><span class="n">inttime</span><span class="o">^</span><span class="n">SSUTIL4</span><span class="p">(</span><span class="n">time1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;R&#34;</span> <span class="n">d</span>  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">code</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">flag</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">mid1</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="n">mid1</span><span class="s1">&#39;=&#34;&#34; s mid=mid1</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="n">res</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">s</span> <span class="o">^</span><span class="n">Test</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">res_</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">_flag</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="n">mid1</span><span class="p">[</span><span class="s2">&#34;CentaurXP&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">code</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">.....</span><span class="n">i</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&#34;DOSE&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">......</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">result_code_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">par10</span><span class="p">)</span><span class="n">_res_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">par11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">//....</span><span class="n">E</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">....</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">code</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">.....</span><span class="n">s</span> <span class="n">result</span><span class="o">=</span><span class="n">result_code_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">par10</span><span class="p">)</span><span class="n">_res_</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">par11</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>  <span class="o">//</span><span class="n">i</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;L&#34;</span> <span class="n">d</span> <span class="n">Last</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">  <span class="n">D</span> <span class="n">BUILD2</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Last</span>	<span class="p">;</span> <span class="n">file</span> <span class="n">result</span> <span class="k">if</span> <span class="n">exist</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AllRecord</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">time1</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">s</span> <span class="n">time1</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">time</span><span class="o">=</span><span class="n">time1</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">date</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="n">d</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">result</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">RuntimeError</span>
</span></span><span class="line"><span class="cl">	<span class="n">h</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">iError</span><span class="o">=</span><span class="n">iError</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;Error Code:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ECODE_</span><span class="s2">&#34;,Error:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ZERROR</span><span class="p">,</span><span class="s2">&#34;Runtime Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">D</span><span class="p">:</span><span class="n">isDebug</span> <span class="n">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;Error Code:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ECODE_</span><span class="s2">&#34;,Error:&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">ZERROR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">iError</span><span class="o">&gt;</span><span class="mi">100</span>  <span class="n">s</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">Stop</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">     <span class="o">///</span><span class="n">CreateDate</span><span class="err">ï¼š</span>  <span class="mi">20140717</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Description</span><span class="err">ï¼š</span> <span class="err">æ„å»ºåŒ»å˜±åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Table</span> <span class="n">DHC_LoadSpecimen</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="ne">Input</span><span class="err">ï¼š</span>	
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Output</span><span class="err">ï¼š</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Return</span><span class="err">ï¼š</span>	
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="n">Others</span><span class="err">ï¼š</span><span class="n">DHCLoadSpecimen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;DateTime&#34;</span><span class="p">,</span><span class="s2">&#34;TDMTS&#34;</span><span class="p">,</span><span class="s2">&#34;C&#34;</span><span class="p">,</span><span class="mi">62301</span><span class="p">,</span><span class="mi">42467</span><span class="p">,</span><span class="s2">&#34;T623010010&#34;</span><span class="p">,</span><span class="s2">&#34;T101&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">///</span> <span class="o">^</span><span class="n">DHCLoadSpecimen</span><span class="p">({</span><span class="n">DHC_LoadSpecimen</span><span class="o">.</span><span class="n">DLSP_LabNo</span><span class="p">},{</span><span class="n">DHC_LoadSpecimen</span><span class="o">.</span><span class="n">DLSP_TS</span><span class="p">},{</span><span class="n">DHC_LoadSpecimen</span><span class="o">.</span><span class="n">DLSP_TSCNT</span><span class="p">},</span><span class="s2">&#34;TC&#34;</span><span class="p">,{</span><span class="n">DLST_TestCode</span><span class="p">})</span> 
</span></span><span class="line"><span class="cl">    <span class="o">///</span> <span class="o">^</span><span class="n">DHCLoadSpecimen</span><span class="p">({</span><span class="n">DLSP_LabNo</span><span class="p">},{</span><span class="n">DLSP_TS</span><span class="p">},{</span><span class="n">DLSP_TSCNT</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="o">///</span>   <span class="n">W</span> <span class="o">$$</span><span class="n">BUILD2</span><span class="o">^</span><span class="n">DEBUG</span>
</span></span><span class="line"><span class="cl"><span class="n">BUILD2</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="o">$</span><span class="n">zn</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">LabnoList</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AddTime</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddTime</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate,AddTime)) q:AddTime=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">MiUploadDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate,AddTime,&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">Labno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="p">;</span><span class="n">H</span> <span class="mi">1</span>  <span class="o">//</span><span class="err">æ¯éš”</span><span class="mi">2</span><span class="n">Så¤„ç†ä¸€ä¸ªæ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">D</span><span class="p">:</span><span class="n">isDebug</span> <span class="n">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;BUILD2|labno=&#34;</span><span class="n">_Labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">S</span> <span class="n">SIMAck</span><span class="o">=$$</span><span class="n">BUILD</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">I</span> <span class="n">SIMAck</span><span class="o">=</span><span class="mi">0</span> <span class="n">D</span>  
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">err</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,Labno,&#34;S&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">E</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">D</span><span class="p">:</span><span class="n">isDebug</span> <span class="n">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;BUILD2|Fail:labno=&#34;</span><span class="n">_Labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="n">Q</span><span class="p">:</span><span class="n">tryTimes</span><span class="o">&lt;</span><span class="mi">4</span>  <span class="o">//</span><span class="err">å¤±è´¥</span><span class="mi">3</span><span class="err">æ¬¡æ‰æ›´æ–°å¤±è´¥çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">err</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,Labno,&#34;F&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AddTime</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddTime</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;U&#34;),AddDate,AddTime)) q:AddTime=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">MiUploadDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;U&#34;),AddDate,AddTime,&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">Labno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="p">;</span><span class="n">H</span> <span class="mi">1</span>  <span class="o">//</span><span class="err">æ¯éš”</span><span class="mi">2</span><span class="n">Så¤„ç†ä¸€ä¸ªæ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">D</span><span class="p">:</span><span class="n">isDebug</span> <span class="n">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;BUILD2|labno=&#34;</span><span class="n">_Labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">S</span> <span class="n">SIMAck</span><span class="o">=$$</span><span class="n">BUILD</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">I</span> <span class="n">SIMAck</span><span class="o">=</span><span class="mi">0</span> <span class="n">D</span>  
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">err</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,Labno,&#34;S&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">E</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">D</span><span class="p">:</span><span class="n">isDebug</span> <span class="n">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;BUILD2|Fail:labno=&#34;</span><span class="n">_Labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="n">Q</span><span class="p">:</span><span class="n">tryTimes</span><span class="o">&lt;</span><span class="mi">4</span>  <span class="o">//</span><span class="err">å¤±è´¥</span><span class="mi">3</span><span class="err">æ¬¡æ‰æ›´æ–°å¤±è´¥çŠ¶æ€</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">err</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,Labno,&#34;F&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">///</span><span class="err">è€å¹´åŒ»é™¢æµæ°´çº¿ä¸Šä¼ æ‰€æœ‰é›†ä¸­æ¥æ”¶æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">s</span> <span class="n">Labno</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">Labno</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">DHCUploadAll</span><span class="p">(</span><span class="n">Labno</span><span class="p">))</span> <span class="n">Q</span><span class="p">:</span><span class="n">Labno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">//.</span><span class="n">s</span> <span class="n">WorkGroupMachineDR</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">DHCUploadAll</span><span class="p">(</span><span class="n">Labno</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">//.</span><span class="n">S</span> <span class="n">SIMAck</span><span class="o">=$$</span><span class="n">SendSorting</span><span class="p">(</span><span class="n">WorkGroupMachineDR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//.</span><span class="n">I</span> <span class="n">SIMAck</span><span class="s1">&#39;=0 s ^DHCUploadAllBAK(&#34;F&#34;,Labno)=^DHCUploadAll(Labno)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//.</span><span class="n">e</span>  <span class="n">s</span> <span class="o">^</span><span class="n">DHCUploadAllBAK</span><span class="p">(</span><span class="s2">&#34;S&#34;</span><span class="p">,</span><span class="n">Labno</span><span class="p">)</span><span class="o">=^</span><span class="n">DHCUploadAll</span><span class="p">(</span><span class="n">Labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//.</span><span class="n">s</span> <span class="o">^</span><span class="n">DHCUploadAllBAK</span><span class="p">(</span><span class="s2">&#34;B&#34;</span><span class="p">,</span><span class="n">Labno</span><span class="p">)</span><span class="o">=^</span><span class="n">DHCUploadAll</span><span class="p">(</span><span class="n">Labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//.</span><span class="n">k</span> <span class="o">^</span><span class="n">DHCUploadAll</span><span class="p">(</span><span class="n">Labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Q</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">JudgeUrgent</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">urgent</span><span class="p">,</span><span class="s2">&#34;urgentJu&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">urgent</span><span class="o">=</span><span class="mi">1</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">urgent</span><span class="o">=</span><span class="s2">&#34;S&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">urgent</span><span class="p">,</span><span class="s2">&#34;urgentJUS&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">e</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">urgent</span><span class="o">=</span><span class="s2">&#34;R&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BUILD</span><span class="p">()</span> 
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">episx</span><span class="o">=</span><span class="n">Labno</span><span class="p">,</span><span class="n">Labno</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">Labno</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">RetAck</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="p">(</span><span class="n">surn</span><span class="p">,</span><span class="n">givn</span><span class="p">,</span><span class="n">sex</span><span class="p">,</span><span class="n">dob</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">urno</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="n">loc</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(Labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">VisitNumberData</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">urno</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">urno</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="n">givn</span><span class="o">=</span><span class="n">surn</span> <span class="n">s</span> <span class="n">givn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">GName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">diag</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span> <span class="p">;;;</span> <span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">SpecType</span><span class="o">=$$</span><span class="n">GetSpecType</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">)</span>  <span class="p">;;;</span> <span class="err">æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">debtor</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">;</span><span class="err">ç™»è®°å·</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">admtype</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">;</span><span class="err">å°±è¯Šç±»å‹</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">urgent</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="p">;</span><span class="err">æ˜¯å¦åŠ æ€¥</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">urgent</span><span class="p">,</span><span class="s2">&#34;urgent&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">JudgeAdmType</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">JudgeUrgent</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">SpeciesDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">//</span><span class="n">s</span> <span class="n">Species</span> <span class="o">=</span> <span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">):</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">),</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">S</span> <span class="n">Species</span><span class="o">=</span><span class="n">SpeciesDR</span> <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">DOB</span><span class="o">=</span> <span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="p">;</span><span class="err">å‡ºç”Ÿæ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">s</span> <span class="n">DOB</span><span class="o">=</span><span class="s2">&#34;20000202&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">LocationDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Location</span> <span class="o">=</span> <span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">):</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Loc</span><span class="o">=</span><span class="n">Location</span> <span class="p">;</span><span class="err">ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">TSName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">//</span><span class="err">å¤šæ¡åŒ»å˜±ä¿¡æ¯åˆå¹¶</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">TSName</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">TestSetDR</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="n">TestSetDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberTestSetI</span><span class="p">(</span><span class="s2">&#34;IndexMaster&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span><span class="n">TestSetDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">q</span><span class="p">:</span><span class="n">TestSetDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">TSName</span><span class="p">)</span> <span class="n">s</span> <span class="n">TSName</span><span class="o">=</span><span class="n">TSName_</span><span class="s2">&#34;+&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTTestSetD</span><span class="p">(</span><span class="n">TestSetDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">e</span>  <span class="n">s</span> <span class="n">TSName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTTestSetD</span><span class="p">(</span><span class="n">TestSetDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">Labno</span><span class="p">)</span> <span class="p">;</span><span class="err">åˆ›å»ºä¸Šä¼ åŒ–éªŒé¡¹ç›®åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$D(^TMP(&#34;MIFTESTCODE&#34;,$j,mi,Labno)) q 1</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">F</span>  <span class="n">S</span> <span class="n">chl</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">Labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span> <span class="n">Q</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">S</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_chl_</span><span class="s2">&#34;^^^0</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tcx</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">tcx</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="s1">&#39;$L(tcx) S tcx=&#34;^^^^^^0&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">date</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">time</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">temepis</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">H</span><span class="o">|</span>\<span class="o">^&amp;|||</span><span class="n">BSLIS</span><span class="o">^</span><span class="n">V3</span><span class="o">.</span><span class="mi">00</span><span class="o">|||||||</span><span class="n">P</span><span class="o">|</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;H|\^&amp;|||BSLIS^V3.00|||||host|TSDWN^REPLY|P|1&#34;</span><span class="n">_cr</span>   <span class="p">;</span><span class="err">å¤´ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">P</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">0010332409</span><span class="o">|</span><span class="mi">0010332409</span><span class="o">||</span><span class="n">Doe</span><span class="o">^</span><span class="n">JohnlSmith</span><span class="o">||</span><span class="mi">19150826</span><span class="o">|</span><span class="n">F</span><span class="o">|||||||||||||||||</span><span class="mi">5500</span><span class="o">|||||||||&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;P|1|&#34;</span><span class="n">_debtor_</span><span class="s2">&#34;|&#34;</span><span class="n">_cr</span>  <span class="p">;</span><span class="err">ç—…äººä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SName</span><span class="o">=</span><span class="c1">##class(OTH.DHCINSUPort).GetPinYingCode(SName)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;P|1|&#34;</span><span class="n">_debtor_</span><span class="s2">&#34;|||&#34;</span><span class="n">_SName_</span><span class="s2">&#34;^^^||&#34;</span><span class="n">_DOB_</span><span class="s2">&#34;|&#34;</span><span class="n">_Species_</span><span class="s2">&#34;|||||||||||||||||&#34;</span><span class="n">_Loc_</span><span class="s2">&#34;|||||||||&#34;</span><span class="n">_cr</span>  <span class="p">;</span><span class="err">ç—…äººä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="n">Labno</span><span class="o">=</span><span class="s2">&#34;N&#34;</span> <span class="n">s</span> <span class="n">Labno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">O</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">112448100</span><span class="o">||^^^</span><span class="n">TP</span><span class="o">^^^</span><span class="mi">0</span>\<span class="o">^^^</span><span class="n">ALB</span><span class="o">^^^</span><span class="mi">0</span><span class="o">|</span><span class="n">R</span><span class="o">||</span><span class="mi">20110826112206</span><span class="o">||||</span><span class="n">N</span><span class="o">|</span><span class="n">hep</span><span class="o">|</span><span class="n">lipemic</span><span class="o">||</span><span class="n">Serum</span><span class="o">||||||||||</span><span class="n">Q</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">s</span> <span class="n">SpecType</span><span class="o">=</span><span class="s2">&#34;Serum&#34;</span>	<span class="o">//</span><span class="n">YHR</span> <span class="err">è®¾ç½®ç©ºç™½çš„ä¸ºè¡€ç±»å‹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;O|1|&#34;</span><span class="n">_Labno_</span><span class="s2">&#34;||&#34;</span><span class="n">_tcx_</span><span class="s2">&#34;|&#34;</span><span class="n">_urgent_</span><span class="s2">&#34;||&#34;</span><span class="n">_date_time_</span><span class="s2">&#34;||||A|hep|lipemic||&#34;</span><span class="n">_SpecType_</span><span class="s2">&#34;|||&#34;</span><span class="n">_TSName_</span><span class="s2">&#34;|&#34;</span><span class="n">_admtype_</span><span class="s2">&#34;||||||&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;Q&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">    <span class="p">;</span><span class="mi">4</span><span class="n">L</span><span class="o">|</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;L|1|&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">RetAck</span><span class="o">=$$</span><span class="n">Send</span><span class="p">(</span><span class="n">Labno</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">K</span> <span class="o">^</span><span class="n">TMIF</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">Labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="n">RetAck</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">JudgeAdmType</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">admtype</span><span class="o">=</span><span class="mi">1</span> <span class="n">s</span> <span class="n">admtype</span><span class="o">=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">admtype</span><span class="o">=</span><span class="mi">2</span> <span class="n">s</span> <span class="n">admtype</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">admtype</span><span class="o">=</span><span class="mi">8</span> <span class="n">s</span> <span class="n">admtype</span><span class="o">=</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">SendSorting</span><span class="p">(</span><span class="n">WorkGroupMachineDR</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">episx</span><span class="o">=</span><span class="n">Labno</span><span class="p">,</span><span class="n">Labno</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="n">Labno</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">RetAck</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="p">(</span><span class="n">surn</span><span class="p">,</span><span class="n">givn</span><span class="p">,</span><span class="n">sex</span><span class="p">,</span><span class="n">dob</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">urno</span><span class="p">,</span><span class="n">age</span><span class="p">,</span><span class="n">loc</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(Labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">VisitNumberData</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">urno</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">urno</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="n">givn</span><span class="o">=</span><span class="n">surn</span> <span class="n">s</span> <span class="n">givn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">admtype</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">;</span><span class="err">å°±è¯Šç±»å‹</span>
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">JudgeAdmType</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">urgent</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="p">;</span><span class="err">æ˜¯å¦åŠ æ€¥</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">D</span> <span class="n">JudgeUrgent</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">GName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">diag</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span> <span class="p">;;;</span> <span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">SpecType</span><span class="o">=$$</span><span class="n">GetSpecType</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">)</span>  <span class="p">;;;</span> <span class="err">æ ‡æœ¬</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">debtor</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="p">;</span><span class="err">ç™»è®°å·</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">SpeciesDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">//</span><span class="n">s</span> <span class="n">Species</span> <span class="o">=</span> <span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">):</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">),</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">LG</span><span class="p">(</span><span class="o">$</span><span class="n">G</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">TSName</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">S</span> <span class="n">Species</span><span class="o">=</span><span class="n">SpeciesDR</span> <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">DOB</span><span class="o">=</span> <span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="p">;</span><span class="err">å‡ºç”Ÿæ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">LocationDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">VisitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Location</span> <span class="o">=</span> <span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">):</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">Loc</span><span class="o">=</span><span class="n">Location</span> <span class="p">;</span><span class="err">ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">TSName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="o">//</span><span class="err">å¤šæ¡åŒ»å˜±ä¿¡æ¯åˆå¹¶</span>
</span></span><span class="line"><span class="cl"> 	<span class="n">s</span> <span class="n">TestSetDR</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"> 	<span class="k">for</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="n">TestSetDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberTestSetI</span><span class="p">(</span><span class="s2">&#34;IndexMaster&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span><span class="n">TestSetDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">		<span class="n">q</span><span class="p">:</span><span class="n">TestSetDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">TSName</span><span class="p">)</span> <span class="n">s</span> <span class="n">TSName</span><span class="o">=</span><span class="n">TSName_</span><span class="s2">&#34;+&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTTestSetD</span><span class="p">(</span><span class="n">TestSetDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">e</span>  <span class="n">s</span> <span class="n">TSName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTTestSetD</span><span class="p">(</span><span class="n">TestSetDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;Sorting&#34;</span><span class="n">_WorkGroupMachineDR</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_</span><span class="s2">&#34;^^^&#34;</span><span class="n">_chl_</span><span class="s2">&#34;^^^0</span><span class="se">\&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">date</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">time</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="s2">&#34;:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">temepis</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">H</span><span class="o">|</span>\<span class="o">^&amp;|||</span><span class="n">BSLIS</span><span class="o">^</span><span class="n">V3</span><span class="o">.</span><span class="mi">00</span><span class="o">|||||||</span><span class="n">P</span><span class="o">|</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&#34;H|\^&amp;|||BSLIS^V3.00|||||host|TSDWN^REPLY|P|1&#34;</span><span class="n">_cr</span>   <span class="p">;</span><span class="err">å¤´ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">P</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">0010332409</span><span class="o">|</span><span class="mi">0010332409</span><span class="o">||</span><span class="n">Doe</span><span class="o">^</span><span class="n">JohnlSmith</span><span class="o">||</span><span class="mi">19150826</span><span class="o">|</span><span class="n">F</span><span class="o">|||||||||||||||||</span><span class="mi">5500</span><span class="o">|||||||||&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;P|1|&#34;</span><span class="n">_debtor_</span><span class="s2">&#34;|&#34;</span><span class="n">_cr</span>  <span class="p">;</span><span class="err">ç—…äººä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;P|1|&#34;</span><span class="n">_debtor_</span><span class="s2">&#34;|||&#34;</span><span class="n">_SName_</span><span class="s2">&#34;^&#34;</span><span class="n">_GName_</span><span class="s2">&#34;^^||&#34;</span><span class="n">_DOB_</span><span class="s2">&#34;|&#34;</span><span class="n">_Species_</span><span class="s2">&#34;|||||||||||||||||&#34;</span><span class="n">_Loc_</span><span class="s2">&#34;|||||||||&#34;</span><span class="n">_cr</span>  <span class="p">;</span><span class="err">ç—…äººä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">	<span class="n">I</span> <span class="n">Labno</span><span class="o">=</span><span class="s2">&#34;N&#34;</span> <span class="n">s</span> <span class="n">Labno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">O</span><span class="o">|</span><span class="mi">1</span><span class="o">|</span><span class="mi">112448100</span><span class="o">||^^^</span><span class="n">TP</span><span class="o">^^^</span><span class="mi">0</span>\<span class="o">^^^</span><span class="n">ALB</span><span class="o">^^^</span><span class="mi">0</span><span class="o">|</span><span class="n">R</span><span class="o">||</span><span class="mi">20110826112206</span><span class="o">||||</span><span class="n">N</span><span class="o">|</span><span class="n">hep</span><span class="o">|</span><span class="n">lipemic</span><span class="o">||</span><span class="n">Serum</span><span class="o">||||||||||</span><span class="n">Q</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">;</span><span class="n">s</span> <span class="n">SpecType</span><span class="o">=</span><span class="s2">&#34;Serum&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;O|1|&#34;</span><span class="n">_Labno_</span><span class="s2">&#34;||&#34;</span><span class="n">_tcx_</span><span class="s2">&#34;|&#34;</span><span class="n">_urgent_</span><span class="s2">&#34;||&#34;</span><span class="n">_date_time_</span><span class="s2">&#34;||||A|hep|lipemic||&#34;</span><span class="n">_SpecType_</span><span class="s2">&#34;|||&#34;</span><span class="n">_TSName_</span><span class="s2">&#34;|&#34;</span><span class="n">_admtype_</span><span class="s2">&#34;||||||&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;Q&#34;</span><span class="n">_cr</span>
</span></span><span class="line"><span class="cl">    <span class="p">;</span><span class="mi">4</span><span class="n">L</span><span class="o">|</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">CR</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_</span><span class="s2">&#34;L|1|&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">RetAck</span><span class="o">=$$</span><span class="n">Send</span><span class="p">(</span><span class="n">Labno</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="n">RetAck</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Send</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span>  <span class="p">;</span> <span class="n">send</span> <span class="n">list</span> <span class="n">of</span> <span class="n">orders</span> <span class="k">if</span> <span class="n">exists</span>
</span></span><span class="line"><span class="cl">  <span class="n">W</span> <span class="n">enq</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">S</span> <span class="n">ret</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">F</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span> <span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">)</span>  <span class="n">Q</span> 
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">:</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span><span class="p">:</span><span class="s2">&#34;ENQ&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">nak</span><span class="p">:</span><span class="s2">&#34;NAK&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">R</span><span class="p">),</span><span class="s2">&#34;1H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">enq</span> <span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="s1">&#39;=ack W eot,*-3 d Trace^MI.MIF000(mi,&#34;EOT&#34;,&#34;H--&gt;M&#34;) Q ret</span>
</span></span><span class="line"><span class="cl">  <span class="n">F</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">cr</span><span class="p">)</span> <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">temstr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">S</span> <span class="n">temstr</span><span class="o">=</span><span class="n">i_temstr</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">I</span> <span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="o">$</span><span class="n">L</span><span class="p">(</span><span class="n">temstr</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">247</span> <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">S</span> <span class="n">str1</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">241</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">str2</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">482</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">str2</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="mi">483</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">temstr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">S</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">s</span> <span class="n">temstr</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">S</span> <span class="n">temstr</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="n">_temstr</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">E</span>  <span class="n">D</span>
</span></span><span class="line"><span class="cl">  <span class="o">..</span><span class="n">S</span> <span class="n">ret</span><span class="o">=$$</span><span class="n">SEND</span><span class="p">(</span><span class="n">temstr</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">W</span> <span class="n">eot</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">Q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">SEND</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span>  <span class="p">;</span> <span class="n">send</span> <span class="n">string</span> <span class="n">to</span> <span class="n">instrument</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="n">flag</span><span class="o">=</span><span class="mi">1</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_etb</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">chsum</span><span class="o">=$$</span><span class="n">CHSUM</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">e</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="nb">str</span><span class="o">=</span><span class="n">str_cr_etx</span>
</span></span><span class="line"><span class="cl">  <span class="o">.</span><span class="n">s</span> <span class="n">chsum</span><span class="o">=$$</span><span class="n">CHSUM</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">W</span> <span class="n">stx</span><span class="p">,</span><span class="nb">str</span><span class="p">,</span><span class="n">chsum</span><span class="p">,</span><span class="n">cr</span><span class="p">,</span><span class="n">lf</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">stx_str_chsum_cr_lf</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">F</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span> <span class="n">R</span> <span class="o">*</span><span class="n">R</span><span class="p">:</span><span class="mi">1</span> <span class="n">I</span> <span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span><span class="p">)</span><span class="o">!</span><span class="p">(</span><span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span><span class="p">)</span> <span class="n">Q</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">ack</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span> <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=</span><span class="n">eot</span> <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;EOT&#34;</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span> <span class="n">Q</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="n">I</span> <span class="o">$</span><span class="n">c</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span> <span class="n">W</span> <span class="n">nak</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="s2">&#34;H&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">Q</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">CHSUM</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="p">;</span> <span class="n">calculate</span> <span class="n">check</span> <span class="n">sum</span>
</span></span><span class="line"><span class="cl">  <span class="n">n</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">s</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span> <span class="n">f</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">s</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="o">+$</span><span class="n">a</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">z</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="s2">&#34;0123456789ABCDEF&#34;</span><span class="p">,</span><span class="n">z</span><span class="c1">#256\16+1)_$e(&#34;0123456789ABCDEF&#34;,z#16+1)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="n">z</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">ACK</span>  <span class="p">;</span> <span class="n">send</span> <span class="s1">&#39;ack&#39;</span> <span class="n">to</span> <span class="n">instrument</span>
</span></span><span class="line"><span class="cl">  <span class="n">w</span> <span class="n">ack</span><span class="p">,</span><span class="o">*-</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">  <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="s2">&#34;ACK&#34;</span><span class="p">,</span><span class="s2">&#34;H--&gt;M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="n">NEXTTRAY</span><span class="p">(</span><span class="n">tray</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="n">tray</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="o">///</span>  
</span></span><span class="line"><span class="cl"><span class="n">GetSpecType</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">VisitNumberDR</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">;</span><span class="n">s</span> <span class="n">RetVal</span><span class="o">=</span><span class="s2">&#34;SE&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">RetVal</span><span class="o">=</span><span class="s2">&#34;Serum&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">SpecimenDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">),</span><span class="mi">56</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">s</span> <span class="n">SpecimenName</span> <span class="o">=</span> <span class="o">$</span><span class="n">s</span><span class="p">(</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpecimenDR</span><span class="p">):</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpecimenD</span><span class="p">(</span><span class="n">SpecimenDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">),</span><span class="mi">1</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="n">SpecimenName</span><span class="p">[</span><span class="s2">&#34;è¡€&#34;</span> <span class="n">s</span> <span class="n">RetVal</span><span class="o">=</span><span class="s2">&#34;Serum&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="n">SpecimenName</span><span class="p">[</span><span class="s2">&#34;å°¿&#34;</span> <span class="n">s</span> <span class="n">RetVal</span><span class="o">=</span><span class="s2">&#34;Urine&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="n">i</span> <span class="n">SpecimenName</span><span class="p">[</span><span class="s2">&#34;è¡€æµ†&#34;</span> <span class="n">s</span> <span class="n">RetVal</span><span class="o">=</span><span class="s2">&#34;Plasma&#34;</span>	<span class="o">//</span><span class="n">YHR</span> <span class="mi">20230929</span> <span class="err">å¢åŠ è¡€æµ†ä»£ç </span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="n">RetVal</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">Log</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">N</span> <span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">mi</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">info</span><span class="o">=$</span><span class="n">G</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$L(mi) 1</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span><span class="p">:</span><span class="s1">&#39;$D(^TMIF(mi)) 1</span>
</span></span><span class="line"><span class="cl">	<span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="s2">&#34;DEBUG&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="n">curDate</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">curTime</span><span class="o">=$</span><span class="n">P</span><span class="p">(</span><span class="o">$</span><span class="n">H</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">S</span> <span class="o">^</span><span class="n">TMPSIMENS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">curDate</span><span class="p">,</span><span class="n">curTime</span><span class="p">)</span><span class="o">=</span><span class="n">info</span>
</span></span><span class="line"><span class="cl">	<span class="n">Q</span> <span class="mi">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é€šè¿‡æ•°æ®åº“ä¸»åŠ¨ä¸Šä¼ ">é€šè¿‡æ•°æ®åº“ä¸»åŠ¨ä¸Šä¼ 
</h3><h4 id="odbcè¿æ¥æ•°æ®åº“å›æ’æ•°æ®">ODBCè¿æ¥æ•°æ®åº“å›æ’æ•°æ®
</h4><h5 id="ç¤ºä¾‹ä»£ç dl96a">ç¤ºä¾‹ä»£ç (DL96A)
</h5><blockquote>
<p>é€šè¿‡æ•°æ®åº“è¿æ¥ï¼Œåœ¨QryLabInfoä¸­æ‹¼ä¸²sqlè¯­å¥.Insert into liscontroller.lis_application (SPEC_NUM,BTBarcode,ASTBarcode,PATIENT_ID,MSPosition,PatientNo,FULL_NAME,FIRST_NAME,LAST_NAME,Birth,AGE,SEX,Purpose,WARD,Specimen,BedNo,Diagnosis,SpRequest,Medication,SuspectedBact,Doctor,AdviceNo,ApplyDate,SendDate,Collector,SPEC_DATE,CollectPosition,IdResult,Updated,UpdateDate,CARSS_ReadDate,StainType,StructVersion) values<br>
&hellip;//(&lsquo;9999&rsquo;,&lsquo;NULL&rsquo;,&lsquo;NULL&rsquo;,&lsquo;199732&rsquo;,&lsquo;NULL&rsquo;,&rsquo; &lsquo;,&lsquo;æµ‹è¯•&rsquo;,&lsquo;NULL&rsquo;,&lsquo;NULL&rsquo;,&rsquo;&rsquo;,&lsquo;85y&rsquo;,&lsquo;f&rsquo;,&lsquo;æ™®é€šç»†èŒåŸ¹å…»+è¯æ•&rsquo;,&lsquo;ä¸‰ç—…å®¤&rsquo;,&lsquo;ç—°&rsquo;,&lsquo;3&rsquo;,&rsquo; &lsquo;,&rsquo; &lsquo;,&rsquo; &lsquo;,&rsquo; &lsquo;,&lsquo;åˆ˜äº‘&rsquo;,&rsquo; &lsquo;,&lsquo;NULL&rsquo;,&lsquo;2024/6/28 9:17&rsquo;,&lsquo;è°¢è‰³çº¢&rsquo;,&lsquo;2024/6/29 11:17&rsquo;,&rsquo; &lsquo;,&lsquo;NULL&rsquo;,&lsquo;0&rsquo;,&lsquo;NULL&rsquo;,&lsquo;NULL&rsquo;,&lsquo;NULL&rsquo;,&lsquo;NULL&rsquo;)</p></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">///</span> <span class="p">[{</span><span class="s2">&#34;MachID&#34;</span><span class="p">:</span><span class="s2">&#34;#RowID&#34;</span><span class="p">,</span><span class="s2">&#34;Type&#34;</span><span class="p">:</span><span class="s2">&#34;DataBase&#34;</span><span class="p">,</span><span class="s2">&#34;UpTime&#34;</span><span class="p">:</span><span class="s2">&#34;3000&#34;</span><span class="p">,</span><span class="s2">&#34;Address&#34;</span><span class="p">:</span><span class="s2">&#34;DSN=DL96A&#34;</span><span class="p">,</span><span class="s2">&#34;UpCDF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;UpREF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;DealProcess&#34;</span><span class="p">:</span><span class="s2">&#34;MI.MIFDL96A&#34;</span><span class="p">,</span><span class="s2">&#34;Para&#34;</span><span class="p">:</span><span class="s2">&#34;SELECT * FROM lis_result  WHERE DATE(UpdateDate) = CURDATE()#ID#&#34;</span><span class="p">,</span><span class="s2">&#34;PreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoM,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UPPreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoM,PreDeal&#34;</span><span class="p">}]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="p">[{</span><span class="s2">&#34;MachID&#34;</span><span class="p">:</span><span class="s2">&#34;#RowID&#34;</span><span class="p">,</span><span class="s2">&#34;Type&#34;</span><span class="p">:</span><span class="s2">&#34;DataBase&#34;</span><span class="p">,</span><span class="s2">&#34;UpTime&#34;</span><span class="p">:</span><span class="s2">&#34;3000&#34;</span><span class="p">,</span><span class="s2">&#34;Address&#34;</span><span class="p">:</span><span class="s2">&#34;DSN=DL96a&#34;</span><span class="p">,</span><span class="s2">&#34;UpCDF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;UpREF&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="s2">&#34;DealProcess&#34;</span><span class="p">:</span><span class="s2">&#34;MI.MIFDL96A2&#34;</span><span class="p">,</span><span class="s2">&#34;Para&#34;</span><span class="p">:</span><span class="s2">&#34;SELECT * FROM lis_result  WHERE DATE(UpdateDate) = CURDATE()#ID#&#34;</span><span class="p">,</span><span class="s2">&#34;PreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoM,PreDeal&#34;</span><span class="p">,</span><span class="s2">&#34;UPPreDealClass&#34;</span><span class="p">:</span><span class="s2">&#34;PreDeal.DealDemoM,PreDeal&#34;</span><span class="p">}]</span>
</span></span><span class="line"><span class="cl"><span class="n">Class</span> <span class="n">MI</span><span class="o">.</span><span class="n">MIFDL96A</span> <span class="n">Extends</span> <span class="o">%</span><span class="n">RegisteredObject</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">D</span> <span class="c1">##class(MI.MIFDL96E02).fileMTHD(&#34;22&#34;,&#34;4185~33122416~~~â–¡è‚ºç‚é“¾çƒèŒ(S.pneumoniae)â–¡G+çƒèŒâ–¡â–¡[spn]â–¡(ä¼˜åŠ¿èŒ2)~~~~~A;PEN;;ï¼8;è€è¯;;B;CLI;;â‰¥8;è€è¯;;A;SXT;;â‰¥8/152;è€è¯;;B;CRO;;ï¼1;æ•æ„Ÿ;;A;ERY;;â‰¥16;è€è¯;;B;VA;;â‰¤1;æ•æ„Ÿ;;B;LEV;;ï¼2;æ•æ„Ÿ;;B;TET;;ï¼32;è€è¯;;B;MRP;;â‰¤0.25;æ•æ„Ÿ;;C;CXM;;â‰¥4;è€è¯;;C;RIF;;â‰¤0.5;æ•æ„Ÿ;;C;AMC;;â‰¤1.0/0.5;æ•æ„Ÿ;;C;LNZ;;â‰¤2;æ•æ„Ÿ;;~~~~~å¯¹å·¦æ°§æ°Ÿæ²™æ˜Ÿæ•æ„Ÿçš„èŒæ ªå¯é¢„æŠ¥å…¶å¯¹å‰ç±³æ²™æ˜Ÿå’Œè«è¥¿æ²™æ˜Ÿæ•æ„Ÿã€‚[13][10]å¯¹å››ç¯ç´ æ•æ„Ÿçš„èŒæ ªå¯¹å¤šè¥¿ç¯ç´ å’Œç±³è¯ºç¯ç´ ä¹Ÿæ•æ„Ÿã€‚[13][10]åˆ©ç¦å¹³ä¸å•ç‹¬ç”¨äºæŠ—èŒæ²»ç–—ã€‚[13][10]çº¢éœ‰ç´ å¯é¢„æŠ¥é˜¿å¥‡éœ‰ç´ ã€å…‹æ‹‰éœ‰ç´ å’Œåœ°çº¢éœ‰ç´ çš„æ•æ„Ÿå’Œè€è¯æ€§ã€‚[13][10]~~~~æ™®é€šç»†èŒåŸ¹å…»+è¯æ•~2020-12-25â–¡8:33:23~2020-12-27â–¡8:33:23~1~&#34;,&#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;, &#34;&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">fileMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(record) q </span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ItemDeli</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">92</span><span class="p">)</span> 				<span class="o">//</span><span class="err">é¡¹ç›®åˆ†éš”ç¬¦</span><span class="mi">92</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">ResultDeli</span><span class="o">=$</span><span class="n">c</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span> 			<span class="o">//</span><span class="err">ç»“æœåˆ†éš”ç¬¦</span><span class="mi">44</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">AntDeli</span><span class="o">=</span><span class="s2">&#34;]&#34;</span> 					<span class="o">//</span><span class="err">æŠ—ç”Ÿç´ åˆ†éš”ç¬¦</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">SenDeli</span><span class="o">=</span><span class="s2">&#34;[&#34;</span> 					<span class="o">//</span><span class="err">è¯æ•ç»“æœåˆ†éš”ç¬¦</span><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;record&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">surname</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">res</span><span class="p">,</span><span class="n">fresult</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">xBugs</span><span class="p">,</span><span class="n">AntLIST</span><span class="p">,</span><span class="n">expertRules</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">å¤„ç†é˜´æ€§ç»“æœ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;~&#34;</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">code</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">   	<span class="o">//</span><span class="mi">7417</span><span class="o">~</span><span class="mi">6987</span><span class="o">~</span><span class="mi">3259</span><span class="o">~</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="o">*</span><span class="err">â–¡</span><span class="o">|~</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="o">*</span><span class="err">â–¡</span><span class="o">|~~</span><span class="err">â–¡</span><span class="p">,</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="err">å¤§è‚ åŸƒå¸ŒèŒ</span><span class="p">(</span><span class="n">Escherichia</span><span class="err">â–¡</span><span class="n">Coli</span><span class="p">),</span><span class="n">eco</span><span class="p">,</span><span class="o">-</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="err">â–¡</span><span class="o">|~~</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">AMP</span><span class="p">,</span><span class="err">â‰¥</span><span class="mi">32</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">&amp;</span><span class="mi">16</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">32</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">GEN</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">2</span><span class="o">&amp;</span><span class="mi">4</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">8</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">SAM</span><span class="p">,</span><span class="mi">16</span><span class="o">/</span><span class="mi">8</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">/</span><span class="mi">4</span><span class="o">&amp;</span><span class="mi">16</span><span class="o">/</span><span class="mi">8</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">32</span><span class="o">/</span><span class="mi">16</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">TZP</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">4</span><span class="o">/</span><span class="mi">4</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">16</span><span class="o">/</span><span class="mi">4</span><span class="o">&amp;</span><span class="mi">32</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span><span class="mi">4</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">128</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CSL</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">/</span><span class="mi">4</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">O</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">16</span><span class="o">/</span><span class="mi">8</span><span class="o">&amp;</span><span class="mi">32</span><span class="o">/</span><span class="mi">16</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">64</span><span class="o">/</span><span class="mi">32</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CCV</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CTC</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CZO</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">2</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">2</span><span class="o">&amp;</span><span class="mi">4</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">8</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">FEP</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.12</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">2</span><span class="o">&amp;</span><span class="mi">4</span><span class="o">-</span><span class="mi">8</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">16</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">FOX</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">&amp;</span><span class="mi">16</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">32</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CXM</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">4</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">&amp;</span><span class="mi">16</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">32</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CXM</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">4</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">4</span><span class="o">&amp;</span><span class="mi">8</span><span class="o">-</span><span class="mi">16</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">32</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">LVX</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.12</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.5</span><span class="o">&amp;</span><span class="mi">1</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">2</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">SXT</span><span class="p">,</span><span class="err">â‰¥</span><span class="mi">8</span><span class="o">/</span><span class="mi">152</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">2</span><span class="o">/</span><span class="mi">38</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">4</span><span class="o">/</span><span class="mi">76</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CTX</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.12</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="o">&amp;</span><span class="mi">2</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">4</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">IPM</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.25</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="o">&amp;</span><span class="mi">2</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">4</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CAZ</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.5</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">4</span><span class="o">&amp;</span><span class="mi">8</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">16</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">CHL</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">&amp;</span><span class="mi">16</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">32</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">MEM</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.06</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="o">&amp;</span><span class="mi">2</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">4</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">AMK</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">4</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">4</span><span class="o">&amp;</span><span class="mi">8</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">16</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">NIT</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">16</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">32</span><span class="o">&amp;</span><span class="mi">64</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">128</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">ETP</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.015</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.5</span><span class="o">&amp;</span><span class="mi">1</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">2</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">MNO</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">O</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">4</span><span class="o">&amp;</span><span class="mi">8</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">16</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">TGC</span><span class="p">,</span><span class="err">â‰¤</span><span class="mf">0.25</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="o">&amp;</span><span class="mi">2</span><span class="o">&amp;&gt;</span><span class="mi">2</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">POL</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">1</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">O</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â‰¤</span><span class="mi">2</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">4</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">AZM</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="p">,</span><span class="n">Y</span><span class="o">|~</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">MDR</span><span class="o">|~</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="o">*</span><span class="n">MDR</span><span class="err">ï¼šå¤šé‡è€è¯èŒæ ªã€‚</span><span class="o">*</span><span class="err">å¤´å­¢è¥¿ä¸çš„æŠ˜ç‚¹åŸºäºè‡³å°‘</span><span class="mi">8</span><span class="n">g</span><span class="err">â–¡</span><span class="n">qdçš„ç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">å¤´å­¢å¡è‚Ÿçš„æ•æ„ŸæŠ˜ç‚¹åŸºäº</span><span class="mi">1</span><span class="n">g</span><span class="err">â–¡</span><span class="n">q12hçš„ç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">äºšèƒºåŸ¹å—çš„æŠ˜ç‚¹åŸºäº</span><span class="mi">500</span><span class="n">mg</span><span class="err">â–¡</span><span class="n">q6hæˆ–1g</span><span class="err">â–¡</span><span class="n">q8hçš„ç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">å„ä»–åŸ¹å—çš„æŠ˜ç‚¹åŸºäº</span><span class="mi">1</span><span class="n">g</span><span class="err">â–¡</span><span class="n">qdçš„ç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">å¤šé»èŒç´ </span><span class="n">Båº”ä¸ä¸€ç§æˆ–å¤šç§æ´»æ€§æŠ—ç”Ÿç´ è”åˆä½¿ç”¨</span><span class="err">ï¼Œå»ºè®®å’¨è¯¢æ„ŸæŸ“è¯Šæ²»ä¸“å®¶ã€‚</span><span class="o">*</span><span class="err">å¤´å­¢å‘‹è¾›ï¼ˆæ³¨å°„ï¼‰çš„æŠ˜ç‚¹åŸºäº</span><span class="mf">1.5</span><span class="n">g</span><span class="err">â–¡</span><span class="n">q8hçš„ç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">æ°¨è‹„è¥¿æ—çš„ç»“æœå¯ç”¨äºé¢„æŠ¥é˜¿è«è¥¿æ—çš„æ•æ„Ÿæ€§ã€‚</span><span class="o">*</span><span class="err">ç¯ä¸™æ²™æ˜ŸæŠ˜ç‚¹åŸºäºé™è„‰æ³¨å°„</span><span class="mi">400</span><span class="n">mg</span><span class="err">â–¡</span><span class="n">q12hæˆ–å£æœ500mg</span><span class="err">â–¡</span><span class="n">q12hç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">å¤šé»èŒç´ </span><span class="n">Båº”ç»™äºˆè´Ÿè·å‰‚é‡å’Œæœ€å¤§æ¨èå‰‚é‡</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">æ²»ç–—éå¤æ‚æ³Œå°¿é“ä»¥å¤–æ„ŸæŸ“çš„å¤´å­¢å”‘æ—æŠ˜ç‚¹æ˜¯åŸºäº</span><span class="mi">2</span><span class="n">g</span><span class="err">â–¡</span><span class="n">q8hçš„ç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">å¤´å­¢å™»è‚Ÿçš„æŠ˜ç‚¹åŸºäº</span><span class="mi">1</span><span class="n">g</span><span class="err">â–¡</span><span class="n">q8hçš„ç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">ç¾ç½—åŸ¹å—çš„æŠ˜ç‚¹åŸºäº</span><span class="mi">1</span><span class="n">g</span><span class="err">â–¡</span><span class="n">q8hçš„ç»™è¯æ–¹æ¡ˆ</span><span class="err">ã€‚</span><span class="o">*</span><span class="err">å¯¹äºè‚ºç‚å³ä½¿é»èŒç´ æˆ–å¤šé»èŒç´ </span><span class="n">Bå…¨èº«ç»™è¯</span><span class="err">ï¼Œäº¦å¾ˆå¯èƒ½æ— æ•ˆã€‚</span><span class="o">*</span><span class="err">æ­¤æŠ¥å‘Šé‡‡ç”¨çš„æŠ˜ç‚¹æ ‡å‡†æ¥æºä¸º</span><span class="n">CLSIM100</span><span class="err">â–¡</span><span class="mi">2023</span><span class="err">ï¼Œå…¶ä¸­æ›¿åŠ ç¯ç´ ä¸º</span><span class="n">EUCAST</span><span class="err">â–¡</span><span class="mi">2018</span><span class="err">ï¼Œå¤´å­¢å“Œé…®</span><span class="o">/</span><span class="err">èˆ’å·´å¦ä¸º</span><span class="n">CHINETæŠ€æœ¯è¦æ±‚</span><span class="err">â–¡</span><span class="mi">2022</span><span class="err">ï¼Œå“Œæ‹‰è¥¿æ—</span><span class="o">/</span><span class="err">ä»–å”‘å·´å¦ä¸º</span><span class="n">CLSIM100</span><span class="err">â–¡</span><span class="mi">2021</span><span class="err">ã€‚</span><span class="o">|~~~~~</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="mi">2024</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">23</span><span class="err">â–¡</span><span class="mi">09</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">15</span><span class="o">|~~~</span><span class="mi">1</span><span class="o">~</span><span class="mi">2024</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">23</span><span class="err">â–¡</span><span class="mi">10</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">54</span><span class="o">~</span><span class="err">â–¡</span><span class="o">~</span><span class="err">â–¡</span><span class="p">,</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="err">å¤§è‚ åŸƒå¸ŒèŒ</span><span class="p">(</span><span class="n">Escherichia</span><span class="err">â–¡</span><span class="n">Coli</span><span class="p">),</span><span class="n">eco</span><span class="p">,</span><span class="n">G</span><span class="o">-</span><span class="err">æ†èŒ</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="err">â–¡</span><span class="o">|~</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">MDR</span><span class="o">|~~~~</span>
</span></span><span class="line"><span class="cl">    <span class="o">///</span><span class="err">â–¡</span><span class="p">,</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="err">å¤§è‚ åŸƒå¸ŒèŒ</span><span class="p">(</span><span class="n">Escherichia</span><span class="err">â–¡</span><span class="n">Coli</span><span class="p">),</span><span class="n">eco</span><span class="p">,</span><span class="o">-</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="err">â–¡</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">///</span><span class="mi">7602</span><span class="o">~</span><span class="mi">0</span><span class="o">~</span><span class="mi">4786</span><span class="o">~~~~~</span><span class="p">,</span><span class="n">A2</span><span class="p">,</span><span class="err">å…½ç±»æ°”å•èƒèŒ</span><span class="p">(</span><span class="n">Aeromonas</span><span class="err">â–¡</span><span class="n">bestiarum</span><span class="p">),</span><span class="err">â–¡</span><span class="p">,</span><span class="mf">44.12</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="n">aer</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="err">â–¡</span><span class="o">|~~~~~~~~~~~</span><span class="mi">1</span><span class="o">~</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">06</span><span class="err">â–¡</span><span class="mi">16</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">22</span><span class="o">~~</span><span class="err">â–¡</span><span class="p">,</span><span class="err">â–¡</span><span class="p">,</span><span class="mi">4786</span><span class="o">+</span><span class="n">A2</span><span class="p">,</span><span class="err">å…½ç±»æ°”å•èƒèŒ</span><span class="p">(</span><span class="n">Aeromonas</span><span class="err">â–¡</span><span class="n">bestiarum</span><span class="p">),</span><span class="n">aer</span><span class="p">,</span><span class="o">-</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="err">â–¡</span><span class="o">|~~~~~</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">s</span> <span class="n">xBugs</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;~&#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="s2">&#34;(&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">xBugs</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;~&#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">xBugs</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">6</span> <span class="n">s</span> <span class="n">xBugs</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;~&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">xBugs</span><span class="p">,</span><span class="s2">&#34;xBugs&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">antStr</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;~&#34;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">expertRules</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">record</span><span class="p">,</span><span class="s2">&#34;~&#34;</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">s</span> <span class="n">expertRules</span><span class="o">=$</span><span class="n">replace</span><span class="p">(</span><span class="n">expertRules</span><span class="p">,</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="s2">&#34;$r$n&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">expertRules</span><span class="p">,</span><span class="s2">&#34;expertRules&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">expertRules</span><span class="p">[</span><span class="s2">&#34;*&#34;</span> <span class="n">s</span> <span class="n">expertRules</span><span class="o">=..</span><span class="n">RExpertRules</span><span class="p">(</span><span class="n">expertRules</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">^</span><span class="n">DL96A</span><span class="p">(</span><span class="s2">&#34;ZJGZ&#34;</span><span class="p">,</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">code</span><span class="p">)</span><span class="o">=</span><span class="n">expertRules</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">antStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="n">I</span><span class="o">-</span><span class="mi">01</span><span class="p">,</span><span class="mf">2E10405500</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">E2</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span><span class="n">AMP</span><span class="p">,</span><span class="err">â‰¥</span><span class="mi">32</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">ml</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">&amp;</span><span class="mi">16</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">32</span><span class="p">,</span><span class="n">Y</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="n">I</span><span class="o">-</span><span class="mi">2565</span><span class="p">,</span><span class="mi">2</span><span class="n">R10131374</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">STREP3</span><span class="p">,</span><span class="n">efa</span><span class="p">,</span><span class="n">AMP</span><span class="p">,</span><span class="o">=</span><span class="mf">0.5</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">mL</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">16</span><span class="p">,</span><span class="n">Y</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="n">efa</span><span class="p">,</span><span class="n">AMP</span><span class="p">,</span><span class="o">=</span><span class="mf">0.5</span><span class="err">Î¼</span><span class="n">g</span><span class="o">/</span><span class="n">mL</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="err">â‰¤</span><span class="mi">8</span><span class="o">&amp;</span><span class="err">â–¡</span><span class="o">&amp;</span><span class="err">â‰¥</span><span class="mi">16</span><span class="p">,</span><span class="n">Y</span><span class="o">|</span><span class="n">I</span><span class="o">-</span><span class="mi">2565</span><span class="p">,</span><span class="mi">2</span><span class="n">R10131374</span><span class="p">,</span><span class="n">DL</span><span class="o">-</span><span class="mi">120</span><span class="err">â–¡</span><span class="n">STREP3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">antList</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">antStr</span><span class="p">,</span><span class="s2">&#34;|&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">AntGroup</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">antList</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>  						<span class="o">//</span><span class="err">æŠ—ç”Ÿç´ åˆ†ç»„</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">xANT</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">antList</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span> <span class="n">q</span><span class="p">:</span><span class="n">xANT</span><span class="o">=</span><span class="s2">&#34;&#34;</span> 		<span class="o">//</span><span class="err">æŠ—ç”Ÿç´ </span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">xMIC</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">antList</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="s2">&#34;Î¼g/ml &#34;</span><span class="p">)</span> 			<span class="o">//</span><span class="n">MIC</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">xRES</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">antList</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="s2">&#34; &#34;</span><span class="p">)</span> 					<span class="o">//</span><span class="err">è€è¯</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">i</span> <span class="n">xRES</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">s</span> <span class="n">xRES</span><span class="o">=</span><span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">AntLIST</span><span class="o">=</span><span class="n">AntLIST_xANT_AntDeli_xRES_AntDeli_xMIC_AntDeli_AntDeli_AntGroup_SenDeli</span> 
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">AntLIST</span><span class="p">,</span><span class="s2">&#34;AntLIST&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">xBugs</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AntLIST</span><span class="p">)</span> <span class="n">d</span> 
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">fresult</span><span class="o">=</span><span class="n">xBugs_ItemDeli_AntLIST_ItemDeli_code_ResultDeli</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">fresult</span><span class="p">,</span><span class="s2">&#34;fresult&lt;--M&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(fresult) q 0</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(epis) q 0</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">Save</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">code_ItemDeli_xBugs_ItemDeli_ItemDeli_ItemDeli_ResultDeli</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">SaveAnt</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">epis</span><span class="p">,</span><span class="n">fresult</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">h</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">s</span> <span class="n">ret</span><span class="o">=..</span><span class="n">SaveZJGZ</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">expertRules</span><span class="p">)</span>   <span class="o">//</span><span class="err">å¯¹äºä¸“å®¶è§„åˆ™åœ¨åŒè¡¨çš„ï¼Œä¿è¯è¯æ•ç»“æœå…ˆå­˜ç”ŸæˆæŠ¥å‘Šï¼Œå†å­˜ä¸“å®¶è§„åˆ™</span> <span class="mi">0704</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">ret</span><span class="p">,</span><span class="s2">&#34;ä¸“å®¶è§„åˆ™ä¿å­˜ret&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">fresult</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">QC</span><span class="p">,</span><span class="n">AntLIST</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##class(MI.MIFDL96A2).RExpertRules(&#34;sadsa*da*dasds*sad &#34;)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="mi">20240802</span>    <span class="err">æ ¼å¼åŒ–ä¸“å®¶è§„åˆ™</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">RExpertRules</span><span class="p">(</span><span class="n">expertRules</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">expertRules</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">expertRules</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">expertRules</span><span class="p">[</span><span class="s2">&#34;*&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">expertRules</span><span class="o">=</span><span class="s2">&#34;1ã€&#34;</span><span class="n">_expertRules</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">f</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">expertRules</span><span class="p">,</span><span class="s2">&#34;*&#34;</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">expertRules</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">expertRules</span><span class="p">,</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_i_</span><span class="s2">&#34;ã€&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">expertRules</span><span class="p">,</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">expertRules</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">ä¿å­˜ä¸“å®¶è§„åˆ™</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="mi">20240704</span> 
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##class(MI.MIFDL96A2).SaveZJGZ(&#34;6633&#34;,&#34;40&#34;,1,&#34;å¤šé»èŒç´ Båº”ä¸ä¸€ç§æˆ–å¤šç§æ´»æ€§æŠ—ç”Ÿç´ è”åˆä½¿ç”¨ï¼Œå»ºè®®å’¨è¯¢æ„ŸæŸ“è¯Šæ²»ä¸“å®¶ã€‚*å¤´å­¢å™»è‚Ÿçš„æŠ˜ç‚¹åŸºäº1gâ–¡q8hçš„ç»™è¯æ–¹æ¡ˆã€‚*äºšèƒºåŸ¹å—çš„æŠ˜ç‚¹åŸºäº500mgâ–¡q6hæˆ–1gâ–¡q8hçš„ç»™è¯æ–¹æ¡ˆã€‚*ç¾ç½—åŸ¹å—çš„æŠ˜ç‚¹åŸºäº1gâ–¡q8hçš„ç»™è¯æ–¹æ¡ˆã€‚*å¤´å­¢å”‘å•‰çš„ç»“æœå¯é¢„æŠ¥éå¤æ‚æ€§çš„æ³Œå°¿ç³»ç»Ÿæ„ŸæŸ“çš„å¤§è‚ åŸƒå¸ŒèŒå¯¹å£æœå¤´å­¢æ‹‰å®šã€å¤´å­¢åœ°å°¼ã€å¤´å­¢å…‹ç½—ã€å¤´å­¢ä¸™çƒ¯ã€å¤´å­¢æ³Šè‚Ÿã€å¤´å­¢å‘‹è¾›çš„æ•æ„Ÿæ€§ã€‚*å¤´å­¢è¥¿ä¸çš„æŠ˜ç‚¹åŸºäºè‡³å°‘8gâ–¡qdçš„ç»™è¯æ–¹æ¡ˆã€‚*ä»…è‚ æ²™é—¨èŒä¼¤å¯’è¡€æ¸…å‹å’Œå¿—è´ºèŒå±å…·æœ‰é˜¿å¥‡éœ‰ç´ çš„ä¸´åºŠæ¨èæŠ˜ç‚¹ã€‚*æ°¨è‹„è¥¿æ—çš„ç»“æœå¯ç”¨äºé¢„æŠ¥é˜¿è«è¥¿æ—çš„æ•æ„Ÿæ€§ã€‚*ç¯ä¸™æ²™æ˜ŸæŠ˜ç‚¹åŸºäºé™è„‰æ³¨å°„400mgâ–¡q12hæˆ–å£æœ500mgâ–¡q12hç»™è¯æ–¹æ¡ˆã€‚*å¤´å­¢å¡è‚Ÿçš„æ•æ„ŸæŠ˜ç‚¹åŸºäº1gâ–¡q12hçš„ç»™è¯æ–¹æ¡ˆã€‚*å¤´å­¢å‘‹è¾›ï¼ˆæ³¨å°„ï¼‰çš„æŠ˜ç‚¹åŸºäº1.5gâ–¡q8hçš„ç»™è¯æ–¹æ¡ˆã€‚*æ²»ç–—éå¤æ‚æ³Œå°¿é“æ„ŸæŸ“çš„å¤´å­¢å”‘æ—æŠ˜ç‚¹æ˜¯åŸºäº1gâ–¡q12hçš„ç»™è¯æ–¹æ¡ˆã€‚*æ²»ç–—éå¤æ‚æ³Œå°¿é“ä»¥å¤–æ„ŸæŸ“çš„å¤´å­¢å”‘æ—æŠ˜ç‚¹æ˜¯åŸºäº2gâ–¡q8hçš„ç»™è¯æ–¹æ¡ˆã€‚*å¤šé»èŒç´ Båº”ç»™äºˆè´Ÿè·å‰‚é‡å’Œæœ€å¤§æ¨èå‰‚é‡ã€‚*å„ä»–åŸ¹å—çš„æŠ˜ç‚¹åŸºäº1gâ–¡qdçš„ç»™è¯æ–¹æ¡ˆã€‚*å¯¹äºè‚ºç‚å³ä½¿é»èŒç´ æˆ–å¤šé»èŒç´ Bå…¨èº«ç»™è¯ï¼Œäº¦å¾ˆå¯èƒ½æ— æ•ˆã€‚&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveZJGZ</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">isolate</span><span class="p">,</span> <span class="n">ExpertRules</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="o">^</span><span class="n">GYN</span><span class="p">(</span><span class="s2">&#34;Rule&#34;</span><span class="p">,</span><span class="n">epis</span><span class="p">)</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">epis</span><span class="p">,</span> <span class="n">mi</span><span class="p">,</span> <span class="n">isolate</span><span class="p">,</span> <span class="n">ExpertRules</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="o">//</span><span class="n">TestCodeDR</span> <span class="err">ç»†èŒä¸€ï¼Œç»†èŒäºŒï¼Œç»†èŒä¸‰</span> <span class="mi">570</span><span class="p">,</span><span class="mi">586</span><span class="p">,</span><span class="mi">575</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">ExpertRules</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ExpertRules</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">TestCodeDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="n">isolate</span><span class="o">=</span><span class="mi">1</span> <span class="n">s</span> <span class="n">TestCodeDR</span><span class="o">=</span><span class="mi">261</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(mi) q 0</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(epis) d Trace^MI.MIF000(mi,&#34;æµæ°´å·ä¸èƒ½ä¸ºç©º&#34;,&#34;ä¿å­˜æ£€æµ‹ç»“è®ºè¿”å›&#34;)  q 0</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æŠ¥å‘Šå¯èƒ½æ ¸æ”¶åˆ°å¾®ç”Ÿç‰©åŸ¹å…»çš„å››ä¸ªå°ç»„</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">WGM</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="o">$</span><span class="n">d</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexMicNo&#34;</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="n">_epis</span><span class="p">))</span> <span class="n">s</span> <span class="n">WGM</span><span class="o">=</span><span class="mi">15</span>
</span></span><span class="line"><span class="cl">	<span class="n">i</span> <span class="s1">&#39;$l(WGM) q 0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">sc</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">transmitDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">transmitDate</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexMicNo&#34;</span><span class="p">,</span><span class="n">WGM</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="n">_epis</span><span class="p">,</span><span class="n">transmitDate</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">transmitDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">s</span> <span class="n">ReportDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">ReportDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexMicNo&#34;</span><span class="p">,</span><span class="n">WGM</span><span class="p">,</span><span class="s2">&#34; &#34;</span><span class="n">_epis</span><span class="p">,</span><span class="n">transmitDate</span><span class="p">,</span><span class="n">ReportDR</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">ReportDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span> 
</span></span><span class="line"><span class="cl">	<span class="o">..//</span><span class="n">IndexReportItem</span> <span class="n">On</span> <span class="p">(</span><span class="n">VisitNumberReportDR</span><span class="p">,</span> <span class="n">TestCodeDR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="s1">&#39;$d(^dbo.RPVisitNumberReportResultI(&#34;IndexReportItem&#34;,ReportDR,TestCodeDR)) q</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">ResultDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportResultI</span><span class="p">(</span><span class="s2">&#34;IndexReportItem&#34;</span><span class="p">,</span><span class="n">ReportDR</span><span class="p">,</span><span class="n">TestCodeDR</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">objRep</span><span class="o">=</span><span class="c1">##Class(dbo.RPVisitNumberReportResult).%OpenId(ResultDR)</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">EXPRlues</span><span class="o">=</span><span class="n">objRep</span><span class="o">.</span><span class="n">ExpertRule</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="n">EXPRlues</span><span class="o">=</span><span class="n">ExpertRules</span> <span class="n">q</span>  <span class="o">//</span><span class="err">ä¸“å®¶è§„åˆ™ä¸å†å˜åŒ–ï¼Œä¸å­˜</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">objRep</span><span class="o">.</span><span class="n">ExpertRule</span><span class="o">=</span><span class="n">ExpertRules</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">s</span> <span class="n">sc</span><span class="o">=</span><span class="n">objRep</span><span class="o">.%</span><span class="n">Save</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="p">(</span><span class="s1">&#39;$SYSTEM.Status.IsOK(sc)) d Trace^MI.MIF000(mi,&#34;ä¿å­˜æ£€æµ‹ç»“è®ºå¤±è´¥&#34;,&#34;ä¿å­˜æ£€æµ‹ç»“è®ºå¤±è´¥è¿”å›&#34;) q</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">ExpertRules</span><span class="p">,</span><span class="s2">&#34;ä¿å­˜æ£€æµ‹ç»“è®ºæˆåŠŸè¿”å›&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="n">sc</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">D</span> <span class="c1">##class(MI.MIFDL96E02).SaveExpertRules(&#34;26&#34;, &#34;52772&#34;,&#34;ceshi&#34;, &#34;1&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveExpertRules</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">expertRules</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">expertRules</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">expertRules</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">code</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">WorkGroupMachineDR</span><span class="p">,</span><span class="n">AcceptDate</span><span class="p">,</span><span class="n">ReportDr</span><span class="p">,</span><span class="n">TestCodeDR</span><span class="p">,</span><span class="n">ReportResultDR</span><span class="p">,</span><span class="n">CodeDR</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">WorkGroupMachineDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">b</span> <span class="p">;</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AcceptDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AcceptDate</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexAcceptDate&#34;</span><span class="p">,</span><span class="n">WorkGroupMachineDR</span><span class="p">,</span><span class="n">AcceptDate</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">AcceptDate</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ReportDr</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">ReportDr</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexAcceptDate&#34;</span><span class="p">,</span><span class="n">WorkGroupMachineDR</span><span class="p">,</span><span class="n">AcceptDate</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(epis),ReportDr)) q:ReportDr=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">TestCodeDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">TestCodeDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportResultI</span><span class="p">(</span><span class="s2">&#34;IndexReportItem&#34;</span><span class="p">,</span><span class="n">ReportDr</span><span class="p">,</span><span class="n">TestCodeDR</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">TestCodeDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">ReportResultDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">ReportResultDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportResultI</span><span class="p">(</span><span class="s2">&#34;IndexReportItem&#34;</span><span class="p">,</span><span class="n">ReportDr</span><span class="p">,</span><span class="n">TestCodeDR</span><span class="p">,</span><span class="n">ReportResultDR</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">ReportResultDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">....</span><span class="n">s</span> <span class="n">CodeDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportResultD</span><span class="p">(</span><span class="n">ReportResultDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">....</span><span class="n">b</span> <span class="p">;</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl">    <span class="o">....</span><span class="n">i</span> <span class="p">(</span><span class="n">code</span><span class="o">+</span><span class="mi">655</span><span class="o">=</span><span class="n">CodeDR</span><span class="p">)</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.....//</span><span class="n">b</span> <span class="p">;</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="o">.....</span><span class="n">s</span> <span class="n">obj</span><span class="o">=</span><span class="c1">##Class(dbo.RPVisitNumberReportResult).%OpenId(ReportResultDR)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.....</span><span class="n">s</span> <span class="n">obj</span><span class="o">.</span><span class="n">ExpertRule</span><span class="o">=</span><span class="n">expertRules</span>
</span></span><span class="line"><span class="cl">    <span class="o">.....</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="n">obj</span><span class="o">.%</span><span class="n">Save</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">D</span> <span class="c1">##class(MI.MIFLISMonitorTest)SaveImageMTHD(&#34;7&#34;,&#34;9999&#34;, &#34;&#34;,&#34;175&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">epis</span><span class="err">ï¼šæµæ°´å·ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡åç§°ï¼Œè‡ªå·±åœ¨ä¿å­˜å‰æå–æµæ°´</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">ImageClass</span><span class="p">:</span><span class="err">å›¾ç‰‡ç±»åˆ«ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡åç§°ï¼Œè‡ªå·±åœ¨ä¿å­˜å‰æå–å›¾ç‰‡ç±»å‹</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">FileName</span><span class="p">:</span><span class="err">ä¿å­˜åœ¨æ–‡ä»¶æœåŠ¡çš„ç›¸å¯¹è·¯å¾„ï¼Œé»˜è®¤ä¸åŠ¨</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">FullName</span><span class="p">:</span><span class="err">æ–‡ä»¶å…¨è·¯å¾„ï¼Œå¦‚æœæ˜¯ç›‘å¬å›¾ç‰‡æ¨¡å¼è¯¥ä½ç½®æ”¾å›¾ç‰‡å…¨è·¯å¾„åç§°ï¼Œæ»¡è¶³æœ‰çš„å›¾ç‰‡åç§°æ— æ³•å¾—åˆ°æµæ°´å’Œå›¾ç‰‡ç±»åˆ«çš„æƒ…å†µ</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveImageMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">ImageClass</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FullName</span><span class="p">,</span> <span class="n">SaveImageRetName</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">é€šè¿‡</span><span class="n">OtherParaé…ç½®å–å›¾çš„åœ¨è¿™é‡Œé€šè¿‡episå’ŒImageClassçš„å›¾ç‰‡åå­—æå–å‡ºæµæ°´å·å’Œå›¾ç‰‡ç±»åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">epis</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ImageClass</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">ImageClass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FileName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">FileName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FullName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">FullName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SaveImageRetName</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">SaveImageRetName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="c1">##Class(MI.Common.MIFBase).Trace(mi,epis_&#34;:&#34;_ImageClass_&#34;:&#34;_FileName,&#34;H&lt;--M&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span> <span class="n">ImageOrder</span><span class="p">,</span> <span class="n">Caption</span><span class="p">,</span> <span class="n">DisplayRatio</span><span class="p">,</span> <span class="n">Height</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">åŠ ä¸Šå½“å‰æ—¶é—´ï¼Œé˜²æ­¢æµè§ˆå™¨ç¼“å­˜</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">FileName</span><span class="o">=</span><span class="n">FileName_</span><span class="s2">&#34;?&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">OtherParaç”¨</span><span class="o">^</span><span class="err">åˆ†éš”ç¬¬å››ä½æŒ‡å®š</span><span class="n">SaveImageRetNameçš„è¯åœ¨è¿™é‡Œæ”¹FileNameä¸ºæ–°åç§°</span><span class="err">ã€‚åŒæ—¶è®©æ–¹æ³•è¿”å›æ–°å›¾ç‰‡åå­—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">NewFileName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">SaveImageRetName</span><span class="o">=</span><span class="s2">&#34;SaveImageRetName&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="err">å›¾ç‰‡æ–°åå­—</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="p">;</span><span class="n">s</span> <span class="n">NewFileName</span><span class="o">=</span><span class="n">epis_</span><span class="s2">&#34;-&#34;</span><span class="n">_ImageClass_</span><span class="s2">&#34;-&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.//</span><span class="err">è·¯å¾„æ–°åå­—</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">NewPathName</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">SPLen</span><span class="o">=$</span><span class="n">l</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">f</span> <span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">SPLen</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">ii</span><span class="o">&lt;</span><span class="n">SPLen</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">NewPathName</span><span class="o">=</span><span class="n">NewPathName_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="n">ii</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">ii</span><span class="o">=</span><span class="n">SPLen</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">NewFileName</span><span class="o">=</span><span class="n">NewFileName_</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">,</span><span class="n">ii</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">NewPathName</span><span class="o">=</span><span class="n">NewPathName_NewFileName</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">FileName</span><span class="o">=</span><span class="n">NewPathName</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æœ€åè¿”å›</span><span class="n">NewFileName</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.Common.MachineResult).SaveImage(ReceiveDate, epis, ImageClass, ImageOrder, FileName, mi, Caption, DisplayRatio, Height, Width, Sequence)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è¿”å›å€¼æ§åˆ¶å›¾ç‰‡åç§°æ¨¡å¼</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">SaveImageRetName</span><span class="o">=</span><span class="s2">&#34;SaveImageRetName&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="n">NewFileName</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">è¿”å›ç»™ç›‘å¬å½“å‰ä¸Šä¼ æ–‡ä»¶è·¯å¾„åç§°ï¼Œé»˜è®¤ä¸è¦åŠ¨</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##class(MI.MIFLISMonitorTest).GetFtpMTHD(&#34;7&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">mi</span><span class="p">:</span><span class="err">ä»ªå™¨</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetFtpMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">//</span><span class="err">æ–‡ä»¶æœåŠ¡æ¨¡å¼å¿…é¡»æ”¹çš„åœ°æ–¹ï¼Œè€çš„</span><span class="n">FTPæ¨¡å¼è¿™ä¹ˆæ”¹äº†ä¹Ÿæ²¡é—®é¢˜</span><span class="err">ï¼Œæ‰€ä»¥å»ºè®®éƒ½è¿™æ ·</span>
</span></span><span class="line"><span class="cl">	<span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">q</span> <span class="c1">##Class(MI.Common.MIFBase).GetMiFtpPath(mi)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Creator</span><span class="err">ï¼š</span>      <span class="err">æŸ¥è¯¢æ‚£è€…ä¿¡æ¯ï¼Œç›‘å¬é…ç½®ä¸Šä¼ å‰å¤„ç†ç±»åä¼šå®šæ—¶è°ƒç”¨è¿™ä¸ª</span><span class="n">queryæŸ¥è¯¢æ•°æ®è¿›è¡Œä¸Šä¼ æ“ä½œ</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">CreatDate</span><span class="err">ï¼š</span>    <span class="mi">20140919</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Description</span><span class="p">:</span><span class="err">ï¼š</span> 
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Table</span><span class="err">ï¼š</span>    
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="ne">Input</span><span class="err">ï¼š</span>        <span class="n">mi</span><span class="err">ï¼šä»ªå™¨ä¸»é”®</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Output</span><span class="err">ï¼š</span>       <span class="err">ä»ªå™¨ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Return</span><span class="err">ï¼š</span>       <span class="err">ä»ªå™¨ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Others</span><span class="err">ï¼š</span>   
</span></span><span class="line"><span class="cl"><span class="n">Query</span> <span class="n">QryLabInfo</span><span class="p">(</span><span class="n">mi</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Query</span><span class="p">(</span><span class="n">ROWSPEC</span> <span class="o">=</span> <span class="s2">&#34;labno,labnoInfo,patInfo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">Queryçš„æ‰§è¡Œæ–¹æ³•</span>
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">d</span> <span class="c1">##class(%ResultSet).RunQuery(&#34;MI.MIFDL96A&#34;,&#34;QryLabInfo&#34;,&#34;56&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoExecute</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">,</span> <span class="n">mi</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">,</span> <span class="n">P1</span><span class="p">,</span> <span class="n">P2</span><span class="p">,</span> <span class="n">P3</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">i</span><span class="p">(</span><span class="o">^</span><span class="n">CacheTemp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">flag</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">LabnoList</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æ§åˆ¶è¾“å‡º</span><span class="n">Excel</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutFileInfo(&#34;D:\\OUT\\ä¸Šä¼ .xls&#34;,&#34;å¼ ä¸‰[0][1]ç”·[0][1]28å²[0][1]&#34;_$h,&#34;900001&#34;,&#34;1&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">Set</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æ§åˆ¶è¾“å‡º</span><span class="n">Excel</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æŸ¥æœ€è¿‘</span><span class="mi">8</span><span class="err">å¤©</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddDate</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate)) q:AddDate=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">AddTime</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">AddTime</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate,AddTime)) q:AddTime=&#34;&#34;  d</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="mi">20</span><span class="err">ç§’ä»¥å†…çš„å…ˆä¸ä¸Šä¼ ï¼Œé˜²æ­¢æ²¡æ¥æ”¶å®Œ</span>
</span></span><span class="line"><span class="cl">	<span class="o">..</span><span class="n">i</span> <span class="p">(</span><span class="n">AddDate</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)),((</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">AddTime</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">)</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">MiUploadDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadI</span><span class="p">(</span><span class="s2">&#34;IndexSendStatus&#34;</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(&#34;C&#34;),AddDate,AddTime,&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">labno</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="s1">&#39;$l(labno) q</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">å¾—åˆ°é€šé“å·</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">chl</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPMachineUploadD</span><span class="p">(</span><span class="n">MiUploadDR</span><span class="p">)),</span><span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">æµ‹è¯•ç±»å‹</span><span class="mi">0</span><span class="err">ï¼šæ–‡æœ¬ï¼Œ</span><span class="mi">1</span><span class="err">ï¼šæ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">s</span> <span class="n">TestType</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">TestType</span><span class="o">=</span><span class="s2">&#34;0&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="err">æ–‡æœ¬åŒå‘ä¸Šä¼ å¼€å§‹</span><span class="o">******************************************************</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="err">æ§åˆ¶è¾“å‡ºæ–‡æœ¬çš„å†…å®¹</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">txtInfo</span><span class="o">=</span><span class="n">labno_</span><span class="s2">&#34;^&#34;</span><span class="n">_chl</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutFileInfo($zd($h,8)_labno_&#34;.order&#34;,txtInfo,labno,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">labno</span><span class="o">=</span><span class="n">labnoOld_</span><span class="s2">&#34;^&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_labno_</span><span class="s2">&#34;.ok&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutFileInfo($zd($h,8)_labno_&#34;.ok&#34;,txtInfo,labno,&#34;&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="err">æ–‡æœ¬åŒå‘ä¸Šä¼ ç»“æŸ</span><span class="o">******************************************************</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="o">..</span><span class="n">i</span> <span class="n">TestType</span><span class="o">=</span><span class="s2">&#34;1&#34;</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="err">æ•°æ®åº“åŒå‘ä¸Šä¼ å¼€å§‹</span><span class="o">******************************************************</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="err">æ§åˆ¶æ‰§è¡Œ</span><span class="n">sql</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="n">Insert</span> <span class="n">into</span> <span class="n">liscontroller</span><span class="o">.</span><span class="n">lis_application</span> <span class="p">(</span><span class="n">SPEC_NUM</span><span class="p">,</span><span class="n">BTBarcode</span><span class="p">,</span><span class="n">ASTBarcode</span><span class="p">,</span><span class="n">PATIENT_ID</span><span class="p">,</span><span class="n">MSPosition</span><span class="p">,</span><span class="n">PatientNo</span><span class="p">,</span><span class="n">FULL_NAME</span><span class="p">,</span><span class="n">FIRST_NAME</span><span class="p">,</span><span class="n">LAST_NAME</span><span class="p">,</span><span class="n">Birth</span><span class="p">,</span><span class="n">AGE</span><span class="p">,</span><span class="n">SEX</span><span class="p">,</span><span class="n">Purpose</span><span class="p">,</span><span class="n">WARD</span><span class="p">,</span><span class="n">Specimen</span><span class="p">,</span><span class="n">BedNo</span><span class="p">,</span><span class="n">Diagnosis</span><span class="p">,</span><span class="n">SpRequest</span><span class="p">,</span><span class="n">Medication</span><span class="p">,</span><span class="n">SuspectedBact</span><span class="p">,</span><span class="n">Doctor</span><span class="p">,</span><span class="n">AdviceNo</span><span class="p">,</span><span class="n">ApplyDate</span><span class="p">,</span><span class="n">SendDate</span><span class="p">,</span><span class="n">Collector</span><span class="p">,</span><span class="n">SPEC_DATE</span><span class="p">,</span><span class="n">CollectPosition</span><span class="p">,</span><span class="n">IdResult</span><span class="p">,</span><span class="n">Updated</span><span class="p">,</span><span class="n">UpdateDate</span><span class="p">,</span><span class="n">CARSS_ReadDate</span><span class="p">,</span><span class="n">StainType</span><span class="p">,</span><span class="n">StructVersion</span><span class="p">)</span> <span class="n">values</span> 
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="p">(</span><span class="s1">&#39;9999&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;199732&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;æµ‹è¯•&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;85y&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;æ™®é€šç»†èŒåŸ¹å…»+è¯æ•&#39;</span><span class="p">,</span><span class="s1">&#39;ä¸‰ç—…å®¤&#39;</span><span class="p">,</span><span class="s1">&#39;ç—°&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;åˆ˜äº‘&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;2024/6/28 9:17&#39;</span><span class="p">,</span><span class="s1">&#39;è°¢è‰³çº¢&#39;</span><span class="p">,</span><span class="s1">&#39;2024/6/29 11:17&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">,</span><span class="s1">&#39;NULL&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">PatInfo</span><span class="o">=..</span><span class="n">GetPatInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;PatInfo&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">01</span> <span class="mi">16</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mi">48</span><span class="p">,</span><span class="n">Mejer600</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">2406290091</span><span class="p">,,,</span><span class="n">mnwk</span><span class="o">-</span><span class="err">æ³Œå°¿å¤–ç§‘</span><span class="p">,</span><span class="err">åˆ˜ä¹</span><span class="p">,</span><span class="err">å”äº‘</span><span class="p">,</span><span class="mi">0000628089</span><span class="p">,</span><span class="err">å‘¨ç”°é¦™</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="err">ä½é™¢</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">43</span><span class="p">,,</span><span class="mi">2406290091</span><span class="p">,</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">29</span> <span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">,,,,,</span><span class="err">è‚¾ç§¯æ°´ä¼´è‚¾è¾“å°¿ç®¡ç»“çŸ³</span><span class="p">,,,,</span><span class="mi">2024</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">29</span> <span class="mi">06</span><span class="p">:</span><span class="mi">48</span><span class="p">,,</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">EPIS</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>   <span class="o">//</span><span class="err">é‰´å®šå·</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">DTTime</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">32</span><span class="p">)</span>   <span class="o">//</span><span class="err">æ ¸æ”¶æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Name</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>   <span class="o">//</span><span class="err">å§“å</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Sex</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>   <span class="o">//</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;1&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;m&#34;</span> 
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;2&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;f&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>   <span class="o">//</span><span class="err">å¹´é¾„</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">MediNo</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">29</span><span class="p">)</span>   <span class="o">//</span><span class="err">ç—…æ¡ˆå·</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Location</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>   <span class="o">//</span><span class="err">ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">i</span> <span class="n">Location</span><span class="p">[</span><span class="s2">&#34;-&#34;</span> <span class="n">s</span> <span class="n">Location</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">Location</span><span class="p">,</span><span class="s2">&#34;-&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">//</span><span class="n">jzwkszwk</span><span class="o">-</span><span class="err">è„ŠæŸ±å¤–ç§‘</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Speciman</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>   <span class="o">//</span><span class="err">æ ‡æœ¬ç±»å‹</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>   <span class="o">//</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Doctor</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>   <span class="o">//</span><span class="err">åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">CollectUser</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">PatInfo</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>   <span class="o">//</span><span class="err">é‡‡é›†è€…</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="n">s</span> <span class="n">DTTime</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">,</span><span class="s2">&#34;/&#34;</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>  <span class="o">//</span><span class="mi">2024</span><span class="o">/</span><span class="mi">6</span><span class="o">/</span><span class="mi">28</span> <span class="mi">9</span><span class="p">:</span><span class="mi">17</span>   <span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s2">&#34;:&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">*-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">SqlStr</span><span class="o">=</span><span class="s2">&#34;Insert into liscontroller.lis_application (SPEC_NUM,BTBarcode,ASTBarcode,PATIENT_ID,MSPosition,PatientNo,FULL_NAME,FIRST_NAME,LAST_NAME,Birth,AGE,SEX,Purpose,WARD,Specimen,BedNo,Diagnosis,SpRequest,Medication,SuspectedBact,Doctor,AdviceNo,ApplyDate,SendDate,Collector,SPEC_DATE,CollectPosition,IdResult,Updated,UpdateDate,CARSS_ReadDate,StainType,StructVersion) values &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">ValueStr</span><span class="o">=</span><span class="s2">&#34;(&#39;&#34;</span><span class="n">_EPIS_</span><span class="s2">&#34;&#39;,&#39;NULL&#39;,&#39;NULL&#39;,&#39;&#34;</span><span class="n">_MediNo_</span><span class="s2">&#34;&#39;,&#39;NULL&#39;,&#39; &#39;,&#39;&#34;</span><span class="n">_Name_</span><span class="s2">&#34;&#39;,&#39;NULL&#39;,&#39;NULL&#39;,&#39;&#39;,&#39;&#34;</span><span class="n">_Age_</span><span class="s2">&#34;&#39;,&#39;&#34;</span><span class="n">_Sex_</span><span class="s2">&#34;&#39;,&#39;æ™®é€šç»†èŒåŸ¹å…»+è¯æ•&#39;,&#39;&#34;</span><span class="n">_Location_</span><span class="s2">&#34;&#39;,&#39;&#34;</span><span class="n">_Speciman_</span><span class="s2">&#34;&#39;,&#39;&#34;</span><span class="n">_BedNo_</span><span class="s2">&#34;&#39;,&#39; &#39;,&#39; &#39;,&#39; &#39;,&#39; &#39;,&#39;&#34;</span><span class="n">_Doctor_</span><span class="s2">&#34;&#39;,&#39; &#39;,&#39;NULL&#39;,&#39;&#34;</span><span class="n">_DTTime_</span><span class="s2">&#34;&#39;,&#39;&#34;</span><span class="n">_CollectUser_</span><span class="s2">&#34;&#39;,&#39;&#34;</span><span class="n">_DTTime_</span><span class="s2">&#34;&#39;,&#39; &#39;,&#39;NULL&#39;,&#39;0&#39;,&#39;NULL&#39;,&#39;NULL&#39;,&#39;NULL&#39;,&#39;NULL&#39;)&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">SqlStr</span><span class="o">=</span><span class="n">SqlStr_ValueStr</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">d</span> <span class="n">Trace</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">SqlStr</span><span class="p">,</span><span class="s2">&#34;SqlStr&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="o">^</span><span class="n">DL96</span><span class="p">(</span><span class="s2">&#34;Send&#34;</span><span class="p">,</span><span class="o">+$</span><span class="n">h</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>  <span class="o">//</span><span class="err">ä¸Šä¼ æ ‡è¯†ç½®ä¸º</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="o">...//</span><span class="err">å¤šæ¡å‘½ä»¤ç»„è£…å¤šä¸ª</span><span class="n">SQLè¯­å¥è¾“å‡º</span><span class="o">.</span><span class="n">SQLåŒ…å«</span><span class="o">$</span><span class="n">StoredProcedureå°±å½“å­˜å‚¨è¿‡ç¨‹æ‰§è¡Œ</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">s</span> <span class="n">Data</span><span class="o">=</span><span class="c1">##class(MI.Common.MIFBase).DemoMOutDBInfo(&#34;DSN=DL96A&#34;,SqlStr,labno)</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span><span class="n">d</span> <span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="o">..//</span><span class="err">æ•°æ®åº“åŒå‘ä¸Šä¼ ç»“æŸ</span><span class="o">******************************************************</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">OutputRow</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ColFields</span><span class="o">=</span><span class="s2">&#34;labno,labnoInfo,patInfo&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span><span class="o">=</span><span class="c1">##Class(LIS.Util.Common).TransListNull(Data,ColFields)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">quit</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoClose</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span> <span class="p">[</span> <span class="n">PlaceAfter</span> <span class="o">=</span> <span class="n">QryLabInfoExecute</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Kill</span> <span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">QryLabInfoFetch</span><span class="p">(</span><span class="n">ByRef</span> <span class="n">qHandle</span> <span class="n">As</span> <span class="o">%</span><span class="n">Binary</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">Row</span> <span class="n">As</span> <span class="o">%</span><span class="n">List</span><span class="p">,</span> <span class="n">ByRef</span> <span class="n">AtEnd</span> <span class="n">As</span> <span class="o">%</span><span class="n">Integer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="n">Status</span> <span class="p">[</span> <span class="n">PlaceAfter</span> <span class="o">=</span> <span class="n">QryLabInfoExecute</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">AtEnd</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">repid</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=$</span><span class="n">LIST</span><span class="p">(</span><span class="n">qHandle</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Set</span> <span class="n">ind</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">If</span> <span class="n">ind</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">AtEnd</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">Row</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">Else</span>      <span class="p">{</span> 
</span></span><span class="line"><span class="cl">        <span class="n">Set</span> <span class="n">Row</span><span class="o">=^</span><span class="n">CacheTemp</span><span class="p">(</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">qHandle</span><span class="o">=$</span><span class="n">lb</span><span class="p">(</span><span class="n">AtEnd</span><span class="p">,</span><span class="n">repid</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Quit</span> <span class="o">$$$</span><span class="n">OK</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFLISMonitorTest).GetLabnoInfo(6,1001367)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetLabnoInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">è·å–é¡¹ç›®é€šé“å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="n">ScanOne</span><span class="o">^</span><span class="n">MI</span><span class="o">.</span><span class="n">MIF000</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="n">f</span>  <span class="n">s</span> <span class="n">chl</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">,</span><span class="n">chl</span><span class="p">))</span> <span class="n">q</span><span class="p">:</span><span class="n">chl</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="n">d</span>
</span></span><span class="line"><span class="cl">    <span class="o">.</span><span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">tcx_chl_</span><span class="s2">&#34;+&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">tcx</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">tcx</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">k</span> <span class="o">^</span><span class="n">TMP</span><span class="p">(</span><span class="s2">&#34;MIFTESTCODE&#34;</span><span class="p">,</span><span class="o">$</span><span class="n">j</span><span class="p">,</span><span class="n">mi</span><span class="p">,</span><span class="n">labno</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">tcx</span><span class="p">)</span> <span class="n">s</span> <span class="n">tcx</span><span class="o">=</span><span class="n">labno_</span><span class="s2">&#34;,&#34;</span><span class="n">_tcx_</span><span class="s2">&#34;|&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">tcx</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFDL96A2).GetEPIS(&#34;40&#34;,&#34;2407210719&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">IndexReportID</span> <span class="n">On</span> <span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">,</span> <span class="n">WorkGroupMachineDR</span><span class="p">,</span> <span class="n">OrderNo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">labno</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">EPIS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">WGMDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">OrderNo</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span><span class="n">WGMDR</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReportDR</span><span class="o">=$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportI</span><span class="p">(</span><span class="s2">&#34;IndexReportID&#34;</span><span class="p">,</span><span class="n">VisitNumberDR</span><span class="p">,</span><span class="n">WGMDR</span><span class="p">,</span><span class="n">OrderNo</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">EPIS</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">ReportDR</span><span class="p">)),</span><span class="mi">6</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AcceptDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">ReportDR</span><span class="p">)),</span><span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AcceptDate</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">AcceptDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">AcceptDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">AcceptDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AcceptTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberReportD</span><span class="p">(</span><span class="n">ReportDR</span><span class="p">)),</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">AcceptDT</span><span class="o">=</span><span class="n">AcceptDate_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">AcceptTime</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">EPIS_</span><span class="s2">&#34;^&#34;</span><span class="n">_AcceptDT</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="n">w</span> <span class="c1">##Class(MI.MIFDL96A2).GetPatInfo(&#34;40&#34;,&#34;L0116440&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">GetPatInfo</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">labno</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">labno</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span> <span class="n">q</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">VisitNumberDR</span> <span class="o">=</span> <span class="o">$</span><span class="n">o</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberI</span><span class="p">(</span><span class="s2">&#34;IndexVisitNumber&#34;</span><span class="p">,</span><span class="c1">##Class(LIS.Util.Common).IndexData(labno),&#34;&#34;))</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$l(VisitNumberDR) q &#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="err">æ ‡æœ¬ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">TransmitDate</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="s2">&#34;-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RPVisitNumberData</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">RPVisitNumberD</span><span class="p">(</span><span class="n">VisitNumberDR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="n">IndexEpisodeNo</span> <span class="n">On</span> <span class="p">(</span><span class="n">TransmitDate</span><span class="p">,</span> <span class="n">WorkGroupMachineDR</span><span class="p">,</span> <span class="n">EpisodeNo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">MedicalRecordNo</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">SpecimenDR</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">Specimen</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="n">EPIS</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">MedicalRecordNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>   <span class="o">//</span><span class="err">ç—…æ¡ˆå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SpecimenDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">56</span><span class="p">)</span>       <span class="o">//</span><span class="err">æ ‡æœ¬ç±»å‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">EPIS</span><span class="o">=..</span><span class="n">GetEPIS</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">)</span>                  <span class="o">//</span><span class="err">é‰´å®šå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AcceptDT</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">EPIS</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">EPIS</span><span class="o">=$</span><span class="n">p</span><span class="p">(</span><span class="n">EPIS</span><span class="p">,</span><span class="s2">&#34;^&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpecimenDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Specimen</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpecimenD</span><span class="p">(</span><span class="n">SpecimenDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">LocationDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span><span class="n">Location</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Location</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTLocationD</span><span class="p">(</span><span class="n">LocationDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Location</span><span class="p">[</span><span class="s2">&#34;ICU&#34;</span> <span class="n">s</span> <span class="n">Location</span><span class="o">=</span><span class="s2">&#34;é‡ç—‡ç›‘æŠ¤å®¤&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">DoctorDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">23</span><span class="p">),</span><span class="n">Doctor</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Doctor</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTDoctorD</span><span class="p">(</span><span class="n">DoctorDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">67</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ReceiveUserDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">68</span><span class="p">),</span><span class="n">ReceiveUser</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">ReceiveUser</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">SYSUserD</span><span class="p">(</span><span class="n">ReceiveUserDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RegNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SurName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">GivenName</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">SurName</span><span class="o">=</span><span class="n">GivenName</span> <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">PatName</span><span class="o">=</span><span class="n">SurName_GivenName</span>  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">SpeciesDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Species</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">Species</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTSpeciesD</span><span class="p">(</span><span class="n">SpeciesDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AdmTypeDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">AdmType</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AdmType</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAdmissionTypeD</span><span class="p">(</span><span class="n">AdmTypeDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">BedNo</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Age</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">AgeUnitDR</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">19</span><span class="p">),</span><span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">AgeUnitDR</span><span class="o">=</span><span class="mi">1</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;y&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">AgeUnitDR</span><span class="o">=</span><span class="mi">2</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;m&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">AgeUnitDR</span><span class="o">=</span><span class="mi">3</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;d&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">AgeUnitDR</span><span class="o">=</span><span class="mi">4</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=</span><span class="s2">&#34;h&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span><span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)</span> <span class="n">s</span> <span class="n">AgeUnit</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTAgeUnitD</span><span class="p">(</span><span class="n">AgeUnitDR</span><span class="p">)),</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="n">Age</span><span class="o">=</span><span class="n">Age_AgeUnit</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">CollectDate</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">51</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">CollectTime</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Diagnose</span><span class="o">=$</span><span class="n">tr</span><span class="p">(</span><span class="o">$</span><span class="n">lg</span><span class="p">(</span><span class="n">RPVisitNumberData</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="s2">&#34;ï¼Œ&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampleda</span><span class="o">=$</span><span class="n">zd</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="o">$</span><span class="n">p</span><span class="p">(</span><span class="o">$</span><span class="n">h</span><span class="p">,</span><span class="s2">&#34;,&#34;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Instrument</span> <span class="o">=</span> <span class="s2">&#34;XN&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span> <span class="n">s</span> <span class="n">Instrument</span><span class="o">=$</span><span class="n">lg</span><span class="p">(</span><span class="o">^</span><span class="n">dbo</span><span class="o">.</span><span class="n">BTMIMachineParameterD</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="mi">22</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampleno</span><span class="o">=</span><span class="n">labno</span>   <span class="o">//</span><span class="err">æ£€æµ‹å·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sampletype</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Feetype</span><span class="o">=</span><span class="s2">&#34;&#34;</span> <span class="p">;</span><span class="err">è´¹åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Srcdepno</span><span class="o">=</span><span class="n">Location</span>  <span class="p">;</span><span class="err">é€æ£€ç§‘å®¤</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Srcdocno</span><span class="o">=</span><span class="n">Doctor</span>   <span class="p">;</span><span class="err">é€æ£€åŒ»ç”Ÿ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Userno</span><span class="o">=</span><span class="n">ReceiveUser</span> <span class="p">;</span><span class="err">æ£€éªŒåŒ»ç”Ÿ</span><span class="p">(</span><span class="err">å½•å…¥è€…</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patno</span><span class="o">=</span><span class="n">RegNo</span> <span class="p">;</span><span class="err">ç™»è®°å·</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">BarCode</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patna</span><span class="o">=</span><span class="n">PatName</span>   <span class="p">;</span><span class="err">ç—…äººå§“å</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="mi">1</span>  <span class="p">;</span><span class="err">æ€§åˆ«</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Species</span><span class="o">=</span><span class="s2">&#34;ç”·&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;1&#34;</span>     <span class="p">;</span><span class="mi">1</span><span class="p">:</span><span class="err">ç”·</span> <span class="err">ï¼Œ</span><span class="mi">2</span> <span class="err">å¥³</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="n">Species</span> <span class="o">=</span><span class="s2">&#34;å¥³&#34;</span> <span class="n">s</span> <span class="n">Sex</span><span class="o">=</span><span class="s2">&#34;2&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Pattype</span><span class="o">=</span><span class="n">AdmType</span>   <span class="p">;</span><span class="err">ç—…äººç±»å‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Bedno</span> <span class="o">=</span> <span class="n">BedNo</span>    <span class="p">;</span><span class="err">åºŠå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patage</span><span class="o">=</span><span class="n">Age</span>  <span class="p">;</span><span class="err">å¹´é¾„</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Ageunit</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å¹´é¾„å•ä½</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reqno</span><span class="o">=</span><span class="n">labno</span>  <span class="p">;</span><span class="err">ç”³è¯·å·</span> <span class="o">=</span> <span class="err">æ£€éªŒå·</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reqda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Reqda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">ReceiveDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">ReceiveTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span><span class="err">é€æ£€æ—¥æœŸ</span> <span class="o">=</span> <span class="err">æ¥æ”¶æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reportda</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">æŠ¥å‘Šæ—¥æœŸ</span>  <span class="o">=</span> <span class="err">åˆå®¡</span><span class="p">(</span><span class="err">ä¿å­˜ç»“æœ</span><span class="p">)</span><span class="err">æ—¶é—´</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Printflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">æ‰“å°æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Resultflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç»“æœæ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Errflag</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">é”™è¯¯æ ‡å¿—</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Diagnose</span> <span class="o">=</span> <span class="n">Diagnose</span>   <span class="p">;</span><span class="err">è¯Šæ–­</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Description</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">å¤‡æ³¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Reserve</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ä¿ç•™å­—æ®µ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Patnamn</span><span class="o">=</span><span class="s2">&#34;&#34;</span>   <span class="p">;</span><span class="err">å§“åæ‹¼éŸ³ç </span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">$</span><span class="n">l</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">)</span> <span class="n">s</span> <span class="n">Getda</span><span class="o">=$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34;-&#34;</span><span class="n">_</span><span class="o">$</span><span class="n">e</span><span class="p">(</span><span class="n">CollectDate</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="n">_</span><span class="s2">&#34; &#34;</span><span class="n">_</span><span class="o">$</span><span class="n">zt</span><span class="p">(</span><span class="n">CollectTime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">e</span>  <span class="n">s</span> <span class="n">Getda</span><span class="o">=</span><span class="n">Reqda</span> <span class="p">;</span><span class="err">æ¥æ”¶æ—¶é—´</span><span class="o">/</span><span class="err">é‡‡æ ·æ—¥æœŸ</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">Wardno</span><span class="o">=</span><span class="s2">&#34;&#34;</span>  <span class="p">;</span><span class="err">ç—…åŒº</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">Sampleda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Instrument_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampleno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sampletype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Feetype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdepno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Srcdocno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Userno_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patna_</span><span class="s2">&#34;,&#34;</span><span class="n">_Sex_</span><span class="s2">&#34;,&#34;</span><span class="n">_Pattype_</span><span class="s2">&#34;,&#34;</span><span class="n">_Bedno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Patage_</span><span class="s2">&#34;,&#34;</span><span class="n">_Ageunit_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqno_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reqda_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Reportda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Printflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Resultflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Errflag_</span><span class="s2">&#34;,&#34;</span><span class="n">_Diagnose_</span><span class="s2">&#34;,&#34;</span><span class="n">_Description_</span><span class="s2">&#34;,&#34;</span><span class="n">_Reserve_</span><span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">RetString</span><span class="o">=</span><span class="n">RetString_Patnamn_</span><span class="s2">&#34;,&#34;</span><span class="n">_Getda_</span><span class="s2">&#34;,&#34;</span><span class="n">_Wardno_</span><span class="s2">&#34;,&#34;</span><span class="n">_BarCode_</span><span class="s2">&#34;,&#34;</span><span class="n">_MedicalRecordNo_</span><span class="s2">&#34;,&#34;</span><span class="n">_Specimen_</span><span class="s2">&#34;,&#34;</span><span class="n">_EPIS_</span><span class="s2">&#34;,&#34;</span><span class="n">_AcceptDT</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="n">RetString</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">///</span> <span class="err">ç›‘å¬åšä¸Šä¼ æ“ä½œåè°ƒç”¨æ”¹æ–¹æ³•è®¾ç½®æ ‡æœ¬ä¸Šä¼ è¡¨çŠ¶æ€</span>
</span></span><span class="line"><span class="cl"><span class="n">ClassMethod</span> <span class="n">SaveSDFMTHD</span><span class="p">(</span><span class="n">mi</span><span class="p">,</span> <span class="n">labno</span><span class="p">,</span> <span class="n">epis</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">P4</span><span class="p">,</span> <span class="n">P5</span><span class="p">,</span> <span class="n">P6</span><span class="p">,</span> <span class="n">P7</span><span class="p">,</span> <span class="n">P8</span><span class="p">,</span> <span class="n">P9</span><span class="p">,</span> <span class="n">P10</span><span class="p">,</span> <span class="n">P11</span><span class="p">,</span> <span class="n">P12</span><span class="p">,</span> <span class="n">P13</span><span class="p">,</span> <span class="n">Sessions</span><span class="p">,</span> <span class="n">Output</span> <span class="n">RowCount</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span><span class="p">)</span> <span class="n">As</span> <span class="o">%</span><span class="ne">String</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">mi</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">mi</span><span class="p">),</span><span class="n">labno</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">labno</span><span class="p">),</span><span class="n">epis</span> <span class="o">=</span> <span class="o">$</span><span class="n">g</span><span class="p">(</span><span class="n">epis</span><span class="p">),</span><span class="n">filename</span><span class="o">=$</span><span class="n">g</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="s1">&#39;$d(^dbo.BTMIMachineParameterD(mi)) q</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="n">ret</span><span class="o">=</span><span class="c1">##Class(MI.MachineUpload).SetSendFlag(mi,labno,&#34;S&#34;,filename)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="link" href="" ></a></p>

</section>


    <footer class="article-footer">
    <section>
        é¡µé¢æµè§ˆé‡<span id="busuanzi_value_page_pv">Loading</span>
    </section>
</footer>


    
</article>

<div class="post-password">
	
</div>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/">
        
        

        <div class="article-details">
            <h2 class="article-title"></h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/">
        
        

        <div class="article-details">
            <h2 class="article-title"></h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/">
        
        

        <div class="article-details">
            <h2 class="article-title"></h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src='//unpkg.com/@waline/client@v2/dist/waline.js'></script>
<link href='//unpkg.com/@waline/client@v2/dist/waline.css' rel='stylesheet'/>
<div id="waline" class="waline-container"></div>
<style>
    .waline-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
        --waline-font-size: var(--article-font-size);
    }
    .waline-container .wl-count {
        color: var(--card-text-color-main);
    }
</style><script>
    
    Waline.init({"dark":"html[data-scheme=\"dark\"]","el":"#waline","emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo"],"lang":"zh-CN","locale":{"admin":"Admin","placeholder":null},"requiredMeta":["name","email","url"],"serverURL":"https://waline.717170.xyz"});
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 muziyang
    </section>
    
    <section class="powerby">
        
            ç½‘ç«™æ€»è®¿å®¢æ•°ï¼š<span id='busuanzi_value_site_uv'>Loading</span><br/>ç½‘ç«™æ€»è®¿é—®é‡ï¼š<span id='busuanzi_value_site_pv'>Loading</span> <br/>
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<script defer src="https://cn.vercount.one/js"></script>

    </body>
</html>
